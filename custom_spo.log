Using device: cuda
/share/u/can/SAEBench/custom_saes/topk_sae.py:110: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  pt_params = t.load(path_to_params)
Loaded config: {'trainer': {'trainer_class': 'TrainerTopKAdditivity', 'dict_class': 'AutoEncoderTopK', 'lr': 0.000282842712474619, 'steps': 48828, 'seed': 0, 'activation_dim': 2304, 'dict_size': 8192, 'k': 20, 'auxk_alpha': 0.03125, 'additivity_coeff': 0.0, 'intersection_coeff': 0.0, 'device': 'cuda:0', 'layer': 4, 'lm_name': 'google/gemma-2-2b', 'wandb_name': 'TopKTrainer_Additivity-google/gemma-2-2b-resid_post_layer_4-add_coeff-0.0-inters_coeff-0.0', 'submodule_name': 'resid_post_layer_4'}, 'buffer': {'d_submodule': 2304, 'io': 'out', 'n_ctxs': 8192, 'ctx_len': 128, 'refresh_batch_size': 32, 'out_batch_size': 2048, 'device': 'cuda:0'}}
Original keys in state_dict: odict_keys(['b_dec', 'encoder.weight', 'encoder.bias', 'decoder.weight'])
Renamed keys in state_dict: dict_keys(['b_dec', 'W_enc', 'b_enc', 'W_dec'])
Evaluations:   0%|          | 0/1 [00:00<?, ?it/s]


Running sparse_probing evaluation




Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s][A
Loading checkpoint shards:  33%|███▎      | 1/3 [00:47<01:34, 47.39s/it][A
Loading checkpoint shards:  67%|██████▋   | 2/3 [01:32<00:46, 46.25s/it][A
Loading checkpoint shards: 100%|██████████| 3/3 [01:37<00:00, 27.17s/it][ALoading checkpoint shards: 100%|██████████| 3/3 [01:37<00:00, 32.43s/it]
Loaded pretrained model gemma-2-2b into HookedTransformer

Running SAE evaluation on all selected SAEs:   0%|          | 0/1 [00:00<?, ?it/s][ALoading activations from artifacts/sparse_probing/gemma-2-2b/blocks.4.hook_resid_post/LabHC_bias_in_bios_class_set1_activations.pt
/share/u/can/SAEBench/evals/sparse_probing/main.py:153: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  acts = torch.load(activations_path)
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 0: 0.9350000619888306
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for 1: 0.9600000381469727
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 17 epochs
Test accuracy for 2: 0.9290000200271606
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for 6: 0.9820000529289246
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 20 epochs
Test accuracy for 9: 0.971000075340271
Num non-zero elements: 1
Test accuracy for 0: 0.673
Num non-zero elements: 1
Test accuracy for 1: 0.794
Num non-zero elements: 1
Test accuracy for 2: 0.891
Num non-zero elements: 1
Test accuracy for 6: 0.97
Num non-zero elements: 1
Test accuracy for 9: 0.933
Num non-zero elements: 2
Test accuracy for 0: 0.856
Num non-zero elements: 2
Test accuracy for 1: 0.783
Num non-zero elements: 2
Test accuracy for 2: 0.908
Num non-zero elements: 2
Test accuracy for 6: 0.978
Num non-zero elements: 2
Test accuracy for 9: 0.929
Num non-zero elements: 5
Test accuracy for 0: 0.874
Num non-zero elements: 5
Test accuracy for 1: 0.853
Num non-zero elements: 5
Test accuracy for 2: 0.917
Num non-zero elements: 5
Test accuracy for 6: 0.985
Num non-zero elements: 5
Test accuracy for 9: 0.936
Num non-zero elements: 10
Test accuracy for 0: 0.891
Num non-zero elements: 10
Test accuracy for 1: 0.868
Num non-zero elements: 10
Test accuracy for 2: 0.917
Num non-zero elements: 10
Test accuracy for 6: 0.984
Num non-zero elements: 10
Test accuracy for 9: 0.95
Num non-zero elements: 20
Test accuracy for 0: 0.911
Num non-zero elements: 20
Test accuracy for 1: 0.937
Num non-zero elements: 20
Test accuracy for 2: 0.928
Num non-zero elements: 20
Test accuracy for 6: 0.989
Num non-zero elements: 20
Test accuracy for 9: 0.96
Num non-zero elements: 50
Test accuracy for 0: 0.932
Num non-zero elements: 50
Test accuracy for 1: 0.946
Num non-zero elements: 50
Test accuracy for 2: 0.934
Num non-zero elements: 50
Test accuracy for 6: 0.992
Num non-zero elements: 50
Test accuracy for 9: 0.964
Loading activations from artifacts/sparse_probing/gemma-2-2b/blocks.4.hook_resid_post/LabHC_bias_in_bios_class_set2_activations.pt
/share/u/can/SAEBench/evals/sparse_probing/main.py:153: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  acts = torch.load(activations_path)
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for 11: 0.9420000314712524
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for 13: 0.9350000619888306
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 14: 0.9300000667572021
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 24 epochs
Test accuracy for 18: 0.9110000729560852
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 25 epochs
Test accuracy for 19: 0.9570000171661377
Num non-zero elements: 1
Test accuracy for 11: 0.727
Num non-zero elements: 1
Test accuracy for 13: 0.704
Num non-zero elements: 1
Test accuracy for 14: 0.908
Num non-zero elements: 1
Test accuracy for 18: 0.634
Num non-zero elements: 1
Test accuracy for 19: 0.864
Num non-zero elements: 2
Test accuracy for 11: 0.85
Num non-zero elements: 2
Test accuracy for 13: 0.701
Num non-zero elements: 2
Test accuracy for 14: 0.899
Num non-zero elements: 2
Test accuracy for 18: 0.729
Num non-zero elements: 2
Test accuracy for 19: 0.859
Num non-zero elements: 5
Test accuracy for 11: 0.918
Num non-zero elements: 5
Test accuracy for 13: 0.759
Num non-zero elements: 5
Test accuracy for 14: 0.915
Num non-zero elements: 5
Test accuracy for 18: 0.904
Num non-zero elements: 5
Test accuracy for 19: 0.891
Num non-zero elements: 10
Test accuracy for 11: 0.915
Num non-zero elements: 10
Test accuracy for 13: 0.889
Num non-zero elements: 10
Test accuracy for 14: 0.918
Num non-zero elements: 10
Test accuracy for 18: 0.898
Num non-zero elements: 10
Test accuracy for 19: 0.899
Num non-zero elements: 20
Test accuracy for 11: 0.931
Num non-zero elements: 20
Test accuracy for 13: 0.917
Num non-zero elements: 20
Test accuracy for 14: 0.931
Num non-zero elements: 20
Test accuracy for 18: 0.911
Num non-zero elements: 20
Test accuracy for 19: 0.916
Num non-zero elements: 50
Test accuracy for 11: 0.943
Num non-zero elements: 50
Test accuracy for 13: 0.951
Num non-zero elements: 50
Test accuracy for 14: 0.933
Num non-zero elements: 50
Test accuracy for 18: 0.911
Num non-zero elements: 50
Test accuracy for 19: 0.928
Loading activations from artifacts/sparse_probing/gemma-2-2b/blocks.4.hook_resid_post/LabHC_bias_in_bios_class_set3_activations.pt
/share/u/can/SAEBench/evals/sparse_probing/main.py:153: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  acts = torch.load(activations_path)
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for 20: 0.9380000233650208
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 17 epochs
Test accuracy for 21: 0.9070000648498535
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for 22: 0.9050000309944153
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for 25: 0.9510000348091125
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for 26: 0.8700000643730164
Num non-zero elements: 1
Test accuracy for 20: 0.898
Num non-zero elements: 1
Test accuracy for 21: 0.627
Num non-zero elements: 1
Test accuracy for 22: 0.784
Num non-zero elements: 1
Test accuracy for 25: 0.857
Num non-zero elements: 1
Test accuracy for 26: 0.708
Num non-zero elements: 2
Test accuracy for 20: 0.903
Num non-zero elements: 2
Test accuracy for 21: 0.784
Num non-zero elements: 2
Test accuracy for 22: 0.865
Num non-zero elements: 2
Test accuracy for 25: 0.876
Num non-zero elements: 2
Test accuracy for 26: 0.758
Num non-zero elements: 5
Test accuracy for 20: 0.917
Num non-zero elements: 5
Test accuracy for 21: 0.791
Num non-zero elements: 5
Test accuracy for 22: 0.874
Num non-zero elements: 5
Test accuracy for 25: 0.899
Num non-zero elements: 5
Test accuracy for 26: 0.783
Num non-zero elements: 10
Test accuracy for 20: 0.918
Num non-zero elements: 10
Test accuracy for 21: 0.819
Num non-zero elements: 10
Test accuracy for 22: 0.875
Num non-zero elements: 10
Test accuracy for 25: 0.908
Num non-zero elements: 10
Test accuracy for 26: 0.847
Num non-zero elements: 20
Test accuracy for 20: 0.926
Num non-zero elements: 20
Test accuracy for 21: 0.833
Num non-zero elements: 20
Test accuracy for 22: 0.878
Num non-zero elements: 20
Test accuracy for 25: 0.931
Num non-zero elements: 20
Test accuracy for 26: 0.855
Num non-zero elements: 50
Test accuracy for 20: 0.942
Num non-zero elements: 50
Test accuracy for 21: 0.878
Num non-zero elements: 50
Test accuracy for 22: 0.902
Num non-zero elements: 50
Test accuracy for 25: 0.944
Num non-zero elements: 50
Test accuracy for 26: 0.871


  0%|          | 0/34 [00:00<?, ?it/s][A[A

  3%|▎         | 1/34 [00:00<00:03,  9.43it/s][A[A100%|██████████| 34/34 [00:00<00:00, 177.57it/s]


  0%|          | 0/31 [00:00<?, ?it/s][A[A100%|██████████| 31/31 [00:00<00:00, 880.36it/s]
Removing 31 from train set
Removing 0 from train set
Removing 29 from train set
Removing 28 from train set
Removing 7 from train set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  20%|██        | 1/5 [00:00<00:00,  7.60it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00,  8.48it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00,  9.63it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00,  9.48it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 39.42it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 39.17it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   2%|▏         | 1/63 [00:00<00:11,  5.19it/s][A[A

Collecting activations:   8%|▊         | 5/63 [00:00<00:03, 17.43it/s][A[A

Collecting activations:  11%|█         | 7/63 [00:00<00:03, 17.67it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:03, 17.82it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 17.90it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 17.96it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 17.99it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.02it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.79it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.14it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.19it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.76it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.51it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.35it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.17it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.12it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.02it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.14it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.01it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.14it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.72it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.46it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.32it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.15it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.11it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.12it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.96it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.11it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.69it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.44it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.28it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.12it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.08it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.94it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.09it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.90it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.05it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.65it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.40it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.13it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.07it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.03it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.95it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.89it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.89it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.89it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.88it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.88it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.88it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.88it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.89it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.89it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.88it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.89it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.03it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.83it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.96it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.55it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.32it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.17it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.34it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.27it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.79it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.45it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.23it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.11it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.04it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.27it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.24it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.76it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.42it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.23it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.11it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.02it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.25it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.47it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.73it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.50it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.03it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.25it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.01it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.01it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.57it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.31it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.05it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.34it/s]
Num non-zero elements: 2304
Test accuracy for 1: 0.91
Num non-zero elements: 2304
Test accuracy for 2: 0.914
Num non-zero elements: 2304
Test accuracy for 3: 0.889
Num non-zero elements: 2304
Test accuracy for 5: 0.891
Num non-zero elements: 2304
Test accuracy for 6: 0.841
Num non-zero elements: 1
Test accuracy for 1: 0.699
Num non-zero elements: 1
Test accuracy for 2: 0.701
Num non-zero elements: 1
Test accuracy for 3: 0.609
Num non-zero elements: 1
Test accuracy for 5: 0.678
Num non-zero elements: 1
Test accuracy for 6: 0.607
Num non-zero elements: 2
Test accuracy for 1: 0.741
Num non-zero elements: 2
Test accuracy for 2: 0.769
Num non-zero elements: 2
Test accuracy for 3: 0.603
Num non-zero elements: 2
Test accuracy for 5: 0.69
Num non-zero elements: 2
Test accuracy for 6: 0.613
Num non-zero elements: 5
Test accuracy for 1: 0.784
Num non-zero elements: 5
Test accuracy for 2: 0.806
Num non-zero elements: 5
Test accuracy for 3: 0.638
Num non-zero elements: 5
Test accuracy for 5: 0.713
Num non-zero elements: 5
Test accuracy for 6: 0.664
Num non-zero elements: 10
Test accuracy for 1: 0.819
Num non-zero elements: 10
Test accuracy for 2: 0.821
Num non-zero elements: 10
Test accuracy for 3: 0.744
Num non-zero elements: 10
Test accuracy for 5: 0.759
Num non-zero elements: 10
Test accuracy for 6: 0.727
Num non-zero elements: 20
Test accuracy for 1: 0.837
Num non-zero elements: 20
Test accuracy for 2: 0.838
Num non-zero elements: 20
Test accuracy for 3: 0.78
Num non-zero elements: 20
Test accuracy for 5: 0.762
Num non-zero elements: 20
Test accuracy for 6: 0.764
Num non-zero elements: 50
Test accuracy for 1: 0.89
Num non-zero elements: 50
Test accuracy for 2: 0.862
Num non-zero elements: 50
Test accuracy for 3: 0.87
Num non-zero elements: 50
Test accuracy for 5: 0.816
Num non-zero elements: 50
Test accuracy for 6: 0.793
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 14 epochs
Test accuracy for 1: 0.9300000667572021
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 20 epochs
Test accuracy for 2: 0.9290000200271606
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for 3: 0.8960000276565552
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 20 epochs
Test accuracy for 5: 0.906000018119812
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 6: 0.8520000576972961
Num non-zero elements: 1
Test accuracy for 1: 0.801
Num non-zero elements: 1
Test accuracy for 2: 0.825
Num non-zero elements: 1
Test accuracy for 3: 0.593
Num non-zero elements: 1
Test accuracy for 5: 0.806
Num non-zero elements: 1
Test accuracy for 6: 0.616
Num non-zero elements: 2
Test accuracy for 1: 0.824
Num non-zero elements: 2
Test accuracy for 2: 0.834
Num non-zero elements: 2
Test accuracy for 3: 0.707
Num non-zero elements: 2
Test accuracy for 5: 0.854
Num non-zero elements: 2
Test accuracy for 6: 0.69
Num non-zero elements: 5
Test accuracy for 1: 0.888
Num non-zero elements: 5
Test accuracy for 2: 0.859
Num non-zero elements: 5
Test accuracy for 3: 0.773
Num non-zero elements: 5
Test accuracy for 5: 0.868
Num non-zero elements: 5
Test accuracy for 6: 0.741
Num non-zero elements: 10
Test accuracy for 1: 0.891
Num non-zero elements: 10
Test accuracy for 2: 0.86
Num non-zero elements: 10
Test accuracy for 3: 0.845
Num non-zero elements: 10
Test accuracy for 5: 0.886
Num non-zero elements: 10
Test accuracy for 6: 0.758
Num non-zero elements: 20
Test accuracy for 1: 0.903
Num non-zero elements: 20
Test accuracy for 2: 0.888
Num non-zero elements: 20
Test accuracy for 3: 0.856
Num non-zero elements: 20
Test accuracy for 5: 0.897
Num non-zero elements: 20
Test accuracy for 6: 0.786
Num non-zero elements: 50
Test accuracy for 1: 0.913
Num non-zero elements: 50
Test accuracy for 2: 0.913
Num non-zero elements: 50
Test accuracy for 3: 0.868
Num non-zero elements: 50
Test accuracy for 5: 0.899
Num non-zero elements: 50
Test accuracy for 6: 0.832


Tokenizing data:   0%|          | 0/2 [00:00<?, ?it/s][A[A

Tokenizing data: 100%|██████████| 2/2 [00:00<00:00, 10.58it/s][A[ATokenizing data: 100%|██████████| 2/2 [00:00<00:00, 10.57it/s]


Tokenizing data:   0%|          | 0/2 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 2/2 [00:00<00:00, 39.71it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   6%|▋         | 4/63 [00:00<00:02, 29.02it/s][A[A

Collecting activations:  11%|█         | 7/63 [00:00<00:02, 22.10it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 20.17it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 19.32it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.97it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.70it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:00<00:02, 18.50it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.36it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.27it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.20it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.46it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   6%|▋         | 4/63 [00:00<00:02, 29.12it/s][A[A

Collecting activations:  11%|█         | 7/63 [00:00<00:02, 22.04it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 20.09it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 19.23it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.88it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.60it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:00<00:02, 18.41it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.27it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:01, 17.91it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 17.92it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 17.92it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 17.92it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.91it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.91it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.92it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.37it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.94it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.93it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.63it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.38it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.21it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.11it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.06it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.38it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.60it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.91it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.55it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.32it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.08it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.35it/s]
Num non-zero elements: 2304
Test accuracy for 1.0: 0.902
Num non-zero elements: 2304
Test accuracy for 5.0: 0.902
Num non-zero elements: 1
Test accuracy for 1.0: 0.631
Num non-zero elements: 1
Test accuracy for 5.0: 0.631
Num non-zero elements: 2
Test accuracy for 1.0: 0.654
Num non-zero elements: 2
Test accuracy for 5.0: 0.654
Num non-zero elements: 5
Test accuracy for 1.0: 0.669
Num non-zero elements: 5
Test accuracy for 5.0: 0.669
Num non-zero elements: 10
Test accuracy for 1.0: 0.764
Num non-zero elements: 10
Test accuracy for 5.0: 0.764
Num non-zero elements: 20
Test accuracy for 1.0: 0.791
Num non-zero elements: 20
Test accuracy for 5.0: 0.792
Num non-zero elements: 50
Test accuracy for 1.0: 0.83
Num non-zero elements: 50
Test accuracy for 5.0: 0.83
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 23 epochs
Test accuracy for 1.0: 0.8920000195503235
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 23 epochs
Test accuracy for 5.0: 0.8950000405311584
Num non-zero elements: 1
Test accuracy for 1.0: 0.557
Num non-zero elements: 1
Test accuracy for 5.0: 0.557
Num non-zero elements: 2
Test accuracy for 1.0: 0.652
Num non-zero elements: 2
Test accuracy for 5.0: 0.652
Num non-zero elements: 5
Test accuracy for 1.0: 0.773
Num non-zero elements: 5
Test accuracy for 5.0: 0.773
Num non-zero elements: 10
Test accuracy for 1.0: 0.813
Num non-zero elements: 10
Test accuracy for 5.0: 0.813
Num non-zero elements: 20
Test accuracy for 1.0: 0.845
Num non-zero elements: 20
Test accuracy for 5.0: 0.845
Num non-zero elements: 50
Test accuracy for 1.0: 0.867
Num non-zero elements: 50
Test accuracy for 5.0: 0.867
Loading dataset codeparrot/github-code, this usually takes ~30 seconds


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  20%|██        | 1/5 [00:01<00:07,  1.93s/it][A[A

Tokenizing data:  40%|████      | 2/5 [00:02<00:04,  1.35s/it][A[A

Tokenizing data:  60%|██████    | 3/5 [00:04<00:02,  1.28s/it][A[A

Tokenizing data:  80%|████████  | 4/5 [00:04<00:01,  1.02s/it][A[A

Tokenizing data: 100%|██████████| 5/5 [00:05<00:00,  1.14it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:05<00:00,  1.06s/it]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  20%|██        | 1/5 [00:00<00:02,  1.83it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00,  3.10it/s][A[A

Tokenizing data:  60%|██████    | 3/5 [00:01<00:00,  3.23it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:01<00:00,  3.91it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:01<00:00,  4.36it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:01<00:00,  3.67it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   6%|▋         | 4/63 [00:00<00:02, 29.50it/s][A[A

Collecting activations:  11%|█         | 7/63 [00:00<00:02, 22.18it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 20.20it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 19.31it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.95it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.68it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:00<00:02, 18.48it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.34it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.24it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.98it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.45it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.09it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.12it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.70it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.45it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.30it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.12it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.06it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.94it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.09it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.87it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.05it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.63it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.38it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.22it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.13it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.06it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.01it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.95it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.94it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.90it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.90it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.90it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.89it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.89it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.89it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.88it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.89it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.87it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.02it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.81it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:03, 18.99it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.58it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.34it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.09it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.02it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 17.97it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.93it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.92it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.90it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.89it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.89it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.89it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.88it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.87it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.87it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.86it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.86it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.87it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.86it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.86it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.86it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.86it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.86it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.86it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.86it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.85it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.85it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.99it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.82it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:03, 18.96it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.55it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.30it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.15it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.05it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 17.99it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 17.94it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.91it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.88it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.87it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.86it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.85it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.84it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.83it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.81it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.82it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.83it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.82it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.82it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.81it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.81it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.81it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.82it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.81it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:03<00:00, 17.82it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.82it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.81it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.81it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.81it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.95it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.76it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.90it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.49it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.24it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.09it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.00it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.95it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.27it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.17it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.72it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.38it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.17it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.05it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.97it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.92it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.19it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.18it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.69it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.35it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.14it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.02it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.95it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.90it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.15it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.76it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.89it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.48it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.22it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.97it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.92it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.19it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.98it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.29it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.71it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.38it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.17it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.03it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.96it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.42it/s]
Num non-zero elements: 2304
Test accuracy for C: 0.96
Num non-zero elements: 2304
Test accuracy for Python: 0.99
Num non-zero elements: 2304
Test accuracy for HTML: 0.983
Num non-zero elements: 2304
Test accuracy for Java: 0.97
Num non-zero elements: 2304
Test accuracy for PHP: 0.947
Num non-zero elements: 1
Test accuracy for C: 0.602
Num non-zero elements: 1
Test accuracy for Python: 0.631
Num non-zero elements: 1
Test accuracy for HTML: 0.722
Num non-zero elements: 1
Test accuracy for Java: 0.605
Num non-zero elements: 1
Test accuracy for PHP: 0.589
Num non-zero elements: 2
Test accuracy for C: 0.73
Num non-zero elements: 2
Test accuracy for Python: 0.679
Num non-zero elements: 2
Test accuracy for HTML: 0.947
Num non-zero elements: 2
Test accuracy for Java: 0.632
Num non-zero elements: 2
Test accuracy for PHP: 0.643
Num non-zero elements: 5
Test accuracy for C: 0.824
Num non-zero elements: 5
Test accuracy for Python: 0.751
Num non-zero elements: 5
Test accuracy for HTML: 0.948
Num non-zero elements: 5
Test accuracy for Java: 0.774
Num non-zero elements: 5
Test accuracy for PHP: 0.711
Num non-zero elements: 10
Test accuracy for C: 0.838
Num non-zero elements: 10
Test accuracy for Python: 0.877
Num non-zero elements: 10
Test accuracy for HTML: 0.949
Num non-zero elements: 10
Test accuracy for Java: 0.815
Num non-zero elements: 10
Test accuracy for PHP: 0.804
Num non-zero elements: 20
Test accuracy for C: 0.884
Num non-zero elements: 20
Test accuracy for Python: 0.921
Num non-zero elements: 20
Test accuracy for HTML: 0.965
Num non-zero elements: 20
Test accuracy for Java: 0.877
Num non-zero elements: 20
Test accuracy for PHP: 0.87
Num non-zero elements: 50
Test accuracy for C: 0.908
Num non-zero elements: 50
Test accuracy for Python: 0.971
Num non-zero elements: 50
Test accuracy for HTML: 0.969
Num non-zero elements: 50
Test accuracy for Java: 0.917
Num non-zero elements: 50
Test accuracy for PHP: 0.891
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 28 epochs
Test accuracy for C: 0.9630000591278076
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 21 epochs
Test accuracy for Python: 0.984000027179718
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 22 epochs
Test accuracy for HTML: 0.9860000610351562
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 20 epochs
Test accuracy for Java: 0.956000030040741
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 26 epochs
Test accuracy for PHP: 0.9510000348091125
Num non-zero elements: 1
Test accuracy for C: 0.632
Num non-zero elements: 1
Test accuracy for Python: 0.623
Num non-zero elements: 1
Test accuracy for HTML: 0.7
Num non-zero elements: 1
Test accuracy for Java: 0.62
Num non-zero elements: 1
Test accuracy for PHP: 0.895
Num non-zero elements: 2
Test accuracy for C: 0.69
Num non-zero elements: 2
Test accuracy for Python: 0.906
Num non-zero elements: 2
Test accuracy for HTML: 0.935
Num non-zero elements: 2
Test accuracy for Java: 0.643
Num non-zero elements: 2
Test accuracy for PHP: 0.896
Num non-zero elements: 5
Test accuracy for C: 0.828
Num non-zero elements: 5
Test accuracy for Python: 0.95
Num non-zero elements: 5
Test accuracy for HTML: 0.948
Num non-zero elements: 5
Test accuracy for Java: 0.848
Num non-zero elements: 5
Test accuracy for PHP: 0.894
Num non-zero elements: 10
Test accuracy for C: 0.882
Num non-zero elements: 10
Test accuracy for Python: 0.958
Num non-zero elements: 10
Test accuracy for HTML: 0.955
Num non-zero elements: 10
Test accuracy for Java: 0.934
Num non-zero elements: 10
Test accuracy for PHP: 0.909
Num non-zero elements: 20
Test accuracy for C: 0.908
Num non-zero elements: 20
Test accuracy for Python: 0.978
Num non-zero elements: 20
Test accuracy for HTML: 0.962
Num non-zero elements: 20
Test accuracy for Java: 0.937
Num non-zero elements: 20
Test accuracy for PHP: 0.913
Num non-zero elements: 50
Test accuracy for C: 0.934
Num non-zero elements: 50
Test accuracy for Python: 0.984
Num non-zero elements: 50
Test accuracy for HTML: 0.968
Num non-zero elements: 50
Test accuracy for Java: 0.942
Num non-zero elements: 50
Test accuracy for PHP: 0.919


Tokenizing data:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Tokenizing data:  50%|█████     | 2/4 [00:00<00:00, 14.38it/s][A[A

Tokenizing data: 100%|██████████| 4/4 [00:00<00:00, 14.34it/s][A[ATokenizing data: 100%|██████████| 4/4 [00:00<00:00, 14.28it/s]


Tokenizing data:   0%|          | 0/4 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 4/4 [00:00<00:00, 52.91it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   6%|▋         | 4/63 [00:00<00:02, 28.67it/s][A[A

Collecting activations:  11%|█         | 7/63 [00:00<00:02, 22.07it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 20.22it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 19.38it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 19.04it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.79it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:00<00:02, 18.59it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.45it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.36it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.30it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.26it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.22it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.21it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.15it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.14it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.21it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.18it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.17it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.15it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.13it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.14it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.14it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.14it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.56it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 22.61it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.75it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 19.14it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.78it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.55it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.42it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.32it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.19it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.18it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.09it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.28it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 22.40it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.65it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 19.03it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.69it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.48it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.35it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.26it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.21it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.00it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.13it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.72it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.47it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.15it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.10it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.98it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.12it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.98it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.11it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.69it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.45it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.29it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.13it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.47it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.41it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.89it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.54it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.35it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.23it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.14it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.09it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.38it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.34it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.87it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.53it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.33it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.20it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.13it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.08it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.35it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.39it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.88it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.54it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.33it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.19it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.07it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.35it/s]
Num non-zero elements: 2304
Test accuracy for 0: 0.913
Num non-zero elements: 2304
Test accuracy for 1: 0.985
Num non-zero elements: 2304
Test accuracy for 2: 0.9
Num non-zero elements: 2304
Test accuracy for 3: 0.922
Num non-zero elements: 1
Test accuracy for 0: 0.771
Num non-zero elements: 1
Test accuracy for 1: 0.692
Num non-zero elements: 1
Test accuracy for 2: 0.655
Num non-zero elements: 1
Test accuracy for 3: 0.785
Num non-zero elements: 2
Test accuracy for 0: 0.786
Num non-zero elements: 2
Test accuracy for 1: 0.798
Num non-zero elements: 2
Test accuracy for 2: 0.686
Num non-zero elements: 2
Test accuracy for 3: 0.8
Num non-zero elements: 5
Test accuracy for 0: 0.872
Num non-zero elements: 5
Test accuracy for 1: 0.882
Num non-zero elements: 5
Test accuracy for 2: 0.784
Num non-zero elements: 5
Test accuracy for 3: 0.84
Num non-zero elements: 10
Test accuracy for 0: 0.886
Num non-zero elements: 10
Test accuracy for 1: 0.935
Num non-zero elements: 10
Test accuracy for 2: 0.806
Num non-zero elements: 10
Test accuracy for 3: 0.853
Num non-zero elements: 20
Test accuracy for 0: 0.902
Num non-zero elements: 20
Test accuracy for 1: 0.964
Num non-zero elements: 20
Test accuracy for 2: 0.866
Num non-zero elements: 20
Test accuracy for 3: 0.889
Num non-zero elements: 50
Test accuracy for 0: 0.915
Num non-zero elements: 50
Test accuracy for 1: 0.975
Num non-zero elements: 50
Test accuracy for 2: 0.877
Num non-zero elements: 50
Test accuracy for 3: 0.92
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for 0: 0.9270000457763672
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for 1: 0.9770000576972961
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 12 epochs
Test accuracy for 2: 0.9170000553131104
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 14 epochs
Test accuracy for 3: 0.9380000233650208
Num non-zero elements: 1
Test accuracy for 0: 0.826
Num non-zero elements: 1
Test accuracy for 1: 0.945
Num non-zero elements: 1
Test accuracy for 2: 0.773
Num non-zero elements: 1
Test accuracy for 3: 0.711
Num non-zero elements: 2
Test accuracy for 0: 0.852
Num non-zero elements: 2
Test accuracy for 1: 0.953
Num non-zero elements: 2
Test accuracy for 2: 0.775
Num non-zero elements: 2
Test accuracy for 3: 0.694
Num non-zero elements: 5
Test accuracy for 0: 0.854
Num non-zero elements: 5
Test accuracy for 1: 0.954
Num non-zero elements: 5
Test accuracy for 2: 0.838
Num non-zero elements: 5
Test accuracy for 3: 0.811
Num non-zero elements: 10
Test accuracy for 0: 0.898
Num non-zero elements: 10
Test accuracy for 1: 0.955
Num non-zero elements: 10
Test accuracy for 2: 0.85
Num non-zero elements: 10
Test accuracy for 3: 0.875
Num non-zero elements: 20
Test accuracy for 0: 0.916
Num non-zero elements: 20
Test accuracy for 1: 0.963
Num non-zero elements: 20
Test accuracy for 2: 0.863
Num non-zero elements: 20
Test accuracy for 3: 0.907
Num non-zero elements: 50
Test accuracy for 0: 0.908
Num non-zero elements: 50
Test accuracy for 1: 0.967
Num non-zero elements: 50
Test accuracy for 2: 0.871
Num non-zero elements: 50
Test accuracy for 3: 0.921
Loading dataset Helsinki-NLP/europarl, this usually takes ~10 seconds


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 15.21it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00,  8.96it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 10.26it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 57.80it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   6%|▋         | 4/63 [00:00<00:02, 28.55it/s][A[A

Collecting activations:  11%|█         | 7/63 [00:00<00:02, 22.02it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 20.20it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 19.37it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 19.03it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.77it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:00<00:02, 18.57it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.45it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.36it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.29it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.24it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.20it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 15.10it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.46it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.63it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.77it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:03<00:00, 14.69it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 17.00it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.28it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.50it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.67it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.05it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 23.52it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.98it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 19.04it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.74it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.54it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.40it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.30it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.24it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.19it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:01, 17.52it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.19it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 15.03it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.35it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.54it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.04it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 22.26it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.53it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.97it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.64it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.41it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.28it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.98it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.17it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.37it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.23it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.75it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.47it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.30it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:03, 15.84it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.20it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:03<00:02,  7.61it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:03<00:01, 10.32it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:03<00:00, 11.67it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:03<00:00, 12.94it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 14.06it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 15.01it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 15.77it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 16.37it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 15.90it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 22.01it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.44it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.89it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.56it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.36it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.23it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.06it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 16.47it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.37it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.25it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.15it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.92it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.90it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.92it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.08it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.84it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.34it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.78it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.46it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.13it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.07it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.44it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.05it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.37it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.81it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.47it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.14it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.05it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.42it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 29.22it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 22.64it/s][A[A

Collecting activations:  56%|█████▋    | 9/16 [00:00<00:00, 20.20it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 19.23it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.85it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.59it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 19.61it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.63it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.85it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.48it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.27it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.02it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.26it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.89it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.24it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.70it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.39it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.21it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 15.71it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.09it/s]
Num non-zero elements: 2304
Test accuracy for en: 0.998
Num non-zero elements: 2304
Test accuracy for fr: 1.0
Num non-zero elements: 2304
Test accuracy for de: 0.998
Num non-zero elements: 2304
Test accuracy for es: 0.999
Num non-zero elements: 2304
Test accuracy for nl: 1.0
Num non-zero elements: 1
Test accuracy for en: 0.939
Num non-zero elements: 1
Test accuracy for fr: 0.656
Num non-zero elements: 1
Test accuracy for de: 0.809
Num non-zero elements: 1
Test accuracy for es: 0.899
Num non-zero elements: 1
Test accuracy for nl: 0.857
Num non-zero elements: 2
Test accuracy for en: 0.979
Num non-zero elements: 2
Test accuracy for fr: 0.904
Num non-zero elements: 2
Test accuracy for de: 0.828
Num non-zero elements: 2
Test accuracy for es: 0.902
Num non-zero elements: 2
Test accuracy for nl: 0.889
Num non-zero elements: 5
Test accuracy for en: 0.995
Num non-zero elements: 5
Test accuracy for fr: 0.97
Num non-zero elements: 5
Test accuracy for de: 0.888
Num non-zero elements: 5
Test accuracy for es: 0.976
Num non-zero elements: 5
Test accuracy for nl: 0.954
Num non-zero elements: 10
Test accuracy for en: 0.997
Num non-zero elements: 10
Test accuracy for fr: 0.989
Num non-zero elements: 10
Test accuracy for de: 0.978
Num non-zero elements: 10
Test accuracy for es: 0.989
Num non-zero elements: 10
Test accuracy for nl: 0.968
Num non-zero elements: 20
Test accuracy for en: 0.997
Num non-zero elements: 20
Test accuracy for fr: 0.995
Num non-zero elements: 20
Test accuracy for de: 0.99
Num non-zero elements: 20
Test accuracy for es: 0.998
Num non-zero elements: 20
Test accuracy for nl: 0.984
Num non-zero elements: 50
Test accuracy for en: 0.997
Num non-zero elements: 50
Test accuracy for fr: 1.0
Num non-zero elements: 50
Test accuracy for de: 0.999
Num non-zero elements: 50
Test accuracy for es: 0.998
Num non-zero elements: 50
Test accuracy for nl: 0.994
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 12 epochs
Test accuracy for en: 0.999000072479248
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 23 epochs
Test accuracy for fr: 1.0
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 14 epochs
Test accuracy for de: 0.9980000257492065
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for es: 1.0
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for nl: 0.9980000257492065
Num non-zero elements: 1
Test accuracy for en: 0.939
Num non-zero elements: 1
Test accuracy for fr: 0.867
Num non-zero elements: 1
Test accuracy for de: 0.864
Num non-zero elements: 1
Test accuracy for es: 0.905
Num non-zero elements: 1
Test accuracy for nl: 0.882
Num non-zero elements: 2
Test accuracy for en: 0.998
Num non-zero elements: 2
Test accuracy for fr: 0.997
Num non-zero elements: 2
Test accuracy for de: 0.864
Num non-zero elements: 2
Test accuracy for es: 0.973
Num non-zero elements: 2
Test accuracy for nl: 0.882
Num non-zero elements: 5
Test accuracy for en: 1.0
Num non-zero elements: 5
Test accuracy for fr: 0.995
Num non-zero elements: 5
Test accuracy for de: 0.997
Num non-zero elements: 5
Test accuracy for es: 0.996
Num non-zero elements: 5
Test accuracy for nl: 0.997
Num non-zero elements: 10
Test accuracy for en: 0.998
Num non-zero elements: 10
Test accuracy for fr: 0.998
Num non-zero elements: 10
Test accuracy for de: 0.999
Num non-zero elements: 10
Test accuracy for es: 0.997
Num non-zero elements: 10
Test accuracy for nl: 0.997
Num non-zero elements: 20
Test accuracy for en: 0.998
Num non-zero elements: 20
Test accuracy for fr: 0.997
Num non-zero elements: 20
Test accuracy for de: 0.997
Num non-zero elements: 20
Test accuracy for es: 0.995
Num non-zero elements: 20
Test accuracy for nl: 0.999
Num non-zero elements: 50
Test accuracy for en: 0.999
Num non-zero elements: 50
Test accuracy for fr: 0.999
Num non-zero elements: 50
Test accuracy for de: 0.996
Num non-zero elements: 50
Test accuracy for es: 0.997
Num non-zero elements: 50
Test accuracy for nl: 0.999

Running SAE evaluation on all selected SAEs: 100%|██████████| 1/1 [15:13<00:00, 913.54s/it][ARunning SAE evaluation on all selected SAEs: 100%|██████████| 1/1 [15:13<00:00, 913.54s/it]
Evaluations: 100%|██████████| 1/1 [17:03<00:00, 1023.12s/it]Evaluations: 100%|██████████| 1/1 [17:03<00:00, 1023.12s/it]
/share/u/can/SAEBench/custom_saes/topk_sae.py:110: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  pt_params = t.load(path_to_params)
Loaded config: {'trainer': {'trainer_class': 'TrainerTopKAdditivity', 'dict_class': 'AutoEncoderTopK', 'lr': 0.000282842712474619, 'steps': 48828, 'seed': 0, 'activation_dim': 2304, 'dict_size': 8192, 'k': 20, 'auxk_alpha': 0.03125, 'additivity_coeff': 0.0, 'intersection_coeff': 1.0, 'device': 'cuda:0', 'layer': 4, 'lm_name': 'google/gemma-2-2b', 'wandb_name': 'TopKTrainer_Additivity-google/gemma-2-2b-resid_post_layer_4-add_coeff-0.0-inters_coeff-1.0', 'submodule_name': 'resid_post_layer_4'}, 'buffer': {'d_submodule': 2304, 'io': 'out', 'n_ctxs': 8192, 'ctx_len': 128, 'refresh_batch_size': 32, 'out_batch_size': 2048, 'device': 'cuda:0'}}
Original keys in state_dict: odict_keys(['b_dec', 'encoder.weight', 'encoder.bias', 'decoder.weight'])
Renamed keys in state_dict: dict_keys(['b_dec', 'W_enc', 'b_enc', 'W_dec'])
Evaluations:   0%|          | 0/1 [00:00<?, ?it/s]


Running sparse_probing evaluation




Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s][A
Loading checkpoint shards:  33%|███▎      | 1/3 [00:48<01:36, 48.09s/it][A
Loading checkpoint shards:  67%|██████▋   | 2/3 [01:37<00:48, 48.75s/it][A
Loading checkpoint shards: 100%|██████████| 3/3 [01:42<00:00, 28.77s/it][ALoading checkpoint shards: 100%|██████████| 3/3 [01:42<00:00, 34.10s/it]
Loaded pretrained model gemma-2-2b into HookedTransformer

Running SAE evaluation on all selected SAEs:   0%|          | 0/1 [00:00<?, ?it/s][A

  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 402.34it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 941.80it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 12.52it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 12.65it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 12.54it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 48.61it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 46.42it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 26.21it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.16it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.65it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.64it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.25it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.96it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.76it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.58it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.47it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.40it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.36it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:02, 16.92it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.71it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.56it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.47it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 18.39it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.34it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.28it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.26it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.25it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.24it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.24it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.21it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.21it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 18.21it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.20it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 15.25it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.95it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.48it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.63it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.48it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 19.01it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.72it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.54it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.41it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.33it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.27it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.24it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.22it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.21it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.20it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.20it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.17it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.16it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.16it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.16it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.15it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.15it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.14it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.14it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.15it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.15it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.31it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.41it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.37it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.91it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.63it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.46it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.36it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.20it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.11it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.11it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.11it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.26it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.35it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.33it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.88it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.62it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.46it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.37it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.19it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.09it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.25it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.39it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.34it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.86it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.58it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.41it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.20it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.27it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.27it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.82it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.54it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.39it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.29it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.22it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.58it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.49it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.96it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.63it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.43it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.29it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.20it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.16it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.44it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.42it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.95it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.59it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.38it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.17it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.13it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.40it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.53it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.98it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.62it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.41it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.19it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.14it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.42it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.48it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.92it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.57it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.37it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.23it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.14it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.39it/s]
Num non-zero elements: 2304
Test accuracy for 0: 0.925
Num non-zero elements: 2304
Test accuracy for 1: 0.943
Num non-zero elements: 2304
Test accuracy for 2: 0.947
Num non-zero elements: 2304
Test accuracy for 6: 0.991
Num non-zero elements: 2304
Test accuracy for 9: 0.971
Num non-zero elements: 1
Test accuracy for 0: 0.603
Num non-zero elements: 1
Test accuracy for 1: 0.648
Num non-zero elements: 1
Test accuracy for 2: 0.731
Num non-zero elements: 1
Test accuracy for 6: 0.773
Num non-zero elements: 1
Test accuracy for 9: 0.68
Num non-zero elements: 2
Test accuracy for 0: 0.682
Num non-zero elements: 2
Test accuracy for 1: 0.655
Num non-zero elements: 2
Test accuracy for 2: 0.744
Num non-zero elements: 2
Test accuracy for 6: 0.771
Num non-zero elements: 2
Test accuracy for 9: 0.772
Num non-zero elements: 5
Test accuracy for 0: 0.768
Num non-zero elements: 5
Test accuracy for 1: 0.69
Num non-zero elements: 5
Test accuracy for 2: 0.754
Num non-zero elements: 5
Test accuracy for 6: 0.905
Num non-zero elements: 5
Test accuracy for 9: 0.798
Num non-zero elements: 10
Test accuracy for 0: 0.797
Num non-zero elements: 10
Test accuracy for 1: 0.818
Num non-zero elements: 10
Test accuracy for 2: 0.83
Num non-zero elements: 10
Test accuracy for 6: 0.929
Num non-zero elements: 10
Test accuracy for 9: 0.912
Num non-zero elements: 20
Test accuracy for 0: 0.796
Num non-zero elements: 20
Test accuracy for 1: 0.867
Num non-zero elements: 20
Test accuracy for 2: 0.847
Num non-zero elements: 20
Test accuracy for 6: 0.96
Num non-zero elements: 20
Test accuracy for 9: 0.945
Num non-zero elements: 50
Test accuracy for 0: 0.862
Num non-zero elements: 50
Test accuracy for 1: 0.905
Num non-zero elements: 50
Test accuracy for 2: 0.897
Num non-zero elements: 50
Test accuracy for 6: 0.977
Num non-zero elements: 50
Test accuracy for 9: 0.948
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for 0: 0.9330000281333923
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 1: 0.9490000605583191
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for 2: 0.9430000185966492
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 22 epochs
Test accuracy for 6: 0.9830000400543213
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for 9: 0.9650000333786011
Num non-zero elements: 1
Test accuracy for 0: 0.679
Num non-zero elements: 1
Test accuracy for 1: 0.637
Num non-zero elements: 1
Test accuracy for 2: 0.89
Num non-zero elements: 1
Test accuracy for 6: 0.967
Num non-zero elements: 1
Test accuracy for 9: 0.932
Num non-zero elements: 2
Test accuracy for 0: 0.703
Num non-zero elements: 2
Test accuracy for 1: 0.626
Num non-zero elements: 2
Test accuracy for 2: 0.904
Num non-zero elements: 2
Test accuracy for 6: 0.986
Num non-zero elements: 2
Test accuracy for 9: 0.93
Num non-zero elements: 5
Test accuracy for 0: 0.767
Num non-zero elements: 5
Test accuracy for 1: 0.86
Num non-zero elements: 5
Test accuracy for 2: 0.919
Num non-zero elements: 5
Test accuracy for 6: 0.987
Num non-zero elements: 5
Test accuracy for 9: 0.938
Num non-zero elements: 10
Test accuracy for 0: 0.857
Num non-zero elements: 10
Test accuracy for 1: 0.899
Num non-zero elements: 10
Test accuracy for 2: 0.922
Num non-zero elements: 10
Test accuracy for 6: 0.986
Num non-zero elements: 10
Test accuracy for 9: 0.948
Num non-zero elements: 20
Test accuracy for 0: 0.926
Num non-zero elements: 20
Test accuracy for 1: 0.926
Num non-zero elements: 20
Test accuracy for 2: 0.932
Num non-zero elements: 20
Test accuracy for 6: 0.99
Num non-zero elements: 20
Test accuracy for 9: 0.941
Num non-zero elements: 50
Test accuracy for 0: 0.947
Num non-zero elements: 50
Test accuracy for 1: 0.952
Num non-zero elements: 50
Test accuracy for 2: 0.933
Num non-zero elements: 50
Test accuracy for 6: 0.99
Num non-zero elements: 50
Test accuracy for 9: 0.968


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 635.91it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 1036.56it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 13.07it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 12.86it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 12.91it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 45.90it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 45.41it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.83it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.12it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.53it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.50it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.10it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 16.75it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:00<00:02, 18.93it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.70it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.53it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.41it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.33it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.26it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.21it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.09it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.46it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 23.06it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.82it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 18.96it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.66it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.46it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.33it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.19it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 17.05it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.28it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.20it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:01, 14.06it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 16.77it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 17.09it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 17.33it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 17.51it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.65it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.75it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.84it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.86it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.58it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.33it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.83it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.53it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.35it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.17it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.09it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:03<00:00, 16.91it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.22it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.14it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.05it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.65it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.90it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 22.70it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.26it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.28it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.91it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.64it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.41it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.24it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.92it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.92it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.92it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.34it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 22.04it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.42it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.84it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.52it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.32it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.09it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.02it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.95it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.94it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.92it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.90it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.90it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.90it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.90it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.89it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.89it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.89it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.89it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.89it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.88it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.89it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.89it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.89it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.88it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.88it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.88it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.87it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.05it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.53it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.21it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.71it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.40it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.22it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.09it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.37it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.24it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.44it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.83it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.48it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.13it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.44it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.62it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.56it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.91it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.53it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.27it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.07it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.58it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.20it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.73it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.40it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.21it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.09it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.00it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.97it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.22it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.55it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.86it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.47it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 17.47it/s][A[A

Collecting activations:  81%|████████▏ | 13/16 [00:00<00:00, 18.28it/s][A[A

Collecting activations:  94%|█████████▍| 15/16 [00:00<00:00, 18.16it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.30it/s]
Num non-zero elements: 2304
Test accuracy for 11: 0.94
Num non-zero elements: 2304
Test accuracy for 13: 0.934
Num non-zero elements: 2304
Test accuracy for 14: 0.938
Num non-zero elements: 2304
Test accuracy for 18: 0.895
Num non-zero elements: 2304
Test accuracy for 19: 0.947
Num non-zero elements: 1
Test accuracy for 11: 0.72
Num non-zero elements: 1
Test accuracy for 13: 0.694
Num non-zero elements: 1
Test accuracy for 14: 0.665
Num non-zero elements: 1
Test accuracy for 18: 0.689
Num non-zero elements: 1
Test accuracy for 19: 0.778
Num non-zero elements: 2
Test accuracy for 11: 0.727
Num non-zero elements: 2
Test accuracy for 13: 0.698
Num non-zero elements: 2
Test accuracy for 14: 0.666
Num non-zero elements: 2
Test accuracy for 18: 0.706
Num non-zero elements: 2
Test accuracy for 19: 0.78
Num non-zero elements: 5
Test accuracy for 11: 0.834
Num non-zero elements: 5
Test accuracy for 13: 0.785
Num non-zero elements: 5
Test accuracy for 14: 0.736
Num non-zero elements: 5
Test accuracy for 18: 0.707
Num non-zero elements: 5
Test accuracy for 19: 0.829
Num non-zero elements: 10
Test accuracy for 11: 0.861
Num non-zero elements: 10
Test accuracy for 13: 0.852
Num non-zero elements: 10
Test accuracy for 14: 0.799
Num non-zero elements: 10
Test accuracy for 18: 0.746
Num non-zero elements: 10
Test accuracy for 19: 0.853
Num non-zero elements: 20
Test accuracy for 11: 0.902
Num non-zero elements: 20
Test accuracy for 13: 0.864
Num non-zero elements: 20
Test accuracy for 14: 0.866
Num non-zero elements: 20
Test accuracy for 18: 0.765
Num non-zero elements: 20
Test accuracy for 19: 0.911
Num non-zero elements: 50
Test accuracy for 11: 0.93
Num non-zero elements: 50
Test accuracy for 13: 0.893
Num non-zero elements: 50
Test accuracy for 14: 0.897
Num non-zero elements: 50
Test accuracy for 18: 0.821
Num non-zero elements: 50
Test accuracy for 19: 0.931
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 14 epochs
Test accuracy for 11: 0.9490000605583191
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for 13: 0.937000036239624
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 21 epochs
Test accuracy for 14: 0.9420000314712524
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for 18: 0.9120000600814819
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 20 epochs
Test accuracy for 19: 0.9540000557899475
Num non-zero elements: 1
Test accuracy for 11: 0.729
Num non-zero elements: 1
Test accuracy for 13: 0.752
Num non-zero elements: 1
Test accuracy for 14: 0.888
Num non-zero elements: 1
Test accuracy for 18: 0.719
Num non-zero elements: 1
Test accuracy for 19: 0.859
Num non-zero elements: 2
Test accuracy for 11: 0.836
Num non-zero elements: 2
Test accuracy for 13: 0.771
Num non-zero elements: 2
Test accuracy for 14: 0.888
Num non-zero elements: 2
Test accuracy for 18: 0.887
Num non-zero elements: 2
Test accuracy for 19: 0.864
Num non-zero elements: 5
Test accuracy for 11: 0.917
Num non-zero elements: 5
Test accuracy for 13: 0.884
Num non-zero elements: 5
Test accuracy for 14: 0.909
Num non-zero elements: 5
Test accuracy for 18: 0.903
Num non-zero elements: 5
Test accuracy for 19: 0.89
Num non-zero elements: 10
Test accuracy for 11: 0.936
Num non-zero elements: 10
Test accuracy for 13: 0.89
Num non-zero elements: 10
Test accuracy for 14: 0.908
Num non-zero elements: 10
Test accuracy for 18: 0.915
Num non-zero elements: 10
Test accuracy for 19: 0.905
Num non-zero elements: 20
Test accuracy for 11: 0.948
Num non-zero elements: 20
Test accuracy for 13: 0.93
Num non-zero elements: 20
Test accuracy for 14: 0.933
Num non-zero elements: 20
Test accuracy for 18: 0.912
Num non-zero elements: 20
Test accuracy for 19: 0.928
Num non-zero elements: 50
Test accuracy for 11: 0.963
Num non-zero elements: 50
Test accuracy for 13: 0.949
Num non-zero elements: 50
Test accuracy for 14: 0.934
Num non-zero elements: 50
Test accuracy for 18: 0.917
Num non-zero elements: 50
Test accuracy for 19: 0.93


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 639.87it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 1057.52it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00,  6.29it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00,  8.97it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00,  9.08it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 46.39it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 46.33it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 28.21it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.26it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.60it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.55it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.14it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.83it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.63it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.46it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.34it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.28it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.22it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.20it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.08it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.52it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.12it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.22it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.79it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.53it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.37it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.28it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.22it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.02it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.17it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.03it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.12it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.69it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.45it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.09it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.97it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.11it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.41it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.23it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.75it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.47it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.30it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.20it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.12it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.06it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.93it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.08it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.97it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.06it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.65it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.40it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.07it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.02it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.95it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.94it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.89it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.90it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.89it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.90it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.89it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.04it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.88it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.99it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.57it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.32it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.17it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.02it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.35it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.29it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.79it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.46it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.02it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.98it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.26it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.26it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.78it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.45it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.24it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.04it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.26it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.21it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.76it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.43it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.22it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.10it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.02it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.98it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.24it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.24it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.77it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.43it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.23it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.10it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.03it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.98it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.25it/s]
Num non-zero elements: 2304
Test accuracy for 20: 0.934
Num non-zero elements: 2304
Test accuracy for 21: 0.896
Num non-zero elements: 2304
Test accuracy for 22: 0.901
Num non-zero elements: 2304
Test accuracy for 25: 0.948
Num non-zero elements: 2304
Test accuracy for 26: 0.849
Num non-zero elements: 1
Test accuracy for 20: 0.745
Num non-zero elements: 1
Test accuracy for 21: 0.627
Num non-zero elements: 1
Test accuracy for 22: 0.617
Num non-zero elements: 1
Test accuracy for 25: 0.713
Num non-zero elements: 1
Test accuracy for 26: 0.646
Num non-zero elements: 2
Test accuracy for 20: 0.807
Num non-zero elements: 2
Test accuracy for 21: 0.706
Num non-zero elements: 2
Test accuracy for 22: 0.608
Num non-zero elements: 2
Test accuracy for 25: 0.733
Num non-zero elements: 2
Test accuracy for 26: 0.656
Num non-zero elements: 5
Test accuracy for 20: 0.852
Num non-zero elements: 5
Test accuracy for 21: 0.746
Num non-zero elements: 5
Test accuracy for 22: 0.74
Num non-zero elements: 5
Test accuracy for 25: 0.779
Num non-zero elements: 5
Test accuracy for 26: 0.7
Num non-zero elements: 10
Test accuracy for 20: 0.865
Num non-zero elements: 10
Test accuracy for 21: 0.824
Num non-zero elements: 10
Test accuracy for 22: 0.745
Num non-zero elements: 10
Test accuracy for 25: 0.88
Num non-zero elements: 10
Test accuracy for 26: 0.715
Num non-zero elements: 20
Test accuracy for 20: 0.895
Num non-zero elements: 20
Test accuracy for 21: 0.835
Num non-zero elements: 20
Test accuracy for 22: 0.761
Num non-zero elements: 20
Test accuracy for 25: 0.895
Num non-zero elements: 20
Test accuracy for 26: 0.77
Num non-zero elements: 50
Test accuracy for 20: 0.91
Num non-zero elements: 50
Test accuracy for 21: 0.868
Num non-zero elements: 50
Test accuracy for 22: 0.838
Num non-zero elements: 50
Test accuracy for 25: 0.926
Num non-zero elements: 50
Test accuracy for 26: 0.832
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for 20: 0.9340000152587891
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 14 epochs
Test accuracy for 21: 0.9040000438690186
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for 22: 0.8940000534057617
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 25: 0.9470000267028809
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for 26: 0.8880000710487366
Num non-zero elements: 1
Test accuracy for 20: 0.903
Num non-zero elements: 1
Test accuracy for 21: 0.749
Num non-zero elements: 1
Test accuracy for 22: 0.761
Num non-zero elements: 1
Test accuracy for 25: 0.855
Num non-zero elements: 1
Test accuracy for 26: 0.714
Num non-zero elements: 2
Test accuracy for 20: 0.909
Num non-zero elements: 2
Test accuracy for 21: 0.755
Num non-zero elements: 2
Test accuracy for 22: 0.843
Num non-zero elements: 2
Test accuracy for 25: 0.886
Num non-zero elements: 2
Test accuracy for 26: 0.753
Num non-zero elements: 5
Test accuracy for 20: 0.909
Num non-zero elements: 5
Test accuracy for 21: 0.828
Num non-zero elements: 5
Test accuracy for 22: 0.878
Num non-zero elements: 5
Test accuracy for 25: 0.909
Num non-zero elements: 5
Test accuracy for 26: 0.797
Num non-zero elements: 10
Test accuracy for 20: 0.912
Num non-zero elements: 10
Test accuracy for 21: 0.832
Num non-zero elements: 10
Test accuracy for 22: 0.879
Num non-zero elements: 10
Test accuracy for 25: 0.909
Num non-zero elements: 10
Test accuracy for 26: 0.844
Num non-zero elements: 20
Test accuracy for 20: 0.92
Num non-zero elements: 20
Test accuracy for 21: 0.829
Num non-zero elements: 20
Test accuracy for 22: 0.879
Num non-zero elements: 20
Test accuracy for 25: 0.933
Num non-zero elements: 20
Test accuracy for 26: 0.845
Num non-zero elements: 50
Test accuracy for 20: 0.931
Num non-zero elements: 50
Test accuracy for 21: 0.862
Num non-zero elements: 50
Test accuracy for 22: 0.894
Num non-zero elements: 50
Test accuracy for 25: 0.948
Num non-zero elements: 50
Test accuracy for 26: 0.871


  0%|          | 0/34 [00:00<?, ?it/s][A[A100%|██████████| 34/34 [00:00<00:00, 396.79it/s]


  0%|          | 0/31 [00:00<?, ?it/s][A[A100%|██████████| 31/31 [00:00<00:00, 868.70it/s]
Removing 31 from train set
Removing 0 from train set
Removing 29 from train set
Removing 28 from train set
Removing 7 from train set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  20%|██        | 1/5 [00:00<00:00,  9.96it/s][A[A

Tokenizing data:  60%|██████    | 3/5 [00:00<00:00, 10.08it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 10.07it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 10.05it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 37.63it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 37.91it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.79it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.28it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.59it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.53it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.11it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.81it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.60it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.45it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.33it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.26it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.20it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.05it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.50it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.04it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.18it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.76it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.52it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.37it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.26it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.15it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.00it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.14it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.71it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.46it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.30it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.20it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.13it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.08it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.94it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.08it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.93it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.06it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.64it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.39it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.09it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.04it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.95it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.91it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.91it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.92it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.92it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.92it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.92it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.90it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.88it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.89it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.04it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.91it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.03it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.62it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.37it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.11it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.03it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 17.99it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.94it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.93it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.92it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.90it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.89it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.88it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.88it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.89it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.88it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.89it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.89it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.88it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.89it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.87it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.88it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.88it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.88it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.01it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.83it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.96it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.54it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.29it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.14it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.04it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.32it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.27it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.77it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.42it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.22it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.10it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.01it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.97it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.24it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.30it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.77it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.42it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.21it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.08it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.00it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.89it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.20it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.48it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.82it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.45it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.23it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.08it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.98it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.95it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.25it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.23it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.74it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.40it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.19it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.06it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.98it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.93it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.21it/s]
Num non-zero elements: 2304
Test accuracy for 1: 0.924
Num non-zero elements: 2304
Test accuracy for 2: 0.898
Num non-zero elements: 2304
Test accuracy for 3: 0.9
Num non-zero elements: 2304
Test accuracy for 5: 0.91
Num non-zero elements: 2304
Test accuracy for 6: 0.836
Num non-zero elements: 1
Test accuracy for 1: 0.701
Num non-zero elements: 1
Test accuracy for 2: 0.691
Num non-zero elements: 1
Test accuracy for 3: 0.601
Num non-zero elements: 1
Test accuracy for 5: 0.686
Num non-zero elements: 1
Test accuracy for 6: 0.615
Num non-zero elements: 2
Test accuracy for 1: 0.696
Num non-zero elements: 2
Test accuracy for 2: 0.773
Num non-zero elements: 2
Test accuracy for 3: 0.598
Num non-zero elements: 2
Test accuracy for 5: 0.678
Num non-zero elements: 2
Test accuracy for 6: 0.615
Num non-zero elements: 5
Test accuracy for 1: 0.787
Num non-zero elements: 5
Test accuracy for 2: 0.819
Num non-zero elements: 5
Test accuracy for 3: 0.621
Num non-zero elements: 5
Test accuracy for 5: 0.722
Num non-zero elements: 5
Test accuracy for 6: 0.699
Num non-zero elements: 10
Test accuracy for 1: 0.842
Num non-zero elements: 10
Test accuracy for 2: 0.819
Num non-zero elements: 10
Test accuracy for 3: 0.723
Num non-zero elements: 10
Test accuracy for 5: 0.747
Num non-zero elements: 10
Test accuracy for 6: 0.715
Num non-zero elements: 20
Test accuracy for 1: 0.822
Num non-zero elements: 20
Test accuracy for 2: 0.842
Num non-zero elements: 20
Test accuracy for 3: 0.765
Num non-zero elements: 20
Test accuracy for 5: 0.752
Num non-zero elements: 20
Test accuracy for 6: 0.752
Num non-zero elements: 50
Test accuracy for 1: 0.873
Num non-zero elements: 50
Test accuracy for 2: 0.858
Num non-zero elements: 50
Test accuracy for 3: 0.856
Num non-zero elements: 50
Test accuracy for 5: 0.804
Num non-zero elements: 50
Test accuracy for 6: 0.792
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for 1: 0.9270000457763672
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for 2: 0.9110000729560852
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 21 epochs
Test accuracy for 3: 0.9000000357627869
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for 5: 0.8940000534057617
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 21 epochs
Test accuracy for 6: 0.8460000157356262
Num non-zero elements: 1
Test accuracy for 1: 0.805
Num non-zero elements: 1
Test accuracy for 2: 0.823
Num non-zero elements: 1
Test accuracy for 3: 0.578
Num non-zero elements: 1
Test accuracy for 5: 0.8
Num non-zero elements: 1
Test accuracy for 6: 0.606
Num non-zero elements: 2
Test accuracy for 1: 0.795
Num non-zero elements: 2
Test accuracy for 2: 0.823
Num non-zero elements: 2
Test accuracy for 3: 0.71
Num non-zero elements: 2
Test accuracy for 5: 0.857
Num non-zero elements: 2
Test accuracy for 6: 0.627
Num non-zero elements: 5
Test accuracy for 1: 0.859
Num non-zero elements: 5
Test accuracy for 2: 0.852
Num non-zero elements: 5
Test accuracy for 3: 0.785
Num non-zero elements: 5
Test accuracy for 5: 0.86
Num non-zero elements: 5
Test accuracy for 6: 0.716
Num non-zero elements: 10
Test accuracy for 1: 0.889
Num non-zero elements: 10
Test accuracy for 2: 0.868
Num non-zero elements: 10
Test accuracy for 3: 0.842
Num non-zero elements: 10
Test accuracy for 5: 0.872
Num non-zero elements: 10
Test accuracy for 6: 0.737
Num non-zero elements: 20
Test accuracy for 1: 0.91
Num non-zero elements: 20
Test accuracy for 2: 0.886
Num non-zero elements: 20
Test accuracy for 3: 0.866
Num non-zero elements: 20
Test accuracy for 5: 0.89
Num non-zero elements: 20
Test accuracy for 6: 0.774
Num non-zero elements: 50
Test accuracy for 1: 0.918
Num non-zero elements: 50
Test accuracy for 2: 0.908
Num non-zero elements: 50
Test accuracy for 3: 0.875
Num non-zero elements: 50
Test accuracy for 5: 0.897
Num non-zero elements: 50
Test accuracy for 6: 0.822


Tokenizing data:   0%|          | 0/2 [00:00<?, ?it/s][A[A

Tokenizing data:  50%|█████     | 1/2 [00:00<00:00,  9.59it/s][A[A

Tokenizing data: 100%|██████████| 2/2 [00:00<00:00,  9.71it/s][A[ATokenizing data: 100%|██████████| 2/2 [00:00<00:00,  9.67it/s]


Tokenizing data:   0%|          | 0/2 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 2/2 [00:00<00:00, 37.58it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.26it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.08it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.49it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.46it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.06it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.77it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.56it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.41it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.30it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.23it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.19it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.02it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.46it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.31it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.24it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.79it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.51it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.34it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.17it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.12it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.76it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.98it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.13it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.59it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.29it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.77it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.49it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.31it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.20it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.13it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.47it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.59it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.60it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.97it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.61it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.39it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.24it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.15it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.57it/s]
Num non-zero elements: 2304
Test accuracy for 1.0: 0.902
Num non-zero elements: 2304
Test accuracy for 5.0: 0.904
Num non-zero elements: 1
Test accuracy for 1.0: 0.631
Num non-zero elements: 1
Test accuracy for 5.0: 0.631
Num non-zero elements: 2
Test accuracy for 1.0: 0.654
Num non-zero elements: 2
Test accuracy for 5.0: 0.654
Num non-zero elements: 5
Test accuracy for 1.0: 0.669
Num non-zero elements: 5
Test accuracy for 5.0: 0.669
Num non-zero elements: 10
Test accuracy for 1.0: 0.764
Num non-zero elements: 10
Test accuracy for 5.0: 0.764
Num non-zero elements: 20
Test accuracy for 1.0: 0.791
Num non-zero elements: 20
Test accuracy for 5.0: 0.792
Num non-zero elements: 50
Test accuracy for 1.0: 0.827
Num non-zero elements: 50
Test accuracy for 5.0: 0.828
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 21 epochs
Test accuracy for 1.0: 0.8980000615119934
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 5.0: 0.893000066280365
Num non-zero elements: 1
Test accuracy for 1.0: 0.678
Num non-zero elements: 1
Test accuracy for 5.0: 0.678
Num non-zero elements: 2
Test accuracy for 1.0: 0.68
Num non-zero elements: 2
Test accuracy for 5.0: 0.68
Num non-zero elements: 5
Test accuracy for 1.0: 0.779
Num non-zero elements: 5
Test accuracy for 5.0: 0.779
Num non-zero elements: 10
Test accuracy for 1.0: 0.834
Num non-zero elements: 10
Test accuracy for 5.0: 0.834
Num non-zero elements: 20
Test accuracy for 1.0: 0.871
Num non-zero elements: 20
Test accuracy for 5.0: 0.871
Num non-zero elements: 50
Test accuracy for 1.0: 0.884
Num non-zero elements: 50
Test accuracy for 5.0: 0.884
Loading dataset codeparrot/github-code, this usually takes ~30 seconds


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  20%|██        | 1/5 [00:01<00:07,  1.90s/it][A[A

Tokenizing data:  40%|████      | 2/5 [00:03<00:04,  1.49s/it][A[A

Tokenizing data:  60%|██████    | 3/5 [00:04<00:02,  1.29s/it][A[A

Tokenizing data:  80%|████████  | 4/5 [00:04<00:00,  1.02it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:05<00:00,  1.18it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:05<00:00,  1.05s/it]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  20%|██        | 1/5 [00:00<00:02,  1.96it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00,  3.23it/s][A[A

Tokenizing data:  60%|██████    | 3/5 [00:00<00:00,  3.32it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:01<00:00,  4.05it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:01<00:00,  4.46it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:01<00:00,  3.79it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 29.47it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.19it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.54it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.48it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.95it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.71it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:00<00:02, 18.52it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.38it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.27it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.21it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.47it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.12it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.19it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.74it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.49it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.32it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.13it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.09it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.95it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.10it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.97it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.06it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.65it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.39it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.08it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.03it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.91it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.91it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.90it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.91it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.90it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.04it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.89it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.04it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.62it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.36it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.10it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.03it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 17.99it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.94it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.92it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.91it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.90it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.90it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.89it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.89it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.89it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.88it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.88it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.87it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.88it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.88it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.88it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.87it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.87it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.87it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.87it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.54it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 28.28it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 22.97it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.32it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.27it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.87it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.58it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.35it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.20it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.88it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.87it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.85it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.84it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.84it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.84it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.84it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.84it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.83it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.83it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.82it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.82it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.81it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.82it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.82it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.84it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.27it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.82it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.93it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.50it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.25it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.09it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.00it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.95it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.28it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.25it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.74it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.39it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.04it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.96it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.93it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.20it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.21it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.73it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.39it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.19it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.05it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.96it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.92it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.20it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.16it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.71it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.37it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.04it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.96it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.90it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.18it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.18it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.70it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.35it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.03it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.96it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.91it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.18it/s]
Num non-zero elements: 2304
Test accuracy for C: 0.964
Num non-zero elements: 2304
Test accuracy for Python: 0.986
Num non-zero elements: 2304
Test accuracy for HTML: 0.988
Num non-zero elements: 2304
Test accuracy for Java: 0.959
Num non-zero elements: 2304
Test accuracy for PHP: 0.952
Num non-zero elements: 1
Test accuracy for C: 0.605
Num non-zero elements: 1
Test accuracy for Python: 0.612
Num non-zero elements: 1
Test accuracy for HTML: 0.733
Num non-zero elements: 1
Test accuracy for Java: 0.6
Num non-zero elements: 1
Test accuracy for PHP: 0.567
Num non-zero elements: 2
Test accuracy for C: 0.727
Num non-zero elements: 2
Test accuracy for Python: 0.686
Num non-zero elements: 2
Test accuracy for HTML: 0.94
Num non-zero elements: 2
Test accuracy for Java: 0.619
Num non-zero elements: 2
Test accuracy for PHP: 0.659
Num non-zero elements: 5
Test accuracy for C: 0.82
Num non-zero elements: 5
Test accuracy for Python: 0.738
Num non-zero elements: 5
Test accuracy for HTML: 0.938
Num non-zero elements: 5
Test accuracy for Java: 0.775
Num non-zero elements: 5
Test accuracy for PHP: 0.694
Num non-zero elements: 10
Test accuracy for C: 0.817
Num non-zero elements: 10
Test accuracy for Python: 0.859
Num non-zero elements: 10
Test accuracy for HTML: 0.948
Num non-zero elements: 10
Test accuracy for Java: 0.844
Num non-zero elements: 10
Test accuracy for PHP: 0.794
Num non-zero elements: 20
Test accuracy for C: 0.862
Num non-zero elements: 20
Test accuracy for Python: 0.911
Num non-zero elements: 20
Test accuracy for HTML: 0.961
Num non-zero elements: 20
Test accuracy for Java: 0.869
Num non-zero elements: 20
Test accuracy for PHP: 0.864
Num non-zero elements: 50
Test accuracy for C: 0.915
Num non-zero elements: 50
Test accuracy for Python: 0.971
Num non-zero elements: 50
Test accuracy for HTML: 0.969
Num non-zero elements: 50
Test accuracy for Java: 0.913
Num non-zero elements: 50
Test accuracy for PHP: 0.891
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 20 epochs
Test accuracy for C: 0.9530000686645508
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 17 epochs
Test accuracy for Python: 0.987000048160553
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for HTML: 0.9850000739097595
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for Java: 0.9670000672340393
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 22 epochs
Test accuracy for PHP: 0.9590000510215759
Num non-zero elements: 1
Test accuracy for C: 0.609
Num non-zero elements: 1
Test accuracy for Python: 0.911
Num non-zero elements: 1
Test accuracy for HTML: 0.939
Num non-zero elements: 1
Test accuracy for Java: 0.732
Num non-zero elements: 1
Test accuracy for PHP: 0.89
Num non-zero elements: 2
Test accuracy for C: 0.653
Num non-zero elements: 2
Test accuracy for Python: 0.937
Num non-zero elements: 2
Test accuracy for HTML: 0.938
Num non-zero elements: 2
Test accuracy for Java: 0.831
Num non-zero elements: 2
Test accuracy for PHP: 0.909
Num non-zero elements: 5
Test accuracy for C: 0.892
Num non-zero elements: 5
Test accuracy for Python: 0.946
Num non-zero elements: 5
Test accuracy for HTML: 0.948
Num non-zero elements: 5
Test accuracy for Java: 0.929
Num non-zero elements: 5
Test accuracy for PHP: 0.906
Num non-zero elements: 10
Test accuracy for C: 0.879
Num non-zero elements: 10
Test accuracy for Python: 0.964
Num non-zero elements: 10
Test accuracy for HTML: 0.95
Num non-zero elements: 10
Test accuracy for Java: 0.929
Num non-zero elements: 10
Test accuracy for PHP: 0.908
Num non-zero elements: 20
Test accuracy for C: 0.911
Num non-zero elements: 20
Test accuracy for Python: 0.976
Num non-zero elements: 20
Test accuracy for HTML: 0.955
Num non-zero elements: 20
Test accuracy for Java: 0.939
Num non-zero elements: 20
Test accuracy for PHP: 0.919
Num non-zero elements: 50
Test accuracy for C: 0.945
Num non-zero elements: 50
Test accuracy for Python: 0.982
Num non-zero elements: 50
Test accuracy for HTML: 0.961
Num non-zero elements: 50
Test accuracy for Java: 0.939
Num non-zero elements: 50
Test accuracy for PHP: 0.929


Tokenizing data:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Tokenizing data:  50%|█████     | 2/4 [00:00<00:00, 13.97it/s][A[A

Tokenizing data: 100%|██████████| 4/4 [00:00<00:00, 13.79it/s][A[ATokenizing data: 100%|██████████| 4/4 [00:00<00:00, 13.64it/s]


Tokenizing data:   0%|          | 0/4 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 4/4 [00:00<00:00, 46.24it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.12it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 22.86it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.45it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.45it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.09it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.81it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.61it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.46it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.36it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.29it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.23it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.21it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.42it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.31it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.26it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:01, 15.30it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.79it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.88it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.90it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   6%|▋         | 4/63 [00:00<00:02, 28.93it/s][A[A

Collecting activations:  11%|█         | 7/63 [00:00<00:02, 22.10it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 20.21it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 19.36it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 19.01it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.75it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:00<00:02, 18.51it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.38it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.30it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.24it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.20it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.49it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.99it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.48it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.93it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.59it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.39it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.27it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 16.52it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.44it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 18.32it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.24it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.16it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.13it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 23.84it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 20.02it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 19.03it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.71it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.49it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.32it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 17.61it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 16.05it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.40it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.28it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.19it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.12it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.07it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.14it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.95it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.73it/s][A[A

Collecting activations:  56%|█████▋    | 9/16 [00:00<00:00, 18.87it/s][A[A

Collecting activations:  69%|██████▉   | 11/16 [00:00<00:00, 18.58it/s][A[A

Collecting activations:  81%|████████▏ | 13/16 [00:00<00:00, 18.39it/s][A[A

Collecting activations:  94%|█████████▍| 15/16 [00:00<00:00, 18.26it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.72it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.40it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.23it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.74it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.46it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.29it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.14it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.51it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.34it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.85it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.51it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.30it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.17it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.09it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.31it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.51it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.90it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.54it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.31it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.09it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.31it/s]
Num non-zero elements: 2304
Test accuracy for 0: 0.912
Num non-zero elements: 2304
Test accuracy for 1: 0.984
Num non-zero elements: 2304
Test accuracy for 2: 0.903
Num non-zero elements: 2304
Test accuracy for 3: 0.917
Num non-zero elements: 1
Test accuracy for 0: 0.778
Num non-zero elements: 1
Test accuracy for 1: 0.699
Num non-zero elements: 1
Test accuracy for 2: 0.659
Num non-zero elements: 1
Test accuracy for 3: 0.783
Num non-zero elements: 2
Test accuracy for 0: 0.801
Num non-zero elements: 2
Test accuracy for 1: 0.795
Num non-zero elements: 2
Test accuracy for 2: 0.701
Num non-zero elements: 2
Test accuracy for 3: 0.791
Num non-zero elements: 5
Test accuracy for 0: 0.879
Num non-zero elements: 5
Test accuracy for 1: 0.886
Num non-zero elements: 5
Test accuracy for 2: 0.768
Num non-zero elements: 5
Test accuracy for 3: 0.846
Num non-zero elements: 10
Test accuracy for 0: 0.893
Num non-zero elements: 10
Test accuracy for 1: 0.939
Num non-zero elements: 10
Test accuracy for 2: 0.804
Num non-zero elements: 10
Test accuracy for 3: 0.847
Num non-zero elements: 20
Test accuracy for 0: 0.899
Num non-zero elements: 20
Test accuracy for 1: 0.961
Num non-zero elements: 20
Test accuracy for 2: 0.86
Num non-zero elements: 20
Test accuracy for 3: 0.879
Num non-zero elements: 50
Test accuracy for 0: 0.913
Num non-zero elements: 50
Test accuracy for 1: 0.969
Num non-zero elements: 50
Test accuracy for 2: 0.878
Num non-zero elements: 50
Test accuracy for 3: 0.916
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 14 epochs
Test accuracy for 0: 0.937000036239624
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for 1: 0.9790000319480896
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for 2: 0.9080000519752502
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for 3: 0.9280000329017639
Num non-zero elements: 1
Test accuracy for 0: 0.713
Num non-zero elements: 1
Test accuracy for 1: 0.942
Num non-zero elements: 1
Test accuracy for 2: 0.75
Num non-zero elements: 1
Test accuracy for 3: 0.7
Num non-zero elements: 2
Test accuracy for 0: 0.835
Num non-zero elements: 2
Test accuracy for 1: 0.947
Num non-zero elements: 2
Test accuracy for 2: 0.76
Num non-zero elements: 2
Test accuracy for 3: 0.766
Num non-zero elements: 5
Test accuracy for 0: 0.855
Num non-zero elements: 5
Test accuracy for 1: 0.95
Num non-zero elements: 5
Test accuracy for 2: 0.819
Num non-zero elements: 5
Test accuracy for 3: 0.799
Num non-zero elements: 10
Test accuracy for 0: 0.894
Num non-zero elements: 10
Test accuracy for 1: 0.957
Num non-zero elements: 10
Test accuracy for 2: 0.851
Num non-zero elements: 10
Test accuracy for 3: 0.862
Num non-zero elements: 20
Test accuracy for 0: 0.914
Num non-zero elements: 20
Test accuracy for 1: 0.966
Num non-zero elements: 20
Test accuracy for 2: 0.878
Num non-zero elements: 20
Test accuracy for 3: 0.894
Num non-zero elements: 50
Test accuracy for 0: 0.92
Num non-zero elements: 50
Test accuracy for 1: 0.974
Num non-zero elements: 50
Test accuracy for 2: 0.873
Num non-zero elements: 50
Test accuracy for 3: 0.928
Loading dataset Helsinki-NLP/europarl, this usually takes ~10 seconds


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 14.87it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00,  8.84it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 10.13it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 55.22it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 28.51it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.34it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.65it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.60it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 19.05it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.82it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:00<00:02, 18.60it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.47it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.37it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.31it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.26it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.23it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.20it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.14it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.11it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.12it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.13it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.56it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.27it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.29it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.85it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.59it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.41it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.20it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.06it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.21it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.03it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.15it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.73it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.49it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.33it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.13it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.14it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.09it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.15it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.72it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.47it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.30it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.09it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.97it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.11it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.00it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.10it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.67it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.43it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.15it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.10it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.05it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.92it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.92it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.92it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.91it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.91it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.92it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.91it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.06it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.87it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.02it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.61it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.36it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.20it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.11it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.06it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.39it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.26it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.80it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.46it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.14it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.02it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.29it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.26it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.81it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.47it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.13it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.06it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.02it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.29it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.22it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.76it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.44it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.25it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.05it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.27it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.26it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.78it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.43it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.25it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.02it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.26it/s]
Num non-zero elements: 2304
Test accuracy for en: 0.998
Num non-zero elements: 2304
Test accuracy for fr: 1.0
Num non-zero elements: 2304
Test accuracy for de: 0.999
Num non-zero elements: 2304
Test accuracy for es: 0.999
Num non-zero elements: 2304
Test accuracy for nl: 1.0
Num non-zero elements: 1
Test accuracy for en: 0.942
Num non-zero elements: 1
Test accuracy for fr: 0.664
Num non-zero elements: 1
Test accuracy for de: 0.789
Num non-zero elements: 1
Test accuracy for es: 0.891
Num non-zero elements: 1
Test accuracy for nl: 0.846
Num non-zero elements: 2
Test accuracy for en: 0.973
Num non-zero elements: 2
Test accuracy for fr: 0.901
Num non-zero elements: 2
Test accuracy for de: 0.836
Num non-zero elements: 2
Test accuracy for es: 0.898
Num non-zero elements: 2
Test accuracy for nl: 0.886
Num non-zero elements: 5
Test accuracy for en: 0.996
Num non-zero elements: 5
Test accuracy for fr: 0.973
Num non-zero elements: 5
Test accuracy for de: 0.884
Num non-zero elements: 5
Test accuracy for es: 0.983
Num non-zero elements: 5
Test accuracy for nl: 0.953
Num non-zero elements: 10
Test accuracy for en: 0.995
Num non-zero elements: 10
Test accuracy for fr: 0.99
Num non-zero elements: 10
Test accuracy for de: 0.965
Num non-zero elements: 10
Test accuracy for es: 0.985
Num non-zero elements: 10
Test accuracy for nl: 0.976
Num non-zero elements: 20
Test accuracy for en: 0.999
Num non-zero elements: 20
Test accuracy for fr: 0.996
Num non-zero elements: 20
Test accuracy for de: 0.986
Num non-zero elements: 20
Test accuracy for es: 0.998
Num non-zero elements: 20
Test accuracy for nl: 0.979
Num non-zero elements: 50
Test accuracy for en: 0.998
Num non-zero elements: 50
Test accuracy for fr: 1.0
Num non-zero elements: 50
Test accuracy for de: 0.996
Num non-zero elements: 50
Test accuracy for es: 1.0
Num non-zero elements: 50
Test accuracy for nl: 0.996
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 12 epochs
Test accuracy for en: 0.9980000257492065
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for fr: 0.9970000386238098
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 24 epochs
Test accuracy for de: 0.9980000257492065
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 12 epochs
Test accuracy for es: 0.999000072479248
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for nl: 0.9980000257492065
Num non-zero elements: 1
Test accuracy for en: 0.998
Num non-zero elements: 1
Test accuracy for fr: 0.996
Num non-zero elements: 1
Test accuracy for de: 0.989
Num non-zero elements: 1
Test accuracy for es: 0.864
Num non-zero elements: 1
Test accuracy for nl: 0.896
Num non-zero elements: 2
Test accuracy for en: 0.999
Num non-zero elements: 2
Test accuracy for fr: 0.995
Num non-zero elements: 2
Test accuracy for de: 0.988
Num non-zero elements: 2
Test accuracy for es: 0.885
Num non-zero elements: 2
Test accuracy for nl: 0.995
Num non-zero elements: 5
Test accuracy for en: 0.999
Num non-zero elements: 5
Test accuracy for fr: 0.995
Num non-zero elements: 5
Test accuracy for de: 0.999
Num non-zero elements: 5
Test accuracy for es: 0.887
Num non-zero elements: 5
Test accuracy for nl: 0.997
Num non-zero elements: 10
Test accuracy for en: 0.998
Num non-zero elements: 10
Test accuracy for fr: 0.997
Num non-zero elements: 10
Test accuracy for de: 0.997
Num non-zero elements: 10
Test accuracy for es: 0.991
Num non-zero elements: 10
Test accuracy for nl: 0.998
Num non-zero elements: 20
Test accuracy for en: 1.0
Num non-zero elements: 20
Test accuracy for fr: 0.995
Num non-zero elements: 20
Test accuracy for de: 0.998
Num non-zero elements: 20
Test accuracy for es: 0.993
Num non-zero elements: 20
Test accuracy for nl: 0.998
Num non-zero elements: 50
Test accuracy for en: 0.998
Num non-zero elements: 50
Test accuracy for fr: 0.995
Num non-zero elements: 50
Test accuracy for de: 0.998
Num non-zero elements: 50
Test accuracy for es: 0.995
Num non-zero elements: 50
Test accuracy for nl: 1.0

Running SAE evaluation on all selected SAEs: 100%|██████████| 1/1 [16:39<00:00, 999.39s/it][ARunning SAE evaluation on all selected SAEs: 100%|██████████| 1/1 [16:39<00:00, 999.39s/it]
Evaluations: 100%|██████████| 1/1 [18:33<00:00, 1113.26s/it]Evaluations: 100%|██████████| 1/1 [18:33<00:00, 1113.26s/it]
/share/u/can/SAEBench/custom_saes/topk_sae.py:110: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  pt_params = t.load(path_to_params)
Loaded config: {'trainer': {'trainer_class': 'TrainerTopKAdditivity', 'dict_class': 'AutoEncoderTopK', 'lr': 0.000282842712474619, 'steps': 48828, 'seed': 0, 'activation_dim': 2304, 'dict_size': 8192, 'k': 20, 'auxk_alpha': 0.03125, 'additivity_coeff': 1.0, 'intersection_coeff': 0.0, 'device': 'cuda:0', 'layer': 4, 'lm_name': 'google/gemma-2-2b', 'wandb_name': 'TopKTrainer_Additivity-google/gemma-2-2b-resid_post_layer_4-add_coeff-1.0-inters_coeff-0.0', 'submodule_name': 'resid_post_layer_4'}, 'buffer': {'d_submodule': 2304, 'io': 'out', 'n_ctxs': 8192, 'ctx_len': 128, 'refresh_batch_size': 32, 'out_batch_size': 2048, 'device': 'cuda:0'}}
Original keys in state_dict: odict_keys(['b_dec', 'encoder.weight', 'encoder.bias', 'decoder.weight'])
Renamed keys in state_dict: dict_keys(['b_dec', 'W_enc', 'b_enc', 'W_dec'])
Evaluations:   0%|          | 0/1 [00:00<?, ?it/s]


Running sparse_probing evaluation




Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s][A
Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:01,  1.55it/s][A
Loading checkpoint shards:  67%|██████▋   | 2/3 [00:01<00:00,  1.50it/s][A
Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.19it/s][ALoading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  1.95it/s]
Loaded pretrained model gemma-2-2b into HookedTransformer

Running SAE evaluation on all selected SAEs:   0%|          | 0/1 [00:00<?, ?it/s][A

  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 633.05it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 1040.10it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 12.67it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 13.26it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 13.12it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 51.30it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.62it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.20it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.62it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.58it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.19it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.89it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.68it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.50it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.41it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.34it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.29it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.26it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.23it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.21it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.20it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.16it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.15it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.15it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.15it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.15it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.13it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.13it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.13it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.13it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.57it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.39it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.35it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.87it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.61it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.44it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.34it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.27it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.22it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.19it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.14it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.14it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.12it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.12it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.12it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.12it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.26it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.35it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.33it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.88it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.62it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.44it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.33it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.26it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.08it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.23it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.30it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.30it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.85it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.58it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.41it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.20it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.02it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.20it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.34it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.25it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.79it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.52it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.35it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.11it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.95it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.12it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.21it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.21it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.75it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.48it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.30it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.19it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.12it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.50it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.26it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.92it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.57it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.35it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.23it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.14it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.09it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.37it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.34it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.85it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.52it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.33it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.22it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.13it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.09it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.35it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.44it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.90it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.55it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.35it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.22it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.14it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.37it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.37it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.86it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.50it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.30it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.17it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.09it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.06it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.33it/s]
Num non-zero elements: 2304
Test accuracy for 0: 0.925
Num non-zero elements: 2304
Test accuracy for 1: 0.943
Num non-zero elements: 2304
Test accuracy for 2: 0.947
Num non-zero elements: 2304
Test accuracy for 6: 0.991
Num non-zero elements: 2304
Test accuracy for 9: 0.971
Num non-zero elements: 1
Test accuracy for 0: 0.603
Num non-zero elements: 1
Test accuracy for 1: 0.648
Num non-zero elements: 1
Test accuracy for 2: 0.731
Num non-zero elements: 1
Test accuracy for 6: 0.773
Num non-zero elements: 1
Test accuracy for 9: 0.68
Num non-zero elements: 2
Test accuracy for 0: 0.682
Num non-zero elements: 2
Test accuracy for 1: 0.655
Num non-zero elements: 2
Test accuracy for 2: 0.744
Num non-zero elements: 2
Test accuracy for 6: 0.771
Num non-zero elements: 2
Test accuracy for 9: 0.772
Num non-zero elements: 5
Test accuracy for 0: 0.768
Num non-zero elements: 5
Test accuracy for 1: 0.69
Num non-zero elements: 5
Test accuracy for 2: 0.754
Num non-zero elements: 5
Test accuracy for 6: 0.905
Num non-zero elements: 5
Test accuracy for 9: 0.798
Num non-zero elements: 10
Test accuracy for 0: 0.797
Num non-zero elements: 10
Test accuracy for 1: 0.818
Num non-zero elements: 10
Test accuracy for 2: 0.83
Num non-zero elements: 10
Test accuracy for 6: 0.929
Num non-zero elements: 10
Test accuracy for 9: 0.912
Num non-zero elements: 20
Test accuracy for 0: 0.796
Num non-zero elements: 20
Test accuracy for 1: 0.867
Num non-zero elements: 20
Test accuracy for 2: 0.847
Num non-zero elements: 20
Test accuracy for 6: 0.96
Num non-zero elements: 20
Test accuracy for 9: 0.945
Num non-zero elements: 50
Test accuracy for 0: 0.862
Num non-zero elements: 50
Test accuracy for 1: 0.905
Num non-zero elements: 50
Test accuracy for 2: 0.897
Num non-zero elements: 50
Test accuracy for 6: 0.977
Num non-zero elements: 50
Test accuracy for 9: 0.948
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 12 epochs
Test accuracy for 0: 0.9330000281333923
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 21 epochs
Test accuracy for 1: 0.9630000591278076
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 21 epochs
Test accuracy for 2: 0.9360000491142273
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for 6: 0.9790000319480896
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 22 epochs
Test accuracy for 9: 0.9690000414848328
Num non-zero elements: 1
Test accuracy for 0: 0.628
Num non-zero elements: 1
Test accuracy for 1: 0.64
Num non-zero elements: 1
Test accuracy for 2: 0.9
Num non-zero elements: 1
Test accuracy for 6: 0.971
Num non-zero elements: 1
Test accuracy for 9: 0.928
Num non-zero elements: 2
Test accuracy for 0: 0.711
Num non-zero elements: 2
Test accuracy for 1: 0.634
Num non-zero elements: 2
Test accuracy for 2: 0.918
Num non-zero elements: 2
Test accuracy for 6: 0.984
Num non-zero elements: 2
Test accuracy for 9: 0.93
Num non-zero elements: 5
Test accuracy for 0: 0.878
Num non-zero elements: 5
Test accuracy for 1: 0.829
Num non-zero elements: 5
Test accuracy for 2: 0.917
Num non-zero elements: 5
Test accuracy for 6: 0.984
Num non-zero elements: 5
Test accuracy for 9: 0.94
Num non-zero elements: 10
Test accuracy for 0: 0.886
Num non-zero elements: 10
Test accuracy for 1: 0.898
Num non-zero elements: 10
Test accuracy for 2: 0.933
Num non-zero elements: 10
Test accuracy for 6: 0.985
Num non-zero elements: 10
Test accuracy for 9: 0.941
Num non-zero elements: 20
Test accuracy for 0: 0.918
Num non-zero elements: 20
Test accuracy for 1: 0.932
Num non-zero elements: 20
Test accuracy for 2: 0.939
Num non-zero elements: 20
Test accuracy for 6: 0.988
Num non-zero elements: 20
Test accuracy for 9: 0.946
Num non-zero elements: 50
Test accuracy for 0: 0.925
Num non-zero elements: 50
Test accuracy for 1: 0.961
Num non-zero elements: 50
Test accuracy for 2: 0.931
Num non-zero elements: 50
Test accuracy for 6: 0.988
Num non-zero elements: 50
Test accuracy for 9: 0.963


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 633.48it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 932.92it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 12.98it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 12.63it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 12.64it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 48.79it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 47.31it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 26.99it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 22.96it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.48it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.49it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.09it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.81it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.61it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.46it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.36it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.30it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.24it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.20it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.52it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.95it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.48it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.94it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.64it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.44it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.33it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.21it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.98it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.47it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.91it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.60it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.40it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.27it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.13it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.97it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.15it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.10it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.14it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.70it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.46it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.30it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.12it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.07it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 15.86it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 14.31it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 16.95it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.22it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.42it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.57it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 16.81it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.97it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.73it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 23.30it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.84it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 18.91it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.60it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.38it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.15it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 17.91it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 17.92it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.91it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.91it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.92it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.10it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 23.48it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.82it/s][A[A

Collecting activations:  56%|█████▋    | 9/16 [00:00<00:00, 18.89it/s][A[A

Collecting activations:  69%|██████▉   | 11/16 [00:00<00:00, 18.57it/s][A[A

Collecting activations:  81%|████████▏ | 13/16 [00:00<00:00, 18.36it/s][A[A

Collecting activations:  94%|█████████▍| 15/16 [00:00<00:00, 18.21it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.72it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.05it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.05it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.61it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 17.20it/s][A[A

Collecting activations:  81%|████████▏ | 13/16 [00:00<00:00, 18.45it/s][A[A

Collecting activations:  94%|█████████▍| 15/16 [00:00<00:00, 18.28it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.40it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.32it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.14it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.67it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.38it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.22it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.11it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.34it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.64it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.55it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.91it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.55it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.32it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.58it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.74it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.93it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.52it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.28it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.14it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.06it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.02it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.28it/s]
Num non-zero elements: 2304
Test accuracy for 11: 0.937
Num non-zero elements: 2304
Test accuracy for 13: 0.944
Num non-zero elements: 2304
Test accuracy for 14: 0.944
Num non-zero elements: 2304
Test accuracy for 18: 0.919
Num non-zero elements: 2304
Test accuracy for 19: 0.956
Num non-zero elements: 1
Test accuracy for 11: 0.711
Num non-zero elements: 1
Test accuracy for 13: 0.709
Num non-zero elements: 1
Test accuracy for 14: 0.669
Num non-zero elements: 1
Test accuracy for 18: 0.69
Num non-zero elements: 1
Test accuracy for 19: 0.787
Num non-zero elements: 2
Test accuracy for 11: 0.736
Num non-zero elements: 2
Test accuracy for 13: 0.692
Num non-zero elements: 2
Test accuracy for 14: 0.67
Num non-zero elements: 2
Test accuracy for 18: 0.703
Num non-zero elements: 2
Test accuracy for 19: 0.803
Num non-zero elements: 5
Test accuracy for 11: 0.832
Num non-zero elements: 5
Test accuracy for 13: 0.777
Num non-zero elements: 5
Test accuracy for 14: 0.762
Num non-zero elements: 5
Test accuracy for 18: 0.72
Num non-zero elements: 5
Test accuracy for 19: 0.824
Num non-zero elements: 10
Test accuracy for 11: 0.877
Num non-zero elements: 10
Test accuracy for 13: 0.844
Num non-zero elements: 10
Test accuracy for 14: 0.79
Num non-zero elements: 10
Test accuracy for 18: 0.746
Num non-zero elements: 10
Test accuracy for 19: 0.828
Num non-zero elements: 20
Test accuracy for 11: 0.904
Num non-zero elements: 20
Test accuracy for 13: 0.875
Num non-zero elements: 20
Test accuracy for 14: 0.856
Num non-zero elements: 20
Test accuracy for 18: 0.762
Num non-zero elements: 20
Test accuracy for 19: 0.919
Num non-zero elements: 50
Test accuracy for 11: 0.917
Num non-zero elements: 50
Test accuracy for 13: 0.893
Num non-zero elements: 50
Test accuracy for 14: 0.896
Num non-zero elements: 50
Test accuracy for 18: 0.822
Num non-zero elements: 50
Test accuracy for 19: 0.921
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 17 epochs
Test accuracy for 11: 0.940000057220459
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 21 epochs
Test accuracy for 13: 0.940000057220459
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 14: 0.9480000734329224
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 23 epochs
Test accuracy for 18: 0.9130000472068787
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 19: 0.9590000510215759
Num non-zero elements: 1
Test accuracy for 11: 0.731
Num non-zero elements: 1
Test accuracy for 13: 0.748
Num non-zero elements: 1
Test accuracy for 14: 0.846
Num non-zero elements: 1
Test accuracy for 18: 0.726
Num non-zero elements: 1
Test accuracy for 19: 0.847
Num non-zero elements: 2
Test accuracy for 11: 0.85
Num non-zero elements: 2
Test accuracy for 13: 0.736
Num non-zero elements: 2
Test accuracy for 14: 0.849
Num non-zero elements: 2
Test accuracy for 18: 0.886
Num non-zero elements: 2
Test accuracy for 19: 0.864
Num non-zero elements: 5
Test accuracy for 11: 0.867
Num non-zero elements: 5
Test accuracy for 13: 0.821
Num non-zero elements: 5
Test accuracy for 14: 0.926
Num non-zero elements: 5
Test accuracy for 18: 0.903
Num non-zero elements: 5
Test accuracy for 19: 0.883
Num non-zero elements: 10
Test accuracy for 11: 0.914
Num non-zero elements: 10
Test accuracy for 13: 0.893
Num non-zero elements: 10
Test accuracy for 14: 0.935
Num non-zero elements: 10
Test accuracy for 18: 0.908
Num non-zero elements: 10
Test accuracy for 19: 0.905
Num non-zero elements: 20
Test accuracy for 11: 0.947
Num non-zero elements: 20
Test accuracy for 13: 0.922
Num non-zero elements: 20
Test accuracy for 14: 0.929
Num non-zero elements: 20
Test accuracy for 18: 0.898
Num non-zero elements: 20
Test accuracy for 19: 0.916
Num non-zero elements: 50
Test accuracy for 11: 0.952
Num non-zero elements: 50
Test accuracy for 13: 0.939
Num non-zero elements: 50
Test accuracy for 14: 0.942
Num non-zero elements: 50
Test accuracy for 18: 0.9
Num non-zero elements: 50
Test accuracy for 19: 0.917


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 637.62it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 1050.81it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00,  6.21it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00,  8.85it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00,  8.96it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 46.90it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 46.72it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.54it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.14it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.55it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.51it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.11it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.81it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.61it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.45it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.34it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.28it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.23it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.07it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.51it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.10it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.19it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.77it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.52it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.36it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.26it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.02it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.15it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.03it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.15it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.72it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.48it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.32it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.22it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.10it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.97it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.12it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.01it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.13it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.68it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.44it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.11it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.07it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.94it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.08it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.96it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.06it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.63it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.39it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.06it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.01it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.95it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.93it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.92it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.90it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.90it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.89it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.89it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.89it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.89it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.89it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.89it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.89it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.89it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.03it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.85it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.98it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.56it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.32it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.02it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.34it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.57it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.89it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.49it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.27it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.05it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.30it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.70it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.90it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.51it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.28it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.14it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 13.78it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.01it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.38it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.78it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.42it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.23it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.98it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.94it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.20it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.98it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.99it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.55it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.29it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.11it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.02it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.96it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.32it/s]
Num non-zero elements: 2304
Test accuracy for 20: 0.939
Num non-zero elements: 2304
Test accuracy for 21: 0.886
Num non-zero elements: 2304
Test accuracy for 22: 0.905
Num non-zero elements: 2304
Test accuracy for 25: 0.954
Num non-zero elements: 2304
Test accuracy for 26: 0.881
Num non-zero elements: 1
Test accuracy for 20: 0.755
Num non-zero elements: 1
Test accuracy for 21: 0.617
Num non-zero elements: 1
Test accuracy for 22: 0.623
Num non-zero elements: 1
Test accuracy for 25: 0.716
Num non-zero elements: 1
Test accuracy for 26: 0.666
Num non-zero elements: 2
Test accuracy for 20: 0.802
Num non-zero elements: 2
Test accuracy for 21: 0.718
Num non-zero elements: 2
Test accuracy for 22: 0.609
Num non-zero elements: 2
Test accuracy for 25: 0.71
Num non-zero elements: 2
Test accuracy for 26: 0.64
Num non-zero elements: 5
Test accuracy for 20: 0.838
Num non-zero elements: 5
Test accuracy for 21: 0.757
Num non-zero elements: 5
Test accuracy for 22: 0.743
Num non-zero elements: 5
Test accuracy for 25: 0.778
Num non-zero elements: 5
Test accuracy for 26: 0.688
Num non-zero elements: 10
Test accuracy for 20: 0.885
Num non-zero elements: 10
Test accuracy for 21: 0.812
Num non-zero elements: 10
Test accuracy for 22: 0.773
Num non-zero elements: 10
Test accuracy for 25: 0.888
Num non-zero elements: 10
Test accuracy for 26: 0.7
Num non-zero elements: 20
Test accuracy for 20: 0.896
Num non-zero elements: 20
Test accuracy for 21: 0.838
Num non-zero elements: 20
Test accuracy for 22: 0.771
Num non-zero elements: 20
Test accuracy for 25: 0.909
Num non-zero elements: 20
Test accuracy for 26: 0.751
Num non-zero elements: 50
Test accuracy for 20: 0.906
Num non-zero elements: 50
Test accuracy for 21: 0.865
Num non-zero elements: 50
Test accuracy for 22: 0.839
Num non-zero elements: 50
Test accuracy for 25: 0.92
Num non-zero elements: 50
Test accuracy for 26: 0.829
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 21 epochs
Test accuracy for 20: 0.9480000734329224
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 14 epochs
Test accuracy for 21: 0.8960000276565552
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 17 epochs
Test accuracy for 22: 0.9030000567436218
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for 25: 0.9480000734329224
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 21 epochs
Test accuracy for 26: 0.8860000371932983
Num non-zero elements: 1
Test accuracy for 20: 0.879
Num non-zero elements: 1
Test accuracy for 21: 0.763
Num non-zero elements: 1
Test accuracy for 22: 0.844
Num non-zero elements: 1
Test accuracy for 25: 0.854
Num non-zero elements: 1
Test accuracy for 26: 0.727
Num non-zero elements: 2
Test accuracy for 20: 0.89
Num non-zero elements: 2
Test accuracy for 21: 0.752
Num non-zero elements: 2
Test accuracy for 22: 0.87
Num non-zero elements: 2
Test accuracy for 25: 0.875
Num non-zero elements: 2
Test accuracy for 26: 0.784
Num non-zero elements: 5
Test accuracy for 20: 0.903
Num non-zero elements: 5
Test accuracy for 21: 0.799
Num non-zero elements: 5
Test accuracy for 22: 0.869
Num non-zero elements: 5
Test accuracy for 25: 0.872
Num non-zero elements: 5
Test accuracy for 26: 0.826
Num non-zero elements: 10
Test accuracy for 20: 0.918
Num non-zero elements: 10
Test accuracy for 21: 0.812
Num non-zero elements: 10
Test accuracy for 22: 0.868
Num non-zero elements: 10
Test accuracy for 25: 0.915
Num non-zero elements: 10
Test accuracy for 26: 0.865
Num non-zero elements: 20
Test accuracy for 20: 0.928
Num non-zero elements: 20
Test accuracy for 21: 0.851
Num non-zero elements: 20
Test accuracy for 22: 0.885
Num non-zero elements: 20
Test accuracy for 25: 0.919
Num non-zero elements: 20
Test accuracy for 26: 0.846
Num non-zero elements: 50
Test accuracy for 20: 0.95
Num non-zero elements: 50
Test accuracy for 21: 0.868
Num non-zero elements: 50
Test accuracy for 22: 0.895
Num non-zero elements: 50
Test accuracy for 25: 0.946
Num non-zero elements: 50
Test accuracy for 26: 0.864


  0%|          | 0/34 [00:00<?, ?it/s][A[A100%|██████████| 34/34 [00:00<00:00, 399.13it/s]


  0%|          | 0/31 [00:00<?, ?it/s][A[A100%|██████████| 31/31 [00:00<00:00, 856.11it/s]
Removing 31 from train set
Removing 0 from train set
Removing 29 from train set
Removing 28 from train set
Removing 7 from train set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 10.11it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 10.22it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 10.21it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 37.49it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 37.35it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.82it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 22.99it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.47it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.46it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.07it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.78it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.57it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.41it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.31it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.24it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.20it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.05it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.48it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.04it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.17it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.75it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.49it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.33it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.22it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.15it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.12it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.97it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.12it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.93it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.07it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.65it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.41it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.26it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.11it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.07it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.94it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.07it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.96it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.07it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.64it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.39it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.23it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.07it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.03it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.95it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.92it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.91it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.91it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.90it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.90it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.04it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.86it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:03, 19.00it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.58it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.35it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.20it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.11it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.04it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 17.99it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.95it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.93it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.91it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.91it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.90it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.89it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.88it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.88it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.86it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.86it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.87it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.86it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.86it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.86it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.86it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.86it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.85it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.85it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.85it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.84it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.99it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.00it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.02it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.57it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.31it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.05it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.06it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 25.76it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 23.24it/s][A[A

Collecting activations:  56%|█████▋    | 9/16 [00:00<00:00, 20.41it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 19.31it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.88it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.59it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 19.62it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.29it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.76it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.40it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.20it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.00it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.96it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.23it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.25it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.74it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.39it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.06it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.99it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.95it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.21it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.24it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.74it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.37it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.17it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.05it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.97it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.93it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.20it/s]
Num non-zero elements: 2304
Test accuracy for 1: 0.928
Num non-zero elements: 2304
Test accuracy for 2: 0.908
Num non-zero elements: 2304
Test accuracy for 3: 0.893
Num non-zero elements: 2304
Test accuracy for 5: 0.911
Num non-zero elements: 2304
Test accuracy for 6: 0.836
Num non-zero elements: 1
Test accuracy for 1: 0.7
Num non-zero elements: 1
Test accuracy for 2: 0.691
Num non-zero elements: 1
Test accuracy for 3: 0.602
Num non-zero elements: 1
Test accuracy for 5: 0.677
Num non-zero elements: 1
Test accuracy for 6: 0.613
Num non-zero elements: 2
Test accuracy for 1: 0.748
Num non-zero elements: 2
Test accuracy for 2: 0.783
Num non-zero elements: 2
Test accuracy for 3: 0.609
Num non-zero elements: 2
Test accuracy for 5: 0.73
Num non-zero elements: 2
Test accuracy for 6: 0.63
Num non-zero elements: 5
Test accuracy for 1: 0.78
Num non-zero elements: 5
Test accuracy for 2: 0.811
Num non-zero elements: 5
Test accuracy for 3: 0.648
Num non-zero elements: 5
Test accuracy for 5: 0.718
Num non-zero elements: 5
Test accuracy for 6: 0.664
Num non-zero elements: 10
Test accuracy for 1: 0.838
Num non-zero elements: 10
Test accuracy for 2: 0.839
Num non-zero elements: 10
Test accuracy for 3: 0.732
Num non-zero elements: 10
Test accuracy for 5: 0.746
Num non-zero elements: 10
Test accuracy for 6: 0.744
Num non-zero elements: 20
Test accuracy for 1: 0.839
Num non-zero elements: 20
Test accuracy for 2: 0.837
Num non-zero elements: 20
Test accuracy for 3: 0.8
Num non-zero elements: 20
Test accuracy for 5: 0.748
Num non-zero elements: 20
Test accuracy for 6: 0.744
Num non-zero elements: 50
Test accuracy for 1: 0.881
Num non-zero elements: 50
Test accuracy for 2: 0.853
Num non-zero elements: 50
Test accuracy for 3: 0.859
Num non-zero elements: 50
Test accuracy for 5: 0.817
Num non-zero elements: 50
Test accuracy for 6: 0.771
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 14 epochs
Test accuracy for 1: 0.921000063419342
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 25 epochs
Test accuracy for 2: 0.9180000424385071
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for 3: 0.8960000276565552
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 25 epochs
Test accuracy for 5: 0.9050000309944153
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 6: 0.8380000591278076
Num non-zero elements: 1
Test accuracy for 1: 0.806
Num non-zero elements: 1
Test accuracy for 2: 0.777
Num non-zero elements: 1
Test accuracy for 3: 0.57
Num non-zero elements: 1
Test accuracy for 5: 0.795
Num non-zero elements: 1
Test accuracy for 6: 0.599
Num non-zero elements: 2
Test accuracy for 1: 0.832
Num non-zero elements: 2
Test accuracy for 2: 0.828
Num non-zero elements: 2
Test accuracy for 3: 0.713
Num non-zero elements: 2
Test accuracy for 5: 0.85
Num non-zero elements: 2
Test accuracy for 6: 0.688
Num non-zero elements: 5
Test accuracy for 1: 0.886
Num non-zero elements: 5
Test accuracy for 2: 0.838
Num non-zero elements: 5
Test accuracy for 3: 0.773
Num non-zero elements: 5
Test accuracy for 5: 0.858
Num non-zero elements: 5
Test accuracy for 6: 0.73
Num non-zero elements: 10
Test accuracy for 1: 0.917
Num non-zero elements: 10
Test accuracy for 2: 0.849
Num non-zero elements: 10
Test accuracy for 3: 0.839
Num non-zero elements: 10
Test accuracy for 5: 0.886
Num non-zero elements: 10
Test accuracy for 6: 0.762
Num non-zero elements: 20
Test accuracy for 1: 0.915
Num non-zero elements: 20
Test accuracy for 2: 0.895
Num non-zero elements: 20
Test accuracy for 3: 0.852
Num non-zero elements: 20
Test accuracy for 5: 0.884
Num non-zero elements: 20
Test accuracy for 6: 0.78
Num non-zero elements: 50
Test accuracy for 1: 0.912
Num non-zero elements: 50
Test accuracy for 2: 0.897
Num non-zero elements: 50
Test accuracy for 3: 0.88
Num non-zero elements: 50
Test accuracy for 5: 0.876
Num non-zero elements: 50
Test accuracy for 6: 0.809


Tokenizing data:   0%|          | 0/2 [00:00<?, ?it/s][A[A

Tokenizing data:  50%|█████     | 1/2 [00:00<00:00,  9.38it/s][A[A

Tokenizing data: 100%|██████████| 2/2 [00:00<00:00,  9.63it/s][A[ATokenizing data: 100%|██████████| 2/2 [00:00<00:00,  7.96it/s]


Tokenizing data:   0%|          | 0/2 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 2/2 [00:00<00:00, 37.46it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.23it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 22.94it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.44it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.44it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.05it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.77it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.56it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.40it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.30it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.23it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.18it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.47it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.98it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.05it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.46it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.44it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.04it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.75it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.54it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.36it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.25it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 15.86it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 18.27it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.20it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.14it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.36it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.91it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.40it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.86it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.55it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.36it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.22it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.14it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.54it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.66it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.31it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.80it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.50it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.32it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.21it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.16it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.62it/s]
Num non-zero elements: 2304
Test accuracy for 1.0: 0.903
Num non-zero elements: 2304
Test accuracy for 5.0: 0.903
Num non-zero elements: 1
Test accuracy for 1.0: 0.631
Num non-zero elements: 1
Test accuracy for 5.0: 0.631
Num non-zero elements: 2
Test accuracy for 1.0: 0.654
Num non-zero elements: 2
Test accuracy for 5.0: 0.654
Num non-zero elements: 5
Test accuracy for 1.0: 0.669
Num non-zero elements: 5
Test accuracy for 5.0: 0.669
Num non-zero elements: 10
Test accuracy for 1.0: 0.764
Num non-zero elements: 10
Test accuracy for 5.0: 0.764
Num non-zero elements: 20
Test accuracy for 1.0: 0.792
Num non-zero elements: 20
Test accuracy for 5.0: 0.791
Num non-zero elements: 50
Test accuracy for 1.0: 0.829
Num non-zero elements: 50
Test accuracy for 5.0: 0.829
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 1.0: 0.8920000195503235
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for 5.0: 0.8890000581741333
Num non-zero elements: 1
Test accuracy for 1.0: 0.583
Num non-zero elements: 1
Test accuracy for 5.0: 0.583
Num non-zero elements: 2
Test accuracy for 1.0: 0.613
Num non-zero elements: 2
Test accuracy for 5.0: 0.613
Num non-zero elements: 5
Test accuracy for 1.0: 0.786
Num non-zero elements: 5
Test accuracy for 5.0: 0.786
Num non-zero elements: 10
Test accuracy for 1.0: 0.808
Num non-zero elements: 10
Test accuracy for 5.0: 0.808
Num non-zero elements: 20
Test accuracy for 1.0: 0.849
Num non-zero elements: 20
Test accuracy for 5.0: 0.849
Num non-zero elements: 50
Test accuracy for 1.0: 0.879
Num non-zero elements: 50
Test accuracy for 5.0: 0.879
Loading dataset codeparrot/github-code, this usually takes ~30 seconds


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  20%|██        | 1/5 [00:01<00:07,  1.89s/it][A[A

Tokenizing data:  40%|████      | 2/5 [00:02<00:04,  1.37s/it][A[A

Tokenizing data:  60%|██████    | 3/5 [00:04<00:02,  1.30s/it][A[A

Tokenizing data:  80%|████████  | 4/5 [00:04<00:00,  1.02it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:05<00:00,  1.18it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:05<00:00,  1.04s/it]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  20%|██        | 1/5 [00:00<00:02,  1.93it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00,  3.19it/s][A[A

Tokenizing data:  60%|██████    | 3/5 [00:01<00:00,  3.15it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:01<00:00,  3.94it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:01<00:00,  4.38it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:01<00:00,  3.70it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 28.56it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.10it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.57it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.50it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.09it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.79it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.57it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.41it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.31it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.23it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.18it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.47it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.36it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.25it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.78it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.51it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.36it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.26it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.12it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 16.06it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.46it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.32it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.21it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.15it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 15.92it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.30it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.21it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.14it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.09it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.06it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.09it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.08it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.69it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.42it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.09it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.04it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.92it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.92it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.92it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.91it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.91it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.06it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.90it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.03it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.61it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.37it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.22it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.12it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.05it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.00it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.95it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.94it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.91it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.90it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.90it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.89it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.89it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.89it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.89it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.88it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.89it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.89it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.89it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.89it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.89it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.02it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.85it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:03, 18.96it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.55it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.06it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.00it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 17.95it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.92it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.89it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.87it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.86it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.86it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.86it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.85it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.86it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.86it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.85it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.84it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.83it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.83it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.85it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.84it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.83it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.84it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:03<00:00, 17.84it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.84it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.83it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.82it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.82it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.97it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.81it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.96it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.53it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.28it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.10it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.01it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.96it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.31it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.20it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.73it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.39it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.05it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.97it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.93it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.20it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.16it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.72it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.37it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.17it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.05it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.97it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.94it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.20it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.19it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.71it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.37it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.17it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.05it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.97it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.93it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.20it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.21it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.71it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.36it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.17it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.04it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.96it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.91it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.19it/s]
Num non-zero elements: 2304
Test accuracy for C: 0.957
Num non-zero elements: 2304
Test accuracy for Python: 0.988
Num non-zero elements: 2304
Test accuracy for HTML: 0.979
Num non-zero elements: 2304
Test accuracy for Java: 0.964
Num non-zero elements: 2304
Test accuracy for PHP: 0.942
Num non-zero elements: 1
Test accuracy for C: 0.592
Num non-zero elements: 1
Test accuracy for Python: 0.634
Num non-zero elements: 1
Test accuracy for HTML: 0.713
Num non-zero elements: 1
Test accuracy for Java: 0.611
Num non-zero elements: 1
Test accuracy for PHP: 0.58
Num non-zero elements: 2
Test accuracy for C: 0.732
Num non-zero elements: 2
Test accuracy for Python: 0.68
Num non-zero elements: 2
Test accuracy for HTML: 0.946
Num non-zero elements: 2
Test accuracy for Java: 0.615
Num non-zero elements: 2
Test accuracy for PHP: 0.636
Num non-zero elements: 5
Test accuracy for C: 0.827
Num non-zero elements: 5
Test accuracy for Python: 0.732
Num non-zero elements: 5
Test accuracy for HTML: 0.951
Num non-zero elements: 5
Test accuracy for Java: 0.786
Num non-zero elements: 5
Test accuracy for PHP: 0.717
Num non-zero elements: 10
Test accuracy for C: 0.834
Num non-zero elements: 10
Test accuracy for Python: 0.861
Num non-zero elements: 10
Test accuracy for HTML: 0.952
Num non-zero elements: 10
Test accuracy for Java: 0.835
Num non-zero elements: 10
Test accuracy for PHP: 0.816
Num non-zero elements: 20
Test accuracy for C: 0.868
Num non-zero elements: 20
Test accuracy for Python: 0.912
Num non-zero elements: 20
Test accuracy for HTML: 0.961
Num non-zero elements: 20
Test accuracy for Java: 0.875
Num non-zero elements: 20
Test accuracy for PHP: 0.879
Num non-zero elements: 50
Test accuracy for C: 0.919
Num non-zero elements: 50
Test accuracy for Python: 0.964
Num non-zero elements: 50
Test accuracy for HTML: 0.97
Num non-zero elements: 50
Test accuracy for Java: 0.917
Num non-zero elements: 50
Test accuracy for PHP: 0.894
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for C: 0.9530000686645508
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 33 epochs
Test accuracy for Python: 0.984000027179718
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 23 epochs
Test accuracy for HTML: 0.9920000433921814
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 23 epochs
Test accuracy for Java: 0.9650000333786011
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for PHP: 0.956000030040741
Num non-zero elements: 1
Test accuracy for C: 0.638
Num non-zero elements: 1
Test accuracy for Python: 0.885
Num non-zero elements: 1
Test accuracy for HTML: 0.874
Num non-zero elements: 1
Test accuracy for Java: 0.646
Num non-zero elements: 1
Test accuracy for PHP: 0.906
Num non-zero elements: 2
Test accuracy for C: 0.666
Num non-zero elements: 2
Test accuracy for Python: 0.903
Num non-zero elements: 2
Test accuracy for HTML: 0.888
Num non-zero elements: 2
Test accuracy for Java: 0.809
Num non-zero elements: 2
Test accuracy for PHP: 0.906
Num non-zero elements: 5
Test accuracy for C: 0.869
Num non-zero elements: 5
Test accuracy for Python: 0.953
Num non-zero elements: 5
Test accuracy for HTML: 0.938
Num non-zero elements: 5
Test accuracy for Java: 0.813
Num non-zero elements: 5
Test accuracy for PHP: 0.906
Num non-zero elements: 10
Test accuracy for C: 0.903
Num non-zero elements: 10
Test accuracy for Python: 0.968
Num non-zero elements: 10
Test accuracy for HTML: 0.946
Num non-zero elements: 10
Test accuracy for Java: 0.827
Num non-zero elements: 10
Test accuracy for PHP: 0.912
Num non-zero elements: 20
Test accuracy for C: 0.912
Num non-zero elements: 20
Test accuracy for Python: 0.977
Num non-zero elements: 20
Test accuracy for HTML: 0.952
Num non-zero elements: 20
Test accuracy for Java: 0.861
Num non-zero elements: 20
Test accuracy for PHP: 0.919
Num non-zero elements: 50
Test accuracy for C: 0.943
Num non-zero elements: 50
Test accuracy for Python: 0.978
Num non-zero elements: 50
Test accuracy for HTML: 0.96
Num non-zero elements: 50
Test accuracy for Java: 0.936
Num non-zero elements: 50
Test accuracy for PHP: 0.929


Tokenizing data:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Tokenizing data:  50%|█████     | 2/4 [00:00<00:00, 14.87it/s][A[A

Tokenizing data: 100%|██████████| 4/4 [00:00<00:00, 14.71it/s][A[ATokenizing data: 100%|██████████| 4/4 [00:00<00:00, 14.54it/s]


Tokenizing data:   0%|          | 0/4 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 4/4 [00:00<00:00, 56.20it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 26.73it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 22.98it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.54it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.57it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:03, 13.61it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 16.27it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 16.72it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 17.09it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 17.37it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 16.78it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 16.39it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 18.63it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.49it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.40it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.32it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.27it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.23it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.20it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.19it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 18.15it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.15it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.14it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.13it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.14it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.93it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 24.08it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 20.19it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 19.22it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.88it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.64it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.48it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.37it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.29it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.24it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.19it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 16.67it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.54it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.42it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.34it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.27it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.22it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.19it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.17it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.15it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.14it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.13it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.12it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.20it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 26.15it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 20.74it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 19.45it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 19.02it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.73it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.54it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.40it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:00<00:02, 18.32it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.25it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.21it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.18it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.09it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.37it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 22.14it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.55it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 19.01it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.69it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.49it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.36it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.27it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.22it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.56it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.18it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.21it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.02it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.46it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.90it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.58it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.38it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.21it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.55it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.87it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.74it/s][A[A

Collecting activations:  56%|█████▋    | 9/16 [00:00<00:00, 18.93it/s][A[A

Collecting activations:  69%|██████▉   | 11/16 [00:00<00:00, 18.64it/s][A[A

Collecting activations:  81%|████████▏ | 13/16 [00:00<00:00, 18.44it/s][A[A

Collecting activations:  94%|█████████▍| 15/16 [00:00<00:00, 18.30it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.76it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.39it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.27it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.79it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.52it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.35it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.23it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 16.46it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.72it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 29.18it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 22.11it/s][A[A

Collecting activations:  56%|█████▋    | 9/16 [00:00<00:00, 20.01it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 19.14it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.80it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.58it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 19.45it/s]
Num non-zero elements: 2304
Test accuracy for 0: 0.923
Num non-zero elements: 2304
Test accuracy for 1: 0.987
Num non-zero elements: 2304
Test accuracy for 2: 0.902
Num non-zero elements: 2304
Test accuracy for 3: 0.933
Num non-zero elements: 1
Test accuracy for 0: 0.77
Num non-zero elements: 1
Test accuracy for 1: 0.683
Num non-zero elements: 1
Test accuracy for 2: 0.65
Num non-zero elements: 1
Test accuracy for 3: 0.779
Num non-zero elements: 2
Test accuracy for 0: 0.776
Num non-zero elements: 2
Test accuracy for 1: 0.808
Num non-zero elements: 2
Test accuracy for 2: 0.698
Num non-zero elements: 2
Test accuracy for 3: 0.793
Num non-zero elements: 5
Test accuracy for 0: 0.886
Num non-zero elements: 5
Test accuracy for 1: 0.873
Num non-zero elements: 5
Test accuracy for 2: 0.769
Num non-zero elements: 5
Test accuracy for 3: 0.842
Num non-zero elements: 10
Test accuracy for 0: 0.884
Num non-zero elements: 10
Test accuracy for 1: 0.944
Num non-zero elements: 10
Test accuracy for 2: 0.811
Num non-zero elements: 10
Test accuracy for 3: 0.856
Num non-zero elements: 20
Test accuracy for 0: 0.891
Num non-zero elements: 20
Test accuracy for 1: 0.966
Num non-zero elements: 20
Test accuracy for 2: 0.857
Num non-zero elements: 20
Test accuracy for 3: 0.892
Num non-zero elements: 50
Test accuracy for 0: 0.905
Num non-zero elements: 50
Test accuracy for 1: 0.969
Num non-zero elements: 50
Test accuracy for 2: 0.882
Num non-zero elements: 50
Test accuracy for 3: 0.919
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for 0: 0.9320000410079956
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 25 epochs
Test accuracy for 1: 0.9720000624656677
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for 2: 0.921000063419342
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for 3: 0.9420000314712524
Num non-zero elements: 1
Test accuracy for 0: 0.809
Num non-zero elements: 1
Test accuracy for 1: 0.936
Num non-zero elements: 1
Test accuracy for 2: 0.703
Num non-zero elements: 1
Test accuracy for 3: 0.701
Num non-zero elements: 2
Test accuracy for 0: 0.845
Num non-zero elements: 2
Test accuracy for 1: 0.935
Num non-zero elements: 2
Test accuracy for 2: 0.794
Num non-zero elements: 2
Test accuracy for 3: 0.817
Num non-zero elements: 5
Test accuracy for 0: 0.858
Num non-zero elements: 5
Test accuracy for 1: 0.946
Num non-zero elements: 5
Test accuracy for 2: 0.84
Num non-zero elements: 5
Test accuracy for 3: 0.832
Num non-zero elements: 10
Test accuracy for 0: 0.9
Num non-zero elements: 10
Test accuracy for 1: 0.959
Num non-zero elements: 10
Test accuracy for 2: 0.853
Num non-zero elements: 10
Test accuracy for 3: 0.876
Num non-zero elements: 20
Test accuracy for 0: 0.906
Num non-zero elements: 20
Test accuracy for 1: 0.968
Num non-zero elements: 20
Test accuracy for 2: 0.878
Num non-zero elements: 20
Test accuracy for 3: 0.908
Num non-zero elements: 50
Test accuracy for 0: 0.915
Num non-zero elements: 50
Test accuracy for 1: 0.97
Num non-zero elements: 50
Test accuracy for 2: 0.886
Num non-zero elements: 50
Test accuracy for 3: 0.921
Loading dataset Helsinki-NLP/europarl, this usually takes ~10 seconds


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 14.73it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00,  8.74it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 10.00it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 54.00it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.30it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.15it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.55it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.54it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.14it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.86it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.65it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.48it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.38it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.31it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.26it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.23it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.14it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.14it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.14it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.14it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.12it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.12it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.11it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.11it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.55it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.12it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.22it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.79it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.54it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.38it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.28it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.17it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.05it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.19it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.11it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.20it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.77it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.52it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.36it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.27it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.12it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.16it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.98it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.13it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.71it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.47it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.15it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.11it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.94it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.11it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.96it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.06it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.61it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.37it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.22it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.13it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.07it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.02it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.95it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.91it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.91it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.91it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.91it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.91it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.91it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.04it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.89it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.01it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.60it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.36it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.20it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.11it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.07it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.39it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.26it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.77it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.45it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.25it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.14it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.06it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.28it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.31it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.81it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.47it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.13it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.06it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.02it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.29it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.36it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.82it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.48it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.13it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.05it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.29it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.28it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.81it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.45it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.24it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.11it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.03it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.26it/s]
Num non-zero elements: 2304
Test accuracy for en: 0.997
Num non-zero elements: 2304
Test accuracy for fr: 1.0
Num non-zero elements: 2304
Test accuracy for de: 1.0
Num non-zero elements: 2304
Test accuracy for es: 1.0
Num non-zero elements: 2304
Test accuracy for nl: 1.0
Num non-zero elements: 1
Test accuracy for en: 0.946
Num non-zero elements: 1
Test accuracy for fr: 0.652
Num non-zero elements: 1
Test accuracy for de: 0.819
Num non-zero elements: 1
Test accuracy for es: 0.887
Num non-zero elements: 1
Test accuracy for nl: 0.851
Num non-zero elements: 2
Test accuracy for en: 0.972
Num non-zero elements: 2
Test accuracy for fr: 0.895
Num non-zero elements: 2
Test accuracy for de: 0.847
Num non-zero elements: 2
Test accuracy for es: 0.9
Num non-zero elements: 2
Test accuracy for nl: 0.892
Num non-zero elements: 5
Test accuracy for en: 0.993
Num non-zero elements: 5
Test accuracy for fr: 0.966
Num non-zero elements: 5
Test accuracy for de: 0.894
Num non-zero elements: 5
Test accuracy for es: 0.982
Num non-zero elements: 5
Test accuracy for nl: 0.939
Num non-zero elements: 10
Test accuracy for en: 1.0
Num non-zero elements: 10
Test accuracy for fr: 0.989
Num non-zero elements: 10
Test accuracy for de: 0.972
Num non-zero elements: 10
Test accuracy for es: 0.99
Num non-zero elements: 10
Test accuracy for nl: 0.98
Num non-zero elements: 20
Test accuracy for en: 0.998
Num non-zero elements: 20
Test accuracy for fr: 0.995
Num non-zero elements: 20
Test accuracy for de: 0.987
Num non-zero elements: 20
Test accuracy for es: 0.996
Num non-zero elements: 20
Test accuracy for nl: 0.981
Num non-zero elements: 50
Test accuracy for en: 0.997
Num non-zero elements: 50
Test accuracy for fr: 0.999
Num non-zero elements: 50
Test accuracy for de: 0.998
Num non-zero elements: 50
Test accuracy for es: 0.999
Num non-zero elements: 50
Test accuracy for nl: 0.996
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for en: 0.9980000257492065
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for fr: 0.9970000386238098
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for de: 0.999000072479248
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 24 epochs
Test accuracy for es: 0.9970000386238098
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 12 epochs
Test accuracy for nl: 0.9970000386238098
Num non-zero elements: 1
Test accuracy for en: 0.999
Num non-zero elements: 1
Test accuracy for fr: 0.993
Num non-zero elements: 1
Test accuracy for de: 0.983
Num non-zero elements: 1
Test accuracy for es: 0.846
Num non-zero elements: 1
Test accuracy for nl: 0.996
Num non-zero elements: 2
Test accuracy for en: 0.999
Num non-zero elements: 2
Test accuracy for fr: 0.989
Num non-zero elements: 2
Test accuracy for de: 0.993
Num non-zero elements: 2
Test accuracy for es: 0.883
Num non-zero elements: 2
Test accuracy for nl: 0.997
Num non-zero elements: 5
Test accuracy for en: 1.0
Num non-zero elements: 5
Test accuracy for fr: 0.991
Num non-zero elements: 5
Test accuracy for de: 0.999
Num non-zero elements: 5
Test accuracy for es: 0.889
Num non-zero elements: 5
Test accuracy for nl: 0.996
Num non-zero elements: 10
Test accuracy for en: 0.998
Num non-zero elements: 10
Test accuracy for fr: 0.997
Num non-zero elements: 10
Test accuracy for de: 0.997
Num non-zero elements: 10
Test accuracy for es: 0.99
Num non-zero elements: 10
Test accuracy for nl: 0.999
Num non-zero elements: 20
Test accuracy for en: 0.999
Num non-zero elements: 20
Test accuracy for fr: 0.996
Num non-zero elements: 20
Test accuracy for de: 0.994
Num non-zero elements: 20
Test accuracy for es: 0.994
Num non-zero elements: 20
Test accuracy for nl: 1.0
Num non-zero elements: 50
Test accuracy for en: 0.998
Num non-zero elements: 50
Test accuracy for fr: 0.997
Num non-zero elements: 50
Test accuracy for de: 0.997
Num non-zero elements: 50
Test accuracy for es: 0.996
Num non-zero elements: 50
Test accuracy for nl: 1.0

Running SAE evaluation on all selected SAEs: 100%|██████████| 1/1 [17:09<00:00, 1029.11s/it][ARunning SAE evaluation on all selected SAEs: 100%|██████████| 1/1 [17:09<00:00, 1029.11s/it]
Evaluations: 100%|██████████| 1/1 [17:23<00:00, 1043.94s/it]Evaluations: 100%|██████████| 1/1 [17:23<00:00, 1043.94s/it]
/share/u/can/SAEBench/custom_saes/topk_sae.py:110: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  pt_params = t.load(path_to_params)
Loaded config: {'trainer': {'trainer_class': 'TrainerTopKAdditivity', 'dict_class': 'AutoEncoderTopK', 'lr': 0.000282842712474619, 'steps': 48828, 'seed': 0, 'activation_dim': 2304, 'dict_size': 8192, 'k': 20, 'auxk_alpha': 0.03125, 'additivity_coeff': 1.0, 'intersection_coeff': 1.0, 'device': 'cuda:0', 'layer': 4, 'lm_name': 'google/gemma-2-2b', 'wandb_name': 'TopKTrainer_Additivity-google/gemma-2-2b-resid_post_layer_4-add_coeff-1.0-inters_coeff-1.0', 'submodule_name': 'resid_post_layer_4'}, 'buffer': {'d_submodule': 2304, 'io': 'out', 'n_ctxs': 8192, 'ctx_len': 128, 'refresh_batch_size': 32, 'out_batch_size': 2048, 'device': 'cuda:0'}}
Original keys in state_dict: odict_keys(['b_dec', 'encoder.weight', 'encoder.bias', 'decoder.weight'])
Renamed keys in state_dict: dict_keys(['b_dec', 'W_enc', 'b_enc', 'W_dec'])
Evaluations:   0%|          | 0/1 [00:00<?, ?it/s]


Running sparse_probing evaluation




Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s][A
Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:01,  1.53it/s][A
Loading checkpoint shards:  67%|██████▋   | 2/3 [00:01<00:00,  1.59it/s][A
Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.26it/s][ALoading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.01it/s]
Loaded pretrained model gemma-2-2b into HookedTransformer

Running SAE evaluation on all selected SAEs:   0%|          | 0/1 [00:00<?, ?it/s][A

  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 641.80it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 1043.10it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 12.31it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 12.73it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 12.59it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 45.86it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 45.62it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.02it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.29it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.62it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.56it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.15it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.85it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.64it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.46it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.36it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.29it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.24it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.21it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.14it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.11it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.54it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.35it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.31it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.84it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.58it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.42it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.22it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.02it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.20it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.30it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.26it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.80it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.52it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.34it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.11it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.98it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.14it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.17it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.19it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.74it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.44it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.09it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.95it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.10it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.61it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.30it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.78it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.48it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.11it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.05it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.89it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.89it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.89it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.88it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.88it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.88it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.06it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.06it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.07it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.63it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.38it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.22it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.10it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.40it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.28it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.80it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.46it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.21it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.06it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.28it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.27it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.79it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.45it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.25it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.13it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.06it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.28it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.30it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.81it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.46it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.14it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.06it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.29it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.25it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.77it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.42it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.22it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.10it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.02it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.97it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.24it/s]
Num non-zero elements: 2304
Test accuracy for 0: 0.925
Num non-zero elements: 2304
Test accuracy for 1: 0.943
Num non-zero elements: 2304
Test accuracy for 2: 0.947
Num non-zero elements: 2304
Test accuracy for 6: 0.991
Num non-zero elements: 2304
Test accuracy for 9: 0.971
Num non-zero elements: 1
Test accuracy for 0: 0.603
Num non-zero elements: 1
Test accuracy for 1: 0.648
Num non-zero elements: 1
Test accuracy for 2: 0.731
Num non-zero elements: 1
Test accuracy for 6: 0.773
Num non-zero elements: 1
Test accuracy for 9: 0.68
Num non-zero elements: 2
Test accuracy for 0: 0.682
Num non-zero elements: 2
Test accuracy for 1: 0.655
Num non-zero elements: 2
Test accuracy for 2: 0.744
Num non-zero elements: 2
Test accuracy for 6: 0.771
Num non-zero elements: 2
Test accuracy for 9: 0.772
Num non-zero elements: 5
Test accuracy for 0: 0.768
Num non-zero elements: 5
Test accuracy for 1: 0.69
Num non-zero elements: 5
Test accuracy for 2: 0.754
Num non-zero elements: 5
Test accuracy for 6: 0.905
Num non-zero elements: 5
Test accuracy for 9: 0.798
Num non-zero elements: 10
Test accuracy for 0: 0.797
Num non-zero elements: 10
Test accuracy for 1: 0.818
Num non-zero elements: 10
Test accuracy for 2: 0.83
Num non-zero elements: 10
Test accuracy for 6: 0.929
Num non-zero elements: 10
Test accuracy for 9: 0.912
Num non-zero elements: 20
Test accuracy for 0: 0.796
Num non-zero elements: 20
Test accuracy for 1: 0.867
Num non-zero elements: 20
Test accuracy for 2: 0.847
Num non-zero elements: 20
Test accuracy for 6: 0.96
Num non-zero elements: 20
Test accuracy for 9: 0.945
Num non-zero elements: 50
Test accuracy for 0: 0.862
Num non-zero elements: 50
Test accuracy for 1: 0.905
Num non-zero elements: 50
Test accuracy for 2: 0.897
Num non-zero elements: 50
Test accuracy for 6: 0.977
Num non-zero elements: 50
Test accuracy for 9: 0.948
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 23 epochs
Test accuracy for 0: 0.9380000233650208
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 21 epochs
Test accuracy for 1: 0.9480000734329224
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 2: 0.9350000619888306
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for 6: 0.984000027179718
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for 9: 0.9760000705718994
Num non-zero elements: 1
Test accuracy for 0: 0.624
Num non-zero elements: 1
Test accuracy for 1: 0.615
Num non-zero elements: 1
Test accuracy for 2: 0.849
Num non-zero elements: 1
Test accuracy for 6: 0.932
Num non-zero elements: 1
Test accuracy for 9: 0.923
Num non-zero elements: 2
Test accuracy for 0: 0.622
Num non-zero elements: 2
Test accuracy for 1: 0.647
Num non-zero elements: 2
Test accuracy for 2: 0.857
Num non-zero elements: 2
Test accuracy for 6: 0.979
Num non-zero elements: 2
Test accuracy for 9: 0.929
Num non-zero elements: 5
Test accuracy for 0: 0.846
Num non-zero elements: 5
Test accuracy for 1: 0.819
Num non-zero elements: 5
Test accuracy for 2: 0.901
Num non-zero elements: 5
Test accuracy for 6: 0.983
Num non-zero elements: 5
Test accuracy for 9: 0.939
Num non-zero elements: 10
Test accuracy for 0: 0.877
Num non-zero elements: 10
Test accuracy for 1: 0.892
Num non-zero elements: 10
Test accuracy for 2: 0.92
Num non-zero elements: 10
Test accuracy for 6: 0.982
Num non-zero elements: 10
Test accuracy for 9: 0.939
Num non-zero elements: 20
Test accuracy for 0: 0.892
Num non-zero elements: 20
Test accuracy for 1: 0.939
Num non-zero elements: 20
Test accuracy for 2: 0.924
Num non-zero elements: 20
Test accuracy for 6: 0.989
Num non-zero elements: 20
Test accuracy for 9: 0.95
Num non-zero elements: 50
Test accuracy for 0: 0.908
Num non-zero elements: 50
Test accuracy for 1: 0.954
Num non-zero elements: 50
Test accuracy for 2: 0.935
Num non-zero elements: 50
Test accuracy for 6: 0.988
Num non-zero elements: 50
Test accuracy for 9: 0.961


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 631.32it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 972.46it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 12.84it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 12.55it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00,  9.41it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 50.26it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 29.14it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.33it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.64it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.58it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 19.04it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.81it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:00<00:02, 18.62it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.47it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.37it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.31it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.25it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.22it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.14it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.11it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.11it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.11it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.12it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.54it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 24.50it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 20.28it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 19.22it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.86it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.61it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.44it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.33it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.24it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.19it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.28it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.69it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.39it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.88it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.57it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.37it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.13it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 16.89it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.31it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.24it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.14it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 22.41it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:03, 18.06it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 19.16it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.79it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.55it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.38it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.26it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.96it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.12it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 26.74it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 22.96it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.37it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.35it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.95it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.66it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.43it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.26it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 16.85it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.25it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.17it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.92it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.92it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.93it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.34it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.25it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.14it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.67it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.40it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.21it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.11it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.41it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.70it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.94it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.55it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.31it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.17it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.02it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.31it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.89it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.01it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.58it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.33it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 17.34it/s][A[A

Collecting activations:  94%|█████████▍| 15/16 [00:00<00:00, 18.27it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.37it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.66it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.92it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.53it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.30it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.19it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.34it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.45it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.85it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.49it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.28it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.08it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.50it/s]
Num non-zero elements: 2304
Test accuracy for 11: 0.95
Num non-zero elements: 2304
Test accuracy for 13: 0.944
Num non-zero elements: 2304
Test accuracy for 14: 0.955
Num non-zero elements: 2304
Test accuracy for 18: 0.911
Num non-zero elements: 2304
Test accuracy for 19: 0.952
Num non-zero elements: 1
Test accuracy for 11: 0.712
Num non-zero elements: 1
Test accuracy for 13: 0.711
Num non-zero elements: 1
Test accuracy for 14: 0.659
Num non-zero elements: 1
Test accuracy for 18: 0.698
Num non-zero elements: 1
Test accuracy for 19: 0.781
Num non-zero elements: 2
Test accuracy for 11: 0.733
Num non-zero elements: 2
Test accuracy for 13: 0.694
Num non-zero elements: 2
Test accuracy for 14: 0.689
Num non-zero elements: 2
Test accuracy for 18: 0.699
Num non-zero elements: 2
Test accuracy for 19: 0.801
Num non-zero elements: 5
Test accuracy for 11: 0.827
Num non-zero elements: 5
Test accuracy for 13: 0.791
Num non-zero elements: 5
Test accuracy for 14: 0.729
Num non-zero elements: 5
Test accuracy for 18: 0.72
Num non-zero elements: 5
Test accuracy for 19: 0.83
Num non-zero elements: 10
Test accuracy for 11: 0.877
Num non-zero elements: 10
Test accuracy for 13: 0.817
Num non-zero elements: 10
Test accuracy for 14: 0.795
Num non-zero elements: 10
Test accuracy for 18: 0.745
Num non-zero elements: 10
Test accuracy for 19: 0.824
Num non-zero elements: 20
Test accuracy for 11: 0.904
Num non-zero elements: 20
Test accuracy for 13: 0.874
Num non-zero elements: 20
Test accuracy for 14: 0.859
Num non-zero elements: 20
Test accuracy for 18: 0.755
Num non-zero elements: 20
Test accuracy for 19: 0.912
Num non-zero elements: 50
Test accuracy for 11: 0.925
Num non-zero elements: 50
Test accuracy for 13: 0.903
Num non-zero elements: 50
Test accuracy for 14: 0.89
Num non-zero elements: 50
Test accuracy for 18: 0.836
Num non-zero elements: 50
Test accuracy for 19: 0.933
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for 11: 0.9410000443458557
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 13: 0.9330000281333923
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 14: 0.937000036239624
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 27 epochs
Test accuracy for 18: 0.8960000276565552
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 33 epochs
Test accuracy for 19: 0.9600000381469727
Num non-zero elements: 1
Test accuracy for 11: 0.733
Num non-zero elements: 1
Test accuracy for 13: 0.749
Num non-zero elements: 1
Test accuracy for 14: 0.894
Num non-zero elements: 1
Test accuracy for 18: 0.729
Num non-zero elements: 1
Test accuracy for 19: 0.849
Num non-zero elements: 2
Test accuracy for 11: 0.841
Num non-zero elements: 2
Test accuracy for 13: 0.721
Num non-zero elements: 2
Test accuracy for 14: 0.9
Num non-zero elements: 2
Test accuracy for 18: 0.894
Num non-zero elements: 2
Test accuracy for 19: 0.848
Num non-zero elements: 5
Test accuracy for 11: 0.84
Num non-zero elements: 5
Test accuracy for 13: 0.775
Num non-zero elements: 5
Test accuracy for 14: 0.915
Num non-zero elements: 5
Test accuracy for 18: 0.893
Num non-zero elements: 5
Test accuracy for 19: 0.893
Num non-zero elements: 10
Test accuracy for 11: 0.929
Num non-zero elements: 10
Test accuracy for 13: 0.876
Num non-zero elements: 10
Test accuracy for 14: 0.926
Num non-zero elements: 10
Test accuracy for 18: 0.903
Num non-zero elements: 10
Test accuracy for 19: 0.901
Num non-zero elements: 20
Test accuracy for 11: 0.94
Num non-zero elements: 20
Test accuracy for 13: 0.893
Num non-zero elements: 20
Test accuracy for 14: 0.936
Num non-zero elements: 20
Test accuracy for 18: 0.906
Num non-zero elements: 20
Test accuracy for 19: 0.921
Num non-zero elements: 50
Test accuracy for 11: 0.953
Num non-zero elements: 50
Test accuracy for 13: 0.94
Num non-zero elements: 50
Test accuracy for 14: 0.93
Num non-zero elements: 50
Test accuracy for 18: 0.909
Num non-zero elements: 50
Test accuracy for 19: 0.932


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 655.78it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 1087.61it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00,  6.27it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00,  8.93it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00,  9.04it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 47.66it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 47.40it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.44it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.42it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.67it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.58it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.17it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.86it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.64it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.46it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.36it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.28it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.23it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.08it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.53it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.03it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.18it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.77it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.53it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.38it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.28it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.16it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.01it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.09it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.69it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.44it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.20it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.13it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.08it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.97it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.10it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.95it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.08it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.67it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.42it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.26it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.17it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.09it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.05it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.93it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.07it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.88it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.06it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.61it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.39it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.07it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.02it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.95it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.89it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.89it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.89it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.88it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.88it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.89it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.03it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.86it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.01it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.58it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.33it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.05it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.35it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.22it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.77it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.43it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.24it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.11it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.02it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.97it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.25it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.23it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.78it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.43it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.24it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.03it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.98it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.25it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.45it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.84it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.48it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.25it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.13it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.03it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.98it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.26it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.72it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 16.28it/s][A[A

Collecting activations:  56%|█████▋    | 9/16 [00:00<00:00, 18.01it/s][A[A

Collecting activations:  69%|██████▉   | 11/16 [00:00<00:00, 17.95it/s][A[A

Collecting activations:  81%|████████▏ | 13/16 [00:00<00:00, 17.93it/s][A[A

Collecting activations:  94%|█████████▍| 15/16 [00:00<00:00, 17.92it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.90it/s]
Num non-zero elements: 2304
Test accuracy for 20: 0.935
Num non-zero elements: 2304
Test accuracy for 21: 0.9
Num non-zero elements: 2304
Test accuracy for 22: 0.909
Num non-zero elements: 2304
Test accuracy for 25: 0.951
Num non-zero elements: 2304
Test accuracy for 26: 0.861
Num non-zero elements: 1
Test accuracy for 20: 0.742
Num non-zero elements: 1
Test accuracy for 21: 0.625
Num non-zero elements: 1
Test accuracy for 22: 0.621
Num non-zero elements: 1
Test accuracy for 25: 0.711
Num non-zero elements: 1
Test accuracy for 26: 0.653
Num non-zero elements: 2
Test accuracy for 20: 0.79
Num non-zero elements: 2
Test accuracy for 21: 0.697
Num non-zero elements: 2
Test accuracy for 22: 0.604
Num non-zero elements: 2
Test accuracy for 25: 0.7
Num non-zero elements: 2
Test accuracy for 26: 0.662
Num non-zero elements: 5
Test accuracy for 20: 0.852
Num non-zero elements: 5
Test accuracy for 21: 0.767
Num non-zero elements: 5
Test accuracy for 22: 0.731
Num non-zero elements: 5
Test accuracy for 25: 0.789
Num non-zero elements: 5
Test accuracy for 26: 0.7
Num non-zero elements: 10
Test accuracy for 20: 0.871
Num non-zero elements: 10
Test accuracy for 21: 0.822
Num non-zero elements: 10
Test accuracy for 22: 0.757
Num non-zero elements: 10
Test accuracy for 25: 0.874
Num non-zero elements: 10
Test accuracy for 26: 0.714
Num non-zero elements: 20
Test accuracy for 20: 0.893
Num non-zero elements: 20
Test accuracy for 21: 0.835
Num non-zero elements: 20
Test accuracy for 22: 0.766
Num non-zero elements: 20
Test accuracy for 25: 0.905
Num non-zero elements: 20
Test accuracy for 26: 0.768
Num non-zero elements: 50
Test accuracy for 20: 0.92
Num non-zero elements: 50
Test accuracy for 21: 0.867
Num non-zero elements: 50
Test accuracy for 22: 0.83
Num non-zero elements: 50
Test accuracy for 25: 0.924
Num non-zero elements: 50
Test accuracy for 26: 0.825
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 23 epochs
Test accuracy for 20: 0.9410000443458557
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for 21: 0.9010000228881836
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 22: 0.9000000357627869
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for 25: 0.9520000219345093
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for 26: 0.8750000596046448
Num non-zero elements: 1
Test accuracy for 20: 0.864
Num non-zero elements: 1
Test accuracy for 21: 0.763
Num non-zero elements: 1
Test accuracy for 22: 0.865
Num non-zero elements: 1
Test accuracy for 25: 0.849
Num non-zero elements: 1
Test accuracy for 26: 0.714
Num non-zero elements: 2
Test accuracy for 20: 0.886
Num non-zero elements: 2
Test accuracy for 21: 0.761
Num non-zero elements: 2
Test accuracy for 22: 0.868
Num non-zero elements: 2
Test accuracy for 25: 0.856
Num non-zero elements: 2
Test accuracy for 26: 0.754
Num non-zero elements: 5
Test accuracy for 20: 0.896
Num non-zero elements: 5
Test accuracy for 21: 0.803
Num non-zero elements: 5
Test accuracy for 22: 0.859
Num non-zero elements: 5
Test accuracy for 25: 0.864
Num non-zero elements: 5
Test accuracy for 26: 0.798
Num non-zero elements: 10
Test accuracy for 20: 0.924
Num non-zero elements: 10
Test accuracy for 21: 0.825
Num non-zero elements: 10
Test accuracy for 22: 0.866
Num non-zero elements: 10
Test accuracy for 25: 0.903
Num non-zero elements: 10
Test accuracy for 26: 0.83
Num non-zero elements: 20
Test accuracy for 20: 0.923
Num non-zero elements: 20
Test accuracy for 21: 0.843
Num non-zero elements: 20
Test accuracy for 22: 0.874
Num non-zero elements: 20
Test accuracy for 25: 0.918
Num non-zero elements: 20
Test accuracy for 26: 0.848
Num non-zero elements: 50
Test accuracy for 20: 0.929
Num non-zero elements: 50
Test accuracy for 21: 0.867
Num non-zero elements: 50
Test accuracy for 22: 0.889
Num non-zero elements: 50
Test accuracy for 25: 0.943
Num non-zero elements: 50
Test accuracy for 26: 0.869


  0%|          | 0/34 [00:00<?, ?it/s][A[A100%|██████████| 34/34 [00:00<00:00, 397.66it/s]


  0%|          | 0/31 [00:00<?, ?it/s][A[A100%|██████████| 31/31 [00:00<00:00, 865.14it/s]
Removing 31 from train set
Removing 0 from train set
Removing 29 from train set
Removing 28 from train set
Removing 7 from train set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  20%|██        | 1/5 [00:00<00:00,  9.70it/s][A[A

Tokenizing data:  60%|██████    | 3/5 [00:00<00:00, 10.14it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 10.16it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 10.12it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 38.51it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 38.62it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.16it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.09it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.50it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.47it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.07it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.79it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.58it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.42it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.31it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.25it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.19it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.05it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.48it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.02it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.17it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.75it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.50it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.36it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.26it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.13it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.15it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.95it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.10it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.69it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.44it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.12it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.08it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.95it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.10it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.92it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.07it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.65it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.39it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.15it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.09it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.04it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.92it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.92it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.91it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.91it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.91it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.91it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.05it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.90it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.03it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.61it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.35it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.11it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.04it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 17.97it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.95it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.93it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.92it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.91it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.89it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.89it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.90it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.89it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.89it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.89it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.88it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.87it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.87it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.86it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.86it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.86it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.86it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.86it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.86it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.86it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.00it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.82it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.95it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.52it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.28it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.13it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.04it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.31it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.43it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.82it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.45it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.24it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.11it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.01it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.96it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.24it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.98it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.03it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.57it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.30it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.04it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.98it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.34it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.18it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.73it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.40it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.20it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.00it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.96it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.22it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.23it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.72it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.38it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.99it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.95it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.21it/s]
Num non-zero elements: 2304
Test accuracy for 1: 0.932
Num non-zero elements: 2304
Test accuracy for 2: 0.895
Num non-zero elements: 2304
Test accuracy for 3: 0.879
Num non-zero elements: 2304
Test accuracy for 5: 0.893
Num non-zero elements: 2304
Test accuracy for 6: 0.824
Num non-zero elements: 1
Test accuracy for 1: 0.7
Num non-zero elements: 1
Test accuracy for 2: 0.712
Num non-zero elements: 1
Test accuracy for 3: 0.599
Num non-zero elements: 1
Test accuracy for 5: 0.69
Num non-zero elements: 1
Test accuracy for 6: 0.593
Num non-zero elements: 2
Test accuracy for 1: 0.717
Num non-zero elements: 2
Test accuracy for 2: 0.782
Num non-zero elements: 2
Test accuracy for 3: 0.618
Num non-zero elements: 2
Test accuracy for 5: 0.683
Num non-zero elements: 2
Test accuracy for 6: 0.628
Num non-zero elements: 5
Test accuracy for 1: 0.789
Num non-zero elements: 5
Test accuracy for 2: 0.812
Num non-zero elements: 5
Test accuracy for 3: 0.633
Num non-zero elements: 5
Test accuracy for 5: 0.709
Num non-zero elements: 5
Test accuracy for 6: 0.671
Num non-zero elements: 10
Test accuracy for 1: 0.798
Num non-zero elements: 10
Test accuracy for 2: 0.832
Num non-zero elements: 10
Test accuracy for 3: 0.714
Num non-zero elements: 10
Test accuracy for 5: 0.739
Num non-zero elements: 10
Test accuracy for 6: 0.726
Num non-zero elements: 20
Test accuracy for 1: 0.837
Num non-zero elements: 20
Test accuracy for 2: 0.853
Num non-zero elements: 20
Test accuracy for 3: 0.778
Num non-zero elements: 20
Test accuracy for 5: 0.77
Num non-zero elements: 20
Test accuracy for 6: 0.744
Num non-zero elements: 50
Test accuracy for 1: 0.884
Num non-zero elements: 50
Test accuracy for 2: 0.87
Num non-zero elements: 50
Test accuracy for 3: 0.863
Num non-zero elements: 50
Test accuracy for 5: 0.81
Num non-zero elements: 50
Test accuracy for 6: 0.793
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 23 epochs
Test accuracy for 1: 0.9190000295639038
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 21 epochs
Test accuracy for 2: 0.9160000681877136
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 21 epochs
Test accuracy for 3: 0.8950000405311584
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 21 epochs
Test accuracy for 5: 0.8950000405311584
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 6: 0.8460000157356262
Num non-zero elements: 1
Test accuracy for 1: 0.805
Num non-zero elements: 1
Test accuracy for 2: 0.79
Num non-zero elements: 1
Test accuracy for 3: 0.588
Num non-zero elements: 1
Test accuracy for 5: 0.811
Num non-zero elements: 1
Test accuracy for 6: 0.617
Num non-zero elements: 2
Test accuracy for 1: 0.85
Num non-zero elements: 2
Test accuracy for 2: 0.814
Num non-zero elements: 2
Test accuracy for 3: 0.719
Num non-zero elements: 2
Test accuracy for 5: 0.857
Num non-zero elements: 2
Test accuracy for 6: 0.7
Num non-zero elements: 5
Test accuracy for 1: 0.88
Num non-zero elements: 5
Test accuracy for 2: 0.827
Num non-zero elements: 5
Test accuracy for 3: 0.774
Num non-zero elements: 5
Test accuracy for 5: 0.876
Num non-zero elements: 5
Test accuracy for 6: 0.716
Num non-zero elements: 10
Test accuracy for 1: 0.895
Num non-zero elements: 10
Test accuracy for 2: 0.845
Num non-zero elements: 10
Test accuracy for 3: 0.841
Num non-zero elements: 10
Test accuracy for 5: 0.885
Num non-zero elements: 10
Test accuracy for 6: 0.751
Num non-zero elements: 20
Test accuracy for 1: 0.912
Num non-zero elements: 20
Test accuracy for 2: 0.878
Num non-zero elements: 20
Test accuracy for 3: 0.847
Num non-zero elements: 20
Test accuracy for 5: 0.89
Num non-zero elements: 20
Test accuracy for 6: 0.765
Num non-zero elements: 50
Test accuracy for 1: 0.914
Num non-zero elements: 50
Test accuracy for 2: 0.903
Num non-zero elements: 50
Test accuracy for 3: 0.88
Num non-zero elements: 50
Test accuracy for 5: 0.893
Num non-zero elements: 50
Test accuracy for 6: 0.798


Tokenizing data:   0%|          | 0/2 [00:00<?, ?it/s][A[A

Tokenizing data:  50%|█████     | 1/2 [00:00<00:00,  9.75it/s][A[ATokenizing data: 100%|██████████| 2/2 [00:00<00:00,  9.94it/s]


Tokenizing data:   0%|          | 0/2 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 2/2 [00:00<00:00, 38.52it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 28.25it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 22.97it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.48it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.46it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.07it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.76it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.56it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.36it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.32it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.25it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.20it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 15.32it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 17.92it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.20it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 26.63it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 21.86it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 19.92it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.13it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.82it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.59it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.43it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.33it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.25it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.18it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.02it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.37it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.23it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.53it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.95it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 16.68it/s][A[A

Collecting activations:  81%|████████▏ | 13/16 [00:00<00:00, 18.88it/s][A[A

Collecting activations:  94%|█████████▍| 15/16 [00:00<00:00, 18.61it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.66it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.46it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.90it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.56it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.36it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.25it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.11it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.40it/s]
Num non-zero elements: 2304
Test accuracy for 1.0: 0.904
Num non-zero elements: 2304
Test accuracy for 5.0: 0.902
Num non-zero elements: 1
Test accuracy for 1.0: 0.631
Num non-zero elements: 1
Test accuracy for 5.0: 0.631
Num non-zero elements: 2
Test accuracy for 1.0: 0.654
Num non-zero elements: 2
Test accuracy for 5.0: 0.654
Num non-zero elements: 5
Test accuracy for 1.0: 0.669
Num non-zero elements: 5
Test accuracy for 5.0: 0.669
Num non-zero elements: 10
Test accuracy for 1.0: 0.764
Num non-zero elements: 10
Test accuracy for 5.0: 0.764
Num non-zero elements: 20
Test accuracy for 1.0: 0.792
Num non-zero elements: 20
Test accuracy for 5.0: 0.792
Num non-zero elements: 50
Test accuracy for 1.0: 0.829
Num non-zero elements: 50
Test accuracy for 5.0: 0.829
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for 1.0: 0.8970000147819519
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 5.0: 0.8970000147819519
Num non-zero elements: 1
Test accuracy for 1.0: 0.594
Num non-zero elements: 1
Test accuracy for 5.0: 0.594
Num non-zero elements: 2
Test accuracy for 1.0: 0.629
Num non-zero elements: 2
Test accuracy for 5.0: 0.629
Num non-zero elements: 5
Test accuracy for 1.0: 0.841
Num non-zero elements: 5
Test accuracy for 5.0: 0.841
Num non-zero elements: 10
Test accuracy for 1.0: 0.866
Num non-zero elements: 10
Test accuracy for 5.0: 0.866
Num non-zero elements: 20
Test accuracy for 1.0: 0.878
Num non-zero elements: 20
Test accuracy for 5.0: 0.878
Num non-zero elements: 50
Test accuracy for 1.0: 0.887
Num non-zero elements: 50
Test accuracy for 5.0: 0.887
Loading dataset codeparrot/github-code, this usually takes ~30 seconds


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  20%|██        | 1/5 [00:01<00:07,  1.81s/it][A[A

Tokenizing data:  40%|████      | 2/5 [00:02<00:04,  1.37s/it][A[A

Tokenizing data:  60%|██████    | 3/5 [00:04<00:02,  1.32s/it][A[A

Tokenizing data:  80%|████████  | 4/5 [00:04<00:00,  1.02it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:05<00:00,  1.19it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:05<00:00,  1.04s/it]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  20%|██        | 1/5 [00:00<00:02,  1.84it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00,  3.15it/s][A[A

Tokenizing data:  60%|██████    | 3/5 [00:01<00:00,  3.21it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:01<00:00,  3.90it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:01<00:00,  4.35it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:01<00:00,  3.67it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.95it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.22it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.56it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.49it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.08it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.79it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.57it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.39it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.29it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.23it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.18it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.02it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.47it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.94it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.11it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.69it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.45it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.30it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.12it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.09it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 13.09it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 15.98it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 16.49it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.62it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.93it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.40it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.85it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.52it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.11it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.06it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.92it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.92it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.91it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.91it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.91it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.09it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.92it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.04it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.61it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.36it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.11it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.04it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.00it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.94it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.92it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.92it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.90it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.89it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.89it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.89it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.89it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.88it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.88it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.88it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.88it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.88it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.86it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.86it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.86it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.86it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.86it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.01it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.81it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:03, 18.98it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.54it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.28it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.05it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 17.99it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 17.95it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.92it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.89it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.89it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.86it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.84it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.84it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.84it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.84it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.85it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.84it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.85it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.85it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.84it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.83it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.83it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.82it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.82it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:03<00:00, 17.82it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.83it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.84it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.84it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.82it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.96it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.78it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.92it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.50it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.11it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.02it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.97it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.29it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.17it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.69it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.36it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.03it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.96it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.93it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.19it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.20it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.72it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.38it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.17it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.03it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.96it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.92it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.19it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.22it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.72it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.37it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.17it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.05it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.96it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.91it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.19it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.18it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.70it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.36it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.03it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.95it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.91it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.18it/s]
Num non-zero elements: 2304
Test accuracy for C: 0.95
Num non-zero elements: 2304
Test accuracy for Python: 0.987
Num non-zero elements: 2304
Test accuracy for HTML: 0.981
Num non-zero elements: 2304
Test accuracy for Java: 0.96
Num non-zero elements: 2304
Test accuracy for PHP: 0.956
Num non-zero elements: 1
Test accuracy for C: 0.588
Num non-zero elements: 1
Test accuracy for Python: 0.632
Num non-zero elements: 1
Test accuracy for HTML: 0.721
Num non-zero elements: 1
Test accuracy for Java: 0.607
Num non-zero elements: 1
Test accuracy for PHP: 0.583
Num non-zero elements: 2
Test accuracy for C: 0.742
Num non-zero elements: 2
Test accuracy for Python: 0.665
Num non-zero elements: 2
Test accuracy for HTML: 0.942
Num non-zero elements: 2
Test accuracy for Java: 0.605
Num non-zero elements: 2
Test accuracy for PHP: 0.656
Num non-zero elements: 5
Test accuracy for C: 0.765
Num non-zero elements: 5
Test accuracy for Python: 0.742
Num non-zero elements: 5
Test accuracy for HTML: 0.945
Num non-zero elements: 5
Test accuracy for Java: 0.78
Num non-zero elements: 5
Test accuracy for PHP: 0.702
Num non-zero elements: 10
Test accuracy for C: 0.831
Num non-zero elements: 10
Test accuracy for Python: 0.866
Num non-zero elements: 10
Test accuracy for HTML: 0.951
Num non-zero elements: 10
Test accuracy for Java: 0.834
Num non-zero elements: 10
Test accuracy for PHP: 0.798
Num non-zero elements: 20
Test accuracy for C: 0.861
Num non-zero elements: 20
Test accuracy for Python: 0.911
Num non-zero elements: 20
Test accuracy for HTML: 0.969
Num non-zero elements: 20
Test accuracy for Java: 0.843
Num non-zero elements: 20
Test accuracy for PHP: 0.863
Num non-zero elements: 50
Test accuracy for C: 0.911
Num non-zero elements: 50
Test accuracy for Python: 0.97
Num non-zero elements: 50
Test accuracy for HTML: 0.968
Num non-zero elements: 50
Test accuracy for Java: 0.908
Num non-zero elements: 50
Test accuracy for PHP: 0.902
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 21 epochs
Test accuracy for C: 0.9600000381469727
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 36 epochs
Test accuracy for Python: 0.9810000658035278
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 23 epochs
Test accuracy for HTML: 0.9890000224113464
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 27 epochs
Test accuracy for Java: 0.9650000333786011
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 21 epochs
Test accuracy for PHP: 0.9530000686645508
Num non-zero elements: 1
Test accuracy for C: 0.628
Num non-zero elements: 1
Test accuracy for Python: 0.89
Num non-zero elements: 1
Test accuracy for HTML: 0.853
Num non-zero elements: 1
Test accuracy for Java: 0.663
Num non-zero elements: 1
Test accuracy for PHP: 0.907
Num non-zero elements: 2
Test accuracy for C: 0.672
Num non-zero elements: 2
Test accuracy for Python: 0.888
Num non-zero elements: 2
Test accuracy for HTML: 0.938
Num non-zero elements: 2
Test accuracy for Java: 0.795
Num non-zero elements: 2
Test accuracy for PHP: 0.906
Num non-zero elements: 5
Test accuracy for C: 0.709
Num non-zero elements: 5
Test accuracy for Python: 0.944
Num non-zero elements: 5
Test accuracy for HTML: 0.954
Num non-zero elements: 5
Test accuracy for Java: 0.908
Num non-zero elements: 5
Test accuracy for PHP: 0.909
Num non-zero elements: 10
Test accuracy for C: 0.823
Num non-zero elements: 10
Test accuracy for Python: 0.967
Num non-zero elements: 10
Test accuracy for HTML: 0.955
Num non-zero elements: 10
Test accuracy for Java: 0.896
Num non-zero elements: 10
Test accuracy for PHP: 0.914
Num non-zero elements: 20
Test accuracy for C: 0.88
Num non-zero elements: 20
Test accuracy for Python: 0.968
Num non-zero elements: 20
Test accuracy for HTML: 0.952
Num non-zero elements: 20
Test accuracy for Java: 0.921
Num non-zero elements: 20
Test accuracy for PHP: 0.924
Num non-zero elements: 50
Test accuracy for C: 0.921
Num non-zero elements: 50
Test accuracy for Python: 0.974
Num non-zero elements: 50
Test accuracy for HTML: 0.967
Num non-zero elements: 50
Test accuracy for Java: 0.937
Num non-zero elements: 50
Test accuracy for PHP: 0.924


Tokenizing data:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Tokenizing data:  50%|█████     | 2/4 [00:00<00:00, 13.84it/s][A[A

Tokenizing data: 100%|██████████| 4/4 [00:00<00:00, 13.94it/s][A[ATokenizing data: 100%|██████████| 4/4 [00:00<00:00, 13.78it/s]


Tokenizing data:   0%|          | 0/4 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 4/4 [00:00<00:00, 52.39it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.21it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 22.99it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.52it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.53it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.14it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.86it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.66it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.52it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.42it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.35it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 15.55it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 16.92it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.50it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.39it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.33it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.28it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.25it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.22it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.21it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.18it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.18it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 12.17it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 15.11it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.69it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 23.46it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 20.02it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 19.12it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.81it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.61it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.44it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.35it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.28it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.23it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.20it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.18it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.08it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.30it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.40it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.30it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.84it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.58it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.41it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.22it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.18it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.60it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 21.13it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 19.59it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.95it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.69it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.50it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.36it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.25it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.18it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.51it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.18it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.14it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.75it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00,  9.41it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 12.34it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 13.48it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 14.49it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 16.86it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.15it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.13it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.68it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.41it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.25it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.09it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.44it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.55it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.90it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.54it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.31it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.32it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.69it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.94it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.53it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.31it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.17it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.09it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.05it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.33it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.91it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.02it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.60it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.32it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.33it/s]
Num non-zero elements: 2304
Test accuracy for 0: 0.928
Num non-zero elements: 2304
Test accuracy for 1: 0.99
Num non-zero elements: 2304
Test accuracy for 2: 0.92
Num non-zero elements: 2304
Test accuracy for 3: 0.928
Num non-zero elements: 1
Test accuracy for 0: 0.774
Num non-zero elements: 1
Test accuracy for 1: 0.688
Num non-zero elements: 1
Test accuracy for 2: 0.65
Num non-zero elements: 1
Test accuracy for 3: 0.788
Num non-zero elements: 2
Test accuracy for 0: 0.796
Num non-zero elements: 2
Test accuracy for 1: 0.799
Num non-zero elements: 2
Test accuracy for 2: 0.69
Num non-zero elements: 2
Test accuracy for 3: 0.79
Num non-zero elements: 5
Test accuracy for 0: 0.863
Num non-zero elements: 5
Test accuracy for 1: 0.862
Num non-zero elements: 5
Test accuracy for 2: 0.776
Num non-zero elements: 5
Test accuracy for 3: 0.841
Num non-zero elements: 10
Test accuracy for 0: 0.895
Num non-zero elements: 10
Test accuracy for 1: 0.936
Num non-zero elements: 10
Test accuracy for 2: 0.803
Num non-zero elements: 10
Test accuracy for 3: 0.852
Num non-zero elements: 20
Test accuracy for 0: 0.903
Num non-zero elements: 20
Test accuracy for 1: 0.965
Num non-zero elements: 20
Test accuracy for 2: 0.867
Num non-zero elements: 20
Test accuracy for 3: 0.893
Num non-zero elements: 50
Test accuracy for 0: 0.916
Num non-zero elements: 50
Test accuracy for 1: 0.963
Num non-zero elements: 50
Test accuracy for 2: 0.865
Num non-zero elements: 50
Test accuracy for 3: 0.914
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for 0: 0.9280000329017639
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 20 epochs
Test accuracy for 1: 0.9750000238418579
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 14 epochs
Test accuracy for 2: 0.9250000715255737
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 14 epochs
Test accuracy for 3: 0.9450000524520874
Num non-zero elements: 1
Test accuracy for 0: 0.718
Num non-zero elements: 1
Test accuracy for 1: 0.945
Num non-zero elements: 1
Test accuracy for 2: 0.792
Num non-zero elements: 1
Test accuracy for 3: 0.686
Num non-zero elements: 2
Test accuracy for 0: 0.837
Num non-zero elements: 2
Test accuracy for 1: 0.944
Num non-zero elements: 2
Test accuracy for 2: 0.791
Num non-zero elements: 2
Test accuracy for 3: 0.765
Num non-zero elements: 5
Test accuracy for 0: 0.847
Num non-zero elements: 5
Test accuracy for 1: 0.951
Num non-zero elements: 5
Test accuracy for 2: 0.814
Num non-zero elements: 5
Test accuracy for 3: 0.814
Num non-zero elements: 10
Test accuracy for 0: 0.877
Num non-zero elements: 10
Test accuracy for 1: 0.954
Num non-zero elements: 10
Test accuracy for 2: 0.846
Num non-zero elements: 10
Test accuracy for 3: 0.872
Num non-zero elements: 20
Test accuracy for 0: 0.906
Num non-zero elements: 20
Test accuracy for 1: 0.968
Num non-zero elements: 20
Test accuracy for 2: 0.874
Num non-zero elements: 20
Test accuracy for 3: 0.906
Num non-zero elements: 50
Test accuracy for 0: 0.924
Num non-zero elements: 50
Test accuracy for 1: 0.969
Num non-zero elements: 50
Test accuracy for 2: 0.869
Num non-zero elements: 50
Test accuracy for 3: 0.911
Loading dataset Helsinki-NLP/europarl, this usually takes ~10 seconds


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 15.05it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 15.01it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00,  9.97it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 57.14it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 26.82it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.25it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.61it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.57it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.16it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.87it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.65it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.47it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.38it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.31it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.26it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.22it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.08it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.52it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.05it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.20it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.77it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.52it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.36it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.26it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.17it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.05it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.16it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.73it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.49it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.33it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.23it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.12it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.14it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.99it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.10it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.69it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.43it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.27it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.17it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.10it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.05it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.94it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.07it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.47it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.22it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.73it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.46it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.07it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.02it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.95it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.94it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 16.91it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.20it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 14.36it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 16.97it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.21it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.40it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.54it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.65it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:03<00:00, 17.72it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.78it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.78it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 14.43it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.11it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.52it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.82it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.64it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.97it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.60it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.36it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.07it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.54it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.38it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.51it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.90it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.54it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.33it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.07it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.49it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.64it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.57it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.94it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.57it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.34it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.20it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.54it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.36it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.48it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.86it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.52it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.31it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.09it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.57it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.25it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.77it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.42it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.22it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 14.48it/s][A[A

Collecting activations:  94%|█████████▍| 15/16 [00:00<00:00, 17.32it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.43it/s]
Num non-zero elements: 2304
Test accuracy for en: 0.997
Num non-zero elements: 2304
Test accuracy for fr: 1.0
Num non-zero elements: 2304
Test accuracy for de: 1.0
Num non-zero elements: 2304
Test accuracy for es: 0.999
Num non-zero elements: 2304
Test accuracy for nl: 1.0
Num non-zero elements: 1
Test accuracy for en: 0.946
Num non-zero elements: 1
Test accuracy for fr: 0.666
Num non-zero elements: 1
Test accuracy for de: 0.813
Num non-zero elements: 1
Test accuracy for es: 0.89
Num non-zero elements: 1
Test accuracy for nl: 0.859
Num non-zero elements: 2
Test accuracy for en: 0.971
Num non-zero elements: 2
Test accuracy for fr: 0.905
Num non-zero elements: 2
Test accuracy for de: 0.839
Num non-zero elements: 2
Test accuracy for es: 0.908
Num non-zero elements: 2
Test accuracy for nl: 0.889
Num non-zero elements: 5
Test accuracy for en: 0.994
Num non-zero elements: 5
Test accuracy for fr: 0.963
Num non-zero elements: 5
Test accuracy for de: 0.893
Num non-zero elements: 5
Test accuracy for es: 0.981
Num non-zero elements: 5
Test accuracy for nl: 0.954
Num non-zero elements: 10
Test accuracy for en: 0.997
Num non-zero elements: 10
Test accuracy for fr: 0.985
Num non-zero elements: 10
Test accuracy for de: 0.978
Num non-zero elements: 10
Test accuracy for es: 0.985
Num non-zero elements: 10
Test accuracy for nl: 0.972
Num non-zero elements: 20
Test accuracy for en: 0.998
Num non-zero elements: 20
Test accuracy for fr: 0.995
Num non-zero elements: 20
Test accuracy for de: 0.994
Num non-zero elements: 20
Test accuracy for es: 0.996
Num non-zero elements: 20
Test accuracy for nl: 0.982
Num non-zero elements: 50
Test accuracy for en: 0.999
Num non-zero elements: 50
Test accuracy for fr: 1.0
Num non-zero elements: 50
Test accuracy for de: 0.997
Num non-zero elements: 50
Test accuracy for es: 0.999
Num non-zero elements: 50
Test accuracy for nl: 0.994
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 23 epochs
Test accuracy for en: 0.9980000257492065
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for fr: 0.9980000257492065
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 17 epochs
Test accuracy for de: 0.9970000386238098
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for es: 0.9970000386238098
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 17 epochs
Test accuracy for nl: 0.9950000643730164
Num non-zero elements: 1
Test accuracy for en: 0.999
Num non-zero elements: 1
Test accuracy for fr: 0.989
Num non-zero elements: 1
Test accuracy for de: 0.823
Num non-zero elements: 1
Test accuracy for es: 0.874
Num non-zero elements: 1
Test accuracy for nl: 0.924
Num non-zero elements: 2
Test accuracy for en: 0.999
Num non-zero elements: 2
Test accuracy for fr: 0.991
Num non-zero elements: 2
Test accuracy for de: 0.979
Num non-zero elements: 2
Test accuracy for es: 0.918
Num non-zero elements: 2
Test accuracy for nl: 0.926
Num non-zero elements: 5
Test accuracy for en: 0.998
Num non-zero elements: 5
Test accuracy for fr: 0.994
Num non-zero elements: 5
Test accuracy for de: 0.993
Num non-zero elements: 5
Test accuracy for es: 0.978
Num non-zero elements: 5
Test accuracy for nl: 0.936
Num non-zero elements: 10
Test accuracy for en: 0.999
Num non-zero elements: 10
Test accuracy for fr: 0.992
Num non-zero elements: 10
Test accuracy for de: 0.994
Num non-zero elements: 10
Test accuracy for es: 0.99
Num non-zero elements: 10
Test accuracy for nl: 0.984
Num non-zero elements: 20
Test accuracy for en: 0.999
Num non-zero elements: 20
Test accuracy for fr: 0.994
Num non-zero elements: 20
Test accuracy for de: 0.996
Num non-zero elements: 20
Test accuracy for es: 0.992
Num non-zero elements: 20
Test accuracy for nl: 0.994
Num non-zero elements: 50
Test accuracy for en: 0.997
Num non-zero elements: 50
Test accuracy for fr: 0.999
Num non-zero elements: 50
Test accuracy for de: 0.992
Num non-zero elements: 50
Test accuracy for es: 0.993
Num non-zero elements: 50
Test accuracy for nl: 0.997

Running SAE evaluation on all selected SAEs: 100%|██████████| 1/1 [16:51<00:00, 1011.08s/it][ARunning SAE evaluation on all selected SAEs: 100%|██████████| 1/1 [16:51<00:00, 1011.08s/it]
Evaluations: 100%|██████████| 1/1 [17:02<00:00, 1022.96s/it]Evaluations: 100%|██████████| 1/1 [17:02<00:00, 1022.96s/it]
/share/u/can/SAEBench/custom_saes/topk_sae.py:110: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  pt_params = t.load(path_to_params)
Loaded config: {'trainer': {'trainer_class': 'TrainerTopKAdditivity', 'dict_class': 'AutoEncoderTopK', 'lr': 0.000282842712474619, 'steps': 48828, 'seed': 0, 'activation_dim': 2304, 'dict_size': 8192, 'k': 50, 'auxk_alpha': 0.03125, 'additivity_coeff': 0.0, 'intersection_coeff': 0.0, 'device': 'cuda:0', 'layer': 4, 'lm_name': 'google/gemma-2-2b', 'wandb_name': 'TopKTrainer_Additivity-google/gemma-2-2b-resid_post_layer_4-add_coeff-0.0-inters_coeff-0.0', 'submodule_name': 'resid_post_layer_4'}, 'buffer': {'d_submodule': 2304, 'io': 'out', 'n_ctxs': 8192, 'ctx_len': 128, 'refresh_batch_size': 32, 'out_batch_size': 2048, 'device': 'cuda:0'}}
Original keys in state_dict: odict_keys(['b_dec', 'encoder.weight', 'encoder.bias', 'decoder.weight'])
Renamed keys in state_dict: dict_keys(['b_dec', 'W_enc', 'b_enc', 'W_dec'])
Evaluations:   0%|          | 0/1 [00:00<?, ?it/s]


Running sparse_probing evaluation




Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s][A
Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:01,  1.57it/s][A
Loading checkpoint shards:  67%|██████▋   | 2/3 [00:01<00:00,  1.63it/s][A
Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.37it/s][ALoading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.10it/s]
Loaded pretrained model gemma-2-2b into HookedTransformer

Running SAE evaluation on all selected SAEs:   0%|          | 0/1 [00:00<?, ?it/s][A

  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 616.90it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 1047.14it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 12.58it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 12.94it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 12.78it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 47.96it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 47.69it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 26.70it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.03it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.53it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.53it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.14it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.85it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.64it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.46it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.37it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.31it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.26it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.24it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.21it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.20it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.14it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.14it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.14it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.14it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.12it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.12it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.11it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.11it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.54it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.40it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.32it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.86it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.59it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.43it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.33it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.20it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.27it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.24it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.79it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.52it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.35it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.13it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.15it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.21it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.21it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.76it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.50it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.34it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.23it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.10it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.95it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.12it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.07it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.13it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.66it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.39it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.23it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.13it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.07it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.01it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.94it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.89it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.89it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.89it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.88it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.88it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.89it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.03it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.18it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.12it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.66it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.39it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.21it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.10it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.05it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.38it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.26it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.16it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.67it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.40it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.23it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.11it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.05it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.43it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.24it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.81it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.46it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.25it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.13it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.05it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.28it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.31it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.82it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.47it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.27it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.06it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.29it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.26it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.78it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.45it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.24it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.03it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.98it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.25it/s]
Num non-zero elements: 2304
Test accuracy for 0: 0.925
Num non-zero elements: 2304
Test accuracy for 1: 0.943
Num non-zero elements: 2304
Test accuracy for 2: 0.947
Num non-zero elements: 2304
Test accuracy for 6: 0.991
Num non-zero elements: 2304
Test accuracy for 9: 0.971
Num non-zero elements: 1
Test accuracy for 0: 0.603
Num non-zero elements: 1
Test accuracy for 1: 0.648
Num non-zero elements: 1
Test accuracy for 2: 0.731
Num non-zero elements: 1
Test accuracy for 6: 0.773
Num non-zero elements: 1
Test accuracy for 9: 0.68
Num non-zero elements: 2
Test accuracy for 0: 0.682
Num non-zero elements: 2
Test accuracy for 1: 0.655
Num non-zero elements: 2
Test accuracy for 2: 0.744
Num non-zero elements: 2
Test accuracy for 6: 0.771
Num non-zero elements: 2
Test accuracy for 9: 0.772
Num non-zero elements: 5
Test accuracy for 0: 0.768
Num non-zero elements: 5
Test accuracy for 1: 0.69
Num non-zero elements: 5
Test accuracy for 2: 0.754
Num non-zero elements: 5
Test accuracy for 6: 0.905
Num non-zero elements: 5
Test accuracy for 9: 0.798
Num non-zero elements: 10
Test accuracy for 0: 0.797
Num non-zero elements: 10
Test accuracy for 1: 0.818
Num non-zero elements: 10
Test accuracy for 2: 0.83
Num non-zero elements: 10
Test accuracy for 6: 0.929
Num non-zero elements: 10
Test accuracy for 9: 0.912
Num non-zero elements: 20
Test accuracy for 0: 0.796
Num non-zero elements: 20
Test accuracy for 1: 0.867
Num non-zero elements: 20
Test accuracy for 2: 0.847
Num non-zero elements: 20
Test accuracy for 6: 0.96
Num non-zero elements: 20
Test accuracy for 9: 0.945
Num non-zero elements: 50
Test accuracy for 0: 0.862
Num non-zero elements: 50
Test accuracy for 1: 0.905
Num non-zero elements: 50
Test accuracy for 2: 0.897
Num non-zero elements: 50
Test accuracy for 6: 0.977
Num non-zero elements: 50
Test accuracy for 9: 0.948
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 17 epochs
Test accuracy for 0: 0.9390000700950623
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for 1: 0.9590000510215759
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for 2: 0.9380000233650208
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for 6: 0.9880000352859497
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for 9: 0.9720000624656677
Num non-zero elements: 1
Test accuracy for 0: 0.643
Num non-zero elements: 1
Test accuracy for 1: 0.591
Num non-zero elements: 1
Test accuracy for 2: 0.891
Num non-zero elements: 1
Test accuracy for 6: 0.965
Num non-zero elements: 1
Test accuracy for 9: 0.931
Num non-zero elements: 2
Test accuracy for 0: 0.671
Num non-zero elements: 2
Test accuracy for 1: 0.677
Num non-zero elements: 2
Test accuracy for 2: 0.9
Num non-zero elements: 2
Test accuracy for 6: 0.974
Num non-zero elements: 2
Test accuracy for 9: 0.931
Num non-zero elements: 5
Test accuracy for 0: 0.864
Num non-zero elements: 5
Test accuracy for 1: 0.832
Num non-zero elements: 5
Test accuracy for 2: 0.91
Num non-zero elements: 5
Test accuracy for 6: 0.988
Num non-zero elements: 5
Test accuracy for 9: 0.941
Num non-zero elements: 10
Test accuracy for 0: 0.876
Num non-zero elements: 10
Test accuracy for 1: 0.885
Num non-zero elements: 10
Test accuracy for 2: 0.922
Num non-zero elements: 10
Test accuracy for 6: 0.988
Num non-zero elements: 10
Test accuracy for 9: 0.949
Num non-zero elements: 20
Test accuracy for 0: 0.891
Num non-zero elements: 20
Test accuracy for 1: 0.942
Num non-zero elements: 20
Test accuracy for 2: 0.92
Num non-zero elements: 20
Test accuracy for 6: 0.99
Num non-zero elements: 20
Test accuracy for 9: 0.954
Num non-zero elements: 50
Test accuracy for 0: 0.939
Num non-zero elements: 50
Test accuracy for 1: 0.962
Num non-zero elements: 50
Test accuracy for 2: 0.933
Num non-zero elements: 50
Test accuracy for 6: 0.991
Num non-zero elements: 50
Test accuracy for 9: 0.965


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 635.60it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 882.18it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 12.83it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 12.83it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 12.94it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 50.24it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 26.96it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.21it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.62it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.57it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.17it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.88it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:01<00:03, 14.67it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 17.32it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 17.53it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 17.70it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:02, 17.83it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 15.95it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.49it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.40it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.32it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.27it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.23it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.19it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.14it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.13it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.13it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.13it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.21it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.82it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.46it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.95it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.65it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.45it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.34it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.26it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.20it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.18it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 16.39it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.11it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 24.92it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 20.36it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 19.22it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.84it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.59it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.43it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.22it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.24it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 23.23it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.84it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 18.97it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.67it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.46it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.22it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 17.21it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.19it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.15it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.97it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.18it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 22.08it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.47it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.89it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.56it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.35it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.11it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.05it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.95it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 16.52it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 18.33it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.22it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.12it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.97it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 24.90it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 20.24it/s][A[A

Collecting activations:  56%|█████▋    | 9/16 [00:00<00:00, 19.09it/s][A[A

Collecting activations:  69%|██████▉   | 11/16 [00:00<00:00, 15.78it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.28it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.19it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.40it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.46it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.88it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.51it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.30it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.14it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.03it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.28it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.87it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.01it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.59it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.35it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.20it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.09it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.36it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.48it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.88it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.51it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.29it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.06it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.02it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.29it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.98it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.00it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.57it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.33it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 17.32it/s][A[A

Collecting activations:  94%|█████████▍| 15/16 [00:00<00:00, 18.28it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.38it/s]
Num non-zero elements: 2304
Test accuracy for 11: 0.949
Num non-zero elements: 2304
Test accuracy for 13: 0.934
Num non-zero elements: 2304
Test accuracy for 14: 0.946
Num non-zero elements: 2304
Test accuracy for 18: 0.915
Num non-zero elements: 2304
Test accuracy for 19: 0.964
Num non-zero elements: 1
Test accuracy for 11: 0.714
Num non-zero elements: 1
Test accuracy for 13: 0.702
Num non-zero elements: 1
Test accuracy for 14: 0.656
Num non-zero elements: 1
Test accuracy for 18: 0.692
Num non-zero elements: 1
Test accuracy for 19: 0.791
Num non-zero elements: 2
Test accuracy for 11: 0.774
Num non-zero elements: 2
Test accuracy for 13: 0.692
Num non-zero elements: 2
Test accuracy for 14: 0.688
Num non-zero elements: 2
Test accuracy for 18: 0.721
Num non-zero elements: 2
Test accuracy for 19: 0.795
Num non-zero elements: 5
Test accuracy for 11: 0.841
Num non-zero elements: 5
Test accuracy for 13: 0.784
Num non-zero elements: 5
Test accuracy for 14: 0.728
Num non-zero elements: 5
Test accuracy for 18: 0.722
Num non-zero elements: 5
Test accuracy for 19: 0.833
Num non-zero elements: 10
Test accuracy for 11: 0.869
Num non-zero elements: 10
Test accuracy for 13: 0.857
Num non-zero elements: 10
Test accuracy for 14: 0.807
Num non-zero elements: 10
Test accuracy for 18: 0.756
Num non-zero elements: 10
Test accuracy for 19: 0.844
Num non-zero elements: 20
Test accuracy for 11: 0.899
Num non-zero elements: 20
Test accuracy for 13: 0.871
Num non-zero elements: 20
Test accuracy for 14: 0.867
Num non-zero elements: 20
Test accuracy for 18: 0.764
Num non-zero elements: 20
Test accuracy for 19: 0.911
Num non-zero elements: 50
Test accuracy for 11: 0.929
Num non-zero elements: 50
Test accuracy for 13: 0.896
Num non-zero elements: 50
Test accuracy for 14: 0.889
Num non-zero elements: 50
Test accuracy for 18: 0.824
Num non-zero elements: 50
Test accuracy for 19: 0.933
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for 11: 0.9450000524520874
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 20 epochs
Test accuracy for 13: 0.937000036239624
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 22 epochs
Test accuracy for 14: 0.9510000348091125
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 25 epochs
Test accuracy for 18: 0.9080000519752502
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 35 epochs
Test accuracy for 19: 0.9600000381469727
Num non-zero elements: 1
Test accuracy for 11: 0.732
Num non-zero elements: 1
Test accuracy for 13: 0.704
Num non-zero elements: 1
Test accuracy for 14: 0.917
Num non-zero elements: 1
Test accuracy for 18: 0.619
Num non-zero elements: 1
Test accuracy for 19: 0.868
Num non-zero elements: 2
Test accuracy for 11: 0.859
Num non-zero elements: 2
Test accuracy for 13: 0.689
Num non-zero elements: 2
Test accuracy for 14: 0.914
Num non-zero elements: 2
Test accuracy for 18: 0.734
Num non-zero elements: 2
Test accuracy for 19: 0.849
Num non-zero elements: 5
Test accuracy for 11: 0.926
Num non-zero elements: 5
Test accuracy for 13: 0.759
Num non-zero elements: 5
Test accuracy for 14: 0.92
Num non-zero elements: 5
Test accuracy for 18: 0.887
Num non-zero elements: 5
Test accuracy for 19: 0.881
Num non-zero elements: 10
Test accuracy for 11: 0.921
Num non-zero elements: 10
Test accuracy for 13: 0.851
Num non-zero elements: 10
Test accuracy for 14: 0.916
Num non-zero elements: 10
Test accuracy for 18: 0.909
Num non-zero elements: 10
Test accuracy for 19: 0.892
Num non-zero elements: 20
Test accuracy for 11: 0.937
Num non-zero elements: 20
Test accuracy for 13: 0.928
Num non-zero elements: 20
Test accuracy for 14: 0.929
Num non-zero elements: 20
Test accuracy for 18: 0.907
Num non-zero elements: 20
Test accuracy for 19: 0.922
Num non-zero elements: 50
Test accuracy for 11: 0.944
Num non-zero elements: 50
Test accuracy for 13: 0.953
Num non-zero elements: 50
Test accuracy for 14: 0.934
Num non-zero elements: 50
Test accuracy for 18: 0.906
Num non-zero elements: 50
Test accuracy for 19: 0.942


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 660.79it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 1080.72it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00,  6.26it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00,  8.99it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00,  9.08it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 48.42it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 47.31it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.21it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.12it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.54it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.52it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.12it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.82it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.41it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.50it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.38it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.29it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.23it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.20it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.49it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.83it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.42it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.90it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.61it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.42it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 17.94it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 16.62it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.43it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 16.10it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 15.24it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.68it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.76it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.83it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.88it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.92it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:03<00:00, 13.77it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 16.50it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 16.86it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.15it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.38it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.55it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.52it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.15it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.14it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.70it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.43it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.15it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.08it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.04it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.90it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.91it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.89it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.91it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:03<00:00, 12.44it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 15.36it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 15.98it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 16.47it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 16.86it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 15.52it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.23it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 28.85it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 22.58it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 19.89it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.26it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.85it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.56it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.37it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.22it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.89it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.89it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.89it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.89it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.88it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.88it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.86it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.86it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.87it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.87it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.28it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.97it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.37it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.80it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.46it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.12it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.03it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 17.98it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.93it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.90it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.88it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.88it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.88it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.86it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.86it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.85it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.85it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.84it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.84it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.83it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.85it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.84it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.84it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.83it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.84it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.85it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.84it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.84it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.83it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.84it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.01it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.78it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.93it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.52it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.28it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.02it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.96it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.28it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.69it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.90it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.50it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.27it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.10it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.01it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.95it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.28it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.23it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.73it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.40it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.19it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.99it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.95it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.23it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.31it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.75it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.25it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.09it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.00it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.95it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.22it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.50it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.82it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.44it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.23it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 15.67it/s][A[A

Collecting activations:  94%|█████████▍| 15/16 [00:00<00:00, 18.15it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.02it/s]
Num non-zero elements: 2304
Test accuracy for 20: 0.929
Num non-zero elements: 2304
Test accuracy for 21: 0.906
Num non-zero elements: 2304
Test accuracy for 22: 0.897
Num non-zero elements: 2304
Test accuracy for 25: 0.94
Num non-zero elements: 2304
Test accuracy for 26: 0.877
Num non-zero elements: 1
Test accuracy for 20: 0.735
Num non-zero elements: 1
Test accuracy for 21: 0.62
Num non-zero elements: 1
Test accuracy for 22: 0.627
Num non-zero elements: 1
Test accuracy for 25: 0.711
Num non-zero elements: 1
Test accuracy for 26: 0.66
Num non-zero elements: 2
Test accuracy for 20: 0.796
Num non-zero elements: 2
Test accuracy for 21: 0.716
Num non-zero elements: 2
Test accuracy for 22: 0.603
Num non-zero elements: 2
Test accuracy for 25: 0.727
Num non-zero elements: 2
Test accuracy for 26: 0.648
Num non-zero elements: 5
Test accuracy for 20: 0.844
Num non-zero elements: 5
Test accuracy for 21: 0.749
Num non-zero elements: 5
Test accuracy for 22: 0.745
Num non-zero elements: 5
Test accuracy for 25: 0.789
Num non-zero elements: 5
Test accuracy for 26: 0.703
Num non-zero elements: 10
Test accuracy for 20: 0.88
Num non-zero elements: 10
Test accuracy for 21: 0.831
Num non-zero elements: 10
Test accuracy for 22: 0.745
Num non-zero elements: 10
Test accuracy for 25: 0.882
Num non-zero elements: 10
Test accuracy for 26: 0.708
Num non-zero elements: 20
Test accuracy for 20: 0.906
Num non-zero elements: 20
Test accuracy for 21: 0.848
Num non-zero elements: 20
Test accuracy for 22: 0.795
Num non-zero elements: 20
Test accuracy for 25: 0.906
Num non-zero elements: 20
Test accuracy for 26: 0.755
Num non-zero elements: 50
Test accuracy for 20: 0.905
Num non-zero elements: 50
Test accuracy for 21: 0.863
Num non-zero elements: 50
Test accuracy for 22: 0.816
Num non-zero elements: 50
Test accuracy for 25: 0.912
Num non-zero elements: 50
Test accuracy for 26: 0.825
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 21 epochs
Test accuracy for 20: 0.9440000653266907
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for 21: 0.9040000438690186
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 12 epochs
Test accuracy for 22: 0.893000066280365
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for 25: 0.9490000605583191
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 14 epochs
Test accuracy for 26: 0.8740000128746033
Num non-zero elements: 1
Test accuracy for 20: 0.872
Num non-zero elements: 1
Test accuracy for 21: 0.592
Num non-zero elements: 1
Test accuracy for 22: 0.845
Num non-zero elements: 1
Test accuracy for 25: 0.856
Num non-zero elements: 1
Test accuracy for 26: 0.719
Num non-zero elements: 2
Test accuracy for 20: 0.894
Num non-zero elements: 2
Test accuracy for 21: 0.769
Num non-zero elements: 2
Test accuracy for 22: 0.868
Num non-zero elements: 2
Test accuracy for 25: 0.874
Num non-zero elements: 2
Test accuracy for 26: 0.76
Num non-zero elements: 5
Test accuracy for 20: 0.897
Num non-zero elements: 5
Test accuracy for 21: 0.79
Num non-zero elements: 5
Test accuracy for 22: 0.879
Num non-zero elements: 5
Test accuracy for 25: 0.898
Num non-zero elements: 5
Test accuracy for 26: 0.809
Num non-zero elements: 10
Test accuracy for 20: 0.909
Num non-zero elements: 10
Test accuracy for 21: 0.828
Num non-zero elements: 10
Test accuracy for 22: 0.884
Num non-zero elements: 10
Test accuracy for 25: 0.914
Num non-zero elements: 10
Test accuracy for 26: 0.799
Num non-zero elements: 20
Test accuracy for 20: 0.927
Num non-zero elements: 20
Test accuracy for 21: 0.837
Num non-zero elements: 20
Test accuracy for 22: 0.889
Num non-zero elements: 20
Test accuracy for 25: 0.944
Num non-zero elements: 20
Test accuracy for 26: 0.847
Num non-zero elements: 50
Test accuracy for 20: 0.948
Num non-zero elements: 50
Test accuracy for 21: 0.875
Num non-zero elements: 50
Test accuracy for 22: 0.897
Num non-zero elements: 50
Test accuracy for 25: 0.946
Num non-zero elements: 50
Test accuracy for 26: 0.856


  0%|          | 0/34 [00:00<?, ?it/s][A[A100%|██████████| 34/34 [00:00<00:00, 399.31it/s]


  0%|          | 0/31 [00:00<?, ?it/s][A[A100%|██████████| 31/31 [00:00<00:00, 871.23it/s]
Removing 31 from train set
Removing 0 from train set
Removing 29 from train set
Removing 28 from train set
Removing 7 from train set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 10.27it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 10.31it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 10.35it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 39.68it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 39.20it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.99it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.07it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.48it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.44it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.04it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.75it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.53it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.37it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.27it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.20it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.45it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.02it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.14it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.72it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.47it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.32it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.23it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.15it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.11it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.92it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.13it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.02it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.12it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.69it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.43it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.28it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.12it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.08it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.94it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.09it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.92it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.08it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.66it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.40it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.13it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.06it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.03it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.90it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.90it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.89it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.89it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.89it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.89it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.88it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.88it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.89it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.87it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.88it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.89it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.03it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.86it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:03, 18.97it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.56it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.33it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.08it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.02it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 17.98it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.94it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.91it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.89it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.88it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.89it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.88it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.88it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.88it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.88it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.88it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.87it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.86it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.86it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.86it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.86it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.86it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.86it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.85it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.84it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.99it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.80it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.95it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.54it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.29it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.04it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.98it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.32it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.29it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.77it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.42it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.22it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.09it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.02it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.97it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.24it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.27it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.75it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.40it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.20it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.08it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.00it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.96it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.23it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.29it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.74it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.40it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.19it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.05it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.97it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.94it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.87it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.81it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.59it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.91it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.52it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.28it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.56it/s]
Num non-zero elements: 2304
Test accuracy for 1: 0.927
Num non-zero elements: 2304
Test accuracy for 2: 0.901
Num non-zero elements: 2304
Test accuracy for 3: 0.886
Num non-zero elements: 2304
Test accuracy for 5: 0.889
Num non-zero elements: 2304
Test accuracy for 6: 0.842
Num non-zero elements: 1
Test accuracy for 1: 0.711
Num non-zero elements: 1
Test accuracy for 2: 0.697
Num non-zero elements: 1
Test accuracy for 3: 0.615
Num non-zero elements: 1
Test accuracy for 5: 0.699
Num non-zero elements: 1
Test accuracy for 6: 0.616
Num non-zero elements: 2
Test accuracy for 1: 0.734
Num non-zero elements: 2
Test accuracy for 2: 0.765
Num non-zero elements: 2
Test accuracy for 3: 0.616
Num non-zero elements: 2
Test accuracy for 5: 0.689
Num non-zero elements: 2
Test accuracy for 6: 0.64
Num non-zero elements: 5
Test accuracy for 1: 0.784
Num non-zero elements: 5
Test accuracy for 2: 0.817
Num non-zero elements: 5
Test accuracy for 3: 0.635
Num non-zero elements: 5
Test accuracy for 5: 0.725
Num non-zero elements: 5
Test accuracy for 6: 0.699
Num non-zero elements: 10
Test accuracy for 1: 0.823
Num non-zero elements: 10
Test accuracy for 2: 0.813
Num non-zero elements: 10
Test accuracy for 3: 0.747
Num non-zero elements: 10
Test accuracy for 5: 0.747
Num non-zero elements: 10
Test accuracy for 6: 0.724
Num non-zero elements: 20
Test accuracy for 1: 0.843
Num non-zero elements: 20
Test accuracy for 2: 0.832
Num non-zero elements: 20
Test accuracy for 3: 0.783
Num non-zero elements: 20
Test accuracy for 5: 0.748
Num non-zero elements: 20
Test accuracy for 6: 0.75
Num non-zero elements: 50
Test accuracy for 1: 0.883
Num non-zero elements: 50
Test accuracy for 2: 0.839
Num non-zero elements: 50
Test accuracy for 3: 0.846
Num non-zero elements: 50
Test accuracy for 5: 0.815
Num non-zero elements: 50
Test accuracy for 6: 0.799
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 1: 0.9260000586509705
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for 2: 0.9320000410079956
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 24 epochs
Test accuracy for 3: 0.9040000438690186
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for 5: 0.9130000472068787
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for 6: 0.8660000562667847
Num non-zero elements: 1
Test accuracy for 1: 0.805
Num non-zero elements: 1
Test accuracy for 2: 0.781
Num non-zero elements: 1
Test accuracy for 3: 0.565
Num non-zero elements: 1
Test accuracy for 5: 0.8
Num non-zero elements: 1
Test accuracy for 6: 0.605
Num non-zero elements: 2
Test accuracy for 1: 0.806
Num non-zero elements: 2
Test accuracy for 2: 0.829
Num non-zero elements: 2
Test accuracy for 3: 0.695
Num non-zero elements: 2
Test accuracy for 5: 0.852
Num non-zero elements: 2
Test accuracy for 6: 0.661
Num non-zero elements: 5
Test accuracy for 1: 0.895
Num non-zero elements: 5
Test accuracy for 2: 0.848
Num non-zero elements: 5
Test accuracy for 3: 0.747
Num non-zero elements: 5
Test accuracy for 5: 0.87
Num non-zero elements: 5
Test accuracy for 6: 0.732
Num non-zero elements: 10
Test accuracy for 1: 0.9
Num non-zero elements: 10
Test accuracy for 2: 0.864
Num non-zero elements: 10
Test accuracy for 3: 0.838
Num non-zero elements: 10
Test accuracy for 5: 0.878
Num non-zero elements: 10
Test accuracy for 6: 0.741
Num non-zero elements: 20
Test accuracy for 1: 0.911
Num non-zero elements: 20
Test accuracy for 2: 0.888
Num non-zero elements: 20
Test accuracy for 3: 0.865
Num non-zero elements: 20
Test accuracy for 5: 0.901
Num non-zero elements: 20
Test accuracy for 6: 0.812
Num non-zero elements: 50
Test accuracy for 1: 0.922
Num non-zero elements: 50
Test accuracy for 2: 0.894
Num non-zero elements: 50
Test accuracy for 3: 0.887
Num non-zero elements: 50
Test accuracy for 5: 0.899
Num non-zero elements: 50
Test accuracy for 6: 0.804


Tokenizing data:   0%|          | 0/2 [00:00<?, ?it/s][A[A

Tokenizing data:  50%|█████     | 1/2 [00:00<00:00,  9.32it/s][A[A

Tokenizing data: 100%|██████████| 2/2 [00:00<00:00,  9.46it/s][A[ATokenizing data: 100%|██████████| 2/2 [00:00<00:00,  9.27it/s]


Tokenizing data:   0%|          | 0/2 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 2/2 [00:00<00:00, 37.73it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.71it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.09it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.49it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.46it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.06it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.76it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.54it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.37it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.27it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.20it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 14.83it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.10it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 28.15it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 21.22it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 19.62it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.96it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.69it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.49it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.35it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 16.92it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.55it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.40it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.29it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.21it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.31it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 23.52it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.92it/s][A[A

Collecting activations:  56%|█████▋    | 9/16 [00:00<00:00, 18.98it/s][A[A

Collecting activations:  69%|██████▉   | 11/16 [00:00<00:00, 18.66it/s][A[A

Collecting activations:  81%|████████▏ | 13/16 [00:00<00:00, 18.45it/s][A[A

Collecting activations:  94%|█████████▍| 15/16 [00:00<00:00, 18.31it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.82it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.68it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.65it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 19.02it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.64it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.43it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.27it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 13.34it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 16.20it/s]
Num non-zero elements: 2304
Test accuracy for 1.0: 0.903
Num non-zero elements: 2304
Test accuracy for 5.0: 0.903
Num non-zero elements: 1
Test accuracy for 1.0: 0.631
Num non-zero elements: 1
Test accuracy for 5.0: 0.631
Num non-zero elements: 2
Test accuracy for 1.0: 0.654
Num non-zero elements: 2
Test accuracy for 5.0: 0.654
Num non-zero elements: 5
Test accuracy for 1.0: 0.669
Num non-zero elements: 5
Test accuracy for 5.0: 0.669
Num non-zero elements: 10
Test accuracy for 1.0: 0.764
Num non-zero elements: 10
Test accuracy for 5.0: 0.764
Num non-zero elements: 20
Test accuracy for 1.0: 0.791
Num non-zero elements: 20
Test accuracy for 5.0: 0.791
Num non-zero elements: 50
Test accuracy for 1.0: 0.829
Num non-zero elements: 50
Test accuracy for 5.0: 0.829
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 25 epochs
Test accuracy for 1.0: 0.9040000438690186
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 5.0: 0.9030000567436218
Num non-zero elements: 1
Test accuracy for 1.0: 0.602
Num non-zero elements: 1
Test accuracy for 5.0: 0.602
Num non-zero elements: 2
Test accuracy for 1.0: 0.623
Num non-zero elements: 2
Test accuracy for 5.0: 0.623
Num non-zero elements: 5
Test accuracy for 1.0: 0.812
Num non-zero elements: 5
Test accuracy for 5.0: 0.812
Num non-zero elements: 10
Test accuracy for 1.0: 0.834
Num non-zero elements: 10
Test accuracy for 5.0: 0.834
Num non-zero elements: 20
Test accuracy for 1.0: 0.859
Num non-zero elements: 20
Test accuracy for 5.0: 0.859
Num non-zero elements: 50
Test accuracy for 1.0: 0.89
Num non-zero elements: 50
Test accuracy for 5.0: 0.89
Loading dataset codeparrot/github-code, this usually takes ~30 seconds


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  20%|██        | 1/5 [00:01<00:07,  1.93s/it][A[A

Tokenizing data:  40%|████      | 2/5 [00:02<00:04,  1.36s/it][A[A

Tokenizing data:  60%|██████    | 3/5 [00:04<00:02,  1.30s/it][A[A

Tokenizing data:  80%|████████  | 4/5 [00:04<00:00,  1.02it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:05<00:00,  1.16it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:05<00:00,  1.05s/it]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  20%|██        | 1/5 [00:00<00:02,  1.85it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00,  3.05it/s][A[A

Tokenizing data:  60%|██████    | 3/5 [00:01<00:00,  2.94it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:01<00:00,  3.71it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:01<00:00,  4.19it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:01<00:00,  3.52it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.66it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.26it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.55it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.47it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.05it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.75it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.52it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.36it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.26it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.19it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.98it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.42it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.15it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.16it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.69it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.44it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.28it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.17it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.11it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.07it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.93it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.08it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.86it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.01it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.58it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.33it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.10it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.03it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 17.98it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.93it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.92it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.91it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.89it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.89it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.89it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.89it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.89it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.89it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.88it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.88it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.88it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.88it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.88it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.88it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.87it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.87it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.00it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.83it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:03, 18.99it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.57it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.33it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.17it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.07it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 17.99it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 17.95it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.92it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.90it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.89it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.87it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.87it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.87it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.87it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.86it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.85it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.85it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.85it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.85it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.84it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.84it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.85it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.85it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.85it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:03<00:00, 17.85it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.85it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.84it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.83it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.83it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.97it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.83it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:03, 18.97it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.54it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.30it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.15it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.04it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 17.96it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 17.91it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.89it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.88it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.86it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.85it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.85it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.84it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.83it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.83it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.82it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.82it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.83it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.83it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.82it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.82it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.82it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.82it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.81it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:03<00:00, 17.81it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.81it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.81it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.82it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.81it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.95it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.75it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.91it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.49it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.23it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.08it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.96it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.92it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.25it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.23it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.72it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.37it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.02it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.94it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.91it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.18it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.19it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.70it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.36it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.03it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.94it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.89it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.17it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.20it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.71it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.36it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.02it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.94it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.89it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.17it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.15it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.67it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.33it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.13it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.01it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.93it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.89it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.16it/s]
Num non-zero elements: 2304
Test accuracy for C: 0.956
Num non-zero elements: 2304
Test accuracy for Python: 0.984
Num non-zero elements: 2304
Test accuracy for HTML: 0.981
Num non-zero elements: 2304
Test accuracy for Java: 0.962
Num non-zero elements: 2304
Test accuracy for PHP: 0.952
Num non-zero elements: 1
Test accuracy for C: 0.622
Num non-zero elements: 1
Test accuracy for Python: 0.617
Num non-zero elements: 1
Test accuracy for HTML: 0.735
Num non-zero elements: 1
Test accuracy for Java: 0.626
Num non-zero elements: 1
Test accuracy for PHP: 0.559
Num non-zero elements: 2
Test accuracy for C: 0.73
Num non-zero elements: 2
Test accuracy for Python: 0.638
Num non-zero elements: 2
Test accuracy for HTML: 0.943
Num non-zero elements: 2
Test accuracy for Java: 0.636
Num non-zero elements: 2
Test accuracy for PHP: 0.655
Num non-zero elements: 5
Test accuracy for C: 0.829
Num non-zero elements: 5
Test accuracy for Python: 0.747
Num non-zero elements: 5
Test accuracy for HTML: 0.942
Num non-zero elements: 5
Test accuracy for Java: 0.785
Num non-zero elements: 5
Test accuracy for PHP: 0.7
Num non-zero elements: 10
Test accuracy for C: 0.828
Num non-zero elements: 10
Test accuracy for Python: 0.862
Num non-zero elements: 10
Test accuracy for HTML: 0.958
Num non-zero elements: 10
Test accuracy for Java: 0.823
Num non-zero elements: 10
Test accuracy for PHP: 0.802
Num non-zero elements: 20
Test accuracy for C: 0.869
Num non-zero elements: 20
Test accuracy for Python: 0.92
Num non-zero elements: 20
Test accuracy for HTML: 0.962
Num non-zero elements: 20
Test accuracy for Java: 0.875
Num non-zero elements: 20
Test accuracy for PHP: 0.857
Num non-zero elements: 50
Test accuracy for C: 0.908
Num non-zero elements: 50
Test accuracy for Python: 0.966
Num non-zero elements: 50
Test accuracy for HTML: 0.965
Num non-zero elements: 50
Test accuracy for Java: 0.914
Num non-zero elements: 50
Test accuracy for PHP: 0.887
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 20 epochs
Test accuracy for C: 0.9660000205039978
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 21 epochs
Test accuracy for Python: 0.987000048160553
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 23 epochs
Test accuracy for HTML: 0.9860000610351562
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 29 epochs
Test accuracy for Java: 0.9690000414848328
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 43 epochs
Test accuracy for PHP: 0.9620000720024109
Num non-zero elements: 1
Test accuracy for C: 0.631
Num non-zero elements: 1
Test accuracy for Python: 0.907
Num non-zero elements: 1
Test accuracy for HTML: 0.7
Num non-zero elements: 1
Test accuracy for Java: 0.62
Num non-zero elements: 1
Test accuracy for PHP: 0.904
Num non-zero elements: 2
Test accuracy for C: 0.691
Num non-zero elements: 2
Test accuracy for Python: 0.908
Num non-zero elements: 2
Test accuracy for HTML: 0.847
Num non-zero elements: 2
Test accuracy for Java: 0.656
Num non-zero elements: 2
Test accuracy for PHP: 0.903
Num non-zero elements: 5
Test accuracy for C: 0.707
Num non-zero elements: 5
Test accuracy for Python: 0.937
Num non-zero elements: 5
Test accuracy for HTML: 0.941
Num non-zero elements: 5
Test accuracy for Java: 0.894
Num non-zero elements: 5
Test accuracy for PHP: 0.911
Num non-zero elements: 10
Test accuracy for C: 0.9
Num non-zero elements: 10
Test accuracy for Python: 0.969
Num non-zero elements: 10
Test accuracy for HTML: 0.956
Num non-zero elements: 10
Test accuracy for Java: 0.922
Num non-zero elements: 10
Test accuracy for PHP: 0.914
Num non-zero elements: 20
Test accuracy for C: 0.919
Num non-zero elements: 20
Test accuracy for Python: 0.978
Num non-zero elements: 20
Test accuracy for HTML: 0.961
Num non-zero elements: 20
Test accuracy for Java: 0.937
Num non-zero elements: 20
Test accuracy for PHP: 0.924
Num non-zero elements: 50
Test accuracy for C: 0.94
Num non-zero elements: 50
Test accuracy for Python: 0.983
Num non-zero elements: 50
Test accuracy for HTML: 0.965
Num non-zero elements: 50
Test accuracy for Java: 0.934
Num non-zero elements: 50
Test accuracy for PHP: 0.927


Tokenizing data:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Tokenizing data:  50%|█████     | 2/4 [00:00<00:00, 13.91it/s][A[A

Tokenizing data: 100%|██████████| 4/4 [00:00<00:00, 13.73it/s][A[ATokenizing data: 100%|██████████| 4/4 [00:00<00:00, 13.64it/s]


Tokenizing data:   0%|          | 0/4 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 4/4 [00:00<00:00, 52.44it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 26.97it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 22.99it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.51it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.51it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.11it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.83it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.64it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.45it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.35it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.28it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.24it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.20it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 14.01it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 16.86it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.17it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.43it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.18it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.38it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.31it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.86it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.58it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.40it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:03, 14.96it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 17.73it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 17.82it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 17.89it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 17.94it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.07it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.02it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.58it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.34it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.85it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.56it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.39it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.27it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 14.38it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 17.09it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 17.34it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 17.51it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 17.66it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 17.76it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 17.84it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 17.88it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:01, 15.53it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.83it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.22it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.19it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.76it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.50it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.34it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.22it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.08it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 16.22it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.50it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.34it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 18.24it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.16it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.10it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.08it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.13it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.67it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.42it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.11it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:01<00:00, 15.78it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 28.25it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 23.08it/s][A[A

Collecting activations:  56%|█████▋    | 9/16 [00:00<00:00, 20.42it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 19.36it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.95it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.68it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 19.72it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.97it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.07it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.66it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.41it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.25it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.43it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.35it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.86it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.51it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.31it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.10it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.06it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.33it/s]
Num non-zero elements: 2304
Test accuracy for 0: 0.927
Num non-zero elements: 2304
Test accuracy for 1: 0.981
Num non-zero elements: 2304
Test accuracy for 2: 0.906
Num non-zero elements: 2304
Test accuracy for 3: 0.91
Num non-zero elements: 1
Test accuracy for 0: 0.786
Num non-zero elements: 1
Test accuracy for 1: 0.681
Num non-zero elements: 1
Test accuracy for 2: 0.654
Num non-zero elements: 1
Test accuracy for 3: 0.781
Num non-zero elements: 2
Test accuracy for 0: 0.782
Num non-zero elements: 2
Test accuracy for 1: 0.788
Num non-zero elements: 2
Test accuracy for 2: 0.69
Num non-zero elements: 2
Test accuracy for 3: 0.788
Num non-zero elements: 5
Test accuracy for 0: 0.871
Num non-zero elements: 5
Test accuracy for 1: 0.875
Num non-zero elements: 5
Test accuracy for 2: 0.779
Num non-zero elements: 5
Test accuracy for 3: 0.831
Num non-zero elements: 10
Test accuracy for 0: 0.884
Num non-zero elements: 10
Test accuracy for 1: 0.943
Num non-zero elements: 10
Test accuracy for 2: 0.807
Num non-zero elements: 10
Test accuracy for 3: 0.852
Num non-zero elements: 20
Test accuracy for 0: 0.901
Num non-zero elements: 20
Test accuracy for 1: 0.959
Num non-zero elements: 20
Test accuracy for 2: 0.86
Num non-zero elements: 20
Test accuracy for 3: 0.896
Num non-zero elements: 50
Test accuracy for 0: 0.908
Num non-zero elements: 50
Test accuracy for 1: 0.966
Num non-zero elements: 50
Test accuracy for 2: 0.883
Num non-zero elements: 50
Test accuracy for 3: 0.909
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for 0: 0.9350000619888306
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for 1: 0.9790000319480896
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 14 epochs
Test accuracy for 2: 0.9110000729560852
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for 3: 0.9450000524520874
Num non-zero elements: 1
Test accuracy for 0: 0.787
Num non-zero elements: 1
Test accuracy for 1: 0.953
Num non-zero elements: 1
Test accuracy for 2: 0.763
Num non-zero elements: 1
Test accuracy for 3: 0.712
Num non-zero elements: 2
Test accuracy for 0: 0.791
Num non-zero elements: 2
Test accuracy for 1: 0.953
Num non-zero elements: 2
Test accuracy for 2: 0.777
Num non-zero elements: 2
Test accuracy for 3: 0.713
Num non-zero elements: 5
Test accuracy for 0: 0.851
Num non-zero elements: 5
Test accuracy for 1: 0.954
Num non-zero elements: 5
Test accuracy for 2: 0.809
Num non-zero elements: 5
Test accuracy for 3: 0.834
Num non-zero elements: 10
Test accuracy for 0: 0.869
Num non-zero elements: 10
Test accuracy for 1: 0.961
Num non-zero elements: 10
Test accuracy for 2: 0.857
Num non-zero elements: 10
Test accuracy for 3: 0.856
Num non-zero elements: 20
Test accuracy for 0: 0.904
Num non-zero elements: 20
Test accuracy for 1: 0.976
Num non-zero elements: 20
Test accuracy for 2: 0.88
Num non-zero elements: 20
Test accuracy for 3: 0.89
Num non-zero elements: 50
Test accuracy for 0: 0.909
Num non-zero elements: 50
Test accuracy for 1: 0.976
Num non-zero elements: 50
Test accuracy for 2: 0.882
Num non-zero elements: 50
Test accuracy for 3: 0.919
Loading dataset Helsinki-NLP/europarl, this usually takes ~10 seconds


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 14.89it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 14.86it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00,  9.89it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 54.13it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 26.97it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.23it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.60it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.55it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.15it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.79it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.65it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.47it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.35it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.27it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.23it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.20it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.08it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.52it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.15it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.24it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.81it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.55it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.38it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.17it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.18it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.08it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.19it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.75it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.50it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.35it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.13it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.13it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.97it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.12it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.68it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.43it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.12it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.08it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.96it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.10it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.98it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.09it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.66it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.40it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.15it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.09it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.04it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.39it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.05it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.13it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.43it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.86it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.53it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.32it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.11it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.51it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.91it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.36it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.80it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.49it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.29it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.08it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.45it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.21it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.43it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.84it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.50it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 12.68it/s][A[A

Collecting activations:  94%|█████████▍| 15/16 [00:00<00:00, 15.68it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 16.51it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.29it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.14it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.67it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.41it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.21it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 16.05it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.27it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.22it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.44it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 17.44it/s][A[A

Collecting activations:  69%|██████▉   | 11/16 [00:00<00:00, 18.75it/s][A[A

Collecting activations:  81%|████████▏ | 13/16 [00:00<00:00, 18.47it/s][A[A

Collecting activations:  94%|█████████▍| 15/16 [00:00<00:00, 18.26it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.53it/s]
Num non-zero elements: 2304
Test accuracy for en: 0.997
Num non-zero elements: 2304
Test accuracy for fr: 1.0
Num non-zero elements: 2304
Test accuracy for de: 1.0
Num non-zero elements: 2304
Test accuracy for es: 1.0
Num non-zero elements: 2304
Test accuracy for nl: 1.0
Num non-zero elements: 1
Test accuracy for en: 0.946
Num non-zero elements: 1
Test accuracy for fr: 0.652
Num non-zero elements: 1
Test accuracy for de: 0.819
Num non-zero elements: 1
Test accuracy for es: 0.887
Num non-zero elements: 1
Test accuracy for nl: 0.851
Num non-zero elements: 2
Test accuracy for en: 0.972
Num non-zero elements: 2
Test accuracy for fr: 0.895
Num non-zero elements: 2
Test accuracy for de: 0.847
Num non-zero elements: 2
Test accuracy for es: 0.9
Num non-zero elements: 2
Test accuracy for nl: 0.892
Num non-zero elements: 5
Test accuracy for en: 0.993
Num non-zero elements: 5
Test accuracy for fr: 0.966
Num non-zero elements: 5
Test accuracy for de: 0.894
Num non-zero elements: 5
Test accuracy for es: 0.982
Num non-zero elements: 5
Test accuracy for nl: 0.939
Num non-zero elements: 10
Test accuracy for en: 1.0
Num non-zero elements: 10
Test accuracy for fr: 0.989
Num non-zero elements: 10
Test accuracy for de: 0.972
Num non-zero elements: 10
Test accuracy for es: 0.99
Num non-zero elements: 10
Test accuracy for nl: 0.98
Num non-zero elements: 20
Test accuracy for en: 0.998
Num non-zero elements: 20
Test accuracy for fr: 0.995
Num non-zero elements: 20
Test accuracy for de: 0.987
Num non-zero elements: 20
Test accuracy for es: 0.996
Num non-zero elements: 20
Test accuracy for nl: 0.981
Num non-zero elements: 50
Test accuracy for en: 0.997
Num non-zero elements: 50
Test accuracy for fr: 0.999
Num non-zero elements: 50
Test accuracy for de: 0.998
Num non-zero elements: 50
Test accuracy for es: 0.999
Num non-zero elements: 50
Test accuracy for nl: 0.996
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for en: 0.999000072479248
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for fr: 0.999000072479248
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for de: 1.0
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for es: 1.0
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 21 epochs
Test accuracy for nl: 0.9980000257492065
Num non-zero elements: 1
Test accuracy for en: 0.992
Num non-zero elements: 1
Test accuracy for fr: 0.863
Num non-zero elements: 1
Test accuracy for de: 0.998
Num non-zero elements: 1
Test accuracy for es: 0.924
Num non-zero elements: 1
Test accuracy for nl: 0.917
Num non-zero elements: 2
Test accuracy for en: 0.999
Num non-zero elements: 2
Test accuracy for fr: 0.997
Num non-zero elements: 2
Test accuracy for de: 0.997
Num non-zero elements: 2
Test accuracy for es: 0.947
Num non-zero elements: 2
Test accuracy for nl: 0.998
Num non-zero elements: 5
Test accuracy for en: 0.999
Num non-zero elements: 5
Test accuracy for fr: 0.998
Num non-zero elements: 5
Test accuracy for de: 0.999
Num non-zero elements: 5
Test accuracy for es: 0.971
Num non-zero elements: 5
Test accuracy for nl: 0.996
Num non-zero elements: 10
Test accuracy for en: 0.999
Num non-zero elements: 10
Test accuracy for fr: 0.997
Num non-zero elements: 10
Test accuracy for de: 0.999
Num non-zero elements: 10
Test accuracy for es: 0.998
Num non-zero elements: 10
Test accuracy for nl: 0.997
Num non-zero elements: 20
Test accuracy for en: 0.999
Num non-zero elements: 20
Test accuracy for fr: 0.996
Num non-zero elements: 20
Test accuracy for de: 0.999
Num non-zero elements: 20
Test accuracy for es: 0.997
Num non-zero elements: 20
Test accuracy for nl: 1.0
Num non-zero elements: 50
Test accuracy for en: 0.998
Num non-zero elements: 50
Test accuracy for fr: 0.999
Num non-zero elements: 50
Test accuracy for de: 0.999
Num non-zero elements: 50
Test accuracy for es: 0.998
Num non-zero elements: 50
Test accuracy for nl: 1.0

Running SAE evaluation on all selected SAEs: 100%|██████████| 1/1 [17:01<00:00, 1021.01s/it][ARunning SAE evaluation on all selected SAEs: 100%|██████████| 1/1 [17:01<00:00, 1021.01s/it]
Evaluations: 100%|██████████| 1/1 [17:15<00:00, 1035.14s/it]Evaluations: 100%|██████████| 1/1 [17:15<00:00, 1035.14s/it]
/share/u/can/SAEBench/custom_saes/topk_sae.py:110: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  pt_params = t.load(path_to_params)
Loaded config: {'trainer': {'trainer_class': 'TrainerTopKAdditivity', 'dict_class': 'AutoEncoderTopK', 'lr': 0.000282842712474619, 'steps': 48828, 'seed': 0, 'activation_dim': 2304, 'dict_size': 8192, 'k': 50, 'auxk_alpha': 0.03125, 'additivity_coeff': 0.0, 'intersection_coeff': 1.0, 'device': 'cuda:0', 'layer': 4, 'lm_name': 'google/gemma-2-2b', 'wandb_name': 'TopKTrainer_Additivity-google/gemma-2-2b-resid_post_layer_4-add_coeff-0.0-inters_coeff-1.0', 'submodule_name': 'resid_post_layer_4'}, 'buffer': {'d_submodule': 2304, 'io': 'out', 'n_ctxs': 8192, 'ctx_len': 128, 'refresh_batch_size': 32, 'out_batch_size': 2048, 'device': 'cuda:0'}}
Original keys in state_dict: odict_keys(['b_dec', 'encoder.weight', 'encoder.bias', 'decoder.weight'])
Renamed keys in state_dict: dict_keys(['b_dec', 'W_enc', 'b_enc', 'W_dec'])
Evaluations:   0%|          | 0/1 [00:00<?, ?it/s]


Running sparse_probing evaluation




Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s][A
Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:01,  1.56it/s][A
Loading checkpoint shards:  67%|██████▋   | 2/3 [00:01<00:00,  1.62it/s][A
Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.35it/s][ALoading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.08it/s]
Loaded pretrained model gemma-2-2b into HookedTransformer

Running SAE evaluation on all selected SAEs:   0%|          | 0/1 [00:00<?, ?it/s][A

  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 640.59it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 936.17it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 12.62it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 12.92it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 12.79it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 49.07it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 48.78it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 25.94it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 22.92it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.47it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.49it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.10it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.83it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.62it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.44it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.35it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.30it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.24it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.22it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.09it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.51it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.31it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.30it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.84it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.58it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.43it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.32it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.26it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.20it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.07it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.22it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.31it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.28it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.82it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.57it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.40it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.22it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.18it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.28it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.23it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.79it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.53it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.37it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.27it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.15it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.15it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.21it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.18it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.73it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.47it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.30it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.12it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.08it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.93it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.08it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.08it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.13it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.69it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.42it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.45it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.32it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.85it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.51it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.32it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.10it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.06it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.33it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.36it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.86it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.50it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.31it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.19it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.09it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.05it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.33it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.39it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.88it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.52it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.32it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.19it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.11it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.06it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.34it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.35it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.81it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.47it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.28it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.06it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.02it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.30it/s]
Num non-zero elements: 2304
Test accuracy for 0: 0.925
Num non-zero elements: 2304
Test accuracy for 1: 0.943
Num non-zero elements: 2304
Test accuracy for 2: 0.947
Num non-zero elements: 2304
Test accuracy for 6: 0.991
Num non-zero elements: 2304
Test accuracy for 9: 0.971
Num non-zero elements: 1
Test accuracy for 0: 0.603
Num non-zero elements: 1
Test accuracy for 1: 0.648
Num non-zero elements: 1
Test accuracy for 2: 0.731
Num non-zero elements: 1
Test accuracy for 6: 0.773
Num non-zero elements: 1
Test accuracy for 9: 0.68
Num non-zero elements: 2
Test accuracy for 0: 0.682
Num non-zero elements: 2
Test accuracy for 1: 0.655
Num non-zero elements: 2
Test accuracy for 2: 0.744
Num non-zero elements: 2
Test accuracy for 6: 0.771
Num non-zero elements: 2
Test accuracy for 9: 0.772
Num non-zero elements: 5
Test accuracy for 0: 0.768
Num non-zero elements: 5
Test accuracy for 1: 0.69
Num non-zero elements: 5
Test accuracy for 2: 0.754
Num non-zero elements: 5
Test accuracy for 6: 0.905
Num non-zero elements: 5
Test accuracy for 9: 0.798
Num non-zero elements: 10
Test accuracy for 0: 0.797
Num non-zero elements: 10
Test accuracy for 1: 0.818
Num non-zero elements: 10
Test accuracy for 2: 0.83
Num non-zero elements: 10
Test accuracy for 6: 0.929
Num non-zero elements: 10
Test accuracy for 9: 0.912
Num non-zero elements: 20
Test accuracy for 0: 0.796
Num non-zero elements: 20
Test accuracy for 1: 0.867
Num non-zero elements: 20
Test accuracy for 2: 0.847
Num non-zero elements: 20
Test accuracy for 6: 0.96
Num non-zero elements: 20
Test accuracy for 9: 0.945
Num non-zero elements: 50
Test accuracy for 0: 0.862
Num non-zero elements: 50
Test accuracy for 1: 0.905
Num non-zero elements: 50
Test accuracy for 2: 0.897
Num non-zero elements: 50
Test accuracy for 6: 0.977
Num non-zero elements: 50
Test accuracy for 9: 0.948
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 12 epochs
Test accuracy for 0: 0.9340000152587891
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for 1: 0.9630000591278076
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 26 epochs
Test accuracy for 2: 0.9360000491142273
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 21 epochs
Test accuracy for 6: 0.987000048160553
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for 9: 0.968000054359436
Num non-zero elements: 1
Test accuracy for 0: 0.678
Num non-zero elements: 1
Test accuracy for 1: 0.655
Num non-zero elements: 1
Test accuracy for 2: 0.892
Num non-zero elements: 1
Test accuracy for 6: 0.972
Num non-zero elements: 1
Test accuracy for 9: 0.938
Num non-zero elements: 2
Test accuracy for 0: 0.706
Num non-zero elements: 2
Test accuracy for 1: 0.795
Num non-zero elements: 2
Test accuracy for 2: 0.908
Num non-zero elements: 2
Test accuracy for 6: 0.982
Num non-zero elements: 2
Test accuracy for 9: 0.931
Num non-zero elements: 5
Test accuracy for 0: 0.851
Num non-zero elements: 5
Test accuracy for 1: 0.835
Num non-zero elements: 5
Test accuracy for 2: 0.925
Num non-zero elements: 5
Test accuracy for 6: 0.987
Num non-zero elements: 5
Test accuracy for 9: 0.941
Num non-zero elements: 10
Test accuracy for 0: 0.893
Num non-zero elements: 10
Test accuracy for 1: 0.873
Num non-zero elements: 10
Test accuracy for 2: 0.917
Num non-zero elements: 10
Test accuracy for 6: 0.987
Num non-zero elements: 10
Test accuracy for 9: 0.941
Num non-zero elements: 20
Test accuracy for 0: 0.892
Num non-zero elements: 20
Test accuracy for 1: 0.927
Num non-zero elements: 20
Test accuracy for 2: 0.939
Num non-zero elements: 20
Test accuracy for 6: 0.988
Num non-zero elements: 20
Test accuracy for 9: 0.948
Num non-zero elements: 50
Test accuracy for 0: 0.94
Num non-zero elements: 50
Test accuracy for 1: 0.957
Num non-zero elements: 50
Test accuracy for 2: 0.946
Num non-zero elements: 50
Test accuracy for 6: 0.991
Num non-zero elements: 50
Test accuracy for 9: 0.966


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 591.33it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 929.79it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 12.46it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 12.37it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 12.34it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 46.65it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 45.09it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 26.37it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 22.96it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.52it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.53it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.14it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.86it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.66it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.49it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.39it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.32it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.28it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.25it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.22it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.21it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.16it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.15it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.15it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.15it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.15it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.15it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.13it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.12it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.13it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.12it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.18it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 29.55it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.30it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.62it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.55it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 19.01it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.77it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 15.53it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.89it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.09it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.34it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 22.11it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.57it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 19.02it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.70it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.51it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.38it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 16.23it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.57it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.44it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.35it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.28it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.23it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:01, 15.59it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.09it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.14it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 22.13it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:03, 17.86it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 18.97it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.69it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.51it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.38it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.22it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.18it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.77it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.41it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.89it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.60it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.41it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.28it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.20it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.13it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.90it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.15it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.17it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.48it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.90it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 13.75it/s][A[A

Collecting activations:  81%|████████▏ | 13/16 [00:00<00:00, 16.82it/s][A[A

Collecting activations:  94%|█████████▍| 15/16 [00:00<00:00, 17.13it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:01<00:00, 15.54it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 27.98it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 20.22it/s][A[A

Collecting activations:  56%|█████▋    | 9/16 [00:00<00:00, 20.35it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 19.32it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 16.77it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 19.17it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.09it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.45it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.88it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.55it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.35it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.21it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.12it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.49it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.98it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.73it/s][A[A

Collecting activations:  56%|█████▋    | 9/16 [00:00<00:00, 18.87it/s][A[A

Collecting activations:  69%|██████▉   | 11/16 [00:00<00:00, 18.58it/s][A[A

Collecting activations:  81%|████████▏ | 13/16 [00:00<00:00, 18.39it/s][A[A

Collecting activations:  94%|█████████▍| 15/16 [00:00<00:00, 18.25it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.72it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.06it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.10it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.65it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.40it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.24it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.09it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.37it/s]
Num non-zero elements: 2304
Test accuracy for 11: 0.945
Num non-zero elements: 2304
Test accuracy for 13: 0.939
Num non-zero elements: 2304
Test accuracy for 14: 0.94
Num non-zero elements: 2304
Test accuracy for 18: 0.926
Num non-zero elements: 2304
Test accuracy for 19: 0.95
Num non-zero elements: 1
Test accuracy for 11: 0.716
Num non-zero elements: 1
Test accuracy for 13: 0.711
Num non-zero elements: 1
Test accuracy for 14: 0.673
Num non-zero elements: 1
Test accuracy for 18: 0.71
Num non-zero elements: 1
Test accuracy for 19: 0.778
Num non-zero elements: 2
Test accuracy for 11: 0.79
Num non-zero elements: 2
Test accuracy for 13: 0.696
Num non-zero elements: 2
Test accuracy for 14: 0.681
Num non-zero elements: 2
Test accuracy for 18: 0.706
Num non-zero elements: 2
Test accuracy for 19: 0.787
Num non-zero elements: 5
Test accuracy for 11: 0.817
Num non-zero elements: 5
Test accuracy for 13: 0.792
Num non-zero elements: 5
Test accuracy for 14: 0.756
Num non-zero elements: 5
Test accuracy for 18: 0.723
Num non-zero elements: 5
Test accuracy for 19: 0.839
Num non-zero elements: 10
Test accuracy for 11: 0.855
Num non-zero elements: 10
Test accuracy for 13: 0.84
Num non-zero elements: 10
Test accuracy for 14: 0.783
Num non-zero elements: 10
Test accuracy for 18: 0.756
Num non-zero elements: 10
Test accuracy for 19: 0.841
Num non-zero elements: 20
Test accuracy for 11: 0.9
Num non-zero elements: 20
Test accuracy for 13: 0.881
Num non-zero elements: 20
Test accuracy for 14: 0.853
Num non-zero elements: 20
Test accuracy for 18: 0.755
Num non-zero elements: 20
Test accuracy for 19: 0.913
Num non-zero elements: 50
Test accuracy for 11: 0.927
Num non-zero elements: 50
Test accuracy for 13: 0.892
Num non-zero elements: 50
Test accuracy for 14: 0.897
Num non-zero elements: 50
Test accuracy for 18: 0.81
Num non-zero elements: 50
Test accuracy for 19: 0.933
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for 11: 0.9510000348091125
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 26 epochs
Test accuracy for 13: 0.9360000491142273
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for 14: 0.9470000267028809
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for 18: 0.9170000553131104
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 23 epochs
Test accuracy for 19: 0.9660000205039978
Num non-zero elements: 1
Test accuracy for 11: 0.739
Num non-zero elements: 1
Test accuracy for 13: 0.754
Num non-zero elements: 1
Test accuracy for 14: 0.916
Num non-zero elements: 1
Test accuracy for 18: 0.726
Num non-zero elements: 1
Test accuracy for 19: 0.862
Num non-zero elements: 2
Test accuracy for 11: 0.843
Num non-zero elements: 2
Test accuracy for 13: 0.753
Num non-zero elements: 2
Test accuracy for 14: 0.923
Num non-zero elements: 2
Test accuracy for 18: 0.892
Num non-zero elements: 2
Test accuracy for 19: 0.869
Num non-zero elements: 5
Test accuracy for 11: 0.928
Num non-zero elements: 5
Test accuracy for 13: 0.766
Num non-zero elements: 5
Test accuracy for 14: 0.913
Num non-zero elements: 5
Test accuracy for 18: 0.898
Num non-zero elements: 5
Test accuracy for 19: 0.879
Num non-zero elements: 10
Test accuracy for 11: 0.923
Num non-zero elements: 10
Test accuracy for 13: 0.891
Num non-zero elements: 10
Test accuracy for 14: 0.93
Num non-zero elements: 10
Test accuracy for 18: 0.899
Num non-zero elements: 10
Test accuracy for 19: 0.885
Num non-zero elements: 20
Test accuracy for 11: 0.937
Num non-zero elements: 20
Test accuracy for 13: 0.932
Num non-zero elements: 20
Test accuracy for 14: 0.934
Num non-zero elements: 20
Test accuracy for 18: 0.903
Num non-zero elements: 20
Test accuracy for 19: 0.917
Num non-zero elements: 50
Test accuracy for 11: 0.957
Num non-zero elements: 50
Test accuracy for 13: 0.953
Num non-zero elements: 50
Test accuracy for 14: 0.946
Num non-zero elements: 50
Test accuracy for 18: 0.903
Num non-zero elements: 50
Test accuracy for 19: 0.932


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 568.77it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 904.87it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00,  6.07it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00,  8.68it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00,  8.75it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 48.60it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 46.66it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 26.66it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 22.86it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.43it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.37it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.10it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.80it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.60it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.42it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.32it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.25it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.21it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 14.59it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 17.27it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 17.49it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 17.65it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 13.31it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:01, 16.07it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 16.55it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 16.93it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.23it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:03<00:00, 17.46it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.63it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.75it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.83it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 15.58it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.59it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 24.80it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 20.31it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 19.20it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.83it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.58it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.41it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.20it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:01, 14.81it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.45it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.59it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.67it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.80it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.86it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.89it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.92it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.93it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.05it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 28.38it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.19it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.50it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.43it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:03, 16.27it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.50it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:00<00:02, 18.36it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.25it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.95it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.25it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 22.92it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.70it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 19.02it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.62it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.40it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.08it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.94it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 16.11it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.40it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.26it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.17it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.95it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.10it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.95it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.04it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:03, 14.34it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:03, 17.32it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 17.49it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 17.60it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 17.68it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 17.74it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 17.78it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 17.82it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 17.84it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:02, 17.86it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 17.88it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 17.87it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 17.88it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 17.87it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 17.88it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 17.88it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 17.87it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 17.88it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:01, 17.87it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 17.85it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 17.89it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 17.88it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.87it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.89it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.90it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.76it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.70it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.43it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.83it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.49it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.27it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.14it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 14.72it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 16.89it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 28.56it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 22.03it/s][A[A

Collecting activations:  56%|█████▋    | 9/16 [00:00<00:00, 19.91it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 19.04it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.69it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.45it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 19.33it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.59it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 17.58it/s][A[A

Collecting activations:  56%|█████▋    | 9/16 [00:00<00:00, 18.64it/s][A[A

Collecting activations:  69%|██████▉   | 11/16 [00:00<00:00, 18.39it/s][A[A

Collecting activations:  81%|████████▏ | 13/16 [00:00<00:00, 18.21it/s][A[A

Collecting activations:  94%|█████████▍| 15/16 [00:00<00:00, 18.09it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.35it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.22it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.06it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.59it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.32it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.14it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.03it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.98it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.36it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.39it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.13it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.63it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.34it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.17it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.06it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.39it/s]
Num non-zero elements: 2304
Test accuracy for 20: 0.941
Num non-zero elements: 2304
Test accuracy for 21: 0.91
Num non-zero elements: 2304
Test accuracy for 22: 0.899
Num non-zero elements: 2304
Test accuracy for 25: 0.95
Num non-zero elements: 2304
Test accuracy for 26: 0.859
Num non-zero elements: 1
Test accuracy for 20: 0.75
Num non-zero elements: 1
Test accuracy for 21: 0.629
Num non-zero elements: 1
Test accuracy for 22: 0.615
Num non-zero elements: 1
Test accuracy for 25: 0.708
Num non-zero elements: 1
Test accuracy for 26: 0.647
Num non-zero elements: 2
Test accuracy for 20: 0.809
Num non-zero elements: 2
Test accuracy for 21: 0.728
Num non-zero elements: 2
Test accuracy for 22: 0.605
Num non-zero elements: 2
Test accuracy for 25: 0.722
Num non-zero elements: 2
Test accuracy for 26: 0.643
Num non-zero elements: 5
Test accuracy for 20: 0.844
Num non-zero elements: 5
Test accuracy for 21: 0.776
Num non-zero elements: 5
Test accuracy for 22: 0.732
Num non-zero elements: 5
Test accuracy for 25: 0.792
Num non-zero elements: 5
Test accuracy for 26: 0.68
Num non-zero elements: 10
Test accuracy for 20: 0.885
Num non-zero elements: 10
Test accuracy for 21: 0.813
Num non-zero elements: 10
Test accuracy for 22: 0.749
Num non-zero elements: 10
Test accuracy for 25: 0.866
Num non-zero elements: 10
Test accuracy for 26: 0.724
Num non-zero elements: 20
Test accuracy for 20: 0.889
Num non-zero elements: 20
Test accuracy for 21: 0.856
Num non-zero elements: 20
Test accuracy for 22: 0.781
Num non-zero elements: 20
Test accuracy for 25: 0.903
Num non-zero elements: 20
Test accuracy for 26: 0.766
Num non-zero elements: 50
Test accuracy for 20: 0.904
Num non-zero elements: 50
Test accuracy for 21: 0.865
Num non-zero elements: 50
Test accuracy for 22: 0.852
Num non-zero elements: 50
Test accuracy for 25: 0.917
Num non-zero elements: 50
Test accuracy for 26: 0.829
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for 20: 0.9440000653266907
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 14 epochs
Test accuracy for 21: 0.9170000553131104
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for 22: 0.9010000228881836
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 14 epochs
Test accuracy for 25: 0.9460000395774841
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for 26: 0.8920000195503235
Num non-zero elements: 1
Test accuracy for 20: 0.899
Num non-zero elements: 1
Test accuracy for 21: 0.75
Num non-zero elements: 1
Test accuracy for 22: 0.814
Num non-zero elements: 1
Test accuracy for 25: 0.855
Num non-zero elements: 1
Test accuracy for 26: 0.716
Num non-zero elements: 2
Test accuracy for 20: 0.9
Num non-zero elements: 2
Test accuracy for 21: 0.755
Num non-zero elements: 2
Test accuracy for 22: 0.873
Num non-zero elements: 2
Test accuracy for 25: 0.882
Num non-zero elements: 2
Test accuracy for 26: 0.748
Num non-zero elements: 5
Test accuracy for 20: 0.908
Num non-zero elements: 5
Test accuracy for 21: 0.79
Num non-zero elements: 5
Test accuracy for 22: 0.873
Num non-zero elements: 5
Test accuracy for 25: 0.895
Num non-zero elements: 5
Test accuracy for 26: 0.81
Num non-zero elements: 10
Test accuracy for 20: 0.919
Num non-zero elements: 10
Test accuracy for 21: 0.834
Num non-zero elements: 10
Test accuracy for 22: 0.878
Num non-zero elements: 10
Test accuracy for 25: 0.919
Num non-zero elements: 10
Test accuracy for 26: 0.832
Num non-zero elements: 20
Test accuracy for 20: 0.921
Num non-zero elements: 20
Test accuracy for 21: 0.865
Num non-zero elements: 20
Test accuracy for 22: 0.872
Num non-zero elements: 20
Test accuracy for 25: 0.945
Num non-zero elements: 20
Test accuracy for 26: 0.857
Num non-zero elements: 50
Test accuracy for 20: 0.942
Num non-zero elements: 50
Test accuracy for 21: 0.869
Num non-zero elements: 50
Test accuracy for 22: 0.895
Num non-zero elements: 50
Test accuracy for 25: 0.944
Num non-zero elements: 50
Test accuracy for 26: 0.862


  0%|          | 0/34 [00:00<?, ?it/s][A[A100%|██████████| 34/34 [00:00<00:00, 402.63it/s]


  0%|          | 0/31 [00:00<?, ?it/s][A[A100%|██████████| 31/31 [00:00<00:00, 877.11it/s]
Removing 31 from train set
Removing 0 from train set
Removing 29 from train set
Removing 28 from train set
Removing 7 from train set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  20%|██        | 1/5 [00:00<00:00,  9.84it/s][A[A

Tokenizing data:  60%|██████    | 3/5 [00:00<00:00, 10.10it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 10.08it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 10.05it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 37.20it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 37.71it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.12it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.15it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.55it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.51it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.10it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.80it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.60it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.42it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.32it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.25it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.20it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.07it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.49it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.08it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.21it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.79it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.52it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.37it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.27it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.17it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.05it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.18it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.06it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.15it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.74it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.50it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.35it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.13it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.14it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.98it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.12it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.69it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.46it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.30it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.13it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.08it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.93it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.08it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.89it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.05it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.63it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.38it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.22it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.13it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.07it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.03it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.95it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.95it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.92it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.90it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.91it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.91it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.91it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.04it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.87it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.99it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.57it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.31it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.17it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.02it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.35it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.26it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.77it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.44it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.24it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.04it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.26it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.34it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.80it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.45it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.25it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.03it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.28it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.27it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.76it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.42it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.23it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.11it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.02it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.25it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.29it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.78it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.43it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.23it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.10it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.01it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.97it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.25it/s]
Num non-zero elements: 2304
Test accuracy for 1: 0.921
Num non-zero elements: 2304
Test accuracy for 2: 0.899
Num non-zero elements: 2304
Test accuracy for 3: 0.88
Num non-zero elements: 2304
Test accuracy for 5: 0.897
Num non-zero elements: 2304
Test accuracy for 6: 0.841
Num non-zero elements: 1
Test accuracy for 1: 0.701
Num non-zero elements: 1
Test accuracy for 2: 0.694
Num non-zero elements: 1
Test accuracy for 3: 0.589
Num non-zero elements: 1
Test accuracy for 5: 0.678
Num non-zero elements: 1
Test accuracy for 6: 0.558
Num non-zero elements: 2
Test accuracy for 1: 0.702
Num non-zero elements: 2
Test accuracy for 2: 0.778
Num non-zero elements: 2
Test accuracy for 3: 0.609
Num non-zero elements: 2
Test accuracy for 5: 0.683
Num non-zero elements: 2
Test accuracy for 6: 0.631
Num non-zero elements: 5
Test accuracy for 1: 0.779
Num non-zero elements: 5
Test accuracy for 2: 0.816
Num non-zero elements: 5
Test accuracy for 3: 0.631
Num non-zero elements: 5
Test accuracy for 5: 0.71
Num non-zero elements: 5
Test accuracy for 6: 0.704
Num non-zero elements: 10
Test accuracy for 1: 0.835
Num non-zero elements: 10
Test accuracy for 2: 0.81
Num non-zero elements: 10
Test accuracy for 3: 0.743
Num non-zero elements: 10
Test accuracy for 5: 0.738
Num non-zero elements: 10
Test accuracy for 6: 0.725
Num non-zero elements: 20
Test accuracy for 1: 0.85
Num non-zero elements: 20
Test accuracy for 2: 0.833
Num non-zero elements: 20
Test accuracy for 3: 0.797
Num non-zero elements: 20
Test accuracy for 5: 0.774
Num non-zero elements: 20
Test accuracy for 6: 0.745
Num non-zero elements: 50
Test accuracy for 1: 0.878
Num non-zero elements: 50
Test accuracy for 2: 0.858
Num non-zero elements: 50
Test accuracy for 3: 0.839
Num non-zero elements: 50
Test accuracy for 5: 0.818
Num non-zero elements: 50
Test accuracy for 6: 0.796
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 14 epochs
Test accuracy for 1: 0.9240000247955322
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 17 epochs
Test accuracy for 2: 0.9240000247955322
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 29 epochs
Test accuracy for 3: 0.906000018119812
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for 5: 0.9140000343322754
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 20 epochs
Test accuracy for 6: 0.8420000672340393
Num non-zero elements: 1
Test accuracy for 1: 0.807
Num non-zero elements: 1
Test accuracy for 2: 0.793
Num non-zero elements: 1
Test accuracy for 3: 0.574
Num non-zero elements: 1
Test accuracy for 5: 0.795
Num non-zero elements: 1
Test accuracy for 6: 0.604
Num non-zero elements: 2
Test accuracy for 1: 0.845
Num non-zero elements: 2
Test accuracy for 2: 0.83
Num non-zero elements: 2
Test accuracy for 3: 0.712
Num non-zero elements: 2
Test accuracy for 5: 0.855
Num non-zero elements: 2
Test accuracy for 6: 0.714
Num non-zero elements: 5
Test accuracy for 1: 0.873
Num non-zero elements: 5
Test accuracy for 2: 0.863
Num non-zero elements: 5
Test accuracy for 3: 0.796
Num non-zero elements: 5
Test accuracy for 5: 0.871
Num non-zero elements: 5
Test accuracy for 6: 0.756
Num non-zero elements: 10
Test accuracy for 1: 0.902
Num non-zero elements: 10
Test accuracy for 2: 0.867
Num non-zero elements: 10
Test accuracy for 3: 0.846
Num non-zero elements: 10
Test accuracy for 5: 0.879
Num non-zero elements: 10
Test accuracy for 6: 0.761
Num non-zero elements: 20
Test accuracy for 1: 0.917
Num non-zero elements: 20
Test accuracy for 2: 0.884
Num non-zero elements: 20
Test accuracy for 3: 0.861
Num non-zero elements: 20
Test accuracy for 5: 0.886
Num non-zero elements: 20
Test accuracy for 6: 0.786
Num non-zero elements: 50
Test accuracy for 1: 0.93
Num non-zero elements: 50
Test accuracy for 2: 0.902
Num non-zero elements: 50
Test accuracy for 3: 0.881
Num non-zero elements: 50
Test accuracy for 5: 0.895
Num non-zero elements: 50
Test accuracy for 6: 0.825


Tokenizing data:   0%|          | 0/2 [00:00<?, ?it/s][A[A

Tokenizing data:  50%|█████     | 1/2 [00:00<00:00,  9.88it/s][A[ATokenizing data: 100%|██████████| 2/2 [00:00<00:00, 10.04it/s]


Tokenizing data:   0%|          | 0/2 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 2/2 [00:00<00:00, 38.89it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.45it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.05it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.49it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.48it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.09it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.96it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:00<00:02, 18.00it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.65it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.51it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.39it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.30it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.24it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.23it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.07it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.48it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.86it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.46it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.92it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.62it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.43it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.23it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.17it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.18it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.00it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.13it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.72it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.48it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.33it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.23it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.17it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.50it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.59it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.98it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.60it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.39it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.17it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.13it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.39it/s]
Num non-zero elements: 2304
Test accuracy for 1.0: 0.902
Num non-zero elements: 2304
Test accuracy for 5.0: 0.904
Num non-zero elements: 1
Test accuracy for 1.0: 0.631
Num non-zero elements: 1
Test accuracy for 5.0: 0.631
Num non-zero elements: 2
Test accuracy for 1.0: 0.654
Num non-zero elements: 2
Test accuracy for 5.0: 0.654
Num non-zero elements: 5
Test accuracy for 1.0: 0.669
Num non-zero elements: 5
Test accuracy for 5.0: 0.669
Num non-zero elements: 10
Test accuracy for 1.0: 0.764
Num non-zero elements: 10
Test accuracy for 5.0: 0.764
Num non-zero elements: 20
Test accuracy for 1.0: 0.791
Num non-zero elements: 20
Test accuracy for 5.0: 0.792
Num non-zero elements: 50
Test accuracy for 1.0: 0.827
Num non-zero elements: 50
Test accuracy for 5.0: 0.828
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 27 epochs
Test accuracy for 1.0: 0.9000000357627869
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 24 epochs
Test accuracy for 5.0: 0.9010000228881836
Num non-zero elements: 1
Test accuracy for 1.0: 0.64
Num non-zero elements: 1
Test accuracy for 5.0: 0.64
Num non-zero elements: 2
Test accuracy for 1.0: 0.772
Num non-zero elements: 2
Test accuracy for 5.0: 0.772
Num non-zero elements: 5
Test accuracy for 1.0: 0.825
Num non-zero elements: 5
Test accuracy for 5.0: 0.825
Num non-zero elements: 10
Test accuracy for 1.0: 0.872
Num non-zero elements: 10
Test accuracy for 5.0: 0.872
Num non-zero elements: 20
Test accuracy for 1.0: 0.889
Num non-zero elements: 20
Test accuracy for 5.0: 0.889
Num non-zero elements: 50
Test accuracy for 1.0: 0.904
Num non-zero elements: 50
Test accuracy for 5.0: 0.904
Loading dataset codeparrot/github-code, this usually takes ~30 seconds


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  20%|██        | 1/5 [00:01<00:07,  1.90s/it][A[A

Tokenizing data:  40%|████      | 2/5 [00:02<00:04,  1.37s/it][A[A

Tokenizing data:  60%|██████    | 3/5 [00:04<00:02,  1.30s/it][A[A

Tokenizing data:  80%|████████  | 4/5 [00:04<00:00,  1.02it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:05<00:00,  1.17it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:05<00:00,  1.05s/it]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  20%|██        | 1/5 [00:00<00:02,  1.90it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00,  3.21it/s][A[A

Tokenizing data:  60%|██████    | 3/5 [00:01<00:00,  3.19it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:01<00:00,  3.93it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:01<00:00,  4.37it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:01<00:00,  3.70it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.44it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.08it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.49it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.45it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.06it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.76it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.53it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.37it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.26it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.19it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.98it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.43it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.99it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.10it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.68it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.43it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.28it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.10it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.05it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.93it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.07it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.88it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.03it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.61it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.37it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.22it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.13it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.06it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.01it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.95it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.93it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.89it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.89it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.88it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.89it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.03it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.85it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.01it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.60it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.34it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.08it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.01it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 17.97it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.93it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.92it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.90it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.91it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.89it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.88it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.88it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.88it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.88it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.86it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.87it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.87it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.86it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.86it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.85it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.84it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.85it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.84it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.83it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.82it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.98it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.22it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.08it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.61it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.34it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:03, 16.96it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.34it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 17.95it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 17.90it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:02, 17.87it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 17.84it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 17.83it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 17.83it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 17.82it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 17.82it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 17.81it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 17.81it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 17.81it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:01, 17.81it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 17.81it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 17.80it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 17.80it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 17.80it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 17.80it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 17.80it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.80it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.80it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.81it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.94it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.86it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.93it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.50it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.24it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.09it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.99it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.93it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.28it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.19it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.71it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.36it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.03it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.94it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.91it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.18it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.22it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.72it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.37it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.02it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.92it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.90it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.17it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.21it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.71it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.35it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.14it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.02it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.93it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.89it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.92it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.94it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.27it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.71it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.37it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.03it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.96it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.41it/s]
Num non-zero elements: 2304
Test accuracy for C: 0.956
Num non-zero elements: 2304
Test accuracy for Python: 0.984
Num non-zero elements: 2304
Test accuracy for HTML: 0.981
Num non-zero elements: 2304
Test accuracy for Java: 0.963
Num non-zero elements: 2304
Test accuracy for PHP: 0.958
Num non-zero elements: 1
Test accuracy for C: 0.607
Num non-zero elements: 1
Test accuracy for Python: 0.627
Num non-zero elements: 1
Test accuracy for HTML: 0.725
Num non-zero elements: 1
Test accuracy for Java: 0.614
Num non-zero elements: 1
Test accuracy for PHP: 0.578
Num non-zero elements: 2
Test accuracy for C: 0.738
Num non-zero elements: 2
Test accuracy for Python: 0.688
Num non-zero elements: 2
Test accuracy for HTML: 0.937
Num non-zero elements: 2
Test accuracy for Java: 0.626
Num non-zero elements: 2
Test accuracy for PHP: 0.65
Num non-zero elements: 5
Test accuracy for C: 0.823
Num non-zero elements: 5
Test accuracy for Python: 0.755
Num non-zero elements: 5
Test accuracy for HTML: 0.953
Num non-zero elements: 5
Test accuracy for Java: 0.793
Num non-zero elements: 5
Test accuracy for PHP: 0.725
Num non-zero elements: 10
Test accuracy for C: 0.838
Num non-zero elements: 10
Test accuracy for Python: 0.866
Num non-zero elements: 10
Test accuracy for HTML: 0.953
Num non-zero elements: 10
Test accuracy for Java: 0.844
Num non-zero elements: 10
Test accuracy for PHP: 0.804
Num non-zero elements: 20
Test accuracy for C: 0.864
Num non-zero elements: 20
Test accuracy for Python: 0.917
Num non-zero elements: 20
Test accuracy for HTML: 0.955
Num non-zero elements: 20
Test accuracy for Java: 0.876
Num non-zero elements: 20
Test accuracy for PHP: 0.847
Num non-zero elements: 50
Test accuracy for C: 0.919
Num non-zero elements: 50
Test accuracy for Python: 0.965
Num non-zero elements: 50
Test accuracy for HTML: 0.968
Num non-zero elements: 50
Test accuracy for Java: 0.909
Num non-zero elements: 50
Test accuracy for PHP: 0.892
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 34 epochs
Test accuracy for C: 0.9570000171661377
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 34 epochs
Test accuracy for Python: 0.9880000352859497
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 22 epochs
Test accuracy for HTML: 0.984000027179718
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 24 epochs
Test accuracy for Java: 0.9600000381469727
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for PHP: 0.9510000348091125
Num non-zero elements: 1
Test accuracy for C: 0.744
Num non-zero elements: 1
Test accuracy for Python: 0.913
Num non-zero elements: 1
Test accuracy for HTML: 0.893
Num non-zero elements: 1
Test accuracy for Java: 0.72
Num non-zero elements: 1
Test accuracy for PHP: 0.906
Num non-zero elements: 2
Test accuracy for C: 0.823
Num non-zero elements: 2
Test accuracy for Python: 0.913
Num non-zero elements: 2
Test accuracy for HTML: 0.936
Num non-zero elements: 2
Test accuracy for Java: 0.724
Num non-zero elements: 2
Test accuracy for PHP: 0.906
Num non-zero elements: 5
Test accuracy for C: 0.885
Num non-zero elements: 5
Test accuracy for Python: 0.963
Num non-zero elements: 5
Test accuracy for HTML: 0.948
Num non-zero elements: 5
Test accuracy for Java: 0.819
Num non-zero elements: 5
Test accuracy for PHP: 0.91
Num non-zero elements: 10
Test accuracy for C: 0.888
Num non-zero elements: 10
Test accuracy for Python: 0.977
Num non-zero elements: 10
Test accuracy for HTML: 0.955
Num non-zero elements: 10
Test accuracy for Java: 0.919
Num non-zero elements: 10
Test accuracy for PHP: 0.918
Num non-zero elements: 20
Test accuracy for C: 0.912
Num non-zero elements: 20
Test accuracy for Python: 0.978
Num non-zero elements: 20
Test accuracy for HTML: 0.951
Num non-zero elements: 20
Test accuracy for Java: 0.94
Num non-zero elements: 20
Test accuracy for PHP: 0.913
Num non-zero elements: 50
Test accuracy for C: 0.94
Num non-zero elements: 50
Test accuracy for Python: 0.986
Num non-zero elements: 50
Test accuracy for HTML: 0.972
Num non-zero elements: 50
Test accuracy for Java: 0.95
Num non-zero elements: 50
Test accuracy for PHP: 0.932


Tokenizing data:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Tokenizing data:  50%|█████     | 2/4 [00:00<00:00, 14.11it/s][A[A

Tokenizing data: 100%|██████████| 4/4 [00:00<00:00, 14.22it/s][A[ATokenizing data: 100%|██████████| 4/4 [00:00<00:00, 14.17it/s]


Tokenizing data:   0%|          | 0/4 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 4/4 [00:00<00:00, 52.56it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 26.33it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.27it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.69it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.66it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.25it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.96it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.75it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.58it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.46it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.39it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.34it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.31it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.28it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.27it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.26it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.25it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.24it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.22it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.19it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.20it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.21it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.22it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.21it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.21it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.22it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:02<00:00, 18.22it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.20it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.19it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.18it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.63it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.30it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.36it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.93it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.67it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.52it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.41it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.33it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.28it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.25it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.22it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.21it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.20it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.16it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.16it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.16it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.17it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.17it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.17it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.15it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.15it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.15it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.15it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.15it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.30it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.18it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.30it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.88it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.62it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.47it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.37it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.30it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.26it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.22it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.21it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.19it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.19it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.15it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.14it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.15it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.15it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.14it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.13it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.14it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.13it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.27it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.15it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.28it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.84it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.60it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.45it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.34it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.19it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.19it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.12it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.11it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.11it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.25it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.11it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.23it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.81it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.58it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.42it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.31it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.26it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.60it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.50it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.00it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.65it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.46it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.35it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.22it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.49it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.51it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.99it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.64it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.44it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.32it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.24it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.19it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.47it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.46it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.95it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.60it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.40it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.28it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.20it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.16it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.43it/s]
Num non-zero elements: 2304
Test accuracy for 0: 0.924
Num non-zero elements: 2304
Test accuracy for 1: 0.988
Num non-zero elements: 2304
Test accuracy for 2: 0.899
Num non-zero elements: 2304
Test accuracy for 3: 0.919
Num non-zero elements: 1
Test accuracy for 0: 0.762
Num non-zero elements: 1
Test accuracy for 1: 0.682
Num non-zero elements: 1
Test accuracy for 2: 0.646
Num non-zero elements: 1
Test accuracy for 3: 0.788
Num non-zero elements: 2
Test accuracy for 0: 0.781
Num non-zero elements: 2
Test accuracy for 1: 0.798
Num non-zero elements: 2
Test accuracy for 2: 0.697
Num non-zero elements: 2
Test accuracy for 3: 0.803
Num non-zero elements: 5
Test accuracy for 0: 0.864
Num non-zero elements: 5
Test accuracy for 1: 0.873
Num non-zero elements: 5
Test accuracy for 2: 0.78
Num non-zero elements: 5
Test accuracy for 3: 0.841
Num non-zero elements: 10
Test accuracy for 0: 0.876
Num non-zero elements: 10
Test accuracy for 1: 0.939
Num non-zero elements: 10
Test accuracy for 2: 0.804
Num non-zero elements: 10
Test accuracy for 3: 0.848
Num non-zero elements: 20
Test accuracy for 0: 0.906
Num non-zero elements: 20
Test accuracy for 1: 0.957
Num non-zero elements: 20
Test accuracy for 2: 0.868
Num non-zero elements: 20
Test accuracy for 3: 0.896
Num non-zero elements: 50
Test accuracy for 0: 0.909
Num non-zero elements: 50
Test accuracy for 1: 0.967
Num non-zero elements: 50
Test accuracy for 2: 0.885
Num non-zero elements: 50
Test accuracy for 3: 0.911
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for 0: 0.937000036239624
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 14 epochs
Test accuracy for 1: 0.9780000448226929
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for 2: 0.9350000619888306
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 17 epochs
Test accuracy for 3: 0.9380000233650208
Num non-zero elements: 1
Test accuracy for 0: 0.786
Num non-zero elements: 1
Test accuracy for 1: 0.952
Num non-zero elements: 1
Test accuracy for 2: 0.788
Num non-zero elements: 1
Test accuracy for 3: 0.726
Num non-zero elements: 2
Test accuracy for 0: 0.787
Num non-zero elements: 2
Test accuracy for 1: 0.949
Num non-zero elements: 2
Test accuracy for 2: 0.822
Num non-zero elements: 2
Test accuracy for 3: 0.797
Num non-zero elements: 5
Test accuracy for 0: 0.87
Num non-zero elements: 5
Test accuracy for 1: 0.954
Num non-zero elements: 5
Test accuracy for 2: 0.841
Num non-zero elements: 5
Test accuracy for 3: 0.828
Num non-zero elements: 10
Test accuracy for 0: 0.886
Num non-zero elements: 10
Test accuracy for 1: 0.957
Num non-zero elements: 10
Test accuracy for 2: 0.845
Num non-zero elements: 10
Test accuracy for 3: 0.891
Num non-zero elements: 20
Test accuracy for 0: 0.907
Num non-zero elements: 20
Test accuracy for 1: 0.973
Num non-zero elements: 20
Test accuracy for 2: 0.857
Num non-zero elements: 20
Test accuracy for 3: 0.908
Num non-zero elements: 50
Test accuracy for 0: 0.92
Num non-zero elements: 50
Test accuracy for 1: 0.977
Num non-zero elements: 50
Test accuracy for 2: 0.883
Num non-zero elements: 50
Test accuracy for 3: 0.923
Loading dataset Helsinki-NLP/europarl, this usually takes ~10 seconds


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 14.84it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 14.75it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00,  9.75it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 54.23it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.59it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.25it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.63it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.59it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.19it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.90it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.69it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.50it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.40it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.33it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.28it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.26it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.23it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.21it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.20it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.18it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.17it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.16it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 14.95it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 17.60it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 17.74it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 17.86it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.11it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.36it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 22.89it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.84it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 19.03it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.76it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.57it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.41it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.33it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.26it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.22it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.19it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 15.57it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 14.64it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.30it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.52it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.69it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.96it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.34it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.31it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.88it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.55it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.38it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.18it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.20it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.31it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.26it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.78it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.54it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.38it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:03, 15.36it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.02it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 17.47it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 17.51it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 18.18it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.14it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.06it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.03it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.77it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.32it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.83it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.55it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.37it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.26it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.12it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.96it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.13it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.72it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.35it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.83it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.52it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.32it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.20it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.14it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.49it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.10it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.45it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.89it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.56it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.36it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.21it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.13it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.51it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.54it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.54it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.93it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.57it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.35it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.21it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.12it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.53it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.68it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.60it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.95it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.59it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.36it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.22it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.14it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.65it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.05it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.38it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.82it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.49it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.28it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.54it/s]
Num non-zero elements: 2304
Test accuracy for en: 0.999
Num non-zero elements: 2304
Test accuracy for fr: 1.0
Num non-zero elements: 2304
Test accuracy for de: 1.0
Num non-zero elements: 2304
Test accuracy for es: 0.999
Num non-zero elements: 2304
Test accuracy for nl: 1.0
Num non-zero elements: 1
Test accuracy for en: 0.936
Num non-zero elements: 1
Test accuracy for fr: 0.648
Num non-zero elements: 1
Test accuracy for de: 0.797
Num non-zero elements: 1
Test accuracy for es: 0.873
Num non-zero elements: 1
Test accuracy for nl: 0.853
Num non-zero elements: 2
Test accuracy for en: 0.972
Num non-zero elements: 2
Test accuracy for fr: 0.902
Num non-zero elements: 2
Test accuracy for de: 0.831
Num non-zero elements: 2
Test accuracy for es: 0.906
Num non-zero elements: 2
Test accuracy for nl: 0.894
Num non-zero elements: 5
Test accuracy for en: 0.992
Num non-zero elements: 5
Test accuracy for fr: 0.965
Num non-zero elements: 5
Test accuracy for de: 0.895
Num non-zero elements: 5
Test accuracy for es: 0.975
Num non-zero elements: 5
Test accuracy for nl: 0.956
Num non-zero elements: 10
Test accuracy for en: 0.996
Num non-zero elements: 10
Test accuracy for fr: 0.99
Num non-zero elements: 10
Test accuracy for de: 0.973
Num non-zero elements: 10
Test accuracy for es: 0.989
Num non-zero elements: 10
Test accuracy for nl: 0.973
Num non-zero elements: 20
Test accuracy for en: 0.998
Num non-zero elements: 20
Test accuracy for fr: 0.996
Num non-zero elements: 20
Test accuracy for de: 0.99
Num non-zero elements: 20
Test accuracy for es: 0.993
Num non-zero elements: 20
Test accuracy for nl: 0.981
Num non-zero elements: 50
Test accuracy for en: 0.997
Num non-zero elements: 50
Test accuracy for fr: 1.0
Num non-zero elements: 50
Test accuracy for de: 0.997
Num non-zero elements: 50
Test accuracy for es: 0.997
Num non-zero elements: 50
Test accuracy for nl: 0.997
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 11 epochs
Test accuracy for en: 0.9980000257492065
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 14 epochs
Test accuracy for fr: 1.0
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for de: 0.9980000257492065
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for es: 1.0
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 24 epochs
Test accuracy for nl: 0.999000072479248
Num non-zero elements: 1
Test accuracy for en: 0.999
Num non-zero elements: 1
Test accuracy for fr: 0.857
Num non-zero elements: 1
Test accuracy for de: 0.997
Num non-zero elements: 1
Test accuracy for es: 0.912
Num non-zero elements: 1
Test accuracy for nl: 0.904
Num non-zero elements: 2
Test accuracy for en: 0.997
Num non-zero elements: 2
Test accuracy for fr: 0.997
Num non-zero elements: 2
Test accuracy for de: 0.996
Num non-zero elements: 2
Test accuracy for es: 0.96
Num non-zero elements: 2
Test accuracy for nl: 0.997
Num non-zero elements: 5
Test accuracy for en: 0.998
Num non-zero elements: 5
Test accuracy for fr: 0.997
Num non-zero elements: 5
Test accuracy for de: 1.0
Num non-zero elements: 5
Test accuracy for es: 0.959
Num non-zero elements: 5
Test accuracy for nl: 0.998
Num non-zero elements: 10
Test accuracy for en: 1.0
Num non-zero elements: 10
Test accuracy for fr: 0.995
Num non-zero elements: 10
Test accuracy for de: 1.0
Num non-zero elements: 10
Test accuracy for es: 0.995
Num non-zero elements: 10
Test accuracy for nl: 0.999
Num non-zero elements: 20
Test accuracy for en: 1.0
Num non-zero elements: 20
Test accuracy for fr: 0.998
Num non-zero elements: 20
Test accuracy for de: 1.0
Num non-zero elements: 20
Test accuracy for es: 0.997
Num non-zero elements: 20
Test accuracy for nl: 1.0
Num non-zero elements: 50
Test accuracy for en: 0.997
Num non-zero elements: 50
Test accuracy for fr: 0.996
Num non-zero elements: 50
Test accuracy for de: 1.0
Num non-zero elements: 50
Test accuracy for es: 0.997
Num non-zero elements: 50
Test accuracy for nl: 0.999

Running SAE evaluation on all selected SAEs: 100%|██████████| 1/1 [16:33<00:00, 993.94s/it][ARunning SAE evaluation on all selected SAEs: 100%|██████████| 1/1 [16:33<00:00, 993.94s/it]
Evaluations: 100%|██████████| 1/1 [16:46<00:00, 1006.66s/it]Evaluations: 100%|██████████| 1/1 [16:46<00:00, 1006.66s/it]
/share/u/can/SAEBench/custom_saes/topk_sae.py:110: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  pt_params = t.load(path_to_params)
Loaded config: {'trainer': {'trainer_class': 'TrainerTopKAdditivity', 'dict_class': 'AutoEncoderTopK', 'lr': 0.000282842712474619, 'steps': 48828, 'seed': 0, 'activation_dim': 2304, 'dict_size': 8192, 'k': 50, 'auxk_alpha': 0.03125, 'additivity_coeff': 1.0, 'intersection_coeff': 0.0, 'device': 'cuda:0', 'layer': 4, 'lm_name': 'google/gemma-2-2b', 'wandb_name': 'TopKTrainer_Additivity-google/gemma-2-2b-resid_post_layer_4-add_coeff-1.0-inters_coeff-0.0', 'submodule_name': 'resid_post_layer_4'}, 'buffer': {'d_submodule': 2304, 'io': 'out', 'n_ctxs': 8192, 'ctx_len': 128, 'refresh_batch_size': 32, 'out_batch_size': 2048, 'device': 'cuda:0'}}
Original keys in state_dict: odict_keys(['b_dec', 'encoder.weight', 'encoder.bias', 'decoder.weight'])
Renamed keys in state_dict: dict_keys(['b_dec', 'W_enc', 'b_enc', 'W_dec'])
Evaluations:   0%|          | 0/1 [00:00<?, ?it/s]


Running sparse_probing evaluation




Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s][A
Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:01,  1.56it/s][A
Loading checkpoint shards:  67%|██████▋   | 2/3 [00:01<00:00,  1.62it/s][A
Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.35it/s][ALoading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.08it/s]
Loaded pretrained model gemma-2-2b into HookedTransformer

Running SAE evaluation on all selected SAEs:   0%|          | 0/1 [00:00<?, ?it/s][A

  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 626.37it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 1035.27it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 12.21it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 12.58it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 12.45it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 48.37it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 48.17it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 26.33it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.13it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.55it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.53it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.13it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.84it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.63it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.47it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.37it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.30it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.24it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.21it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.52it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.32it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.29it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.85it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.58it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.42it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.22it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.02it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.19it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.26it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.21it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.76it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.50it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.33it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.23it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.15it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.11it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.97it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.12it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.21it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.18it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.73it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.46it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.30it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.20it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.13it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.07it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.69it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.94it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.10it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.15it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.14it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.68it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.42it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.27it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.08it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.04it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.94it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.91it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.91it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.92it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.89it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.89it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.88it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.88it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.88it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.04it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.15it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.11it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.65it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.38it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.22it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.10it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.41it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.32it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.79it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.45it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.14it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.02it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.29it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.28it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.79it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.45it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.25it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.05it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.02it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.27it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.66it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.93it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.52it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.31it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.02it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.25it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.16it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.41it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.82it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.47it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.25it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.48it/s]
Num non-zero elements: 2304
Test accuracy for 0: 0.925
Num non-zero elements: 2304
Test accuracy for 1: 0.943
Num non-zero elements: 2304
Test accuracy for 2: 0.947
Num non-zero elements: 2304
Test accuracy for 6: 0.991
Num non-zero elements: 2304
Test accuracy for 9: 0.971
Num non-zero elements: 1
Test accuracy for 0: 0.603
Num non-zero elements: 1
Test accuracy for 1: 0.648
Num non-zero elements: 1
Test accuracy for 2: 0.731
Num non-zero elements: 1
Test accuracy for 6: 0.773
Num non-zero elements: 1
Test accuracy for 9: 0.68
Num non-zero elements: 2
Test accuracy for 0: 0.682
Num non-zero elements: 2
Test accuracy for 1: 0.655
Num non-zero elements: 2
Test accuracy for 2: 0.744
Num non-zero elements: 2
Test accuracy for 6: 0.771
Num non-zero elements: 2
Test accuracy for 9: 0.772
Num non-zero elements: 5
Test accuracy for 0: 0.768
Num non-zero elements: 5
Test accuracy for 1: 0.69
Num non-zero elements: 5
Test accuracy for 2: 0.754
Num non-zero elements: 5
Test accuracy for 6: 0.905
Num non-zero elements: 5
Test accuracy for 9: 0.798
Num non-zero elements: 10
Test accuracy for 0: 0.797
Num non-zero elements: 10
Test accuracy for 1: 0.818
Num non-zero elements: 10
Test accuracy for 2: 0.83
Num non-zero elements: 10
Test accuracy for 6: 0.929
Num non-zero elements: 10
Test accuracy for 9: 0.912
Num non-zero elements: 20
Test accuracy for 0: 0.796
Num non-zero elements: 20
Test accuracy for 1: 0.867
Num non-zero elements: 20
Test accuracy for 2: 0.847
Num non-zero elements: 20
Test accuracy for 6: 0.96
Num non-zero elements: 20
Test accuracy for 9: 0.945
Num non-zero elements: 50
Test accuracy for 0: 0.862
Num non-zero elements: 50
Test accuracy for 1: 0.905
Num non-zero elements: 50
Test accuracy for 2: 0.897
Num non-zero elements: 50
Test accuracy for 6: 0.977
Num non-zero elements: 50
Test accuracy for 9: 0.948
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 0: 0.940000057220459
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for 1: 0.9620000720024109
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for 2: 0.9330000281333923
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 14 epochs
Test accuracy for 6: 0.9830000400543213
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 26 epochs
Test accuracy for 9: 0.968000054359436
Num non-zero elements: 1
Test accuracy for 0: 0.656
Num non-zero elements: 1
Test accuracy for 1: 0.787
Num non-zero elements: 1
Test accuracy for 2: 0.9
Num non-zero elements: 1
Test accuracy for 6: 0.97
Num non-zero elements: 1
Test accuracy for 9: 0.938
Num non-zero elements: 2
Test accuracy for 0: 0.71
Num non-zero elements: 2
Test accuracy for 1: 0.807
Num non-zero elements: 2
Test accuracy for 2: 0.905
Num non-zero elements: 2
Test accuracy for 6: 0.967
Num non-zero elements: 2
Test accuracy for 9: 0.942
Num non-zero elements: 5
Test accuracy for 0: 0.793
Num non-zero elements: 5
Test accuracy for 1: 0.841
Num non-zero elements: 5
Test accuracy for 2: 0.911
Num non-zero elements: 5
Test accuracy for 6: 0.984
Num non-zero elements: 5
Test accuracy for 9: 0.94
Num non-zero elements: 10
Test accuracy for 0: 0.878
Num non-zero elements: 10
Test accuracy for 1: 0.906
Num non-zero elements: 10
Test accuracy for 2: 0.931
Num non-zero elements: 10
Test accuracy for 6: 0.984
Num non-zero elements: 10
Test accuracy for 9: 0.957
Num non-zero elements: 20
Test accuracy for 0: 0.931
Num non-zero elements: 20
Test accuracy for 1: 0.941
Num non-zero elements: 20
Test accuracy for 2: 0.931
Num non-zero elements: 20
Test accuracy for 6: 0.989
Num non-zero elements: 20
Test accuracy for 9: 0.969
Num non-zero elements: 50
Test accuracy for 0: 0.941
Num non-zero elements: 50
Test accuracy for 1: 0.962
Num non-zero elements: 50
Test accuracy for 2: 0.935
Num non-zero elements: 50
Test accuracy for 6: 0.987
Num non-zero elements: 50
Test accuracy for 9: 0.971


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 676.10it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 1077.87it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 13.37it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 13.25it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 13.35it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 50.68it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 28.61it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.19it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.57it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.55it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 19.01it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.78it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:00<00:02, 18.58it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.43it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.35it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.28it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.24it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.21it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.11it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.12it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.54it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.18it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.22it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.81it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.56it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.40it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.22it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.19it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.78it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.42it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.90it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.59it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.40it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.27it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.13it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.16it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.99it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.09it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.65it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.43it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.28it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.13it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.09it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.96it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.09it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.95it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.06it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.64it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.42it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.26it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.17it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.09it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.04it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.95it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.93it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.06it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.94it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.03it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.60it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.34it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.09it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.38it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.27it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.78it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.45it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.25it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.03it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.27it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.25it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.78it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.45it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.24it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.11it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.02it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.26it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.27it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.79it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.45it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.14it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.05it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.27it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.24it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.77it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.42it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.23it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.04it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.26it/s]
Num non-zero elements: 2304
Test accuracy for 11: 0.944
Num non-zero elements: 2304
Test accuracy for 13: 0.944
Num non-zero elements: 2304
Test accuracy for 14: 0.945
Num non-zero elements: 2304
Test accuracy for 18: 0.909
Num non-zero elements: 2304
Test accuracy for 19: 0.95
Num non-zero elements: 1
Test accuracy for 11: 0.713
Num non-zero elements: 1
Test accuracy for 13: 0.711
Num non-zero elements: 1
Test accuracy for 14: 0.648
Num non-zero elements: 1
Test accuracy for 18: 0.699
Num non-zero elements: 1
Test accuracy for 19: 0.775
Num non-zero elements: 2
Test accuracy for 11: 0.791
Num non-zero elements: 2
Test accuracy for 13: 0.711
Num non-zero elements: 2
Test accuracy for 14: 0.692
Num non-zero elements: 2
Test accuracy for 18: 0.71
Num non-zero elements: 2
Test accuracy for 19: 0.808
Num non-zero elements: 5
Test accuracy for 11: 0.822
Num non-zero elements: 5
Test accuracy for 13: 0.799
Num non-zero elements: 5
Test accuracy for 14: 0.771
Num non-zero elements: 5
Test accuracy for 18: 0.708
Num non-zero elements: 5
Test accuracy for 19: 0.84
Num non-zero elements: 10
Test accuracy for 11: 0.887
Num non-zero elements: 10
Test accuracy for 13: 0.842
Num non-zero elements: 10
Test accuracy for 14: 0.791
Num non-zero elements: 10
Test accuracy for 18: 0.74
Num non-zero elements: 10
Test accuracy for 19: 0.831
Num non-zero elements: 20
Test accuracy for 11: 0.895
Num non-zero elements: 20
Test accuracy for 13: 0.872
Num non-zero elements: 20
Test accuracy for 14: 0.875
Num non-zero elements: 20
Test accuracy for 18: 0.762
Num non-zero elements: 20
Test accuracy for 19: 0.916
Num non-zero elements: 50
Test accuracy for 11: 0.923
Num non-zero elements: 50
Test accuracy for 13: 0.894
Num non-zero elements: 50
Test accuracy for 14: 0.908
Num non-zero elements: 50
Test accuracy for 18: 0.823
Num non-zero elements: 50
Test accuracy for 19: 0.925
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 14 epochs
Test accuracy for 11: 0.9430000185966492
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 17 epochs
Test accuracy for 13: 0.9460000395774841
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 24 epochs
Test accuracy for 14: 0.9440000653266907
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 18: 0.9040000438690186
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for 19: 0.9550000429153442
Num non-zero elements: 1
Test accuracy for 11: 0.737
Num non-zero elements: 1
Test accuracy for 13: 0.748
Num non-zero elements: 1
Test accuracy for 14: 0.885
Num non-zero elements: 1
Test accuracy for 18: 0.721
Num non-zero elements: 1
Test accuracy for 19: 0.866
Num non-zero elements: 2
Test accuracy for 11: 0.89
Num non-zero elements: 2
Test accuracy for 13: 0.789
Num non-zero elements: 2
Test accuracy for 14: 0.889
Num non-zero elements: 2
Test accuracy for 18: 0.879
Num non-zero elements: 2
Test accuracy for 19: 0.883
Num non-zero elements: 5
Test accuracy for 11: 0.923
Num non-zero elements: 5
Test accuracy for 13: 0.782
Num non-zero elements: 5
Test accuracy for 14: 0.884
Num non-zero elements: 5
Test accuracy for 18: 0.916
Num non-zero elements: 5
Test accuracy for 19: 0.868
Num non-zero elements: 10
Test accuracy for 11: 0.928
Num non-zero elements: 10
Test accuracy for 13: 0.889
Num non-zero elements: 10
Test accuracy for 14: 0.919
Num non-zero elements: 10
Test accuracy for 18: 0.917
Num non-zero elements: 10
Test accuracy for 19: 0.905
Num non-zero elements: 20
Test accuracy for 11: 0.931
Num non-zero elements: 20
Test accuracy for 13: 0.938
Num non-zero elements: 20
Test accuracy for 14: 0.946
Num non-zero elements: 20
Test accuracy for 18: 0.916
Num non-zero elements: 20
Test accuracy for 19: 0.923
Num non-zero elements: 50
Test accuracy for 11: 0.953
Num non-zero elements: 50
Test accuracy for 13: 0.951
Num non-zero elements: 50
Test accuracy for 14: 0.947
Num non-zero elements: 50
Test accuracy for 18: 0.913
Num non-zero elements: 50
Test accuracy for 19: 0.948


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 639.84it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 910.71it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 12.17it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00,  7.62it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00,  8.65it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 47.00it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 45.49it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.06it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.04it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:03, 17.67it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.82it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.63it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.50it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.40it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.33it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.28it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.24it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.18it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.14it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.11it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.12it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.12it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.12it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.38it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 22.22it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.62it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 19.04it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.73it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.53it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.39it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.30it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.20it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.47it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.28it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.22it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.19it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.17it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 18.11it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.12it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.86it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.40it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.19it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.55it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.52it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.12it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.82it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.58it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.40it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.30it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.24it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.21it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.07it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.49it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 22.07it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.53it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.97it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.64it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.43it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.20it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.54it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.14it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.98it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.16it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.48it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.25it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.78it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.50it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.33it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.23it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.15it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.10it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 15.67it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.97it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.03it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 23.66it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.93it/s][A[A

Collecting activations:  56%|█████▋    | 9/16 [00:00<00:00, 18.98it/s][A[A

Collecting activations:  69%|██████▉   | 11/16 [00:02<00:01,  3.46it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:02<00:00,  5.23it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:02<00:00,  6.48it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:02<00:00,  6.77it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.86it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.70it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 11.67it/s][A[A

Collecting activations:  69%|██████▉   | 11/16 [00:00<00:00, 15.04it/s][A[A

Collecting activations:  81%|████████▏ | 13/16 [00:00<00:00, 15.79it/s][A[A

Collecting activations:  94%|█████████▍| 15/16 [00:00<00:00, 16.37it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 16.05it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.41it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.24it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.74it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.37it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.22it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.09it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.40it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.39it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.73it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 19.16it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.69it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.40it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.24it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.15it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.09it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 27.83it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 22.53it/s][A[A

Collecting activations:  56%|█████▋    | 9/16 [00:00<00:00, 20.17it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 17.88it/s][A[A

Collecting activations:  94%|█████████▍| 15/16 [00:00<00:00, 18.67it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 19.35it/s]
Num non-zero elements: 2304
Test accuracy for 20: 0.942
Num non-zero elements: 2304
Test accuracy for 21: 0.896
Num non-zero elements: 2304
Test accuracy for 22: 0.892
Num non-zero elements: 2304
Test accuracy for 25: 0.948
Num non-zero elements: 2304
Test accuracy for 26: 0.864
Num non-zero elements: 1
Test accuracy for 20: 0.757
Num non-zero elements: 1
Test accuracy for 21: 0.627
Num non-zero elements: 1
Test accuracy for 22: 0.639
Num non-zero elements: 1
Test accuracy for 25: 0.717
Num non-zero elements: 1
Test accuracy for 26: 0.657
Num non-zero elements: 2
Test accuracy for 20: 0.805
Num non-zero elements: 2
Test accuracy for 21: 0.731
Num non-zero elements: 2
Test accuracy for 22: 0.614
Num non-zero elements: 2
Test accuracy for 25: 0.703
Num non-zero elements: 2
Test accuracy for 26: 0.668
Num non-zero elements: 5
Test accuracy for 20: 0.851
Num non-zero elements: 5
Test accuracy for 21: 0.761
Num non-zero elements: 5
Test accuracy for 22: 0.724
Num non-zero elements: 5
Test accuracy for 25: 0.802
Num non-zero elements: 5
Test accuracy for 26: 0.705
Num non-zero elements: 10
Test accuracy for 20: 0.858
Num non-zero elements: 10
Test accuracy for 21: 0.825
Num non-zero elements: 10
Test accuracy for 22: 0.757
Num non-zero elements: 10
Test accuracy for 25: 0.884
Num non-zero elements: 10
Test accuracy for 26: 0.725
Num non-zero elements: 20
Test accuracy for 20: 0.909
Num non-zero elements: 20
Test accuracy for 21: 0.854
Num non-zero elements: 20
Test accuracy for 22: 0.768
Num non-zero elements: 20
Test accuracy for 25: 0.901
Num non-zero elements: 20
Test accuracy for 26: 0.771
Num non-zero elements: 50
Test accuracy for 20: 0.916
Num non-zero elements: 50
Test accuracy for 21: 0.855
Num non-zero elements: 50
Test accuracy for 22: 0.833
Num non-zero elements: 50
Test accuracy for 25: 0.932
Num non-zero elements: 50
Test accuracy for 26: 0.829
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 25 epochs
Test accuracy for 20: 0.9420000314712524
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for 21: 0.8950000405311584
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 14 epochs
Test accuracy for 22: 0.9040000438690186
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for 25: 0.9590000510215759
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for 26: 0.8870000243186951
Num non-zero elements: 1
Test accuracy for 20: 0.887
Num non-zero elements: 1
Test accuracy for 21: 0.765
Num non-zero elements: 1
Test accuracy for 22: 0.83
Num non-zero elements: 1
Test accuracy for 25: 0.855
Num non-zero elements: 1
Test accuracy for 26: 0.724
Num non-zero elements: 2
Test accuracy for 20: 0.915
Num non-zero elements: 2
Test accuracy for 21: 0.754
Num non-zero elements: 2
Test accuracy for 22: 0.877
Num non-zero elements: 2
Test accuracy for 25: 0.897
Num non-zero elements: 2
Test accuracy for 26: 0.782
Num non-zero elements: 5
Test accuracy for 20: 0.915
Num non-zero elements: 5
Test accuracy for 21: 0.796
Num non-zero elements: 5
Test accuracy for 22: 0.87
Num non-zero elements: 5
Test accuracy for 25: 0.897
Num non-zero elements: 5
Test accuracy for 26: 0.832
Num non-zero elements: 10
Test accuracy for 20: 0.925
Num non-zero elements: 10
Test accuracy for 21: 0.83
Num non-zero elements: 10
Test accuracy for 22: 0.87
Num non-zero elements: 10
Test accuracy for 25: 0.912
Num non-zero elements: 10
Test accuracy for 26: 0.818
Num non-zero elements: 20
Test accuracy for 20: 0.931
Num non-zero elements: 20
Test accuracy for 21: 0.842
Num non-zero elements: 20
Test accuracy for 22: 0.886
Num non-zero elements: 20
Test accuracy for 25: 0.933
Num non-zero elements: 20
Test accuracy for 26: 0.862
Num non-zero elements: 50
Test accuracy for 20: 0.941
Num non-zero elements: 50
Test accuracy for 21: 0.881
Num non-zero elements: 50
Test accuracy for 22: 0.894
Num non-zero elements: 50
Test accuracy for 25: 0.952
Num non-zero elements: 50
Test accuracy for 26: 0.864


  0%|          | 0/34 [00:00<?, ?it/s][A[A100%|██████████| 34/34 [00:00<00:00, 416.95it/s]


  0%|          | 0/31 [00:00<?, ?it/s][A[A100%|██████████| 31/31 [00:00<00:00, 909.39it/s]
Removing 31 from train set
Removing 0 from train set
Removing 29 from train set
Removing 28 from train set
Removing 7 from train set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 10.33it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 10.31it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 10.30it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 39.30it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 39.11it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 28.20it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.05it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.49it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.46it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.06it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.78it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.58it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.41it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.29it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.22it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.18it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.02it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.47it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.05it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.15it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.73it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.49it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.34it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.17it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.11it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.96it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.12it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.92it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.05it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.64it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.41it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.26it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.17it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.10it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.05it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.95it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.93it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.06it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.30it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.18it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.70it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.43it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.26it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 16.52it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.46it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.31it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.19it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:02<00:01, 14.77it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.31it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.47it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.59it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.67it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.74it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.79it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.83it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.81it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:03<00:00, 17.84it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.85it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.87it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.86it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.87it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.84it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 22.10it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:04, 13.95it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:03, 16.31it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:03, 16.76it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 17.09it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 17.32it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:01<00:02, 17.49it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 17.60it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 17.66it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 17.70it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 17.75it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:02, 17.77it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 17.81it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 17.82it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 17.84it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:02<00:01, 17.85it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 17.85it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 17.83it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 17.82it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 17.83it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:01, 17.84it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 17.85it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 17.85it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 17.85it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:03<00:00, 17.85it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 17.84it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 17.83it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.83it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.83it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.84it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.59it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.11it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 13.05it/s][A[A

Collecting activations:  56%|█████▋    | 9/16 [00:00<00:00, 15.57it/s][A[A

Collecting activations:  69%|██████▉   | 11/16 [00:00<00:00, 16.17it/s][A[A

Collecting activations:  81%|████████▏ | 13/16 [00:00<00:00, 13.64it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:01<00:00, 16.40it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:01<00:00, 15.67it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.61it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.18it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.63it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.33it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.14it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.02it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.96it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.31it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.05it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.30it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.71it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.37it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.17it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.05it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.96it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.34it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.41it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.39it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.76it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.39it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.04it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.96it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.45it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.12it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.65it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.32it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.00it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.93it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.89it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.15it/s]
Num non-zero elements: 2304
Test accuracy for 1: 0.925
Num non-zero elements: 2304
Test accuracy for 2: 0.903
Num non-zero elements: 2304
Test accuracy for 3: 0.901
Num non-zero elements: 2304
Test accuracy for 5: 0.908
Num non-zero elements: 2304
Test accuracy for 6: 0.803
Num non-zero elements: 1
Test accuracy for 1: 0.702
Num non-zero elements: 1
Test accuracy for 2: 0.705
Num non-zero elements: 1
Test accuracy for 3: 0.602
Num non-zero elements: 1
Test accuracy for 5: 0.68
Num non-zero elements: 1
Test accuracy for 6: 0.615
Num non-zero elements: 2
Test accuracy for 1: 0.706
Num non-zero elements: 2
Test accuracy for 2: 0.698
Num non-zero elements: 2
Test accuracy for 3: 0.596
Num non-zero elements: 2
Test accuracy for 5: 0.691
Num non-zero elements: 2
Test accuracy for 6: 0.62
Num non-zero elements: 5
Test accuracy for 1: 0.782
Num non-zero elements: 5
Test accuracy for 2: 0.812
Num non-zero elements: 5
Test accuracy for 3: 0.644
Num non-zero elements: 5
Test accuracy for 5: 0.723
Num non-zero elements: 5
Test accuracy for 6: 0.672
Num non-zero elements: 10
Test accuracy for 1: 0.824
Num non-zero elements: 10
Test accuracy for 2: 0.809
Num non-zero elements: 10
Test accuracy for 3: 0.707
Num non-zero elements: 10
Test accuracy for 5: 0.743
Num non-zero elements: 10
Test accuracy for 6: 0.722
Num non-zero elements: 20
Test accuracy for 1: 0.833
Num non-zero elements: 20
Test accuracy for 2: 0.847
Num non-zero elements: 20
Test accuracy for 3: 0.797
Num non-zero elements: 20
Test accuracy for 5: 0.773
Num non-zero elements: 20
Test accuracy for 6: 0.724
Num non-zero elements: 50
Test accuracy for 1: 0.891
Num non-zero elements: 50
Test accuracy for 2: 0.843
Num non-zero elements: 50
Test accuracy for 3: 0.847
Num non-zero elements: 50
Test accuracy for 5: 0.826
Num non-zero elements: 50
Test accuracy for 6: 0.786
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for 1: 0.921000063419342
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 25 epochs
Test accuracy for 2: 0.9300000667572021
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for 3: 0.8920000195503235
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 17 epochs
Test accuracy for 5: 0.9100000262260437
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 20 epochs
Test accuracy for 6: 0.8380000591278076
Num non-zero elements: 1
Test accuracy for 1: 0.834
Num non-zero elements: 1
Test accuracy for 2: 0.773
Num non-zero elements: 1
Test accuracy for 3: 0.618
Num non-zero elements: 1
Test accuracy for 5: 0.799
Num non-zero elements: 1
Test accuracy for 6: 0.598
Num non-zero elements: 2
Test accuracy for 1: 0.876
Num non-zero elements: 2
Test accuracy for 2: 0.83
Num non-zero elements: 2
Test accuracy for 3: 0.648
Num non-zero elements: 2
Test accuracy for 5: 0.86
Num non-zero elements: 2
Test accuracy for 6: 0.704
Num non-zero elements: 5
Test accuracy for 1: 0.893
Num non-zero elements: 5
Test accuracy for 2: 0.841
Num non-zero elements: 5
Test accuracy for 3: 0.768
Num non-zero elements: 5
Test accuracy for 5: 0.858
Num non-zero elements: 5
Test accuracy for 6: 0.74
Num non-zero elements: 10
Test accuracy for 1: 0.899
Num non-zero elements: 10
Test accuracy for 2: 0.848
Num non-zero elements: 10
Test accuracy for 3: 0.848
Num non-zero elements: 10
Test accuracy for 5: 0.88
Num non-zero elements: 10
Test accuracy for 6: 0.746
Num non-zero elements: 20
Test accuracy for 1: 0.929
Num non-zero elements: 20
Test accuracy for 2: 0.882
Num non-zero elements: 20
Test accuracy for 3: 0.875
Num non-zero elements: 20
Test accuracy for 5: 0.888
Num non-zero elements: 20
Test accuracy for 6: 0.795
Num non-zero elements: 50
Test accuracy for 1: 0.921
Num non-zero elements: 50
Test accuracy for 2: 0.905
Num non-zero elements: 50
Test accuracy for 3: 0.886
Num non-zero elements: 50
Test accuracy for 5: 0.889
Num non-zero elements: 50
Test accuracy for 6: 0.832


Tokenizing data:   0%|          | 0/2 [00:00<?, ?it/s][A[A

Tokenizing data:  50%|█████     | 1/2 [00:00<00:00,  9.64it/s][A[ATokenizing data: 100%|██████████| 2/2 [00:00<00:00,  9.84it/s]


Tokenizing data:   0%|          | 0/2 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 2/2 [00:00<00:00, 39.08it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.26it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 22.86it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.41it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.43it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.05it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.76it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.56it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.39it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.30it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.23it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.19it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.47it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.06it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.16it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.75it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.50it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.33it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.23it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.12it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.14it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.95it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.10it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.69it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.44it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.29it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.19it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.14it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.47it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.40it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.91it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.56it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.36it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.24it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.11it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.38it/s]
Num non-zero elements: 2304
Test accuracy for 1.0: 0.903
Num non-zero elements: 2304
Test accuracy for 5.0: 0.902
Num non-zero elements: 1
Test accuracy for 1.0: 0.631
Num non-zero elements: 1
Test accuracy for 5.0: 0.631
Num non-zero elements: 2
Test accuracy for 1.0: 0.654
Num non-zero elements: 2
Test accuracy for 5.0: 0.654
Num non-zero elements: 5
Test accuracy for 1.0: 0.669
Num non-zero elements: 5
Test accuracy for 5.0: 0.669
Num non-zero elements: 10
Test accuracy for 1.0: 0.764
Num non-zero elements: 10
Test accuracy for 5.0: 0.764
Num non-zero elements: 20
Test accuracy for 1.0: 0.792
Num non-zero elements: 20
Test accuracy for 5.0: 0.792
Num non-zero elements: 50
Test accuracy for 1.0: 0.828
Num non-zero elements: 50
Test accuracy for 5.0: 0.828
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for 1.0: 0.8960000276565552
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 25 epochs
Test accuracy for 5.0: 0.8940000534057617
Num non-zero elements: 1
Test accuracy for 1.0: 0.606
Num non-zero elements: 1
Test accuracy for 5.0: 0.606
Num non-zero elements: 2
Test accuracy for 1.0: 0.705
Num non-zero elements: 2
Test accuracy for 5.0: 0.705
Num non-zero elements: 5
Test accuracy for 1.0: 0.828
Num non-zero elements: 5
Test accuracy for 5.0: 0.828
Num non-zero elements: 10
Test accuracy for 1.0: 0.871
Num non-zero elements: 10
Test accuracy for 5.0: 0.871
Num non-zero elements: 20
Test accuracy for 1.0: 0.885
Num non-zero elements: 20
Test accuracy for 5.0: 0.885
Num non-zero elements: 50
Test accuracy for 1.0: 0.906
Num non-zero elements: 50
Test accuracy for 5.0: 0.906
Loading dataset codeparrot/github-code, this usually takes ~30 seconds


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  20%|██        | 1/5 [00:01<00:07,  1.81s/it][A[A

Tokenizing data:  40%|████      | 2/5 [00:02<00:04,  1.36s/it][A[A

Tokenizing data:  60%|██████    | 3/5 [00:03<00:02,  1.22s/it][A[A

Tokenizing data:  80%|████████  | 4/5 [00:04<00:00,  1.08it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:05<00:00,  1.14it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:05<00:00,  1.04s/it]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  20%|██        | 1/5 [00:00<00:01,  2.01it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00,  3.37it/s][A[A

Tokenizing data:  60%|██████    | 3/5 [00:00<00:00,  3.35it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:01<00:00,  4.06it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:01<00:00,  4.48it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:01<00:00,  3.84it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 28.04it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.27it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.46it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.51it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.08it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.78it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.56it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.38it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.27it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.19it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.97it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.43it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.01it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.11it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.67it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.42it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.27it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.11it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.05it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 12.71it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 11.22it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 14.17it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 15.05it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 16.96it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 22.61it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.62it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.99it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.61it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.27it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.13it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.06it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.02it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.95it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.88it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.86it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.87it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.88it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.88it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.89it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.88it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.85it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.85it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:03<00:00, 17.86it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 14.71it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.35it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.50it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.62it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.85it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 23.01it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.69it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 19.00it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.52it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 17.32it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.23it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:02, 17.90it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 17.84it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 17.83it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 17.84it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 17.85it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 17.86it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 17.86it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 17.85it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 17.84it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:01, 17.81it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 17.80it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 17.79it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 17.80it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 17.82it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 17.84it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 17.84it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.84it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.83it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.82it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.01it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.92it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:03, 18.95it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.54it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.30it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.04it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 17.96it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 17.90it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.86it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.84it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.83it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.83it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.83it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.82it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.82it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.80it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.79it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.78it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.78it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.79it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.80it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.80it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.81it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.79it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.79it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:03<00:00, 17.78it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.78it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.78it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.77it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.78it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.71it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 27.65it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 21.92it/s][A[A

Collecting activations:  56%|█████▋    | 9/16 [00:00<00:00, 19.81it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.93it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.59it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.36it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 19.21it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.54it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 15.63it/s][A[A

Collecting activations:  56%|█████▋    | 9/16 [00:00<00:00, 17.52it/s][A[A

Collecting activations:  69%|██████▉   | 11/16 [00:00<00:00, 17.61it/s][A[A

Collecting activations:  81%|████████▏ | 13/16 [00:00<00:00, 17.66it/s][A[A

Collecting activations:  94%|█████████▍| 15/16 [00:00<00:00, 17.70it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.66it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.04it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.85it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.44it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.20it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.99it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.93it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.18it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.73it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.51it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.78it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.41it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.19it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.04it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.98it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.41it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.26it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.39it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.73it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.36it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.00it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.93it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.33it/s]
Num non-zero elements: 2304
Test accuracy for C: 0.958
Num non-zero elements: 2304
Test accuracy for Python: 0.988
Num non-zero elements: 2304
Test accuracy for HTML: 0.985
Num non-zero elements: 2304
Test accuracy for Java: 0.968
Num non-zero elements: 2304
Test accuracy for PHP: 0.96
Num non-zero elements: 1
Test accuracy for C: 0.593
Num non-zero elements: 1
Test accuracy for Python: 0.637
Num non-zero elements: 1
Test accuracy for HTML: 0.706
Num non-zero elements: 1
Test accuracy for Java: 0.611
Num non-zero elements: 1
Test accuracy for PHP: 0.586
Num non-zero elements: 2
Test accuracy for C: 0.726
Num non-zero elements: 2
Test accuracy for Python: 0.665
Num non-zero elements: 2
Test accuracy for HTML: 0.948
Num non-zero elements: 2
Test accuracy for Java: 0.625
Num non-zero elements: 2
Test accuracy for PHP: 0.657
Num non-zero elements: 5
Test accuracy for C: 0.821
Num non-zero elements: 5
Test accuracy for Python: 0.755
Num non-zero elements: 5
Test accuracy for HTML: 0.95
Num non-zero elements: 5
Test accuracy for Java: 0.79
Num non-zero elements: 5
Test accuracy for PHP: 0.71
Num non-zero elements: 10
Test accuracy for C: 0.845
Num non-zero elements: 10
Test accuracy for Python: 0.856
Num non-zero elements: 10
Test accuracy for HTML: 0.954
Num non-zero elements: 10
Test accuracy for Java: 0.826
Num non-zero elements: 10
Test accuracy for PHP: 0.798
Num non-zero elements: 20
Test accuracy for C: 0.87
Num non-zero elements: 20
Test accuracy for Python: 0.906
Num non-zero elements: 20
Test accuracy for HTML: 0.961
Num non-zero elements: 20
Test accuracy for Java: 0.87
Num non-zero elements: 20
Test accuracy for PHP: 0.866
Num non-zero elements: 50
Test accuracy for C: 0.923
Num non-zero elements: 50
Test accuracy for Python: 0.966
Num non-zero elements: 50
Test accuracy for HTML: 0.967
Num non-zero elements: 50
Test accuracy for Java: 0.91
Num non-zero elements: 50
Test accuracy for PHP: 0.888
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 32 epochs
Test accuracy for C: 0.9550000429153442
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 20 epochs
Test accuracy for Python: 0.987000048160553
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 21 epochs
Test accuracy for HTML: 0.9920000433921814
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 31 epochs
Test accuracy for Java: 0.9670000672340393
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 22 epochs
Test accuracy for PHP: 0.9490000605583191
Num non-zero elements: 1
Test accuracy for C: 0.736
Num non-zero elements: 1
Test accuracy for Python: 0.918
Num non-zero elements: 1
Test accuracy for HTML: 0.881
Num non-zero elements: 1
Test accuracy for Java: 0.779
Num non-zero elements: 1
Test accuracy for PHP: 0.912
Num non-zero elements: 2
Test accuracy for C: 0.874
Num non-zero elements: 2
Test accuracy for Python: 0.923
Num non-zero elements: 2
Test accuracy for HTML: 0.946
Num non-zero elements: 2
Test accuracy for Java: 0.881
Num non-zero elements: 2
Test accuracy for PHP: 0.913
Num non-zero elements: 5
Test accuracy for C: 0.893
Num non-zero elements: 5
Test accuracy for Python: 0.957
Num non-zero elements: 5
Test accuracy for HTML: 0.952
Num non-zero elements: 5
Test accuracy for Java: 0.887
Num non-zero elements: 5
Test accuracy for PHP: 0.91
Num non-zero elements: 10
Test accuracy for C: 0.912
Num non-zero elements: 10
Test accuracy for Python: 0.966
Num non-zero elements: 10
Test accuracy for HTML: 0.952
Num non-zero elements: 10
Test accuracy for Java: 0.919
Num non-zero elements: 10
Test accuracy for PHP: 0.922
Num non-zero elements: 20
Test accuracy for C: 0.932
Num non-zero elements: 20
Test accuracy for Python: 0.98
Num non-zero elements: 20
Test accuracy for HTML: 0.954
Num non-zero elements: 20
Test accuracy for Java: 0.926
Num non-zero elements: 20
Test accuracy for PHP: 0.92
Num non-zero elements: 50
Test accuracy for C: 0.937
Num non-zero elements: 50
Test accuracy for Python: 0.985
Num non-zero elements: 50
Test accuracy for HTML: 0.97
Num non-zero elements: 50
Test accuracy for Java: 0.937
Num non-zero elements: 50
Test accuracy for PHP: 0.928


Tokenizing data:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Tokenizing data:  50%|█████     | 2/4 [00:00<00:00, 14.21it/s][A[A

Tokenizing data: 100%|██████████| 4/4 [00:00<00:00, 14.29it/s][A[ATokenizing data: 100%|██████████| 4/4 [00:00<00:00, 14.25it/s]


Tokenizing data:   0%|          | 0/4 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 4/4 [00:00<00:00, 54.02it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.89it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.26it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.66it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.63it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 19.11it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.88it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:00<00:02, 18.69it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.55it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.45it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.38it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.33it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.29it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.28it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.26it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.25it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 18.24it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.22it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.21it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.21it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.20it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.20it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.20it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.15it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.21it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 18.20it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.20it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.19it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.19it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.21it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.63it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.37it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.36it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.92it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.67it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.51it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.41it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.34it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.26it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.22it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.22it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.21it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.20it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.20it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.18it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.18it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.18it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.18it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.18it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.18it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.18it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.18it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.18it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.17it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.16it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.16it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.16it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.31it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.20it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.30it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.88it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.63it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.47it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.35it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.30it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.22it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.20it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.19it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.14it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.14it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.15it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.15it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.13it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.13it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.13it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.13it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.27it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.14it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.25it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.84it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.58it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.43it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.34it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.26it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.22it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.18it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.08it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.22it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.02it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.19it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.77it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.53it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.37it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.27it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.22it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.55it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.51it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.00it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.64it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.44it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.32it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.24it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.20it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.47it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.45it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.97it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.62it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.42it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.29it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.20it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.16it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.44it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.46it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.96it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.63it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.44it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.30it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.21it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.17it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.44it/s]
Num non-zero elements: 2304
Test accuracy for 0: 0.92
Num non-zero elements: 2304
Test accuracy for 1: 0.986
Num non-zero elements: 2304
Test accuracy for 2: 0.906
Num non-zero elements: 2304
Test accuracy for 3: 0.923
Num non-zero elements: 1
Test accuracy for 0: 0.768
Num non-zero elements: 1
Test accuracy for 1: 0.687
Num non-zero elements: 1
Test accuracy for 2: 0.663
Num non-zero elements: 1
Test accuracy for 3: 0.789
Num non-zero elements: 2
Test accuracy for 0: 0.792
Num non-zero elements: 2
Test accuracy for 1: 0.815
Num non-zero elements: 2
Test accuracy for 2: 0.69
Num non-zero elements: 2
Test accuracy for 3: 0.809
Num non-zero elements: 5
Test accuracy for 0: 0.87
Num non-zero elements: 5
Test accuracy for 1: 0.881
Num non-zero elements: 5
Test accuracy for 2: 0.784
Num non-zero elements: 5
Test accuracy for 3: 0.843
Num non-zero elements: 10
Test accuracy for 0: 0.881
Num non-zero elements: 10
Test accuracy for 1: 0.945
Num non-zero elements: 10
Test accuracy for 2: 0.81
Num non-zero elements: 10
Test accuracy for 3: 0.848
Num non-zero elements: 20
Test accuracy for 0: 0.905
Num non-zero elements: 20
Test accuracy for 1: 0.955
Num non-zero elements: 20
Test accuracy for 2: 0.867
Num non-zero elements: 20
Test accuracy for 3: 0.885
Num non-zero elements: 50
Test accuracy for 0: 0.905
Num non-zero elements: 50
Test accuracy for 1: 0.965
Num non-zero elements: 50
Test accuracy for 2: 0.889
Num non-zero elements: 50
Test accuracy for 3: 0.919
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for 0: 0.9340000152587891
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 20 epochs
Test accuracy for 1: 0.9820000529289246
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for 2: 0.9170000553131104
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for 3: 0.9420000314712524
Num non-zero elements: 1
Test accuracy for 0: 0.719
Num non-zero elements: 1
Test accuracy for 1: 0.952
Num non-zero elements: 1
Test accuracy for 2: 0.769
Num non-zero elements: 1
Test accuracy for 3: 0.706
Num non-zero elements: 2
Test accuracy for 0: 0.774
Num non-zero elements: 2
Test accuracy for 1: 0.953
Num non-zero elements: 2
Test accuracy for 2: 0.828
Num non-zero elements: 2
Test accuracy for 3: 0.778
Num non-zero elements: 5
Test accuracy for 0: 0.833
Num non-zero elements: 5
Test accuracy for 1: 0.958
Num non-zero elements: 5
Test accuracy for 2: 0.847
Num non-zero elements: 5
Test accuracy for 3: 0.845
Num non-zero elements: 10
Test accuracy for 0: 0.888
Num non-zero elements: 10
Test accuracy for 1: 0.965
Num non-zero elements: 10
Test accuracy for 2: 0.845
Num non-zero elements: 10
Test accuracy for 3: 0.884
Num non-zero elements: 20
Test accuracy for 0: 0.912
Num non-zero elements: 20
Test accuracy for 1: 0.976
Num non-zero elements: 20
Test accuracy for 2: 0.858
Num non-zero elements: 20
Test accuracy for 3: 0.89
Num non-zero elements: 50
Test accuracy for 0: 0.92
Num non-zero elements: 50
Test accuracy for 1: 0.979
Num non-zero elements: 50
Test accuracy for 2: 0.878
Num non-zero elements: 50
Test accuracy for 3: 0.916
Loading dataset Helsinki-NLP/europarl, this usually takes ~10 seconds


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 14.82it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 15.34it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 15.34it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 60.72it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 28.88it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.17it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.58it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.56it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 19.03it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.80it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:00<00:02, 18.58it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.43it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.35it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.29it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:02, 14.67it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.27it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.50it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.66it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.78it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.88it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.05it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.26it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.93it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.48it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.95it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.64it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.45it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.33it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.20it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.09it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.18it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.74it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.49it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.34it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:03, 14.20it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 17.03it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 17.30it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 17.50it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 17.65it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:02, 17.77it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 17.85it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 17.88it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 16.17it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.51it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.36it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.27it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.21it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.02it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.85it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 22.06it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.47it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.89it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.55it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.36it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.09it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 15.72it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 18.17it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 16.70it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.40it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.29it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.18it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:03<00:00, 14.91it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 17.42it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.57it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.67it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.77it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.83it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 23.89it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 20.01it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 18.91it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.60it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.39it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 17.91it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 17.91it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 17.91it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:01, 17.91it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 17.91it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 17.90it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.90it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.89it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.90it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.12it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.29it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.15it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.68it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.41it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.23it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.13it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.06it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.08it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 23.68it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.89it/s][A[A

Collecting activations:  56%|█████▋    | 9/16 [00:00<00:00, 18.92it/s][A[A

Collecting activations:  69%|██████▉   | 11/16 [00:00<00:00, 18.60it/s][A[A

Collecting activations:  81%|████████▏ | 13/16 [00:00<00:00, 18.37it/s][A[A

Collecting activations:  94%|█████████▍| 15/16 [00:00<00:00, 18.23it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.75it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.78it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.97it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 16.88it/s][A[A

Collecting activations:  69%|██████▉   | 11/16 [00:00<00:00, 18.70it/s][A[A

Collecting activations:  81%|████████▏ | 13/16 [00:00<00:00, 18.45it/s][A[A

Collecting activations:  94%|█████████▍| 15/16 [00:00<00:00, 18.28it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.37it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.97it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.03it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.60it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.35it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.08it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.30it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.42it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.49it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.86it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.52it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.30it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.09it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.48it/s]
Num non-zero elements: 2304
Test accuracy for en: 0.997
Num non-zero elements: 2304
Test accuracy for fr: 1.0
Num non-zero elements: 2304
Test accuracy for de: 1.0
Num non-zero elements: 2304
Test accuracy for es: 1.0
Num non-zero elements: 2304
Test accuracy for nl: 1.0
Num non-zero elements: 1
Test accuracy for en: 0.935
Num non-zero elements: 1
Test accuracy for fr: 0.654
Num non-zero elements: 1
Test accuracy for de: 0.816
Num non-zero elements: 1
Test accuracy for es: 0.891
Num non-zero elements: 1
Test accuracy for nl: 0.851
Num non-zero elements: 2
Test accuracy for en: 0.973
Num non-zero elements: 2
Test accuracy for fr: 0.917
Num non-zero elements: 2
Test accuracy for de: 0.838
Num non-zero elements: 2
Test accuracy for es: 0.904
Num non-zero elements: 2
Test accuracy for nl: 0.89
Num non-zero elements: 5
Test accuracy for en: 0.992
Num non-zero elements: 5
Test accuracy for fr: 0.973
Num non-zero elements: 5
Test accuracy for de: 0.891
Num non-zero elements: 5
Test accuracy for es: 0.981
Num non-zero elements: 5
Test accuracy for nl: 0.955
Num non-zero elements: 10
Test accuracy for en: 0.997
Num non-zero elements: 10
Test accuracy for fr: 0.988
Num non-zero elements: 10
Test accuracy for de: 0.982
Num non-zero elements: 10
Test accuracy for es: 0.987
Num non-zero elements: 10
Test accuracy for nl: 0.966
Num non-zero elements: 20
Test accuracy for en: 0.996
Num non-zero elements: 20
Test accuracy for fr: 0.995
Num non-zero elements: 20
Test accuracy for de: 0.991
Num non-zero elements: 20
Test accuracy for es: 0.995
Num non-zero elements: 20
Test accuracy for nl: 0.987
Num non-zero elements: 50
Test accuracy for en: 0.997
Num non-zero elements: 50
Test accuracy for fr: 0.998
Num non-zero elements: 50
Test accuracy for de: 0.997
Num non-zero elements: 50
Test accuracy for es: 0.997
Num non-zero elements: 50
Test accuracy for nl: 0.994
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 11 epochs
Test accuracy for en: 0.9980000257492065
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 12 epochs
Test accuracy for fr: 0.999000072479248
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 12 epochs
Test accuracy for de: 0.999000072479248
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for es: 1.0
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for nl: 1.0
Num non-zero elements: 1
Test accuracy for en: 0.994
Num non-zero elements: 1
Test accuracy for fr: 0.998
Num non-zero elements: 1
Test accuracy for de: 0.843
Num non-zero elements: 1
Test accuracy for es: 0.966
Num non-zero elements: 1
Test accuracy for nl: 0.851
Num non-zero elements: 2
Test accuracy for en: 0.999
Num non-zero elements: 2
Test accuracy for fr: 0.998
Num non-zero elements: 2
Test accuracy for de: 0.861
Num non-zero elements: 2
Test accuracy for es: 0.983
Num non-zero elements: 2
Test accuracy for nl: 0.996
Num non-zero elements: 5
Test accuracy for en: 0.999
Num non-zero elements: 5
Test accuracy for fr: 0.996
Num non-zero elements: 5
Test accuracy for de: 0.989
Num non-zero elements: 5
Test accuracy for es: 0.989
Num non-zero elements: 5
Test accuracy for nl: 0.999
Num non-zero elements: 10
Test accuracy for en: 0.999
Num non-zero elements: 10
Test accuracy for fr: 0.997
Num non-zero elements: 10
Test accuracy for de: 0.999
Num non-zero elements: 10
Test accuracy for es: 0.997
Num non-zero elements: 10
Test accuracy for nl: 0.999
Num non-zero elements: 20
Test accuracy for en: 0.999
Num non-zero elements: 20
Test accuracy for fr: 0.995
Num non-zero elements: 20
Test accuracy for de: 1.0
Num non-zero elements: 20
Test accuracy for es: 0.998
Num non-zero elements: 20
Test accuracy for nl: 1.0
Num non-zero elements: 50
Test accuracy for en: 0.998
Num non-zero elements: 50
Test accuracy for fr: 0.997
Num non-zero elements: 50
Test accuracy for de: 0.999
Num non-zero elements: 50
Test accuracy for es: 0.999
Num non-zero elements: 50
Test accuracy for nl: 0.999

Running SAE evaluation on all selected SAEs: 100%|██████████| 1/1 [17:03<00:00, 1023.15s/it][ARunning SAE evaluation on all selected SAEs: 100%|██████████| 1/1 [17:03<00:00, 1023.16s/it]
Evaluations: 100%|██████████| 1/1 [17:17<00:00, 1037.00s/it]Evaluations: 100%|██████████| 1/1 [17:17<00:00, 1037.00s/it]
/share/u/can/SAEBench/custom_saes/topk_sae.py:110: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  pt_params = t.load(path_to_params)
Loaded config: {'trainer': {'trainer_class': 'TrainerTopKAdditivity', 'dict_class': 'AutoEncoderTopK', 'lr': 0.000282842712474619, 'steps': 48828, 'seed': 0, 'activation_dim': 2304, 'dict_size': 8192, 'k': 50, 'auxk_alpha': 0.03125, 'additivity_coeff': 1.0, 'intersection_coeff': 1.0, 'device': 'cuda:0', 'layer': 4, 'lm_name': 'google/gemma-2-2b', 'wandb_name': 'TopKTrainer_Additivity-google/gemma-2-2b-resid_post_layer_4-add_coeff-1.0-inters_coeff-1.0', 'submodule_name': 'resid_post_layer_4'}, 'buffer': {'d_submodule': 2304, 'io': 'out', 'n_ctxs': 8192, 'ctx_len': 128, 'refresh_batch_size': 32, 'out_batch_size': 2048, 'device': 'cuda:0'}}
Original keys in state_dict: odict_keys(['b_dec', 'encoder.weight', 'encoder.bias', 'decoder.weight'])
Renamed keys in state_dict: dict_keys(['b_dec', 'W_enc', 'b_enc', 'W_dec'])
Evaluations:   0%|          | 0/1 [00:00<?, ?it/s]


Running sparse_probing evaluation




Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s][A
Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:01,  1.55it/s][A
Loading checkpoint shards:  67%|██████▋   | 2/3 [00:01<00:00,  1.60it/s][A
Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.31it/s][ALoading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.05it/s]
Loaded pretrained model gemma-2-2b into HookedTransformer

Running SAE evaluation on all selected SAEs:   0%|          | 0/1 [00:00<?, ?it/s][A

  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 644.07it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 1061.46it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 12.25it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 12.69it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 12.62it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 47.24it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 47.01it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 26.78it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.05it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.54it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.53it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.14it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.85it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.65it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.46it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.35it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.29it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.25it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.22it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.08it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.52it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.27it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.27it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.81it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.56it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.39it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.15it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.18it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.30it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.26it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.78it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.51it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.34it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.17it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.12it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.14it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.41it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.27it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.80it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.52it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.35it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.17it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.10it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.92it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.93it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.10it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.16it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.13it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.69it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.41it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.12it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.05it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.01it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.95it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.94it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.93it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.90it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.88it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.89it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.89it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.89it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.88it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.03it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.08it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.08it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.64it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.39it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.21it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.10it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.40it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.29it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.81it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.47it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.14it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.05it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.29it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.24it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.78it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.45it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.25it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.02it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.27it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.31it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.81it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.45it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.25it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.14it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.06it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.28it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.26it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.77it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.42it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.22it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.09it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.01it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.97it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.24it/s]
Num non-zero elements: 2304
Test accuracy for 0: 0.925
Num non-zero elements: 2304
Test accuracy for 1: 0.943
Num non-zero elements: 2304
Test accuracy for 2: 0.947
Num non-zero elements: 2304
Test accuracy for 6: 0.991
Num non-zero elements: 2304
Test accuracy for 9: 0.971
Num non-zero elements: 1
Test accuracy for 0: 0.603
Num non-zero elements: 1
Test accuracy for 1: 0.648
Num non-zero elements: 1
Test accuracy for 2: 0.731
Num non-zero elements: 1
Test accuracy for 6: 0.773
Num non-zero elements: 1
Test accuracy for 9: 0.68
Num non-zero elements: 2
Test accuracy for 0: 0.682
Num non-zero elements: 2
Test accuracy for 1: 0.655
Num non-zero elements: 2
Test accuracy for 2: 0.744
Num non-zero elements: 2
Test accuracy for 6: 0.771
Num non-zero elements: 2
Test accuracy for 9: 0.772
Num non-zero elements: 5
Test accuracy for 0: 0.768
Num non-zero elements: 5
Test accuracy for 1: 0.69
Num non-zero elements: 5
Test accuracy for 2: 0.754
Num non-zero elements: 5
Test accuracy for 6: 0.905
Num non-zero elements: 5
Test accuracy for 9: 0.798
Num non-zero elements: 10
Test accuracy for 0: 0.797
Num non-zero elements: 10
Test accuracy for 1: 0.818
Num non-zero elements: 10
Test accuracy for 2: 0.83
Num non-zero elements: 10
Test accuracy for 6: 0.929
Num non-zero elements: 10
Test accuracy for 9: 0.912
Num non-zero elements: 20
Test accuracy for 0: 0.796
Num non-zero elements: 20
Test accuracy for 1: 0.867
Num non-zero elements: 20
Test accuracy for 2: 0.847
Num non-zero elements: 20
Test accuracy for 6: 0.96
Num non-zero elements: 20
Test accuracy for 9: 0.945
Num non-zero elements: 50
Test accuracy for 0: 0.862
Num non-zero elements: 50
Test accuracy for 1: 0.905
Num non-zero elements: 50
Test accuracy for 2: 0.897
Num non-zero elements: 50
Test accuracy for 6: 0.977
Num non-zero elements: 50
Test accuracy for 9: 0.948
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 27 epochs
Test accuracy for 0: 0.9410000443458557
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for 1: 0.9600000381469727
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for 2: 0.9360000491142273
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 21 epochs
Test accuracy for 6: 0.9890000224113464
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 22 epochs
Test accuracy for 9: 0.9670000672340393
Num non-zero elements: 1
Test accuracy for 0: 0.645
Num non-zero elements: 1
Test accuracy for 1: 0.671
Num non-zero elements: 1
Test accuracy for 2: 0.889
Num non-zero elements: 1
Test accuracy for 6: 0.969
Num non-zero elements: 1
Test accuracy for 9: 0.937
Num non-zero elements: 2
Test accuracy for 0: 0.695
Num non-zero elements: 2
Test accuracy for 1: 0.761
Num non-zero elements: 2
Test accuracy for 2: 0.9
Num non-zero elements: 2
Test accuracy for 6: 0.969
Num non-zero elements: 2
Test accuracy for 9: 0.944
Num non-zero elements: 5
Test accuracy for 0: 0.853
Num non-zero elements: 5
Test accuracy for 1: 0.812
Num non-zero elements: 5
Test accuracy for 2: 0.924
Num non-zero elements: 5
Test accuracy for 6: 0.986
Num non-zero elements: 5
Test accuracy for 9: 0.941
Num non-zero elements: 10
Test accuracy for 0: 0.889
Num non-zero elements: 10
Test accuracy for 1: 0.853
Num non-zero elements: 10
Test accuracy for 2: 0.926
Num non-zero elements: 10
Test accuracy for 6: 0.987
Num non-zero elements: 10
Test accuracy for 9: 0.945
Num non-zero elements: 20
Test accuracy for 0: 0.896
Num non-zero elements: 20
Test accuracy for 1: 0.937
Num non-zero elements: 20
Test accuracy for 2: 0.93
Num non-zero elements: 20
Test accuracy for 6: 0.988
Num non-zero elements: 20
Test accuracy for 9: 0.964
Num non-zero elements: 50
Test accuracy for 0: 0.94
Num non-zero elements: 50
Test accuracy for 1: 0.946
Num non-zero elements: 50
Test accuracy for 2: 0.933
Num non-zero elements: 50
Test accuracy for 6: 0.989
Num non-zero elements: 50
Test accuracy for 9: 0.969


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 651.41it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 1053.17it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 12.77it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 12.91it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 12.93it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 45.27it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 45.03it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 28.36it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.30it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.63it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.59it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 19.05it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.82it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:00<00:02, 18.62it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.48it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.39it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.32it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.27it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.24it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.22it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.20it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.15it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.14it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.14it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.15it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.12it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.11it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.12it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.13it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.57it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.21it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.28it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.84it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.58it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.41it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.23it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.19it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.03it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.14it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.73it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.49it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.34it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.17it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.13it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.14it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.97it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.13it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.72it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.47it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.22it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.10it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.96it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.11it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.97it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.08it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.66it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.40it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.07it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.02it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.95it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.92it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.92it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.92it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.92it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.92it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.91it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.91it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.92it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.91it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.05it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.93it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.03it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.59it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.34it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.09it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.38it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.23it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.79it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.44it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.24it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.11it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.04it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.27it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.29it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.78it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.45it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.25it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.03it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.26it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.27it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.77it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.44it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.24it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.04it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.26it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.28it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.78it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.43it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.23it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.04it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.28it/s]
Num non-zero elements: 2304
Test accuracy for 11: 0.954
Num non-zero elements: 2304
Test accuracy for 13: 0.943
Num non-zero elements: 2304
Test accuracy for 14: 0.945
Num non-zero elements: 2304
Test accuracy for 18: 0.915
Num non-zero elements: 2304
Test accuracy for 19: 0.961
Num non-zero elements: 1
Test accuracy for 11: 0.726
Num non-zero elements: 1
Test accuracy for 13: 0.701
Num non-zero elements: 1
Test accuracy for 14: 0.636
Num non-zero elements: 1
Test accuracy for 18: 0.702
Num non-zero elements: 1
Test accuracy for 19: 0.782
Num non-zero elements: 2
Test accuracy for 11: 0.792
Num non-zero elements: 2
Test accuracy for 13: 0.724
Num non-zero elements: 2
Test accuracy for 14: 0.653
Num non-zero elements: 2
Test accuracy for 18: 0.707
Num non-zero elements: 2
Test accuracy for 19: 0.793
Num non-zero elements: 5
Test accuracy for 11: 0.819
Num non-zero elements: 5
Test accuracy for 13: 0.794
Num non-zero elements: 5
Test accuracy for 14: 0.723
Num non-zero elements: 5
Test accuracy for 18: 0.719
Num non-zero elements: 5
Test accuracy for 19: 0.814
Num non-zero elements: 10
Test accuracy for 11: 0.878
Num non-zero elements: 10
Test accuracy for 13: 0.844
Num non-zero elements: 10
Test accuracy for 14: 0.79
Num non-zero elements: 10
Test accuracy for 18: 0.748
Num non-zero elements: 10
Test accuracy for 19: 0.836
Num non-zero elements: 20
Test accuracy for 11: 0.888
Num non-zero elements: 20
Test accuracy for 13: 0.869
Num non-zero elements: 20
Test accuracy for 14: 0.863
Num non-zero elements: 20
Test accuracy for 18: 0.765
Num non-zero elements: 20
Test accuracy for 19: 0.925
Num non-zero elements: 50
Test accuracy for 11: 0.923
Num non-zero elements: 50
Test accuracy for 13: 0.901
Num non-zero elements: 50
Test accuracy for 14: 0.88
Num non-zero elements: 50
Test accuracy for 18: 0.814
Num non-zero elements: 50
Test accuracy for 19: 0.931
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for 11: 0.956000030040741
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 14 epochs
Test accuracy for 13: 0.9550000429153442
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 23 epochs
Test accuracy for 14: 0.9390000700950623
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 27 epochs
Test accuracy for 18: 0.9190000295639038
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 28 epochs
Test accuracy for 19: 0.9550000429153442
Num non-zero elements: 1
Test accuracy for 11: 0.828
Num non-zero elements: 1
Test accuracy for 13: 0.752
Num non-zero elements: 1
Test accuracy for 14: 0.902
Num non-zero elements: 1
Test accuracy for 18: 0.723
Num non-zero elements: 1
Test accuracy for 19: 0.863
Num non-zero elements: 2
Test accuracy for 11: 0.829
Num non-zero elements: 2
Test accuracy for 13: 0.753
Num non-zero elements: 2
Test accuracy for 14: 0.909
Num non-zero elements: 2
Test accuracy for 18: 0.87
Num non-zero elements: 2
Test accuracy for 19: 0.87
Num non-zero elements: 5
Test accuracy for 11: 0.925
Num non-zero elements: 5
Test accuracy for 13: 0.797
Num non-zero elements: 5
Test accuracy for 14: 0.908
Num non-zero elements: 5
Test accuracy for 18: 0.877
Num non-zero elements: 5
Test accuracy for 19: 0.87
Num non-zero elements: 10
Test accuracy for 11: 0.943
Num non-zero elements: 10
Test accuracy for 13: 0.93
Num non-zero elements: 10
Test accuracy for 14: 0.935
Num non-zero elements: 10
Test accuracy for 18: 0.867
Num non-zero elements: 10
Test accuracy for 19: 0.901
Num non-zero elements: 20
Test accuracy for 11: 0.943
Num non-zero elements: 20
Test accuracy for 13: 0.937
Num non-zero elements: 20
Test accuracy for 14: 0.937
Num non-zero elements: 20
Test accuracy for 18: 0.89
Num non-zero elements: 20
Test accuracy for 19: 0.916
Num non-zero elements: 50
Test accuracy for 11: 0.953
Num non-zero elements: 50
Test accuracy for 13: 0.957
Num non-zero elements: 50
Test accuracy for 14: 0.947
Num non-zero elements: 50
Test accuracy for 18: 0.93
Num non-zero elements: 50
Test accuracy for 19: 0.949


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 638.57it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 915.97it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 12.12it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00,  7.54it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00,  8.61it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 46.60it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 45.17it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.39it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.13it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.58it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.56it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.17it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.88it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.67it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.49it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.40it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.35it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.29it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.26it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 16.65it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.67it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.53it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 18.44it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.36it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.30it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.26it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.24it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.22it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.20it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.26it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 18.23it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.22it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.20it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.19it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.19it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.56it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 23.46it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 20.01it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 19.12it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.82it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.61it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.47it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.37it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.29it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.24it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.20it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.19it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 17.10it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.41it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.36it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.29it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.23it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.20it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.18it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.16it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.14it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.13it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.14it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.33it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.44it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.16it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.55it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.51it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.11it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.82it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.60it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.43it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 16.47it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.71it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.54it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.42it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.31it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.23it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.06it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.46it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 25.14it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 20.43it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 19.25it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.86it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.61it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.44it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.23it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.23it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 14.28it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.02it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.28it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.48it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.99it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 22.04it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.47it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.93it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.54it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.36it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.17it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.12it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.81it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.98it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.14it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.96it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.08it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.65it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.40it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.24it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.09it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.41it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.89it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.02it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.61it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.37it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.21it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.11it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.06it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.33it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.61it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.59it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.95it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.58it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.36it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.20it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.13it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.63it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.33it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.80it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.47it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.28it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.24it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.99it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.38it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.82it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.50it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.31it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.11it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.47it/s]
Num non-zero elements: 2304
Test accuracy for 20: 0.925
Num non-zero elements: 2304
Test accuracy for 21: 0.899
Num non-zero elements: 2304
Test accuracy for 22: 0.898
Num non-zero elements: 2304
Test accuracy for 25: 0.96
Num non-zero elements: 2304
Test accuracy for 26: 0.84
Num non-zero elements: 1
Test accuracy for 20: 0.754
Num non-zero elements: 1
Test accuracy for 21: 0.634
Num non-zero elements: 1
Test accuracy for 22: 0.619
Num non-zero elements: 1
Test accuracy for 25: 0.706
Num non-zero elements: 1
Test accuracy for 26: 0.641
Num non-zero elements: 2
Test accuracy for 20: 0.797
Num non-zero elements: 2
Test accuracy for 21: 0.732
Num non-zero elements: 2
Test accuracy for 22: 0.608
Num non-zero elements: 2
Test accuracy for 25: 0.761
Num non-zero elements: 2
Test accuracy for 26: 0.666
Num non-zero elements: 5
Test accuracy for 20: 0.86
Num non-zero elements: 5
Test accuracy for 21: 0.768
Num non-zero elements: 5
Test accuracy for 22: 0.733
Num non-zero elements: 5
Test accuracy for 25: 0.788
Num non-zero elements: 5
Test accuracy for 26: 0.689
Num non-zero elements: 10
Test accuracy for 20: 0.872
Num non-zero elements: 10
Test accuracy for 21: 0.825
Num non-zero elements: 10
Test accuracy for 22: 0.742
Num non-zero elements: 10
Test accuracy for 25: 0.877
Num non-zero elements: 10
Test accuracy for 26: 0.724
Num non-zero elements: 20
Test accuracy for 20: 0.894
Num non-zero elements: 20
Test accuracy for 21: 0.843
Num non-zero elements: 20
Test accuracy for 22: 0.771
Num non-zero elements: 20
Test accuracy for 25: 0.901
Num non-zero elements: 20
Test accuracy for 26: 0.766
Num non-zero elements: 50
Test accuracy for 20: 0.909
Num non-zero elements: 50
Test accuracy for 21: 0.877
Num non-zero elements: 50
Test accuracy for 22: 0.842
Num non-zero elements: 50
Test accuracy for 25: 0.925
Num non-zero elements: 50
Test accuracy for 26: 0.823
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 21 epochs
Test accuracy for 20: 0.940000057220459
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 26 epochs
Test accuracy for 21: 0.9200000166893005
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 12 epochs
Test accuracy for 22: 0.9020000696182251
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for 25: 0.9570000171661377
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 26: 0.8740000128746033
Num non-zero elements: 1
Test accuracy for 20: 0.898
Num non-zero elements: 1
Test accuracy for 21: 0.752
Num non-zero elements: 1
Test accuracy for 22: 0.775
Num non-zero elements: 1
Test accuracy for 25: 0.852
Num non-zero elements: 1
Test accuracy for 26: 0.715
Num non-zero elements: 2
Test accuracy for 20: 0.903
Num non-zero elements: 2
Test accuracy for 21: 0.775
Num non-zero elements: 2
Test accuracy for 22: 0.84
Num non-zero elements: 2
Test accuracy for 25: 0.872
Num non-zero elements: 2
Test accuracy for 26: 0.768
Num non-zero elements: 5
Test accuracy for 20: 0.922
Num non-zero elements: 5
Test accuracy for 21: 0.813
Num non-zero elements: 5
Test accuracy for 22: 0.877
Num non-zero elements: 5
Test accuracy for 25: 0.909
Num non-zero elements: 5
Test accuracy for 26: 0.814
Num non-zero elements: 10
Test accuracy for 20: 0.925
Num non-zero elements: 10
Test accuracy for 21: 0.818
Num non-zero elements: 10
Test accuracy for 22: 0.886
Num non-zero elements: 10
Test accuracy for 25: 0.911
Num non-zero elements: 10
Test accuracy for 26: 0.846
Num non-zero elements: 20
Test accuracy for 20: 0.927
Num non-zero elements: 20
Test accuracy for 21: 0.841
Num non-zero elements: 20
Test accuracy for 22: 0.882
Num non-zero elements: 20
Test accuracy for 25: 0.936
Num non-zero elements: 20
Test accuracy for 26: 0.858
Num non-zero elements: 50
Test accuracy for 20: 0.937
Num non-zero elements: 50
Test accuracy for 21: 0.883
Num non-zero elements: 50
Test accuracy for 22: 0.891
Num non-zero elements: 50
Test accuracy for 25: 0.954
Num non-zero elements: 50
Test accuracy for 26: 0.87


  0%|          | 0/34 [00:00<?, ?it/s][A[A100%|██████████| 34/34 [00:00<00:00, 400.67it/s]


  0%|          | 0/31 [00:00<?, ?it/s][A[A100%|██████████| 31/31 [00:00<00:00, 867.88it/s]
Removing 31 from train set
Removing 0 from train set
Removing 29 from train set
Removing 28 from train set
Removing 7 from train set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  20%|██        | 1/5 [00:00<00:00,  9.62it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00,  9.80it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00,  9.94it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00,  9.95it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00,  9.90it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 38.51it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 38.16it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.18it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.13it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.52it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.48it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.08it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.78it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.56it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.40it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.30it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.23it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.18it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.46it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.93it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.11it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.70it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.46it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.30it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.20it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.09it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.98it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.11it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.92it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.07it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.65it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.40it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.26it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.09it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.05it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.92it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.92it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.91it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.06it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.89it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.03it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.61it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.36it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.11it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.05it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.01it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.95it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.94it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.93it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.89it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.89it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.89it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.89it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.89it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.88it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.88it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.88it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.88it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.88it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.88it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.87it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.87it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.87it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.86it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.01it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.82it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:03, 18.96it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.56it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.32it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.17it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.07it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.00it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 17.95it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.92it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.90it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.89it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.88it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.88it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.87it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.87it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.85it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.84it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.83it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.84it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.85it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.84it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.85it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.85it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.84it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.84it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:03<00:00, 17.84it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.83it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.84it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 14.91it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.50it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.79it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 23.24it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.72it/s][A[A

Collecting activations:  56%|█████▋    | 9/16 [00:00<00:00, 18.81it/s][A[A

Collecting activations:  69%|██████▉   | 11/16 [00:00<00:00, 18.49it/s][A[A

Collecting activations:  81%|████████▏ | 13/16 [00:00<00:00, 18.27it/s][A[A

Collecting activations:  94%|█████████▍| 15/16 [00:00<00:00, 15.32it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.57it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 26.39it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 20.58it/s][A[A

Collecting activations:  56%|█████▋    | 9/16 [00:00<00:00, 19.22it/s][A[A

Collecting activations:  69%|██████▉   | 11/16 [00:00<00:00, 18.78it/s][A[A

Collecting activations:  81%|████████▏ | 13/16 [00:00<00:00, 18.47it/s][A[A

Collecting activations:  94%|█████████▍| 15/16 [00:00<00:00, 18.27it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.97it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.01it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.01it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.57it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.30it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.14it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.03it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.97it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.26it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.37it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.43it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.51it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.54it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.29it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.13it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.05it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.45it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.70it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.20it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.67it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.37it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.17it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.04it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.98it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.32it/s]
Num non-zero elements: 2304
Test accuracy for 1: 0.92
Num non-zero elements: 2304
Test accuracy for 2: 0.899
Num non-zero elements: 2304
Test accuracy for 3: 0.895
Num non-zero elements: 2304
Test accuracy for 5: 0.89
Num non-zero elements: 2304
Test accuracy for 6: 0.815
Num non-zero elements: 1
Test accuracy for 1: 0.709
Num non-zero elements: 1
Test accuracy for 2: 0.708
Num non-zero elements: 1
Test accuracy for 3: 0.601
Num non-zero elements: 1
Test accuracy for 5: 0.7
Num non-zero elements: 1
Test accuracy for 6: 0.605
Num non-zero elements: 2
Test accuracy for 1: 0.755
Num non-zero elements: 2
Test accuracy for 2: 0.799
Num non-zero elements: 2
Test accuracy for 3: 0.607
Num non-zero elements: 2
Test accuracy for 5: 0.69
Num non-zero elements: 2
Test accuracy for 6: 0.628
Num non-zero elements: 5
Test accuracy for 1: 0.784
Num non-zero elements: 5
Test accuracy for 2: 0.805
Num non-zero elements: 5
Test accuracy for 3: 0.64
Num non-zero elements: 5
Test accuracy for 5: 0.716
Num non-zero elements: 5
Test accuracy for 6: 0.664
Num non-zero elements: 10
Test accuracy for 1: 0.833
Num non-zero elements: 10
Test accuracy for 2: 0.825
Num non-zero elements: 10
Test accuracy for 3: 0.727
Num non-zero elements: 10
Test accuracy for 5: 0.738
Num non-zero elements: 10
Test accuracy for 6: 0.731
Num non-zero elements: 20
Test accuracy for 1: 0.831
Num non-zero elements: 20
Test accuracy for 2: 0.829
Num non-zero elements: 20
Test accuracy for 3: 0.793
Num non-zero elements: 20
Test accuracy for 5: 0.764
Num non-zero elements: 20
Test accuracy for 6: 0.729
Num non-zero elements: 50
Test accuracy for 1: 0.896
Num non-zero elements: 50
Test accuracy for 2: 0.881
Num non-zero elements: 50
Test accuracy for 3: 0.843
Num non-zero elements: 50
Test accuracy for 5: 0.809
Num non-zero elements: 50
Test accuracy for 6: 0.77
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 14 epochs
Test accuracy for 1: 0.9270000457763672
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 20 epochs
Test accuracy for 2: 0.9190000295639038
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 20 epochs
Test accuracy for 3: 0.906000018119812
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 5: 0.9000000357627869
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 17 epochs
Test accuracy for 6: 0.8530000448226929
Num non-zero elements: 1
Test accuracy for 1: 0.823
Num non-zero elements: 1
Test accuracy for 2: 0.793
Num non-zero elements: 1
Test accuracy for 3: 0.597
Num non-zero elements: 1
Test accuracy for 5: 0.809
Num non-zero elements: 1
Test accuracy for 6: 0.622
Num non-zero elements: 2
Test accuracy for 1: 0.851
Num non-zero elements: 2
Test accuracy for 2: 0.783
Num non-zero elements: 2
Test accuracy for 3: 0.714
Num non-zero elements: 2
Test accuracy for 5: 0.851
Num non-zero elements: 2
Test accuracy for 6: 0.694
Num non-zero elements: 5
Test accuracy for 1: 0.88
Num non-zero elements: 5
Test accuracy for 2: 0.857
Num non-zero elements: 5
Test accuracy for 3: 0.75
Num non-zero elements: 5
Test accuracy for 5: 0.862
Num non-zero elements: 5
Test accuracy for 6: 0.709
Num non-zero elements: 10
Test accuracy for 1: 0.904
Num non-zero elements: 10
Test accuracy for 2: 0.857
Num non-zero elements: 10
Test accuracy for 3: 0.85
Num non-zero elements: 10
Test accuracy for 5: 0.892
Num non-zero elements: 10
Test accuracy for 6: 0.747
Num non-zero elements: 20
Test accuracy for 1: 0.911
Num non-zero elements: 20
Test accuracy for 2: 0.894
Num non-zero elements: 20
Test accuracy for 3: 0.875
Num non-zero elements: 20
Test accuracy for 5: 0.874
Num non-zero elements: 20
Test accuracy for 6: 0.771
Num non-zero elements: 50
Test accuracy for 1: 0.927
Num non-zero elements: 50
Test accuracy for 2: 0.905
Num non-zero elements: 50
Test accuracy for 3: 0.887
Num non-zero elements: 50
Test accuracy for 5: 0.891
Num non-zero elements: 50
Test accuracy for 6: 0.832


Tokenizing data:   0%|          | 0/2 [00:00<?, ?it/s][A[A

Tokenizing data:  50%|█████     | 1/2 [00:00<00:00,  9.66it/s][A[ATokenizing data: 100%|██████████| 2/2 [00:00<00:00,  9.93it/s]


Tokenizing data:   0%|          | 0/2 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 2/2 [00:00<00:00, 36.94it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 28.10it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.21it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.58it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.53it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.12it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.82it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.61it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.44it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.34it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.26it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.21it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.05it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.51it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.02it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.18it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.76it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.50it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.35it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.14it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.97it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.10it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.68it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.42it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.28it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.19it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.14it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.47it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.41it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.89it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.55it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.35it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.23it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.11it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.38it/s]
Num non-zero elements: 2304
Test accuracy for 1.0: 0.902
Num non-zero elements: 2304
Test accuracy for 5.0: 0.902
Num non-zero elements: 1
Test accuracy for 1.0: 0.631
Num non-zero elements: 1
Test accuracy for 5.0: 0.631
Num non-zero elements: 2
Test accuracy for 1.0: 0.654
Num non-zero elements: 2
Test accuracy for 5.0: 0.654
Num non-zero elements: 5
Test accuracy for 1.0: 0.669
Num non-zero elements: 5
Test accuracy for 5.0: 0.669
Num non-zero elements: 10
Test accuracy for 1.0: 0.764
Num non-zero elements: 10
Test accuracy for 5.0: 0.764
Num non-zero elements: 20
Test accuracy for 1.0: 0.792
Num non-zero elements: 20
Test accuracy for 5.0: 0.792
Num non-zero elements: 50
Test accuracy for 1.0: 0.829
Num non-zero elements: 50
Test accuracy for 5.0: 0.83
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 27 epochs
Test accuracy for 1.0: 0.9000000357627869
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 28 epochs
Test accuracy for 5.0: 0.9000000357627869
Num non-zero elements: 1
Test accuracy for 1.0: 0.686
Num non-zero elements: 1
Test accuracy for 5.0: 0.686
Num non-zero elements: 2
Test accuracy for 1.0: 0.714
Num non-zero elements: 2
Test accuracy for 5.0: 0.714
Num non-zero elements: 5
Test accuracy for 1.0: 0.835
Num non-zero elements: 5
Test accuracy for 5.0: 0.835
Num non-zero elements: 10
Test accuracy for 1.0: 0.877
Num non-zero elements: 10
Test accuracy for 5.0: 0.877
Num non-zero elements: 20
Test accuracy for 1.0: 0.887
Num non-zero elements: 20
Test accuracy for 5.0: 0.887
Num non-zero elements: 50
Test accuracy for 1.0: 0.902
Num non-zero elements: 50
Test accuracy for 5.0: 0.902
Loading dataset codeparrot/github-code, this usually takes ~30 seconds


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  20%|██        | 1/5 [00:01<00:07,  1.89s/it][A[A

Tokenizing data:  40%|████      | 2/5 [00:02<00:04,  1.40s/it][A[A

Tokenizing data:  60%|██████    | 3/5 [00:03<00:02,  1.24s/it][A[A

Tokenizing data:  80%|████████  | 4/5 [00:04<00:00,  1.04it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:05<00:00,  1.21it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:05<00:00,  1.02s/it]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  20%|██        | 1/5 [00:00<00:02,  1.93it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00,  3.18it/s][A[A

Tokenizing data:  60%|██████    | 3/5 [00:00<00:00,  3.31it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:01<00:00,  4.13it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:01<00:00,  4.54it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:01<00:00,  3.82it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 28.79it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.29it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.58it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.50it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.07it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.77it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.54it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.36it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.26it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.98it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.43it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 22.25it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.51it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.93it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.60it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.38it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.09it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.94it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.11it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.91it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.37it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.82it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.50it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.30it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.09it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.04it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.95it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.93it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.89it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.90it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.88it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.88it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.88it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.88it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 16.80it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.17it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.03it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 23.27it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.75it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 18.85it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.53it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.17it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.08it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 17.95it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 17.92it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 17.90it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:02, 17.88it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 17.87it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 17.86it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 17.86it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 17.85it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 17.86it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 17.85it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 17.83it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 17.84it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:01, 17.84it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 17.85it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 17.85it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 17.85it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 17.84it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 17.84it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 17.84it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.83it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.83it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.84it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.03it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 22.42it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.47it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.85it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:03, 17.22it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.54it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.33it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.03it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 17.92it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:02, 17.90it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 17.87it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 17.85it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 17.85it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 17.84it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 17.82it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 17.81it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 17.81it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 17.82it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:01, 17.81it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 17.81it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 17.81it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 17.82it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 17.82it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 17.81it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 17.80it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.80it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.80it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.82it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.97it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.75it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.54it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.88it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.49it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.24it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.08it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.46it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.02it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.31it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.72it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.39it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.06it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.98it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.36it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.50it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.44it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.82it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.44it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.21it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:01<00:00, 15.54it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 27.99it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 22.77it/s][A[A

Collecting activations:  56%|█████▋    | 9/16 [00:00<00:00, 20.13it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 19.10it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.70it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.43it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 19.49it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.94it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.91it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.45it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.20it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.04it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.93it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.87it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.17it/s]
Num non-zero elements: 2304
Test accuracy for C: 0.963
Num non-zero elements: 2304
Test accuracy for Python: 0.989
Num non-zero elements: 2304
Test accuracy for HTML: 0.984
Num non-zero elements: 2304
Test accuracy for Java: 0.956
Num non-zero elements: 2304
Test accuracy for PHP: 0.952
Num non-zero elements: 1
Test accuracy for C: 0.61
Num non-zero elements: 1
Test accuracy for Python: 0.61
Num non-zero elements: 1
Test accuracy for HTML: 0.72
Num non-zero elements: 1
Test accuracy for Java: 0.608
Num non-zero elements: 1
Test accuracy for PHP: 0.578
Num non-zero elements: 2
Test accuracy for C: 0.727
Num non-zero elements: 2
Test accuracy for Python: 0.682
Num non-zero elements: 2
Test accuracy for HTML: 0.94
Num non-zero elements: 2
Test accuracy for Java: 0.622
Num non-zero elements: 2
Test accuracy for PHP: 0.652
Num non-zero elements: 5
Test accuracy for C: 0.77
Num non-zero elements: 5
Test accuracy for Python: 0.745
Num non-zero elements: 5
Test accuracy for HTML: 0.941
Num non-zero elements: 5
Test accuracy for Java: 0.765
Num non-zero elements: 5
Test accuracy for PHP: 0.711
Num non-zero elements: 10
Test accuracy for C: 0.829
Num non-zero elements: 10
Test accuracy for Python: 0.861
Num non-zero elements: 10
Test accuracy for HTML: 0.954
Num non-zero elements: 10
Test accuracy for Java: 0.833
Num non-zero elements: 10
Test accuracy for PHP: 0.817
Num non-zero elements: 20
Test accuracy for C: 0.875
Num non-zero elements: 20
Test accuracy for Python: 0.915
Num non-zero elements: 20
Test accuracy for HTML: 0.961
Num non-zero elements: 20
Test accuracy for Java: 0.858
Num non-zero elements: 20
Test accuracy for PHP: 0.858
Num non-zero elements: 50
Test accuracy for C: 0.906
Num non-zero elements: 50
Test accuracy for Python: 0.97
Num non-zero elements: 50
Test accuracy for HTML: 0.965
Num non-zero elements: 50
Test accuracy for Java: 0.907
Num non-zero elements: 50
Test accuracy for PHP: 0.9
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 33 epochs
Test accuracy for C: 0.9590000510215759
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 22 epochs
Test accuracy for Python: 0.984000027179718
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 20 epochs
Test accuracy for HTML: 0.9890000224113464
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 26 epochs
Test accuracy for Java: 0.9660000205039978
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 21 epochs
Test accuracy for PHP: 0.9530000686645508
Num non-zero elements: 1
Test accuracy for C: 0.661
Num non-zero elements: 1
Test accuracy for Python: 0.914
Num non-zero elements: 1
Test accuracy for HTML: 0.88
Num non-zero elements: 1
Test accuracy for Java: 0.804
Num non-zero elements: 1
Test accuracy for PHP: 0.904
Num non-zero elements: 2
Test accuracy for C: 0.665
Num non-zero elements: 2
Test accuracy for Python: 0.902
Num non-zero elements: 2
Test accuracy for HTML: 0.94
Num non-zero elements: 2
Test accuracy for Java: 0.803
Num non-zero elements: 2
Test accuracy for PHP: 0.905
Num non-zero elements: 5
Test accuracy for C: 0.872
Num non-zero elements: 5
Test accuracy for Python: 0.949
Num non-zero elements: 5
Test accuracy for HTML: 0.948
Num non-zero elements: 5
Test accuracy for Java: 0.91
Num non-zero elements: 5
Test accuracy for PHP: 0.907
Num non-zero elements: 10
Test accuracy for C: 0.896
Num non-zero elements: 10
Test accuracy for Python: 0.968
Num non-zero elements: 10
Test accuracy for HTML: 0.951
Num non-zero elements: 10
Test accuracy for Java: 0.918
Num non-zero elements: 10
Test accuracy for PHP: 0.922
Num non-zero elements: 20
Test accuracy for C: 0.931
Num non-zero elements: 20
Test accuracy for Python: 0.975
Num non-zero elements: 20
Test accuracy for HTML: 0.955
Num non-zero elements: 20
Test accuracy for Java: 0.914
Num non-zero elements: 20
Test accuracy for PHP: 0.915
Num non-zero elements: 50
Test accuracy for C: 0.928
Num non-zero elements: 50
Test accuracy for Python: 0.979
Num non-zero elements: 50
Test accuracy for HTML: 0.976
Num non-zero elements: 50
Test accuracy for Java: 0.944
Num non-zero elements: 50
Test accuracy for PHP: 0.925


Tokenizing data:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Tokenizing data:  25%|██▌       | 1/4 [00:00<00:00,  4.11it/s][A[A

Tokenizing data:  75%|███████▌  | 3/4 [00:00<00:00,  8.65it/s][A[ATokenizing data: 100%|██████████| 4/4 [00:00<00:00,  8.76it/s]


Tokenizing data:   0%|          | 0/4 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 4/4 [00:00<00:00, 49.15it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 28.84it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.33it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.68it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.62it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 19.08it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.85it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:00<00:02, 18.66it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.53it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.44it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.38it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.33it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.29it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.27it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.26it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.24it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 18.22it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.21it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.21it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.21it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.21it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.21it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.21it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.20it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.21it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 18.19it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.19it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.19it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.19it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.20it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.63it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.34it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.35it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.91it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.66it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.50it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.40it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.34it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.25it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.23it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.21it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.20it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.18it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.16it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.17it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.14it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.15it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.17it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.16it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.16it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.16it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.16it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.30it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.14it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.28it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.86it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.60it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.46it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.36it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.28it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.19it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.08it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.23it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.06it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.20it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.78it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.52it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.37it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.27it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.17it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.18it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.05it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.17it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.75it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.50it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.34it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.24it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.18it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.52it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.45it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.95it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.60it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.41it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.28it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.20it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.17it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.43it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.42it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.93it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.59it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.40it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.27it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.19it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.15it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.43it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.41it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.91it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.57it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.37it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.25it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.13it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.40it/s]
Num non-zero elements: 2304
Test accuracy for 0: 0.922
Num non-zero elements: 2304
Test accuracy for 1: 0.981
Num non-zero elements: 2304
Test accuracy for 2: 0.897
Num non-zero elements: 2304
Test accuracy for 3: 0.928
Num non-zero elements: 1
Test accuracy for 0: 0.766
Num non-zero elements: 1
Test accuracy for 1: 0.685
Num non-zero elements: 1
Test accuracy for 2: 0.665
Num non-zero elements: 1
Test accuracy for 3: 0.782
Num non-zero elements: 2
Test accuracy for 0: 0.789
Num non-zero elements: 2
Test accuracy for 1: 0.809
Num non-zero elements: 2
Test accuracy for 2: 0.682
Num non-zero elements: 2
Test accuracy for 3: 0.805
Num non-zero elements: 5
Test accuracy for 0: 0.879
Num non-zero elements: 5
Test accuracy for 1: 0.869
Num non-zero elements: 5
Test accuracy for 2: 0.776
Num non-zero elements: 5
Test accuracy for 3: 0.839
Num non-zero elements: 10
Test accuracy for 0: 0.887
Num non-zero elements: 10
Test accuracy for 1: 0.952
Num non-zero elements: 10
Test accuracy for 2: 0.811
Num non-zero elements: 10
Test accuracy for 3: 0.846
Num non-zero elements: 20
Test accuracy for 0: 0.896
Num non-zero elements: 20
Test accuracy for 1: 0.965
Num non-zero elements: 20
Test accuracy for 2: 0.861
Num non-zero elements: 20
Test accuracy for 3: 0.897
Num non-zero elements: 50
Test accuracy for 0: 0.912
Num non-zero elements: 50
Test accuracy for 1: 0.967
Num non-zero elements: 50
Test accuracy for 2: 0.878
Num non-zero elements: 50
Test accuracy for 3: 0.902
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 0: 0.9320000410079956
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 17 epochs
Test accuracy for 1: 0.9790000319480896
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 14 epochs
Test accuracy for 2: 0.9270000457763672
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for 3: 0.9450000524520874
Num non-zero elements: 1
Test accuracy for 0: 0.725
Num non-zero elements: 1
Test accuracy for 1: 0.959
Num non-zero elements: 1
Test accuracy for 2: 0.764
Num non-zero elements: 1
Test accuracy for 3: 0.69
Num non-zero elements: 2
Test accuracy for 0: 0.803
Num non-zero elements: 2
Test accuracy for 1: 0.96
Num non-zero elements: 2
Test accuracy for 2: 0.835
Num non-zero elements: 2
Test accuracy for 3: 0.763
Num non-zero elements: 5
Test accuracy for 0: 0.852
Num non-zero elements: 5
Test accuracy for 1: 0.959
Num non-zero elements: 5
Test accuracy for 2: 0.847
Num non-zero elements: 5
Test accuracy for 3: 0.867
Num non-zero elements: 10
Test accuracy for 0: 0.881
Num non-zero elements: 10
Test accuracy for 1: 0.967
Num non-zero elements: 10
Test accuracy for 2: 0.855
Num non-zero elements: 10
Test accuracy for 3: 0.868
Num non-zero elements: 20
Test accuracy for 0: 0.907
Num non-zero elements: 20
Test accuracy for 1: 0.965
Num non-zero elements: 20
Test accuracy for 2: 0.86
Num non-zero elements: 20
Test accuracy for 3: 0.894
Num non-zero elements: 50
Test accuracy for 0: 0.92
Num non-zero elements: 50
Test accuracy for 1: 0.979
Num non-zero elements: 50
Test accuracy for 2: 0.892
Num non-zero elements: 50
Test accuracy for 3: 0.914
Loading dataset Helsinki-NLP/europarl, this usually takes ~10 seconds


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 14.70it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 14.41it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 14.46it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 53.77it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.14it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.08it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.54it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.52it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.13it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.85it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.64it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.47it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.37it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.31it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.26it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:02, 16.82it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.57it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.45it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.36it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 18.28it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.23it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.20it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.17it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.15it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.11it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.11it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.11it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.13it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.51it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 23.41it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.97it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 19.07it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:03, 14.57it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 17.31it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 17.52it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:01<00:02, 17.68it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.80it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.87it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.93it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:02<00:02, 11.53it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 14.53it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 15.33it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 16.00it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:01, 16.52it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 16.93it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 17.23it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:03<00:00, 17.45it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:03<00:00, 15.53it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.02it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.09it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 22.07it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.46it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.91it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.60it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.40it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.27it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.12it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 16.16it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 18.48it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.34it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.24it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.17it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.02it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.14it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.84it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.37it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.85it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.55it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.37it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:01<00:02, 15.79it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.29it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.20it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 17.92it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.92it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.93it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.03it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 23.36it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.81it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 18.90it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.58it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.38it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:02, 17.95it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 16.95it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.18it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 15.73it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.14it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.04it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 23.42it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.83it/s][A[A

Collecting activations:  56%|█████▋    | 9/16 [00:00<00:00, 18.89it/s][A[A

Collecting activations:  69%|██████▉   | 11/16 [00:00<00:00, 18.57it/s][A[A

Collecting activations:  81%|████████▏ | 13/16 [00:00<00:00, 18.35it/s][A[A

Collecting activations:  94%|█████████▍| 15/16 [00:00<00:00, 18.20it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.72it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.95it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.00it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.58it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.31it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.17it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.30it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.87it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.32it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.76it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.46it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.14it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 16.60it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.79it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 26.90it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 21.36it/s][A[A

Collecting activations:  56%|█████▋    | 9/16 [00:00<00:00, 19.59it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.85it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.57it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.37it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 19.15it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.56it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.21it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.70it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.41it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.11it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.36it/s]
Num non-zero elements: 2304
Test accuracy for en: 0.997
Num non-zero elements: 2304
Test accuracy for fr: 1.0
Num non-zero elements: 2304
Test accuracy for de: 1.0
Num non-zero elements: 2304
Test accuracy for es: 1.0
Num non-zero elements: 2304
Test accuracy for nl: 1.0
Num non-zero elements: 1
Test accuracy for en: 0.935
Num non-zero elements: 1
Test accuracy for fr: 0.647
Num non-zero elements: 1
Test accuracy for de: 0.807
Num non-zero elements: 1
Test accuracy for es: 0.878
Num non-zero elements: 1
Test accuracy for nl: 0.849
Num non-zero elements: 2
Test accuracy for en: 0.982
Num non-zero elements: 2
Test accuracy for fr: 0.9
Num non-zero elements: 2
Test accuracy for de: 0.835
Num non-zero elements: 2
Test accuracy for es: 0.896
Num non-zero elements: 2
Test accuracy for nl: 0.883
Num non-zero elements: 5
Test accuracy for en: 0.994
Num non-zero elements: 5
Test accuracy for fr: 0.975
Num non-zero elements: 5
Test accuracy for de: 0.884
Num non-zero elements: 5
Test accuracy for es: 0.98
Num non-zero elements: 5
Test accuracy for nl: 0.955
Num non-zero elements: 10
Test accuracy for en: 0.996
Num non-zero elements: 10
Test accuracy for fr: 0.988
Num non-zero elements: 10
Test accuracy for de: 0.974
Num non-zero elements: 10
Test accuracy for es: 0.986
Num non-zero elements: 10
Test accuracy for nl: 0.972
Num non-zero elements: 20
Test accuracy for en: 0.997
Num non-zero elements: 20
Test accuracy for fr: 0.995
Num non-zero elements: 20
Test accuracy for de: 0.99
Num non-zero elements: 20
Test accuracy for es: 0.996
Num non-zero elements: 20
Test accuracy for nl: 0.983
Num non-zero elements: 50
Test accuracy for en: 0.997
Num non-zero elements: 50
Test accuracy for fr: 1.0
Num non-zero elements: 50
Test accuracy for de: 0.996
Num non-zero elements: 50
Test accuracy for es: 0.999
Num non-zero elements: 50
Test accuracy for nl: 0.993
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 12 epochs
Test accuracy for en: 0.999000072479248
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for fr: 1.0
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for de: 0.9980000257492065
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 22 epochs
Test accuracy for es: 0.999000072479248
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for nl: 0.999000072479248
Num non-zero elements: 1
Test accuracy for en: 0.992
Num non-zero elements: 1
Test accuracy for fr: 0.861
Num non-zero elements: 1
Test accuracy for de: 0.753
Num non-zero elements: 1
Test accuracy for es: 0.94
Num non-zero elements: 1
Test accuracy for nl: 0.905
Num non-zero elements: 2
Test accuracy for en: 0.999
Num non-zero elements: 2
Test accuracy for fr: 0.996
Num non-zero elements: 2
Test accuracy for de: 0.853
Num non-zero elements: 2
Test accuracy for es: 0.988
Num non-zero elements: 2
Test accuracy for nl: 0.999
Num non-zero elements: 5
Test accuracy for en: 0.999
Num non-zero elements: 5
Test accuracy for fr: 0.997
Num non-zero elements: 5
Test accuracy for de: 0.993
Num non-zero elements: 5
Test accuracy for es: 0.99
Num non-zero elements: 5
Test accuracy for nl: 1.0
Num non-zero elements: 10
Test accuracy for en: 0.999
Num non-zero elements: 10
Test accuracy for fr: 0.997
Num non-zero elements: 10
Test accuracy for de: 0.998
Num non-zero elements: 10
Test accuracy for es: 0.997
Num non-zero elements: 10
Test accuracy for nl: 0.998
Num non-zero elements: 20
Test accuracy for en: 0.998
Num non-zero elements: 20
Test accuracy for fr: 0.997
Num non-zero elements: 20
Test accuracy for de: 0.999
Num non-zero elements: 20
Test accuracy for es: 0.997
Num non-zero elements: 20
Test accuracy for nl: 0.999
Num non-zero elements: 50
Test accuracy for en: 0.999
Num non-zero elements: 50
Test accuracy for fr: 0.996
Num non-zero elements: 50
Test accuracy for de: 1.0
Num non-zero elements: 50
Test accuracy for es: 0.999
Num non-zero elements: 50
Test accuracy for nl: 0.998

Running SAE evaluation on all selected SAEs: 100%|██████████| 1/1 [17:40<00:00, 1060.24s/it][ARunning SAE evaluation on all selected SAEs: 100%|██████████| 1/1 [17:40<00:00, 1060.24s/it]
Evaluations: 100%|██████████| 1/1 [17:53<00:00, 1073.83s/it]Evaluations: 100%|██████████| 1/1 [17:53<00:00, 1073.83s/it]
/share/u/can/SAEBench/custom_saes/topk_sae.py:110: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  pt_params = t.load(path_to_params)
Loaded config: {'trainer': {'trainer_class': 'TrainerTopKAdditivity', 'dict_class': 'AutoEncoderTopK', 'lr': 0.000282842712474619, 'steps': 48828, 'seed': 0, 'activation_dim': 2304, 'dict_size': 8192, 'k': 125, 'auxk_alpha': 0.03125, 'additivity_coeff': 0.0, 'intersection_coeff': 0.0, 'device': 'cuda:0', 'layer': 4, 'lm_name': 'google/gemma-2-2b', 'wandb_name': 'TopKTrainer_Additivity-google/gemma-2-2b-resid_post_layer_4-add_coeff-0.0-inters_coeff-0.0', 'submodule_name': 'resid_post_layer_4'}, 'buffer': {'d_submodule': 2304, 'io': 'out', 'n_ctxs': 8192, 'ctx_len': 128, 'refresh_batch_size': 32, 'out_batch_size': 2048, 'device': 'cuda:0'}}
Original keys in state_dict: odict_keys(['b_dec', 'encoder.weight', 'encoder.bias', 'decoder.weight'])
Renamed keys in state_dict: dict_keys(['b_dec', 'W_enc', 'b_enc', 'W_dec'])
Evaluations:   0%|          | 0/1 [00:00<?, ?it/s]


Running sparse_probing evaluation




Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s][A
Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:01,  1.55it/s][A
Loading checkpoint shards:  67%|██████▋   | 2/3 [00:01<00:00,  1.61it/s][A
Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.31it/s][ALoading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.06it/s]
Loaded pretrained model gemma-2-2b into HookedTransformer

Running SAE evaluation on all selected SAEs:   0%|          | 0/1 [00:00<?, ?it/s][A

  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 635.03it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 1043.44it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 12.41it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 12.87it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 12.81it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 49.68it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 49.39it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 26.12it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 22.95it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.47it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.48it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.09it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.81it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.61it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.45it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.35it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.28it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.24it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.20it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.09it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.51it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.33it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.29it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.83it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.57it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.41it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.30it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.23it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.02it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.19it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.27it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.26it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.81it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.53it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.36it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.26it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.13it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.96it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.13it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.18it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.19it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.74it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.48it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.20it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.12it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.08it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.94it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.09it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.16it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.14it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.69it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.44it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.07it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.03it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.91it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.91it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.92it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.92it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.89it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.89it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.89it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.90it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.91it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.05it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.10it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.12it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.66it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.39it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.22it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.07it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.42it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.36it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.84it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.48it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.28it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.13it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.04it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.26it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.99it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.04it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.60it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.32it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.05it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.31it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.41it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.19it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.69it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.40it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.22it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.10it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.38it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.63it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.22it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.70it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.39it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.20it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.08it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.36it/s]
Num non-zero elements: 2304
Test accuracy for 0: 0.925
Num non-zero elements: 2304
Test accuracy for 1: 0.943
Num non-zero elements: 2304
Test accuracy for 2: 0.947
Num non-zero elements: 2304
Test accuracy for 6: 0.991
Num non-zero elements: 2304
Test accuracy for 9: 0.971
Num non-zero elements: 1
Test accuracy for 0: 0.603
Num non-zero elements: 1
Test accuracy for 1: 0.648
Num non-zero elements: 1
Test accuracy for 2: 0.731
Num non-zero elements: 1
Test accuracy for 6: 0.773
Num non-zero elements: 1
Test accuracy for 9: 0.68
Num non-zero elements: 2
Test accuracy for 0: 0.682
Num non-zero elements: 2
Test accuracy for 1: 0.655
Num non-zero elements: 2
Test accuracy for 2: 0.744
Num non-zero elements: 2
Test accuracy for 6: 0.771
Num non-zero elements: 2
Test accuracy for 9: 0.772
Num non-zero elements: 5
Test accuracy for 0: 0.768
Num non-zero elements: 5
Test accuracy for 1: 0.69
Num non-zero elements: 5
Test accuracy for 2: 0.754
Num non-zero elements: 5
Test accuracy for 6: 0.905
Num non-zero elements: 5
Test accuracy for 9: 0.798
Num non-zero elements: 10
Test accuracy for 0: 0.797
Num non-zero elements: 10
Test accuracy for 1: 0.818
Num non-zero elements: 10
Test accuracy for 2: 0.83
Num non-zero elements: 10
Test accuracy for 6: 0.929
Num non-zero elements: 10
Test accuracy for 9: 0.912
Num non-zero elements: 20
Test accuracy for 0: 0.796
Num non-zero elements: 20
Test accuracy for 1: 0.867
Num non-zero elements: 20
Test accuracy for 2: 0.847
Num non-zero elements: 20
Test accuracy for 6: 0.96
Num non-zero elements: 20
Test accuracy for 9: 0.945
Num non-zero elements: 50
Test accuracy for 0: 0.862
Num non-zero elements: 50
Test accuracy for 1: 0.905
Num non-zero elements: 50
Test accuracy for 2: 0.897
Num non-zero elements: 50
Test accuracy for 6: 0.977
Num non-zero elements: 50
Test accuracy for 9: 0.948
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 17 epochs
Test accuracy for 0: 0.9430000185966492
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 21 epochs
Test accuracy for 1: 0.9620000720024109
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for 2: 0.9440000653266907
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for 6: 0.9900000691413879
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for 9: 0.971000075340271
Num non-zero elements: 1
Test accuracy for 0: 0.682
Num non-zero elements: 1
Test accuracy for 1: 0.838
Num non-zero elements: 1
Test accuracy for 2: 0.853
Num non-zero elements: 1
Test accuracy for 6: 0.965
Num non-zero elements: 1
Test accuracy for 9: 0.934
Num non-zero elements: 2
Test accuracy for 0: 0.663
Num non-zero elements: 2
Test accuracy for 1: 0.856
Num non-zero elements: 2
Test accuracy for 2: 0.859
Num non-zero elements: 2
Test accuracy for 6: 0.966
Num non-zero elements: 2
Test accuracy for 9: 0.945
Num non-zero elements: 5
Test accuracy for 0: 0.861
Num non-zero elements: 5
Test accuracy for 1: 0.86
Num non-zero elements: 5
Test accuracy for 2: 0.888
Num non-zero elements: 5
Test accuracy for 6: 0.986
Num non-zero elements: 5
Test accuracy for 9: 0.948
Num non-zero elements: 10
Test accuracy for 0: 0.867
Num non-zero elements: 10
Test accuracy for 1: 0.924
Num non-zero elements: 10
Test accuracy for 2: 0.897
Num non-zero elements: 10
Test accuracy for 6: 0.985
Num non-zero elements: 10
Test accuracy for 9: 0.944
Num non-zero elements: 20
Test accuracy for 0: 0.893
Num non-zero elements: 20
Test accuracy for 1: 0.948
Num non-zero elements: 20
Test accuracy for 2: 0.906
Num non-zero elements: 20
Test accuracy for 6: 0.988
Num non-zero elements: 20
Test accuracy for 9: 0.963
Num non-zero elements: 50
Test accuracy for 0: 0.912
Num non-zero elements: 50
Test accuracy for 1: 0.96
Num non-zero elements: 50
Test accuracy for 2: 0.925
Num non-zero elements: 50
Test accuracy for 6: 0.991
Num non-zero elements: 50
Test accuracy for 9: 0.965


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 641.11it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 1037.16it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 12.85it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 12.78it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 12.82it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 46.33it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 46.08it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 26.96it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.14it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.57it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.53it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.13it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.84it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.63it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.46it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.36it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.29it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.25it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.21it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.53it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.24it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.27it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.82it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.55it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.39it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.22it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:01<00:03, 14.71it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 17.46it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 17.62it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 17.75it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:02, 17.84it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.06it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.97it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.16it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.22it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.78it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.51it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.35it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.17it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.12it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.98it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.13it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.00it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.11it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.69it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.44it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.12it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.09it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.95it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.09it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.92it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.06it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.65it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.41it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.26it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.17it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.09it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.04it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.92it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.93it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.06it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.88it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.98it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.56it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.32it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.06it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.35it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.28it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.79it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.44it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.24it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.11it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.02it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.98it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.26it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.28it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.79it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.44it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.24it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.11it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.03it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.98it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.26it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.30it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.77it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.43it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.23it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.10it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.02it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.98it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.25it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.25it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.75it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.41it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.21it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.09it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.02it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.98it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.25it/s]
Num non-zero elements: 2304
Test accuracy for 11: 0.949
Num non-zero elements: 2304
Test accuracy for 13: 0.934
Num non-zero elements: 2304
Test accuracy for 14: 0.946
Num non-zero elements: 2304
Test accuracy for 18: 0.915
Num non-zero elements: 2304
Test accuracy for 19: 0.964
Num non-zero elements: 1
Test accuracy for 11: 0.714
Num non-zero elements: 1
Test accuracy for 13: 0.702
Num non-zero elements: 1
Test accuracy for 14: 0.656
Num non-zero elements: 1
Test accuracy for 18: 0.692
Num non-zero elements: 1
Test accuracy for 19: 0.791
Num non-zero elements: 2
Test accuracy for 11: 0.774
Num non-zero elements: 2
Test accuracy for 13: 0.692
Num non-zero elements: 2
Test accuracy for 14: 0.688
Num non-zero elements: 2
Test accuracy for 18: 0.721
Num non-zero elements: 2
Test accuracy for 19: 0.795
Num non-zero elements: 5
Test accuracy for 11: 0.841
Num non-zero elements: 5
Test accuracy for 13: 0.784
Num non-zero elements: 5
Test accuracy for 14: 0.728
Num non-zero elements: 5
Test accuracy for 18: 0.722
Num non-zero elements: 5
Test accuracy for 19: 0.833
Num non-zero elements: 10
Test accuracy for 11: 0.869
Num non-zero elements: 10
Test accuracy for 13: 0.857
Num non-zero elements: 10
Test accuracy for 14: 0.807
Num non-zero elements: 10
Test accuracy for 18: 0.756
Num non-zero elements: 10
Test accuracy for 19: 0.844
Num non-zero elements: 20
Test accuracy for 11: 0.899
Num non-zero elements: 20
Test accuracy for 13: 0.871
Num non-zero elements: 20
Test accuracy for 14: 0.867
Num non-zero elements: 20
Test accuracy for 18: 0.764
Num non-zero elements: 20
Test accuracy for 19: 0.911
Num non-zero elements: 50
Test accuracy for 11: 0.929
Num non-zero elements: 50
Test accuracy for 13: 0.896
Num non-zero elements: 50
Test accuracy for 14: 0.889
Num non-zero elements: 50
Test accuracy for 18: 0.824
Num non-zero elements: 50
Test accuracy for 19: 0.933
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 14 epochs
Test accuracy for 11: 0.9540000557899475
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 27 epochs
Test accuracy for 13: 0.9520000219345093
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 14: 0.9550000429153442
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 20 epochs
Test accuracy for 18: 0.9150000214576721
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 35 epochs
Test accuracy for 19: 0.968000054359436
Num non-zero elements: 1
Test accuracy for 11: 0.727
Num non-zero elements: 1
Test accuracy for 13: 0.722
Num non-zero elements: 1
Test accuracy for 14: 0.916
Num non-zero elements: 1
Test accuracy for 18: 0.729
Num non-zero elements: 1
Test accuracy for 19: 0.858
Num non-zero elements: 2
Test accuracy for 11: 0.843
Num non-zero elements: 2
Test accuracy for 13: 0.72
Num non-zero elements: 2
Test accuracy for 14: 0.916
Num non-zero elements: 2
Test accuracy for 18: 0.718
Num non-zero elements: 2
Test accuracy for 19: 0.868
Num non-zero elements: 5
Test accuracy for 11: 0.914
Num non-zero elements: 5
Test accuracy for 13: 0.805
Num non-zero elements: 5
Test accuracy for 14: 0.902
Num non-zero elements: 5
Test accuracy for 18: 0.873
Num non-zero elements: 5
Test accuracy for 19: 0.86
Num non-zero elements: 10
Test accuracy for 11: 0.931
Num non-zero elements: 10
Test accuracy for 13: 0.858
Num non-zero elements: 10
Test accuracy for 14: 0.911
Num non-zero elements: 10
Test accuracy for 18: 0.9
Num non-zero elements: 10
Test accuracy for 19: 0.879
Num non-zero elements: 20
Test accuracy for 11: 0.927
Num non-zero elements: 20
Test accuracy for 13: 0.909
Num non-zero elements: 20
Test accuracy for 14: 0.925
Num non-zero elements: 20
Test accuracy for 18: 0.916
Num non-zero elements: 20
Test accuracy for 19: 0.916
Num non-zero elements: 50
Test accuracy for 11: 0.945
Num non-zero elements: 50
Test accuracy for 13: 0.943
Num non-zero elements: 50
Test accuracy for 14: 0.962
Num non-zero elements: 50
Test accuracy for 18: 0.906
Num non-zero elements: 50
Test accuracy for 19: 0.949


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 640.67it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 945.74it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 12.32it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00,  7.54it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00,  8.63it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 47.23it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 46.35it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 26.47it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 22.84it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.43it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.47it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.10it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.82it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.63it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.47it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.36it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.29it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.24it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.21it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 16.33it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.65it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.51it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 18.39it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.31it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.25it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.21it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.19it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.50it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 23.20it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.93it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 19.05it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.76it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.57it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.43it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.33it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.26it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.21it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.18it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.29it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.18it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.25it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.82it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 17.77it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.54it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.41it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.30it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.24it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.19it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.05it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.16it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 23.79it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 20.04it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 19.07it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.73it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.51it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.37it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.18it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 23.19it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.81it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 18.92it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.62it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.42it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.28it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.96it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.13it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 23.84it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.98it/s][A[A

Collecting activations:  56%|█████▋    | 9/16 [00:00<00:00, 18.97it/s][A[A

Collecting activations:  69%|██████▉   | 11/16 [00:00<00:00, 18.63it/s][A[A

Collecting activations:  81%|████████▏ | 13/16 [00:00<00:00, 18.29it/s][A[A

Collecting activations:  94%|█████████▍| 15/16 [00:00<00:00, 18.31it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.80it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.23it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.15it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.68it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.41it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.25it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.13it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.08it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:01<00:00, 15.48it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 27.25it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 22.84it/s][A[A

Collecting activations:  56%|█████▋    | 9/16 [00:00<00:00, 20.30it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 19.29it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.91it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.64it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 19.56it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.65it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.57it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.93it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.57it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.35it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.20it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.13it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.53it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 23.83it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.94it/s][A[A

Collecting activations:  56%|█████▋    | 9/16 [00:00<00:00, 18.94it/s][A[A

Collecting activations:  69%|██████▉   | 11/16 [00:00<00:00, 18.61it/s][A[A

Collecting activations:  81%|████████▏ | 13/16 [00:00<00:00, 18.39it/s][A[A

Collecting activations:  94%|█████████▍| 15/16 [00:00<00:00, 18.24it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.77it/s]
Num non-zero elements: 2304
Test accuracy for 20: 0.928
Num non-zero elements: 2304
Test accuracy for 21: 0.908
Num non-zero elements: 2304
Test accuracy for 22: 0.885
Num non-zero elements: 2304
Test accuracy for 25: 0.954
Num non-zero elements: 2304
Test accuracy for 26: 0.858
Num non-zero elements: 1
Test accuracy for 20: 0.735
Num non-zero elements: 1
Test accuracy for 21: 0.621
Num non-zero elements: 1
Test accuracy for 22: 0.632
Num non-zero elements: 1
Test accuracy for 25: 0.702
Num non-zero elements: 1
Test accuracy for 26: 0.648
Num non-zero elements: 2
Test accuracy for 20: 0.802
Num non-zero elements: 2
Test accuracy for 21: 0.66
Num non-zero elements: 2
Test accuracy for 22: 0.604
Num non-zero elements: 2
Test accuracy for 25: 0.717
Num non-zero elements: 2
Test accuracy for 26: 0.661
Num non-zero elements: 5
Test accuracy for 20: 0.86
Num non-zero elements: 5
Test accuracy for 21: 0.748
Num non-zero elements: 5
Test accuracy for 22: 0.735
Num non-zero elements: 5
Test accuracy for 25: 0.787
Num non-zero elements: 5
Test accuracy for 26: 0.691
Num non-zero elements: 10
Test accuracy for 20: 0.871
Num non-zero elements: 10
Test accuracy for 21: 0.835
Num non-zero elements: 10
Test accuracy for 22: 0.748
Num non-zero elements: 10
Test accuracy for 25: 0.874
Num non-zero elements: 10
Test accuracy for 26: 0.709
Num non-zero elements: 20
Test accuracy for 20: 0.897
Num non-zero elements: 20
Test accuracy for 21: 0.848
Num non-zero elements: 20
Test accuracy for 22: 0.776
Num non-zero elements: 20
Test accuracy for 25: 0.894
Num non-zero elements: 20
Test accuracy for 26: 0.771
Num non-zero elements: 50
Test accuracy for 20: 0.91
Num non-zero elements: 50
Test accuracy for 21: 0.865
Num non-zero elements: 50
Test accuracy for 22: 0.842
Num non-zero elements: 50
Test accuracy for 25: 0.931
Num non-zero elements: 50
Test accuracy for 26: 0.837
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 24 epochs
Test accuracy for 20: 0.9500000476837158
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 14 epochs
Test accuracy for 21: 0.9000000357627869
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for 22: 0.9030000567436218
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 14 epochs
Test accuracy for 25: 0.9540000557899475
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 20 epochs
Test accuracy for 26: 0.8830000162124634
Num non-zero elements: 1
Test accuracy for 20: 0.892
Num non-zero elements: 1
Test accuracy for 21: 0.682
Num non-zero elements: 1
Test accuracy for 22: 0.827
Num non-zero elements: 1
Test accuracy for 25: 0.845
Num non-zero elements: 1
Test accuracy for 26: 0.729
Num non-zero elements: 2
Test accuracy for 20: 0.9
Num non-zero elements: 2
Test accuracy for 21: 0.763
Num non-zero elements: 2
Test accuracy for 22: 0.859
Num non-zero elements: 2
Test accuracy for 25: 0.871
Num non-zero elements: 2
Test accuracy for 26: 0.705
Num non-zero elements: 5
Test accuracy for 20: 0.918
Num non-zero elements: 5
Test accuracy for 21: 0.762
Num non-zero elements: 5
Test accuracy for 22: 0.876
Num non-zero elements: 5
Test accuracy for 25: 0.89
Num non-zero elements: 5
Test accuracy for 26: 0.794
Num non-zero elements: 10
Test accuracy for 20: 0.932
Num non-zero elements: 10
Test accuracy for 21: 0.825
Num non-zero elements: 10
Test accuracy for 22: 0.881
Num non-zero elements: 10
Test accuracy for 25: 0.894
Num non-zero elements: 10
Test accuracy for 26: 0.806
Num non-zero elements: 20
Test accuracy for 20: 0.918
Num non-zero elements: 20
Test accuracy for 21: 0.852
Num non-zero elements: 20
Test accuracy for 22: 0.885
Num non-zero elements: 20
Test accuracy for 25: 0.93
Num non-zero elements: 20
Test accuracy for 26: 0.851
Num non-zero elements: 50
Test accuracy for 20: 0.934
Num non-zero elements: 50
Test accuracy for 21: 0.872
Num non-zero elements: 50
Test accuracy for 22: 0.886
Num non-zero elements: 50
Test accuracy for 25: 0.942
Num non-zero elements: 50
Test accuracy for 26: 0.872


  0%|          | 0/34 [00:00<?, ?it/s][A[A100%|██████████| 34/34 [00:00<00:00, 400.97it/s]


  0%|          | 0/31 [00:00<?, ?it/s][A[A100%|██████████| 31/31 [00:00<00:00, 868.16it/s]
Removing 31 from train set
Removing 0 from train set
Removing 29 from train set
Removing 28 from train set
Removing 7 from train set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  20%|██        | 1/5 [00:00<00:00,  9.72it/s][A[A

Tokenizing data:  60%|██████    | 3/5 [00:00<00:00,  9.95it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 10.01it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00,  9.97it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 37.63it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 37.78it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 26.99it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.03it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.47it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.45it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.06it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.77it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.57it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.38it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.28it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.22it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.06it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.47it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.07it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.19it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.75it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.51it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.36it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.26it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.15it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.00it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.13it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.71it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.47it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.15it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.10it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 16.84it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.06it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 22.57it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.59it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.96it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.60it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.39it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.08it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 16.80it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 18.24it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.16it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 17.70it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 17.66it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.96it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.08it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 23.31it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.80it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 18.88it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.58it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:03, 16.54it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.72it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.49it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.32it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.20it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.91it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.91it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.89it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.89it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.89it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.88it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.89it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.88it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.88it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.88it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.88it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.87it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.09it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.16it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 17.52it/s][A[A

Collecting activations:  56%|█████▋    | 9/16 [00:00<00:00, 18.64it/s][A[A

Collecting activations:  69%|██████▉   | 11/16 [00:00<00:00, 18.38it/s][A[A

Collecting activations:  81%|████████▏ | 13/16 [00:00<00:00, 18.21it/s][A[A

Collecting activations:  94%|█████████▍| 15/16 [00:00<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.34it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.17it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.05it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 15.49it/s][A[A

Collecting activations:  69%|██████▉   | 11/16 [00:00<00:00, 18.23it/s][A[A

Collecting activations:  81%|████████▏ | 13/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations:  94%|█████████▍| 15/16 [00:00<00:00, 18.05it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.00it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.12it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.72it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.38it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.99it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.95it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 16.08it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 29.56it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 23.07it/s][A[A

Collecting activations:  56%|█████▋    | 9/16 [00:00<00:00, 20.36it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 19.28it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.86it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.57it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 19.63it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.84it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.27it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.72it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.39it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.19it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.38it/s]
Num non-zero elements: 2304
Test accuracy for 1: 0.935
Num non-zero elements: 2304
Test accuracy for 2: 0.916
Num non-zero elements: 2304
Test accuracy for 3: 0.886
Num non-zero elements: 2304
Test accuracy for 5: 0.903
Num non-zero elements: 2304
Test accuracy for 6: 0.846
Num non-zero elements: 1
Test accuracy for 1: 0.716
Num non-zero elements: 1
Test accuracy for 2: 0.701
Num non-zero elements: 1
Test accuracy for 3: 0.619
Num non-zero elements: 1
Test accuracy for 5: 0.706
Num non-zero elements: 1
Test accuracy for 6: 0.627
Num non-zero elements: 2
Test accuracy for 1: 0.741
Num non-zero elements: 2
Test accuracy for 2: 0.793
Num non-zero elements: 2
Test accuracy for 3: 0.618
Num non-zero elements: 2
Test accuracy for 5: 0.678
Num non-zero elements: 2
Test accuracy for 6: 0.626
Num non-zero elements: 5
Test accuracy for 1: 0.789
Num non-zero elements: 5
Test accuracy for 2: 0.815
Num non-zero elements: 5
Test accuracy for 3: 0.625
Num non-zero elements: 5
Test accuracy for 5: 0.716
Num non-zero elements: 5
Test accuracy for 6: 0.691
Num non-zero elements: 10
Test accuracy for 1: 0.837
Num non-zero elements: 10
Test accuracy for 2: 0.817
Num non-zero elements: 10
Test accuracy for 3: 0.735
Num non-zero elements: 10
Test accuracy for 5: 0.753
Num non-zero elements: 10
Test accuracy for 6: 0.724
Num non-zero elements: 20
Test accuracy for 1: 0.84
Num non-zero elements: 20
Test accuracy for 2: 0.838
Num non-zero elements: 20
Test accuracy for 3: 0.784
Num non-zero elements: 20
Test accuracy for 5: 0.742
Num non-zero elements: 20
Test accuracy for 6: 0.733
Num non-zero elements: 50
Test accuracy for 1: 0.887
Num non-zero elements: 50
Test accuracy for 2: 0.864
Num non-zero elements: 50
Test accuracy for 3: 0.841
Num non-zero elements: 50
Test accuracy for 5: 0.812
Num non-zero elements: 50
Test accuracy for 6: 0.783
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 26 epochs
Test accuracy for 1: 0.9380000233650208
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 17 epochs
Test accuracy for 2: 0.9260000586509705
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for 3: 0.9130000472068787
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 22 epochs
Test accuracy for 5: 0.906000018119812
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 23 epochs
Test accuracy for 6: 0.8540000319480896
Num non-zero elements: 1
Test accuracy for 1: 0.826
Num non-zero elements: 1
Test accuracy for 2: 0.786
Num non-zero elements: 1
Test accuracy for 3: 0.553
Num non-zero elements: 1
Test accuracy for 5: 0.816
Num non-zero elements: 1
Test accuracy for 6: 0.728
Num non-zero elements: 2
Test accuracy for 1: 0.856
Num non-zero elements: 2
Test accuracy for 2: 0.8
Num non-zero elements: 2
Test accuracy for 3: 0.626
Num non-zero elements: 2
Test accuracy for 5: 0.851
Num non-zero elements: 2
Test accuracy for 6: 0.748
Num non-zero elements: 5
Test accuracy for 1: 0.847
Num non-zero elements: 5
Test accuracy for 2: 0.851
Num non-zero elements: 5
Test accuracy for 3: 0.746
Num non-zero elements: 5
Test accuracy for 5: 0.852
Num non-zero elements: 5
Test accuracy for 6: 0.768
Num non-zero elements: 10
Test accuracy for 1: 0.899
Num non-zero elements: 10
Test accuracy for 2: 0.856
Num non-zero elements: 10
Test accuracy for 3: 0.805
Num non-zero elements: 10
Test accuracy for 5: 0.863
Num non-zero elements: 10
Test accuracy for 6: 0.752
Num non-zero elements: 20
Test accuracy for 1: 0.911
Num non-zero elements: 20
Test accuracy for 2: 0.88
Num non-zero elements: 20
Test accuracy for 3: 0.88
Num non-zero elements: 20
Test accuracy for 5: 0.874
Num non-zero elements: 20
Test accuracy for 6: 0.789
Num non-zero elements: 50
Test accuracy for 1: 0.928
Num non-zero elements: 50
Test accuracy for 2: 0.896
Num non-zero elements: 50
Test accuracy for 3: 0.884
Num non-zero elements: 50
Test accuracy for 5: 0.899
Num non-zero elements: 50
Test accuracy for 6: 0.836


Tokenizing data:   0%|          | 0/2 [00:00<?, ?it/s][A[A

Tokenizing data:  50%|█████     | 1/2 [00:00<00:00,  9.77it/s][A[ATokenizing data: 100%|██████████| 2/2 [00:00<00:00,  9.99it/s]


Tokenizing data:   0%|          | 0/2 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 2/2 [00:00<00:00, 37.28it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.68it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.08it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.52it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.50it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.10it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.81it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.60it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.43it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.32it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.25it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.21it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.06it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.50it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.37it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.30it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.83it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.57it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.40it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.28it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.06it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.20it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.06it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.18it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.76it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.52it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.36it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.21it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.55it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.47it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.96it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.62it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.42it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.29it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.22it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.19it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.45it/s]
Num non-zero elements: 2304
Test accuracy for 1.0: 0.902
Num non-zero elements: 2304
Test accuracy for 5.0: 0.902
Num non-zero elements: 1
Test accuracy for 1.0: 0.631
Num non-zero elements: 1
Test accuracy for 5.0: 0.631
Num non-zero elements: 2
Test accuracy for 1.0: 0.654
Num non-zero elements: 2
Test accuracy for 5.0: 0.654
Num non-zero elements: 5
Test accuracy for 1.0: 0.669
Num non-zero elements: 5
Test accuracy for 5.0: 0.669
Num non-zero elements: 10
Test accuracy for 1.0: 0.764
Num non-zero elements: 10
Test accuracy for 5.0: 0.764
Num non-zero elements: 20
Test accuracy for 1.0: 0.792
Num non-zero elements: 20
Test accuracy for 5.0: 0.792
Num non-zero elements: 50
Test accuracy for 1.0: 0.829
Num non-zero elements: 50
Test accuracy for 5.0: 0.828
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 26 epochs
Test accuracy for 1.0: 0.909000039100647
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 5.0: 0.9020000696182251
Num non-zero elements: 1
Test accuracy for 1.0: 0.604
Num non-zero elements: 1
Test accuracy for 5.0: 0.604
Num non-zero elements: 2
Test accuracy for 1.0: 0.761
Num non-zero elements: 2
Test accuracy for 5.0: 0.761
Num non-zero elements: 5
Test accuracy for 1.0: 0.8
Num non-zero elements: 5
Test accuracy for 5.0: 0.8
Num non-zero elements: 10
Test accuracy for 1.0: 0.857
Num non-zero elements: 10
Test accuracy for 5.0: 0.857
Num non-zero elements: 20
Test accuracy for 1.0: 0.884
Num non-zero elements: 20
Test accuracy for 5.0: 0.884
Num non-zero elements: 50
Test accuracy for 1.0: 0.899
Num non-zero elements: 50
Test accuracy for 5.0: 0.899
Loading dataset codeparrot/github-code, this usually takes ~30 seconds


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  20%|██        | 1/5 [00:01<00:07,  1.95s/it][A[A

Tokenizing data:  40%|████      | 2/5 [00:03<00:04,  1.43s/it][A[A

Tokenizing data:  60%|██████    | 3/5 [00:04<00:02,  1.25s/it][A[A

Tokenizing data:  80%|████████  | 4/5 [00:04<00:00,  1.06it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:05<00:00,  1.20it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:05<00:00,  1.04s/it]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  20%|██        | 1/5 [00:00<00:02,  1.85it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:01,  2.77it/s][A[A

Tokenizing data:  60%|██████    | 3/5 [00:01<00:00,  2.97it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:01<00:00,  3.73it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:01<00:00,  4.16it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:01<00:00,  3.47it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.54it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.05it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.48it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.45it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.04it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.76it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.55it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.36it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.25it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.19it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 14.72it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 17.34it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 17.52it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 17.66it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.75it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.82it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.89it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.19it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 23.09it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.71it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 18.88it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.60it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.42it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.20it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 17.59it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.94it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.13it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 22.45it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.55it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.92it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.58it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.36it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.22it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.12it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.05it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.95it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.91it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 15.08it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 17.60it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:01, 17.68it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 17.75it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 17.79it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 17.82it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 17.67it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 17.92it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 17.88it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.88it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.89it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.90it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.91it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 23.28it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.76it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 18.86it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.53it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.33it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.20it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.10it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 17.94it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:02, 17.92it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 17.90it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 17.89it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 17.89it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 17.88it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 17.88it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 17.88it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 17.87it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 17.87it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:01, 17.88it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 17.86it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 17.86it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 17.87it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 17.85it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.86it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.86it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.87it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.05it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 23.62it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.86it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 18.88it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.54it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.06it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 17.94it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 17.90it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 17.87it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:02, 17.85it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:02, 15.28it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.72it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.74it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:02<00:01, 17.76it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.78it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.79it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.80it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.80it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.77it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.79it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.78it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.79it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:03<00:00, 17.80it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.80it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.80it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.80it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.80it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.91it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.95it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.94it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.50it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.24it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.08it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.99it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.95it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.26it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.00it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.97it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.52it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.25it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.10it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.01it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.95it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.30it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.22it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.70it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 15.42it/s][A[A

Collecting activations:  69%|██████▉   | 11/16 [00:00<00:00, 18.13it/s][A[A

Collecting activations:  81%|████████▏ | 13/16 [00:00<00:00, 18.04it/s][A[A

Collecting activations:  94%|█████████▍| 15/16 [00:00<00:00, 17.96it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.86it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.23it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.72it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.36it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.10it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 16.30it/s][A[A

Collecting activations:  94%|█████████▍| 15/16 [00:00<00:00, 18.37it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.17it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.38it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.76it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.40it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.01it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.92it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.89it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.16it/s]
Num non-zero elements: 2304
Test accuracy for C: 0.966
Num non-zero elements: 2304
Test accuracy for Python: 0.985
Num non-zero elements: 2304
Test accuracy for HTML: 0.987
Num non-zero elements: 2304
Test accuracy for Java: 0.965
Num non-zero elements: 2304
Test accuracy for PHP: 0.946
Num non-zero elements: 1
Test accuracy for C: 0.604
Num non-zero elements: 1
Test accuracy for Python: 0.641
Num non-zero elements: 1
Test accuracy for HTML: 0.725
Num non-zero elements: 1
Test accuracy for Java: 0.612
Num non-zero elements: 1
Test accuracy for PHP: 0.567
Num non-zero elements: 2
Test accuracy for C: 0.723
Num non-zero elements: 2
Test accuracy for Python: 0.683
Num non-zero elements: 2
Test accuracy for HTML: 0.944
Num non-zero elements: 2
Test accuracy for Java: 0.621
Num non-zero elements: 2
Test accuracy for PHP: 0.652
Num non-zero elements: 5
Test accuracy for C: 0.827
Num non-zero elements: 5
Test accuracy for Python: 0.738
Num non-zero elements: 5
Test accuracy for HTML: 0.946
Num non-zero elements: 5
Test accuracy for Java: 0.8
Num non-zero elements: 5
Test accuracy for PHP: 0.712
Num non-zero elements: 10
Test accuracy for C: 0.836
Num non-zero elements: 10
Test accuracy for Python: 0.868
Num non-zero elements: 10
Test accuracy for HTML: 0.956
Num non-zero elements: 10
Test accuracy for Java: 0.81
Num non-zero elements: 10
Test accuracy for PHP: 0.799
Num non-zero elements: 20
Test accuracy for C: 0.863
Num non-zero elements: 20
Test accuracy for Python: 0.905
Num non-zero elements: 20
Test accuracy for HTML: 0.97
Num non-zero elements: 20
Test accuracy for Java: 0.869
Num non-zero elements: 20
Test accuracy for PHP: 0.861
Num non-zero elements: 50
Test accuracy for C: 0.914
Num non-zero elements: 50
Test accuracy for Python: 0.973
Num non-zero elements: 50
Test accuracy for HTML: 0.968
Num non-zero elements: 50
Test accuracy for Java: 0.898
Num non-zero elements: 50
Test accuracy for PHP: 0.909
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 42 epochs
Test accuracy for C: 0.9470000267028809
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 23 epochs
Test accuracy for Python: 0.9850000739097595
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 17 epochs
Test accuracy for HTML: 0.9880000352859497
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 21 epochs
Test accuracy for Java: 0.9740000367164612
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 22 epochs
Test accuracy for PHP: 0.9550000429153442
Num non-zero elements: 1
Test accuracy for C: 0.641
Num non-zero elements: 1
Test accuracy for Python: 0.905
Num non-zero elements: 1
Test accuracy for HTML: 0.687
Num non-zero elements: 1
Test accuracy for Java: 0.638
Num non-zero elements: 1
Test accuracy for PHP: 0.912
Num non-zero elements: 2
Test accuracy for C: 0.813
Num non-zero elements: 2
Test accuracy for Python: 0.921
Num non-zero elements: 2
Test accuracy for HTML: 0.945
Num non-zero elements: 2
Test accuracy for Java: 0.639
Num non-zero elements: 2
Test accuracy for PHP: 0.906
Num non-zero elements: 5
Test accuracy for C: 0.884
Num non-zero elements: 5
Test accuracy for Python: 0.93
Num non-zero elements: 5
Test accuracy for HTML: 0.954
Num non-zero elements: 5
Test accuracy for Java: 0.912
Num non-zero elements: 5
Test accuracy for PHP: 0.914
Num non-zero elements: 10
Test accuracy for C: 0.897
Num non-zero elements: 10
Test accuracy for Python: 0.979
Num non-zero elements: 10
Test accuracy for HTML: 0.952
Num non-zero elements: 10
Test accuracy for Java: 0.917
Num non-zero elements: 10
Test accuracy for PHP: 0.912
Num non-zero elements: 20
Test accuracy for C: 0.924
Num non-zero elements: 20
Test accuracy for Python: 0.983
Num non-zero elements: 20
Test accuracy for HTML: 0.963
Num non-zero elements: 20
Test accuracy for Java: 0.931
Num non-zero elements: 20
Test accuracy for PHP: 0.908
Num non-zero elements: 50
Test accuracy for C: 0.946
Num non-zero elements: 50
Test accuracy for Python: 0.987
Num non-zero elements: 50
Test accuracy for HTML: 0.971
Num non-zero elements: 50
Test accuracy for Java: 0.942
Num non-zero elements: 50
Test accuracy for PHP: 0.93


Tokenizing data:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Tokenizing data:  25%|██▌       | 1/4 [00:00<00:00,  4.07it/s][A[A

Tokenizing data:  75%|███████▌  | 3/4 [00:00<00:00,  8.64it/s][A[ATokenizing data: 100%|██████████| 4/4 [00:00<00:00,  8.75it/s]


Tokenizing data:   0%|          | 0/4 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 4/4 [00:00<00:00, 49.25it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.49it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.18it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.58it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.54it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.14it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.85it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.65it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.48it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.38it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.32it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.26it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.23it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.20it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.14it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.14it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.11it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.12it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.12it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.12it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.55it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.15it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.25it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.83it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.58it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.42it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.32it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.07it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.21it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.11it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.21it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.79it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.54it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.38it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.26it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.13it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.14it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.02it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.12it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.70it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.45it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.30it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.20it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.09it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.95it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.10it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.02it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.11it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.69it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.43it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.27it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.12it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.46it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.38it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.88it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.54it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.33it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.21it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.11it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.07it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.35it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.39it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.88it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.53it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.33it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.21it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.08it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.35it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.34it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.85it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.51it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.31it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.20it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.06it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.34it/s]
Num non-zero elements: 2304
Test accuracy for 0: 0.929
Num non-zero elements: 2304
Test accuracy for 1: 0.981
Num non-zero elements: 2304
Test accuracy for 2: 0.907
Num non-zero elements: 2304
Test accuracy for 3: 0.917
Num non-zero elements: 1
Test accuracy for 0: 0.776
Num non-zero elements: 1
Test accuracy for 1: 0.687
Num non-zero elements: 1
Test accuracy for 2: 0.663
Num non-zero elements: 1
Test accuracy for 3: 0.775
Num non-zero elements: 2
Test accuracy for 0: 0.794
Num non-zero elements: 2
Test accuracy for 1: 0.798
Num non-zero elements: 2
Test accuracy for 2: 0.704
Num non-zero elements: 2
Test accuracy for 3: 0.786
Num non-zero elements: 5
Test accuracy for 0: 0.88
Num non-zero elements: 5
Test accuracy for 1: 0.872
Num non-zero elements: 5
Test accuracy for 2: 0.781
Num non-zero elements: 5
Test accuracy for 3: 0.848
Num non-zero elements: 10
Test accuracy for 0: 0.888
Num non-zero elements: 10
Test accuracy for 1: 0.947
Num non-zero elements: 10
Test accuracy for 2: 0.804
Num non-zero elements: 10
Test accuracy for 3: 0.852
Num non-zero elements: 20
Test accuracy for 0: 0.895
Num non-zero elements: 20
Test accuracy for 1: 0.954
Num non-zero elements: 20
Test accuracy for 2: 0.879
Num non-zero elements: 20
Test accuracy for 3: 0.891
Num non-zero elements: 50
Test accuracy for 0: 0.908
Num non-zero elements: 50
Test accuracy for 1: 0.971
Num non-zero elements: 50
Test accuracy for 2: 0.868
Num non-zero elements: 50
Test accuracy for 3: 0.912
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 12 epochs
Test accuracy for 0: 0.9360000491142273
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 20 epochs
Test accuracy for 1: 0.9780000448226929
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for 2: 0.9180000424385071
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for 3: 0.9590000510215759
Num non-zero elements: 1
Test accuracy for 0: 0.721
Num non-zero elements: 1
Test accuracy for 1: 0.957
Num non-zero elements: 1
Test accuracy for 2: 0.78
Num non-zero elements: 1
Test accuracy for 3: 0.708
Num non-zero elements: 2
Test accuracy for 0: 0.801
Num non-zero elements: 2
Test accuracy for 1: 0.962
Num non-zero elements: 2
Test accuracy for 2: 0.842
Num non-zero elements: 2
Test accuracy for 3: 0.812
Num non-zero elements: 5
Test accuracy for 0: 0.837
Num non-zero elements: 5
Test accuracy for 1: 0.959
Num non-zero elements: 5
Test accuracy for 2: 0.842
Num non-zero elements: 5
Test accuracy for 3: 0.847
Num non-zero elements: 10
Test accuracy for 0: 0.897
Num non-zero elements: 10
Test accuracy for 1: 0.971
Num non-zero elements: 10
Test accuracy for 2: 0.847
Num non-zero elements: 10
Test accuracy for 3: 0.863
Num non-zero elements: 20
Test accuracy for 0: 0.909
Num non-zero elements: 20
Test accuracy for 1: 0.975
Num non-zero elements: 20
Test accuracy for 2: 0.862
Num non-zero elements: 20
Test accuracy for 3: 0.893
Num non-zero elements: 50
Test accuracy for 0: 0.923
Num non-zero elements: 50
Test accuracy for 1: 0.98
Num non-zero elements: 50
Test accuracy for 2: 0.894
Num non-zero elements: 50
Test accuracy for 3: 0.932
Loading dataset Helsinki-NLP/europarl, this usually takes ~10 seconds


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 15.03it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 14.90it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 14.85it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 53.49it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 26.65it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 22.96it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.50it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.51it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.12it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.85it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.63it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.46it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.37it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.30it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.25it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.23it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.20it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.14it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.14it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.14it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.14it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.12it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.12it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.12it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.12it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.43it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 24.55it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 20.31it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 19.23it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:03, 17.14it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.06it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.78it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.59it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.44it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 15.46it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.08it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.15it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 23.76it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 20.05it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 19.10it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.78it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.55it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.38it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.27it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.19it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 16.19it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:01, 18.55it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.42it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.31it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.22it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 14.29it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 14.72it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:01, 17.34it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 17.52it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 17.67it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 17.77it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 17.85it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 17.90it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 17.92it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.91it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.96it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.83it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 23.38it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.90it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 19.00it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.69it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.47it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.18it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.26it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.19it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:03, 16.32it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.96it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.67it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.44it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.30it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.19it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.95it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.06it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.52it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.57it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.92it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.55it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.33it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.19it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.11it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.55it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.81it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.31it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.78it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.46it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.25it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 16.22it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.47it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.08it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.07it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.62it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.35it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.19it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.09it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.32it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.29it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.45it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.84it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.50it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.28it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.07it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.46it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.60it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.55it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.91it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.53it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.30it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.08it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.49it/s]
Num non-zero elements: 2304
Test accuracy for en: 0.998
Num non-zero elements: 2304
Test accuracy for fr: 0.999
Num non-zero elements: 2304
Test accuracy for de: 0.998
Num non-zero elements: 2304
Test accuracy for es: 1.0
Num non-zero elements: 2304
Test accuracy for nl: 1.0
Num non-zero elements: 1
Test accuracy for en: 0.933
Num non-zero elements: 1
Test accuracy for fr: 0.668
Num non-zero elements: 1
Test accuracy for de: 0.818
Num non-zero elements: 1
Test accuracy for es: 0.886
Num non-zero elements: 1
Test accuracy for nl: 0.86
Num non-zero elements: 2
Test accuracy for en: 0.975
Num non-zero elements: 2
Test accuracy for fr: 0.892
Num non-zero elements: 2
Test accuracy for de: 0.841
Num non-zero elements: 2
Test accuracy for es: 0.904
Num non-zero elements: 2
Test accuracy for nl: 0.876
Num non-zero elements: 5
Test accuracy for en: 0.993
Num non-zero elements: 5
Test accuracy for fr: 0.973
Num non-zero elements: 5
Test accuracy for de: 0.895
Num non-zero elements: 5
Test accuracy for es: 0.984
Num non-zero elements: 5
Test accuracy for nl: 0.945
Num non-zero elements: 10
Test accuracy for en: 0.997
Num non-zero elements: 10
Test accuracy for fr: 0.988
Num non-zero elements: 10
Test accuracy for de: 0.98
Num non-zero elements: 10
Test accuracy for es: 0.991
Num non-zero elements: 10
Test accuracy for nl: 0.965
Num non-zero elements: 20
Test accuracy for en: 0.997
Num non-zero elements: 20
Test accuracy for fr: 0.997
Num non-zero elements: 20
Test accuracy for de: 0.988
Num non-zero elements: 20
Test accuracy for es: 0.997
Num non-zero elements: 20
Test accuracy for nl: 0.989
Num non-zero elements: 50
Test accuracy for en: 0.998
Num non-zero elements: 50
Test accuracy for fr: 0.999
Num non-zero elements: 50
Test accuracy for de: 0.996
Num non-zero elements: 50
Test accuracy for es: 0.999
Num non-zero elements: 50
Test accuracy for nl: 0.994
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for en: 0.9980000257492065
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 14 epochs
Test accuracy for fr: 1.0
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for de: 1.0
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 14 epochs
Test accuracy for es: 1.0
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for nl: 0.999000072479248
Num non-zero elements: 1
Test accuracy for en: 0.999
Num non-zero elements: 1
Test accuracy for fr: 0.862
Num non-zero elements: 1
Test accuracy for de: 0.999
Num non-zero elements: 1
Test accuracy for es: 0.887
Num non-zero elements: 1
Test accuracy for nl: 0.852
Num non-zero elements: 2
Test accuracy for en: 1.0
Num non-zero elements: 2
Test accuracy for fr: 0.997
Num non-zero elements: 2
Test accuracy for de: 0.996
Num non-zero elements: 2
Test accuracy for es: 0.994
Num non-zero elements: 2
Test accuracy for nl: 0.997
Num non-zero elements: 5
Test accuracy for en: 0.999
Num non-zero elements: 5
Test accuracy for fr: 0.997
Num non-zero elements: 5
Test accuracy for de: 0.999
Num non-zero elements: 5
Test accuracy for es: 0.996
Num non-zero elements: 5
Test accuracy for nl: 0.995
Num non-zero elements: 10
Test accuracy for en: 0.998
Num non-zero elements: 10
Test accuracy for fr: 0.997
Num non-zero elements: 10
Test accuracy for de: 1.0
Num non-zero elements: 10
Test accuracy for es: 0.996
Num non-zero elements: 10
Test accuracy for nl: 0.997
Num non-zero elements: 20
Test accuracy for en: 1.0
Num non-zero elements: 20
Test accuracy for fr: 0.999
Num non-zero elements: 20
Test accuracy for de: 0.999
Num non-zero elements: 20
Test accuracy for es: 0.999
Num non-zero elements: 20
Test accuracy for nl: 0.998
Num non-zero elements: 50
Test accuracy for en: 0.999
Num non-zero elements: 50
Test accuracy for fr: 1.0
Num non-zero elements: 50
Test accuracy for de: 0.999
Num non-zero elements: 50
Test accuracy for es: 0.998
Num non-zero elements: 50
Test accuracy for nl: 0.998

Running SAE evaluation on all selected SAEs: 100%|██████████| 1/1 [16:56<00:00, 1016.80s/it][ARunning SAE evaluation on all selected SAEs: 100%|██████████| 1/1 [16:56<00:00, 1016.80s/it]
Evaluations: 100%|██████████| 1/1 [17:10<00:00, 1030.68s/it]Evaluations: 100%|██████████| 1/1 [17:10<00:00, 1030.68s/it]
/share/u/can/SAEBench/custom_saes/topk_sae.py:110: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  pt_params = t.load(path_to_params)
Loaded config: {'trainer': {'trainer_class': 'TrainerTopKAdditivity', 'dict_class': 'AutoEncoderTopK', 'lr': 0.000282842712474619, 'steps': 48828, 'seed': 0, 'activation_dim': 2304, 'dict_size': 8192, 'k': 125, 'auxk_alpha': 0.03125, 'additivity_coeff': 0.0, 'intersection_coeff': 1.0, 'device': 'cuda:0', 'layer': 4, 'lm_name': 'google/gemma-2-2b', 'wandb_name': 'TopKTrainer_Additivity-google/gemma-2-2b-resid_post_layer_4-add_coeff-0.0-inters_coeff-1.0', 'submodule_name': 'resid_post_layer_4'}, 'buffer': {'d_submodule': 2304, 'io': 'out', 'n_ctxs': 8192, 'ctx_len': 128, 'refresh_batch_size': 32, 'out_batch_size': 2048, 'device': 'cuda:0'}}
Original keys in state_dict: odict_keys(['b_dec', 'encoder.weight', 'encoder.bias', 'decoder.weight'])
Renamed keys in state_dict: dict_keys(['b_dec', 'W_enc', 'b_enc', 'W_dec'])
Evaluations:   0%|          | 0/1 [00:00<?, ?it/s]


Running sparse_probing evaluation




Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s][A
Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:01,  1.53it/s][A
Loading checkpoint shards:  67%|██████▋   | 2/3 [00:01<00:00,  1.59it/s][A
Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.28it/s][ALoading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.03it/s]
Loaded pretrained model gemma-2-2b into HookedTransformer

Running SAE evaluation on all selected SAEs:   0%|          | 0/1 [00:00<?, ?it/s][A

  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 663.71it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 1084.12it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 12.76it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 13.19it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 13.05it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 50.07it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 26.81it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.20it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.59it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.54it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.13it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.84it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.63it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.47it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.36it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.29it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.24it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.20it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.09it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.52it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.28it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.28it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.83it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.57it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.39it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.22it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.19it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.17it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.17it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.73it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.47it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.22it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.15it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.10it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.95it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.11it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.17it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.18it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.73it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.46it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.30it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.20it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.08it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.94it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.09it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 22.16it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.48it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:03, 13.83it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:03, 16.94it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 17.22it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 17.43it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 17.57it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 17.68it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 17.75it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 17.81it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 17.42it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:02, 17.94it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:02, 14.18it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:02<00:01, 16.84it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.12it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.34it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.49it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.62it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.71it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.77it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.76it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.79it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:03<00:00, 17.83it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.84it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.85it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.86it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.86it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.46it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.98it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.34it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.72it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.46it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.27it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.07it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.44it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.18it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.42it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.82it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.48it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.27it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.09it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.09it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.44it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 28.29it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 22.88it/s][A[A

Collecting activations:  56%|█████▋    | 9/16 [00:00<00:00, 20.27it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 19.26it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.86it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.59it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 19.64it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.33it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.80it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.45it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.25it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.05it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 16.56it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.65it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 25.82it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 20.39it/s][A[A

Collecting activations:  56%|█████▋    | 9/16 [00:00<00:00, 19.13it/s][A[A

Collecting activations:  69%|██████▉   | 11/16 [00:00<00:00, 18.71it/s][A[A

Collecting activations:  81%|████████▏ | 13/16 [00:00<00:00, 18.43it/s][A[A

Collecting activations:  94%|█████████▍| 15/16 [00:00<00:00, 18.25it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.92it/s]
Num non-zero elements: 2304
Test accuracy for 0: 0.925
Num non-zero elements: 2304
Test accuracy for 1: 0.943
Num non-zero elements: 2304
Test accuracy for 2: 0.947
Num non-zero elements: 2304
Test accuracy for 6: 0.991
Num non-zero elements: 2304
Test accuracy for 9: 0.971
Num non-zero elements: 1
Test accuracy for 0: 0.603
Num non-zero elements: 1
Test accuracy for 1: 0.648
Num non-zero elements: 1
Test accuracy for 2: 0.731
Num non-zero elements: 1
Test accuracy for 6: 0.773
Num non-zero elements: 1
Test accuracy for 9: 0.68
Num non-zero elements: 2
Test accuracy for 0: 0.682
Num non-zero elements: 2
Test accuracy for 1: 0.655
Num non-zero elements: 2
Test accuracy for 2: 0.744
Num non-zero elements: 2
Test accuracy for 6: 0.771
Num non-zero elements: 2
Test accuracy for 9: 0.772
Num non-zero elements: 5
Test accuracy for 0: 0.768
Num non-zero elements: 5
Test accuracy for 1: 0.69
Num non-zero elements: 5
Test accuracy for 2: 0.754
Num non-zero elements: 5
Test accuracy for 6: 0.905
Num non-zero elements: 5
Test accuracy for 9: 0.798
Num non-zero elements: 10
Test accuracy for 0: 0.797
Num non-zero elements: 10
Test accuracy for 1: 0.818
Num non-zero elements: 10
Test accuracy for 2: 0.83
Num non-zero elements: 10
Test accuracy for 6: 0.929
Num non-zero elements: 10
Test accuracy for 9: 0.912
Num non-zero elements: 20
Test accuracy for 0: 0.796
Num non-zero elements: 20
Test accuracy for 1: 0.867
Num non-zero elements: 20
Test accuracy for 2: 0.847
Num non-zero elements: 20
Test accuracy for 6: 0.96
Num non-zero elements: 20
Test accuracy for 9: 0.945
Num non-zero elements: 50
Test accuracy for 0: 0.862
Num non-zero elements: 50
Test accuracy for 1: 0.905
Num non-zero elements: 50
Test accuracy for 2: 0.897
Num non-zero elements: 50
Test accuracy for 6: 0.977
Num non-zero elements: 50
Test accuracy for 9: 0.948
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 12 epochs
Test accuracy for 0: 0.940000057220459
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for 1: 0.9640000462532043
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for 2: 0.9380000233650208
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 17 epochs
Test accuracy for 6: 0.9900000691413879
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for 9: 0.9750000238418579
Num non-zero elements: 1
Test accuracy for 0: 0.628
Num non-zero elements: 1
Test accuracy for 1: 0.818
Num non-zero elements: 1
Test accuracy for 2: 0.856
Num non-zero elements: 1
Test accuracy for 6: 0.97
Num non-zero elements: 1
Test accuracy for 9: 0.931
Num non-zero elements: 2
Test accuracy for 0: 0.823
Num non-zero elements: 2
Test accuracy for 1: 0.832
Num non-zero elements: 2
Test accuracy for 2: 0.874
Num non-zero elements: 2
Test accuracy for 6: 0.983
Num non-zero elements: 2
Test accuracy for 9: 0.94
Num non-zero elements: 5
Test accuracy for 0: 0.866
Num non-zero elements: 5
Test accuracy for 1: 0.845
Num non-zero elements: 5
Test accuracy for 2: 0.919
Num non-zero elements: 5
Test accuracy for 6: 0.985
Num non-zero elements: 5
Test accuracy for 9: 0.95
Num non-zero elements: 10
Test accuracy for 0: 0.872
Num non-zero elements: 10
Test accuracy for 1: 0.95
Num non-zero elements: 10
Test accuracy for 2: 0.915
Num non-zero elements: 10
Test accuracy for 6: 0.988
Num non-zero elements: 10
Test accuracy for 9: 0.959
Num non-zero elements: 20
Test accuracy for 0: 0.878
Num non-zero elements: 20
Test accuracy for 1: 0.959
Num non-zero elements: 20
Test accuracy for 2: 0.928
Num non-zero elements: 20
Test accuracy for 6: 0.985
Num non-zero elements: 20
Test accuracy for 9: 0.966
Num non-zero elements: 50
Test accuracy for 0: 0.909
Num non-zero elements: 50
Test accuracy for 1: 0.957
Num non-zero elements: 50
Test accuracy for 2: 0.928
Num non-zero elements: 50
Test accuracy for 6: 0.991
Num non-zero elements: 50
Test accuracy for 9: 0.979


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 671.45it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 1102.69it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 13.28it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 13.29it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 13.33it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 45.48it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 45.21it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 25.17it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 22.83it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.42it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.45it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.07it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.80it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.60it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.44it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.34it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.29it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.24it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.20it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.09it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.49it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.08it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.18it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.76it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.52it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.37it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.28it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.17it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.18it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.02it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.16it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.74it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.49it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.34it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.23it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.15it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.10it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.97it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.12it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.96it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.10it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.68it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.43it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.28it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.12it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.07it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.95it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.08it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.97it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.07it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.64it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.40it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.08it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.03it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.94it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.92it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.92it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.92it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.92it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.91it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.91it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.05it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.93it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.01it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.58it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.33it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.06it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.35it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.36it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.81it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.45it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.24it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.11it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.02it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.97it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.22it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.23it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.10it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.63it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.36it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.19it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.38it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.30it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.77it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.43it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.22it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.10it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.01it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.98it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.25it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.20it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.74it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.39it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.20it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.08it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.00it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.96it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.22it/s]
Num non-zero elements: 2304
Test accuracy for 11: 0.939
Num non-zero elements: 2304
Test accuracy for 13: 0.929
Num non-zero elements: 2304
Test accuracy for 14: 0.955
Num non-zero elements: 2304
Test accuracy for 18: 0.908
Num non-zero elements: 2304
Test accuracy for 19: 0.962
Num non-zero elements: 1
Test accuracy for 11: 0.715
Num non-zero elements: 1
Test accuracy for 13: 0.699
Num non-zero elements: 1
Test accuracy for 14: 0.657
Num non-zero elements: 1
Test accuracy for 18: 0.692
Num non-zero elements: 1
Test accuracy for 19: 0.768
Num non-zero elements: 2
Test accuracy for 11: 0.783
Num non-zero elements: 2
Test accuracy for 13: 0.714
Num non-zero elements: 2
Test accuracy for 14: 0.679
Num non-zero elements: 2
Test accuracy for 18: 0.71
Num non-zero elements: 2
Test accuracy for 19: 0.796
Num non-zero elements: 5
Test accuracy for 11: 0.818
Num non-zero elements: 5
Test accuracy for 13: 0.779
Num non-zero elements: 5
Test accuracy for 14: 0.741
Num non-zero elements: 5
Test accuracy for 18: 0.719
Num non-zero elements: 5
Test accuracy for 19: 0.837
Num non-zero elements: 10
Test accuracy for 11: 0.875
Num non-zero elements: 10
Test accuracy for 13: 0.843
Num non-zero elements: 10
Test accuracy for 14: 0.786
Num non-zero elements: 10
Test accuracy for 18: 0.76
Num non-zero elements: 10
Test accuracy for 19: 0.834
Num non-zero elements: 20
Test accuracy for 11: 0.902
Num non-zero elements: 20
Test accuracy for 13: 0.871
Num non-zero elements: 20
Test accuracy for 14: 0.866
Num non-zero elements: 20
Test accuracy for 18: 0.763
Num non-zero elements: 20
Test accuracy for 19: 0.911
Num non-zero elements: 50
Test accuracy for 11: 0.928
Num non-zero elements: 50
Test accuracy for 13: 0.902
Num non-zero elements: 50
Test accuracy for 14: 0.901
Num non-zero elements: 50
Test accuracy for 18: 0.836
Num non-zero elements: 50
Test accuracy for 19: 0.929
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for 11: 0.9530000686645508
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 24 epochs
Test accuracy for 13: 0.9520000219345093
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for 14: 0.9520000219345093
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 20 epochs
Test accuracy for 18: 0.9190000295639038
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 29 epochs
Test accuracy for 19: 0.9650000333786011
Num non-zero elements: 1
Test accuracy for 11: 0.735
Num non-zero elements: 1
Test accuracy for 13: 0.748
Num non-zero elements: 1
Test accuracy for 14: 0.91
Num non-zero elements: 1
Test accuracy for 18: 0.717
Num non-zero elements: 1
Test accuracy for 19: 0.864
Num non-zero elements: 2
Test accuracy for 11: 0.84
Num non-zero elements: 2
Test accuracy for 13: 0.753
Num non-zero elements: 2
Test accuracy for 14: 0.911
Num non-zero elements: 2
Test accuracy for 18: 0.873
Num non-zero elements: 2
Test accuracy for 19: 0.858
Num non-zero elements: 5
Test accuracy for 11: 0.925
Num non-zero elements: 5
Test accuracy for 13: 0.788
Num non-zero elements: 5
Test accuracy for 14: 0.905
Num non-zero elements: 5
Test accuracy for 18: 0.886
Num non-zero elements: 5
Test accuracy for 19: 0.876
Num non-zero elements: 10
Test accuracy for 11: 0.937
Num non-zero elements: 10
Test accuracy for 13: 0.877
Num non-zero elements: 10
Test accuracy for 14: 0.912
Num non-zero elements: 10
Test accuracy for 18: 0.891
Num non-zero elements: 10
Test accuracy for 19: 0.874
Num non-zero elements: 20
Test accuracy for 11: 0.954
Num non-zero elements: 20
Test accuracy for 13: 0.928
Num non-zero elements: 20
Test accuracy for 14: 0.932
Num non-zero elements: 20
Test accuracy for 18: 0.899
Num non-zero elements: 20
Test accuracy for 19: 0.921
Num non-zero elements: 50
Test accuracy for 11: 0.95
Num non-zero elements: 50
Test accuracy for 13: 0.936
Num non-zero elements: 50
Test accuracy for 14: 0.943
Num non-zero elements: 50
Test accuracy for 18: 0.905
Num non-zero elements: 50
Test accuracy for 19: 0.94


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 621.22it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 890.81it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 12.65it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00,  7.77it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00,  7.28it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00,  7.73it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 47.00it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 45.14it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.14it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 22.87it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.44it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.46it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.09it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.81it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.61it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.45it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.35it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.29it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.23it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.21it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.11it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 14.73it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.50it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.28it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 23.59it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 20.03it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 19.10it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.49it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.67it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.43it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.32it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.25it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.20it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.18it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:02, 15.24it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.06it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.14it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.03it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.18it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.76it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.50it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.34it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.14it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.96it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.09it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.67it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.43it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.28it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.11it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.07it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.95it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.09it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.93it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.06it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.64it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.41it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.27it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.10it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.05it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.92it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.92it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.92it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.06it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.89it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.04it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.60it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.35it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.20it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.10it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.38it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.31it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.79it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.46it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.04it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.28it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.30it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.79it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.46it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.14it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.05it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.28it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.21it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.77it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.44it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.24it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.11it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.04it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.25it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.34it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.82it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.46it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.24it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.05it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.28it/s]
Num non-zero elements: 2304
Test accuracy for 20: 0.942
Num non-zero elements: 2304
Test accuracy for 21: 0.896
Num non-zero elements: 2304
Test accuracy for 22: 0.892
Num non-zero elements: 2304
Test accuracy for 25: 0.948
Num non-zero elements: 2304
Test accuracy for 26: 0.864
Num non-zero elements: 1
Test accuracy for 20: 0.757
Num non-zero elements: 1
Test accuracy for 21: 0.627
Num non-zero elements: 1
Test accuracy for 22: 0.639
Num non-zero elements: 1
Test accuracy for 25: 0.717
Num non-zero elements: 1
Test accuracy for 26: 0.657
Num non-zero elements: 2
Test accuracy for 20: 0.805
Num non-zero elements: 2
Test accuracy for 21: 0.731
Num non-zero elements: 2
Test accuracy for 22: 0.614
Num non-zero elements: 2
Test accuracy for 25: 0.703
Num non-zero elements: 2
Test accuracy for 26: 0.668
Num non-zero elements: 5
Test accuracy for 20: 0.851
Num non-zero elements: 5
Test accuracy for 21: 0.761
Num non-zero elements: 5
Test accuracy for 22: 0.724
Num non-zero elements: 5
Test accuracy for 25: 0.802
Num non-zero elements: 5
Test accuracy for 26: 0.705
Num non-zero elements: 10
Test accuracy for 20: 0.858
Num non-zero elements: 10
Test accuracy for 21: 0.825
Num non-zero elements: 10
Test accuracy for 22: 0.757
Num non-zero elements: 10
Test accuracy for 25: 0.884
Num non-zero elements: 10
Test accuracy for 26: 0.725
Num non-zero elements: 20
Test accuracy for 20: 0.909
Num non-zero elements: 20
Test accuracy for 21: 0.854
Num non-zero elements: 20
Test accuracy for 22: 0.768
Num non-zero elements: 20
Test accuracy for 25: 0.901
Num non-zero elements: 20
Test accuracy for 26: 0.771
Num non-zero elements: 50
Test accuracy for 20: 0.916
Num non-zero elements: 50
Test accuracy for 21: 0.855
Num non-zero elements: 50
Test accuracy for 22: 0.833
Num non-zero elements: 50
Test accuracy for 25: 0.932
Num non-zero elements: 50
Test accuracy for 26: 0.829
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 23 epochs
Test accuracy for 20: 0.9470000267028809
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for 21: 0.9050000309944153
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 24 epochs
Test accuracy for 22: 0.9050000309944153
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 25 epochs
Test accuracy for 25: 0.9590000510215759
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 20 epochs
Test accuracy for 26: 0.8800000548362732
Num non-zero elements: 1
Test accuracy for 20: 0.895
Num non-zero elements: 1
Test accuracy for 21: 0.761
Num non-zero elements: 1
Test accuracy for 22: 0.8
Num non-zero elements: 1
Test accuracy for 25: 0.845
Num non-zero elements: 1
Test accuracy for 26: 0.72
Num non-zero elements: 2
Test accuracy for 20: 0.905
Num non-zero elements: 2
Test accuracy for 21: 0.752
Num non-zero elements: 2
Test accuracy for 22: 0.871
Num non-zero elements: 2
Test accuracy for 25: 0.871
Num non-zero elements: 2
Test accuracy for 26: 0.788
Num non-zero elements: 5
Test accuracy for 20: 0.918
Num non-zero elements: 5
Test accuracy for 21: 0.792
Num non-zero elements: 5
Test accuracy for 22: 0.87
Num non-zero elements: 5
Test accuracy for 25: 0.897
Num non-zero elements: 5
Test accuracy for 26: 0.815
Num non-zero elements: 10
Test accuracy for 20: 0.916
Num non-zero elements: 10
Test accuracy for 21: 0.836
Num non-zero elements: 10
Test accuracy for 22: 0.888
Num non-zero elements: 10
Test accuracy for 25: 0.895
Num non-zero elements: 10
Test accuracy for 26: 0.851
Num non-zero elements: 20
Test accuracy for 20: 0.915
Num non-zero elements: 20
Test accuracy for 21: 0.856
Num non-zero elements: 20
Test accuracy for 22: 0.886
Num non-zero elements: 20
Test accuracy for 25: 0.93
Num non-zero elements: 20
Test accuracy for 26: 0.862
Num non-zero elements: 50
Test accuracy for 20: 0.938
Num non-zero elements: 50
Test accuracy for 21: 0.87
Num non-zero elements: 50
Test accuracy for 22: 0.893
Num non-zero elements: 50
Test accuracy for 25: 0.953
Num non-zero elements: 50
Test accuracy for 26: 0.874


  0%|          | 0/34 [00:00<?, ?it/s][A[A100%|██████████| 34/34 [00:00<00:00, 415.25it/s]


  0%|          | 0/31 [00:00<?, ?it/s][A[A100%|██████████| 31/31 [00:00<00:00, 823.16it/s]
Removing 31 from train set
Removing 0 from train set
Removing 29 from train set
Removing 28 from train set
Removing 7 from train set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  20%|██        | 1/5 [00:00<00:00,  9.93it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00,  9.87it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 10.05it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 10.00it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00,  9.92it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 37.86it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 37.17it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.42it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 22.80it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.37it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.40it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.02it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.74it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.54it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.38it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.29it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.22it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.44it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.37it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.26it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.79it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.51it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.35it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.17it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.11it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.95it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.12it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.81it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.37it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.83it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.51it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.12it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.07it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:02, 15.34it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 17.90it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 17.91it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 17.92it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 17.91it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.92it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.92it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.93it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.96it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 23.67it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.90it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 18.94it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.60it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.40it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 17.95it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:02, 17.93it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 17.91it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 17.89it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:01, 17.88it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 17.88it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 17.88it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 17.88it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 17.88it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 17.89it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 17.88it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.88it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 16.64it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.09it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 22.45it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.51it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.89it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.53it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.07it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.01it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.93it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.90it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.15it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 17.89it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 17.87it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 17.86it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:01, 17.85it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 17.85it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 17.85it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 17.84it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 17.84it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 17.84it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 17.84it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.83it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.82it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.84it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.02it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.44it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.47it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.84it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.48it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.25it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.11it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.52it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.51it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.17it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.66it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 17.70it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.38it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.19it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.07it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.31it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.63it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 15.36it/s][A[A

Collecting activations:  56%|█████▋    | 9/16 [00:00<00:00, 17.24it/s][A[A

Collecting activations:  69%|██████▉   | 11/16 [00:00<00:00, 17.40it/s][A[A

Collecting activations:  81%|████████▏ | 13/16 [00:00<00:00, 17.52it/s][A[A

Collecting activations:  94%|█████████▍| 15/16 [00:00<00:00, 17.61it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.51it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.19it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.00it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 15.30it/s][A[A

Collecting activations:  69%|██████▉   | 11/16 [00:00<00:00, 18.09it/s][A[A

Collecting activations:  81%|████████▏ | 13/16 [00:00<00:00, 18.00it/s][A[A

Collecting activations:  94%|█████████▍| 15/16 [00:00<00:00, 17.94it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.89it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.11it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.69it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.35it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.11it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.00it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.92it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.89it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.13it/s]
Num non-zero elements: 2304
Test accuracy for 1: 0.915
Num non-zero elements: 2304
Test accuracy for 2: 0.906
Num non-zero elements: 2304
Test accuracy for 3: 0.884
Num non-zero elements: 2304
Test accuracy for 5: 0.896
Num non-zero elements: 2304
Test accuracy for 6: 0.818
Num non-zero elements: 1
Test accuracy for 1: 0.708
Num non-zero elements: 1
Test accuracy for 2: 0.699
Num non-zero elements: 1
Test accuracy for 3: 0.612
Num non-zero elements: 1
Test accuracy for 5: 0.703
Num non-zero elements: 1
Test accuracy for 6: 0.63
Num non-zero elements: 2
Test accuracy for 1: 0.707
Num non-zero elements: 2
Test accuracy for 2: 0.797
Num non-zero elements: 2
Test accuracy for 3: 0.612
Num non-zero elements: 2
Test accuracy for 5: 0.687
Num non-zero elements: 2
Test accuracy for 6: 0.616
Num non-zero elements: 5
Test accuracy for 1: 0.774
Num non-zero elements: 5
Test accuracy for 2: 0.807
Num non-zero elements: 5
Test accuracy for 3: 0.614
Num non-zero elements: 5
Test accuracy for 5: 0.725
Num non-zero elements: 5
Test accuracy for 6: 0.657
Num non-zero elements: 10
Test accuracy for 1: 0.835
Num non-zero elements: 10
Test accuracy for 2: 0.814
Num non-zero elements: 10
Test accuracy for 3: 0.719
Num non-zero elements: 10
Test accuracy for 5: 0.746
Num non-zero elements: 10
Test accuracy for 6: 0.722
Num non-zero elements: 20
Test accuracy for 1: 0.822
Num non-zero elements: 20
Test accuracy for 2: 0.832
Num non-zero elements: 20
Test accuracy for 3: 0.788
Num non-zero elements: 20
Test accuracy for 5: 0.75
Num non-zero elements: 20
Test accuracy for 6: 0.754
Num non-zero elements: 50
Test accuracy for 1: 0.896
Num non-zero elements: 50
Test accuracy for 2: 0.858
Num non-zero elements: 50
Test accuracy for 3: 0.855
Num non-zero elements: 50
Test accuracy for 5: 0.823
Num non-zero elements: 50
Test accuracy for 6: 0.781
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 1: 0.9320000410079956
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 2: 0.9290000200271606
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 3: 0.9050000309944153
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for 5: 0.9070000648498535
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 26 epochs
Test accuracy for 6: 0.8480000495910645
Num non-zero elements: 1
Test accuracy for 1: 0.829
Num non-zero elements: 1
Test accuracy for 2: 0.833
Num non-zero elements: 1
Test accuracy for 3: 0.687
Num non-zero elements: 1
Test accuracy for 5: 0.81
Num non-zero elements: 1
Test accuracy for 6: 0.718
Num non-zero elements: 2
Test accuracy for 1: 0.844
Num non-zero elements: 2
Test accuracy for 2: 0.839
Num non-zero elements: 2
Test accuracy for 3: 0.696
Num non-zero elements: 2
Test accuracy for 5: 0.852
Num non-zero elements: 2
Test accuracy for 6: 0.726
Num non-zero elements: 5
Test accuracy for 1: 0.885
Num non-zero elements: 5
Test accuracy for 2: 0.856
Num non-zero elements: 5
Test accuracy for 3: 0.781
Num non-zero elements: 5
Test accuracy for 5: 0.876
Num non-zero elements: 5
Test accuracy for 6: 0.743
Num non-zero elements: 10
Test accuracy for 1: 0.899
Num non-zero elements: 10
Test accuracy for 2: 0.887
Num non-zero elements: 10
Test accuracy for 3: 0.816
Num non-zero elements: 10
Test accuracy for 5: 0.882
Num non-zero elements: 10
Test accuracy for 6: 0.753
Num non-zero elements: 20
Test accuracy for 1: 0.925
Num non-zero elements: 20
Test accuracy for 2: 0.895
Num non-zero elements: 20
Test accuracy for 3: 0.877
Num non-zero elements: 20
Test accuracy for 5: 0.893
Num non-zero elements: 20
Test accuracy for 6: 0.789
Num non-zero elements: 50
Test accuracy for 1: 0.941
Num non-zero elements: 50
Test accuracy for 2: 0.91
Num non-zero elements: 50
Test accuracy for 3: 0.889
Num non-zero elements: 50
Test accuracy for 5: 0.908
Num non-zero elements: 50
Test accuracy for 6: 0.839


Tokenizing data:   0%|          | 0/2 [00:00<?, ?it/s][A[A

Tokenizing data:  50%|█████     | 1/2 [00:00<00:00,  9.95it/s][A[ATokenizing data: 100%|██████████| 2/2 [00:00<00:00, 10.24it/s]


Tokenizing data:   0%|          | 0/2 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 2/2 [00:00<00:00, 37.44it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 28.20it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.09it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.50it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.48it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.07it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.78it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.57it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.39it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.30it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.23it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.19it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.47it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.08it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.18it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.74it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.49it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.34it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.17it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.12it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.13it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.98it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.08it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.66it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.42it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.27it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.13it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.45it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.42it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.90it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.56it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.34it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.20it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.36it/s]
Num non-zero elements: 2304
Test accuracy for 1.0: 0.903
Num non-zero elements: 2304
Test accuracy for 5.0: 0.903
Num non-zero elements: 1
Test accuracy for 1.0: 0.631
Num non-zero elements: 1
Test accuracy for 5.0: 0.631
Num non-zero elements: 2
Test accuracy for 1.0: 0.654
Num non-zero elements: 2
Test accuracy for 5.0: 0.654
Num non-zero elements: 5
Test accuracy for 1.0: 0.669
Num non-zero elements: 5
Test accuracy for 5.0: 0.669
Num non-zero elements: 10
Test accuracy for 1.0: 0.764
Num non-zero elements: 10
Test accuracy for 5.0: 0.764
Num non-zero elements: 20
Test accuracy for 1.0: 0.792
Num non-zero elements: 20
Test accuracy for 5.0: 0.792
Num non-zero elements: 50
Test accuracy for 1.0: 0.829
Num non-zero elements: 50
Test accuracy for 5.0: 0.828
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 31 epochs
Test accuracy for 1.0: 0.9070000648498535
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 30 epochs
Test accuracy for 5.0: 0.9050000309944153
Num non-zero elements: 1
Test accuracy for 1.0: 0.654
Num non-zero elements: 1
Test accuracy for 5.0: 0.654
Num non-zero elements: 2
Test accuracy for 1.0: 0.759
Num non-zero elements: 2
Test accuracy for 5.0: 0.759
Num non-zero elements: 5
Test accuracy for 1.0: 0.788
Num non-zero elements: 5
Test accuracy for 5.0: 0.788
Num non-zero elements: 10
Test accuracy for 1.0: 0.843
Num non-zero elements: 10
Test accuracy for 5.0: 0.843
Num non-zero elements: 20
Test accuracy for 1.0: 0.887
Num non-zero elements: 20
Test accuracy for 5.0: 0.887
Num non-zero elements: 50
Test accuracy for 1.0: 0.907
Num non-zero elements: 50
Test accuracy for 5.0: 0.907
Loading dataset codeparrot/github-code, this usually takes ~30 seconds


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  20%|██        | 1/5 [00:01<00:07,  1.94s/it][A[A

Tokenizing data:  40%|████      | 2/5 [00:02<00:04,  1.42s/it][A[A

Tokenizing data:  60%|██████    | 3/5 [00:04<00:02,  1.28s/it][A[A

Tokenizing data:  80%|████████  | 4/5 [00:04<00:00,  1.04it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:05<00:00,  1.07it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:05<00:00,  1.09s/it]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  20%|██        | 1/5 [00:00<00:02,  1.89it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:01,  2.87it/s][A[A

Tokenizing data:  60%|██████    | 3/5 [00:01<00:00,  3.04it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:01<00:00,  3.80it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:01<00:00,  4.22it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:01<00:00,  3.54it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.59it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 22.93it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.42it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.42it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.03it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.74it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.54it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.37it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.27it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.19it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 15.82it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.26it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 25.49it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 20.47it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 19.27it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.86it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.59it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.40it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.27it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.18it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.98it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.21it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 23.01it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.74it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 18.87it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.57it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.38it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.17it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 17.17it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:01, 16.85it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.27it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.17it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.96it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.52it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.54it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 22.79it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.28it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.27it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.88it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.60it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.37it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.22it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.90it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.88it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.88it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.87it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.87it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.86it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.86it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.86it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.86it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.86it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.85it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.86it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.86it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.86it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.29it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.20it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.07it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.61it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.34it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.07it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.01it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 17.95it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 15.43it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 17.89it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 17.88it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:02, 17.87it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 17.86it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 17.85it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 17.86it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 17.85it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 17.84it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 17.82it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 16.67it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.16it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.92it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:03<00:00, 17.89it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.86it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.84it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.84it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.84it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.88it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.68it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.22it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.69it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.38it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.05it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.35it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.05it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.34it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.77it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.44it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.22it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.39it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.32it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.42it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.32it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.58it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.32it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.05it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.41it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.60it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.50it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.85it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.48it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.24it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.10it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:01<00:00, 15.77it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 28.50it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 22.73it/s][A[A

Collecting activations:  56%|█████▋    | 9/16 [00:00<00:00, 20.14it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 19.11it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.72it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.43it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 19.50it/s]
Num non-zero elements: 2304
Test accuracy for C: 0.952
Num non-zero elements: 2304
Test accuracy for Python: 0.983
Num non-zero elements: 2304
Test accuracy for HTML: 0.979
Num non-zero elements: 2304
Test accuracy for Java: 0.955
Num non-zero elements: 2304
Test accuracy for PHP: 0.948
Num non-zero elements: 1
Test accuracy for C: 0.612
Num non-zero elements: 1
Test accuracy for Python: 0.623
Num non-zero elements: 1
Test accuracy for HTML: 0.694
Num non-zero elements: 1
Test accuracy for Java: 0.606
Num non-zero elements: 1
Test accuracy for PHP: 0.573
Num non-zero elements: 2
Test accuracy for C: 0.723
Num non-zero elements: 2
Test accuracy for Python: 0.63
Num non-zero elements: 2
Test accuracy for HTML: 0.948
Num non-zero elements: 2
Test accuracy for Java: 0.625
Num non-zero elements: 2
Test accuracy for PHP: 0.653
Num non-zero elements: 5
Test accuracy for C: 0.821
Num non-zero elements: 5
Test accuracy for Python: 0.75
Num non-zero elements: 5
Test accuracy for HTML: 0.952
Num non-zero elements: 5
Test accuracy for Java: 0.792
Num non-zero elements: 5
Test accuracy for PHP: 0.711
Num non-zero elements: 10
Test accuracy for C: 0.832
Num non-zero elements: 10
Test accuracy for Python: 0.853
Num non-zero elements: 10
Test accuracy for HTML: 0.956
Num non-zero elements: 10
Test accuracy for Java: 0.825
Num non-zero elements: 10
Test accuracy for PHP: 0.799
Num non-zero elements: 20
Test accuracy for C: 0.878
Num non-zero elements: 20
Test accuracy for Python: 0.908
Num non-zero elements: 20
Test accuracy for HTML: 0.96
Num non-zero elements: 20
Test accuracy for Java: 0.858
Num non-zero elements: 20
Test accuracy for PHP: 0.857
Num non-zero elements: 50
Test accuracy for C: 0.925
Num non-zero elements: 50
Test accuracy for Python: 0.962
Num non-zero elements: 50
Test accuracy for HTML: 0.971
Num non-zero elements: 50
Test accuracy for Java: 0.898
Num non-zero elements: 50
Test accuracy for PHP: 0.89
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 22 epochs
Test accuracy for C: 0.9510000348091125
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 20 epochs
Test accuracy for Python: 0.9920000433921814
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 24 epochs
Test accuracy for HTML: 0.9880000352859497
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 22 epochs
Test accuracy for Java: 0.968000054359436
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 51 epochs
Test accuracy for PHP: 0.956000030040741
Num non-zero elements: 1
Test accuracy for C: 0.722
Num non-zero elements: 1
Test accuracy for Python: 0.84
Num non-zero elements: 1
Test accuracy for HTML: 0.898
Num non-zero elements: 1
Test accuracy for Java: 0.779
Num non-zero elements: 1
Test accuracy for PHP: 0.904
Num non-zero elements: 2
Test accuracy for C: 0.865
Num non-zero elements: 2
Test accuracy for Python: 0.841
Num non-zero elements: 2
Test accuracy for HTML: 0.94
Num non-zero elements: 2
Test accuracy for Java: 0.784
Num non-zero elements: 2
Test accuracy for PHP: 0.902
Num non-zero elements: 5
Test accuracy for C: 0.893
Num non-zero elements: 5
Test accuracy for Python: 0.954
Num non-zero elements: 5
Test accuracy for HTML: 0.946
Num non-zero elements: 5
Test accuracy for Java: 0.906
Num non-zero elements: 5
Test accuracy for PHP: 0.907
Num non-zero elements: 10
Test accuracy for C: 0.898
Num non-zero elements: 10
Test accuracy for Python: 0.973
Num non-zero elements: 10
Test accuracy for HTML: 0.948
Num non-zero elements: 10
Test accuracy for Java: 0.927
Num non-zero elements: 10
Test accuracy for PHP: 0.912
Num non-zero elements: 20
Test accuracy for C: 0.928
Num non-zero elements: 20
Test accuracy for Python: 0.978
Num non-zero elements: 20
Test accuracy for HTML: 0.953
Num non-zero elements: 20
Test accuracy for Java: 0.935
Num non-zero elements: 20
Test accuracy for PHP: 0.925
Num non-zero elements: 50
Test accuracy for C: 0.932
Num non-zero elements: 50
Test accuracy for Python: 0.982
Num non-zero elements: 50
Test accuracy for HTML: 0.968
Num non-zero elements: 50
Test accuracy for Java: 0.939
Num non-zero elements: 50
Test accuracy for PHP: 0.927


Tokenizing data:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Tokenizing data:  50%|█████     | 2/4 [00:00<00:00, 13.86it/s][A[A

Tokenizing data: 100%|██████████| 4/4 [00:00<00:00, 14.04it/s][A[ATokenizing data: 100%|██████████| 4/4 [00:00<00:00, 13.98it/s]


Tokenizing data:   0%|          | 0/4 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 4/4 [00:00<00:00, 58.76it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.31it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.24it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.60it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.55it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.14it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.84it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.63it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.47it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.36it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.29it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.23it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.20it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.09it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.53it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.11it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.22it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.79it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.54it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.39it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.28it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.17it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.07it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.17it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.74it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.50it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.34it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.17it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.12it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.14it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.18it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.18it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.72it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.47it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.20it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.13it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.09it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.30it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 17.76it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.96it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.08it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 23.07it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.73it/s][A[A

Collecting activations:  56%|█████▋    | 9/16 [00:00<00:00, 18.87it/s][A[A

Collecting activations:  69%|██████▉   | 11/16 [00:00<00:00, 18.55it/s][A[A

Collecting activations:  81%|████████▏ | 13/16 [00:00<00:00, 17.76it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.36it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.62it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.56it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.57it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.93it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.57it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.35it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.21it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.13it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.63it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.17it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.45it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.86it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.53it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.32it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.19it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.11it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.50it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.42it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.53it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.92it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.54it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.32it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.50it/s]
Num non-zero elements: 2304
Test accuracy for 0: 0.93
Num non-zero elements: 2304
Test accuracy for 1: 0.986
Num non-zero elements: 2304
Test accuracy for 2: 0.895
Num non-zero elements: 2304
Test accuracy for 3: 0.915
Num non-zero elements: 1
Test accuracy for 0: 0.78
Num non-zero elements: 1
Test accuracy for 1: 0.692
Num non-zero elements: 1
Test accuracy for 2: 0.647
Num non-zero elements: 1
Test accuracy for 3: 0.78
Num non-zero elements: 2
Test accuracy for 0: 0.785
Num non-zero elements: 2
Test accuracy for 1: 0.798
Num non-zero elements: 2
Test accuracy for 2: 0.691
Num non-zero elements: 2
Test accuracy for 3: 0.799
Num non-zero elements: 5
Test accuracy for 0: 0.886
Num non-zero elements: 5
Test accuracy for 1: 0.886
Num non-zero elements: 5
Test accuracy for 2: 0.771
Num non-zero elements: 5
Test accuracy for 3: 0.85
Num non-zero elements: 10
Test accuracy for 0: 0.887
Num non-zero elements: 10
Test accuracy for 1: 0.944
Num non-zero elements: 10
Test accuracy for 2: 0.797
Num non-zero elements: 10
Test accuracy for 3: 0.86
Num non-zero elements: 20
Test accuracy for 0: 0.9
Num non-zero elements: 20
Test accuracy for 1: 0.968
Num non-zero elements: 20
Test accuracy for 2: 0.87
Num non-zero elements: 20
Test accuracy for 3: 0.893
Num non-zero elements: 50
Test accuracy for 0: 0.905
Num non-zero elements: 50
Test accuracy for 1: 0.961
Num non-zero elements: 50
Test accuracy for 2: 0.881
Num non-zero elements: 50
Test accuracy for 3: 0.908
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 0: 0.937000036239624
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for 1: 0.9770000576972961
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for 2: 0.9180000424385071
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for 3: 0.9480000734329224
Num non-zero elements: 1
Test accuracy for 0: 0.832
Num non-zero elements: 1
Test accuracy for 1: 0.961
Num non-zero elements: 1
Test accuracy for 2: 0.783
Num non-zero elements: 1
Test accuracy for 3: 0.631
Num non-zero elements: 2
Test accuracy for 0: 0.831
Num non-zero elements: 2
Test accuracy for 1: 0.962
Num non-zero elements: 2
Test accuracy for 2: 0.826
Num non-zero elements: 2
Test accuracy for 3: 0.791
Num non-zero elements: 5
Test accuracy for 0: 0.865
Num non-zero elements: 5
Test accuracy for 1: 0.959
Num non-zero elements: 5
Test accuracy for 2: 0.831
Num non-zero elements: 5
Test accuracy for 3: 0.843
Num non-zero elements: 10
Test accuracy for 0: 0.894
Num non-zero elements: 10
Test accuracy for 1: 0.962
Num non-zero elements: 10
Test accuracy for 2: 0.85
Num non-zero elements: 10
Test accuracy for 3: 0.882
Num non-zero elements: 20
Test accuracy for 0: 0.91
Num non-zero elements: 20
Test accuracy for 1: 0.974
Num non-zero elements: 20
Test accuracy for 2: 0.869
Num non-zero elements: 20
Test accuracy for 3: 0.91
Num non-zero elements: 50
Test accuracy for 0: 0.924
Num non-zero elements: 50
Test accuracy for 1: 0.976
Num non-zero elements: 50
Test accuracy for 2: 0.881
Num non-zero elements: 50
Test accuracy for 3: 0.936
Loading dataset Helsinki-NLP/europarl, this usually takes ~10 seconds


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 14.91it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 14.62it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 12.19it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 56.70it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 26.65it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.14it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.57it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.56it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.16it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.87it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.66it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.48it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.39it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.32it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.27it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.24it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.21it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.15it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.15it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.15it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.14it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.15it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.14it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.14it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.13it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.13it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.55it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.55it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.39it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.91it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.63it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.47it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.35it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.27it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.07it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.23it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.03it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.18it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.77it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.53it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.37it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.27it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.17it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.06it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.17it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.76it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.49it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.34it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.13it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 16.76it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 18.36it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.27it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.18it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.12it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 12.45it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.27it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 29.32it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 21.80it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 19.87it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.09it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.78it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.54it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.21it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.91it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.91it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.91it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.92it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.91it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.30it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.92it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.05it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.62it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.37it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.21it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.11it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.06it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.40it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.36it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.84it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.50it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.29it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.08it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.31it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.11it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.85it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.50it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.29it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.08it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.30it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.31it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.81it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.48it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.27it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.30it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.28it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.79it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.46it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.25it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.13it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.05it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.28it/s]
Num non-zero elements: 2304
Test accuracy for en: 0.998
Num non-zero elements: 2304
Test accuracy for fr: 1.0
Num non-zero elements: 2304
Test accuracy for de: 0.999
Num non-zero elements: 2304
Test accuracy for es: 0.998
Num non-zero elements: 2304
Test accuracy for nl: 1.0
Num non-zero elements: 1
Test accuracy for en: 0.94
Num non-zero elements: 1
Test accuracy for fr: 0.643
Num non-zero elements: 1
Test accuracy for de: 0.815
Num non-zero elements: 1
Test accuracy for es: 0.897
Num non-zero elements: 1
Test accuracy for nl: 0.853
Num non-zero elements: 2
Test accuracy for en: 0.974
Num non-zero elements: 2
Test accuracy for fr: 0.905
Num non-zero elements: 2
Test accuracy for de: 0.84
Num non-zero elements: 2
Test accuracy for es: 0.896
Num non-zero elements: 2
Test accuracy for nl: 0.888
Num non-zero elements: 5
Test accuracy for en: 0.995
Num non-zero elements: 5
Test accuracy for fr: 0.975
Num non-zero elements: 5
Test accuracy for de: 0.891
Num non-zero elements: 5
Test accuracy for es: 0.984
Num non-zero elements: 5
Test accuracy for nl: 0.947
Num non-zero elements: 10
Test accuracy for en: 0.997
Num non-zero elements: 10
Test accuracy for fr: 0.989
Num non-zero elements: 10
Test accuracy for de: 0.981
Num non-zero elements: 10
Test accuracy for es: 0.988
Num non-zero elements: 10
Test accuracy for nl: 0.977
Num non-zero elements: 20
Test accuracy for en: 0.999
Num non-zero elements: 20
Test accuracy for fr: 0.996
Num non-zero elements: 20
Test accuracy for de: 0.992
Num non-zero elements: 20
Test accuracy for es: 0.994
Num non-zero elements: 20
Test accuracy for nl: 0.978
Num non-zero elements: 50
Test accuracy for en: 0.999
Num non-zero elements: 50
Test accuracy for fr: 0.999
Num non-zero elements: 50
Test accuracy for de: 0.998
Num non-zero elements: 50
Test accuracy for es: 0.998
Num non-zero elements: 50
Test accuracy for nl: 0.995
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 11 epochs
Test accuracy for en: 0.9980000257492065
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for fr: 1.0
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for de: 1.0
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for es: 1.0
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 17 epochs
Test accuracy for nl: 1.0
Num non-zero elements: 1
Test accuracy for en: 0.999
Num non-zero elements: 1
Test accuracy for fr: 0.998
Num non-zero elements: 1
Test accuracy for de: 0.994
Num non-zero elements: 1
Test accuracy for es: 0.787
Num non-zero elements: 1
Test accuracy for nl: 0.954
Num non-zero elements: 2
Test accuracy for en: 0.999
Num non-zero elements: 2
Test accuracy for fr: 0.995
Num non-zero elements: 2
Test accuracy for de: 0.995
Num non-zero elements: 2
Test accuracy for es: 0.997
Num non-zero elements: 2
Test accuracy for nl: 0.997
Num non-zero elements: 5
Test accuracy for en: 0.998
Num non-zero elements: 5
Test accuracy for fr: 0.997
Num non-zero elements: 5
Test accuracy for de: 0.997
Num non-zero elements: 5
Test accuracy for es: 0.997
Num non-zero elements: 5
Test accuracy for nl: 0.993
Num non-zero elements: 10
Test accuracy for en: 0.999
Num non-zero elements: 10
Test accuracy for fr: 0.998
Num non-zero elements: 10
Test accuracy for de: 1.0
Num non-zero elements: 10
Test accuracy for es: 0.999
Num non-zero elements: 10
Test accuracy for nl: 0.997
Num non-zero elements: 20
Test accuracy for en: 0.998
Num non-zero elements: 20
Test accuracy for fr: 0.997
Num non-zero elements: 20
Test accuracy for de: 0.999
Num non-zero elements: 20
Test accuracy for es: 0.999
Num non-zero elements: 20
Test accuracy for nl: 0.998
Num non-zero elements: 50
Test accuracy for en: 0.998
Num non-zero elements: 50
Test accuracy for fr: 0.997
Num non-zero elements: 50
Test accuracy for de: 0.999
Num non-zero elements: 50
Test accuracy for es: 0.998
Num non-zero elements: 50
Test accuracy for nl: 0.999

Running SAE evaluation on all selected SAEs: 100%|██████████| 1/1 [16:33<00:00, 993.49s/it][ARunning SAE evaluation on all selected SAEs: 100%|██████████| 1/1 [16:33<00:00, 993.49s/it]
Evaluations: 100%|██████████| 1/1 [16:45<00:00, 1005.95s/it]Evaluations: 100%|██████████| 1/1 [16:45<00:00, 1005.95s/it]
/share/u/can/SAEBench/custom_saes/topk_sae.py:110: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  pt_params = t.load(path_to_params)
Loaded config: {'trainer': {'trainer_class': 'TrainerTopKAdditivity', 'dict_class': 'AutoEncoderTopK', 'lr': 0.000282842712474619, 'steps': 48828, 'seed': 0, 'activation_dim': 2304, 'dict_size': 8192, 'k': 125, 'auxk_alpha': 0.03125, 'additivity_coeff': 1.0, 'intersection_coeff': 0.0, 'device': 'cuda:0', 'layer': 4, 'lm_name': 'google/gemma-2-2b', 'wandb_name': 'TopKTrainer_Additivity-google/gemma-2-2b-resid_post_layer_4-add_coeff-1.0-inters_coeff-0.0', 'submodule_name': 'resid_post_layer_4'}, 'buffer': {'d_submodule': 2304, 'io': 'out', 'n_ctxs': 8192, 'ctx_len': 128, 'refresh_batch_size': 32, 'out_batch_size': 2048, 'device': 'cuda:0'}}
Original keys in state_dict: odict_keys(['b_dec', 'encoder.weight', 'encoder.bias', 'decoder.weight'])
Renamed keys in state_dict: dict_keys(['b_dec', 'W_enc', 'b_enc', 'W_dec'])
Evaluations:   0%|          | 0/1 [00:00<?, ?it/s]


Running sparse_probing evaluation




Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s][A
Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:01,  1.50it/s][A
Loading checkpoint shards:  67%|██████▋   | 2/3 [00:01<00:00,  1.56it/s][A
Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.21it/s][ALoading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  1.97it/s]
Loaded pretrained model gemma-2-2b into HookedTransformer

Running SAE evaluation on all selected SAEs:   0%|          | 0/1 [00:00<?, ?it/s][A

  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 653.27it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 941.50it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 12.61it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 12.81it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 12.71it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 49.69it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 47.67it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 25.72it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.03it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.51it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.51it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.12it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.84it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 16.54it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.83it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.65it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.50it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:02, 14.95it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.52it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.67it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.80it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.89it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 15.86it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.37it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.30it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 18.25it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.20it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.18it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.16it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.17it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.18it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 23.48it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 20.01it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 19.08it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.78it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.57it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.43it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.33it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.25it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.21it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.18it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.08it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.27it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 23.50it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.97it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 19.03it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.72it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.51it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.36it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.26it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.19it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.20it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 23.85it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 20.01it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 19.07it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.73it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.49it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.35it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 17.32it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.21it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.15it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.21it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 22.14it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.49it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.90it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.56it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.36it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.15it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.08it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.92it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.91it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.91it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.90it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.90it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.95it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 27.69it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 21.01it/s][A[A

Collecting activations:  56%|█████▋    | 9/16 [00:00<00:00, 19.47it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.81it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.56it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.37it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 19.08it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.41it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.52it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.91it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.56it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.34it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 16.49it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.61it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.48it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.88it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.52it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.30it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.17it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.09it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.29it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.30it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.17it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.69it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.40it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.23it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.13it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.07it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.39it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.94it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.34it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.80it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.47it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.13it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.06it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.43it/s]
Num non-zero elements: 2304
Test accuracy for 0: 0.925
Num non-zero elements: 2304
Test accuracy for 1: 0.943
Num non-zero elements: 2304
Test accuracy for 2: 0.947
Num non-zero elements: 2304
Test accuracy for 6: 0.991
Num non-zero elements: 2304
Test accuracy for 9: 0.971
Num non-zero elements: 1
Test accuracy for 0: 0.603
Num non-zero elements: 1
Test accuracy for 1: 0.648
Num non-zero elements: 1
Test accuracy for 2: 0.731
Num non-zero elements: 1
Test accuracy for 6: 0.773
Num non-zero elements: 1
Test accuracy for 9: 0.68
Num non-zero elements: 2
Test accuracy for 0: 0.682
Num non-zero elements: 2
Test accuracy for 1: 0.655
Num non-zero elements: 2
Test accuracy for 2: 0.744
Num non-zero elements: 2
Test accuracy for 6: 0.771
Num non-zero elements: 2
Test accuracy for 9: 0.772
Num non-zero elements: 5
Test accuracy for 0: 0.768
Num non-zero elements: 5
Test accuracy for 1: 0.69
Num non-zero elements: 5
Test accuracy for 2: 0.754
Num non-zero elements: 5
Test accuracy for 6: 0.905
Num non-zero elements: 5
Test accuracy for 9: 0.798
Num non-zero elements: 10
Test accuracy for 0: 0.797
Num non-zero elements: 10
Test accuracy for 1: 0.818
Num non-zero elements: 10
Test accuracy for 2: 0.83
Num non-zero elements: 10
Test accuracy for 6: 0.929
Num non-zero elements: 10
Test accuracy for 9: 0.912
Num non-zero elements: 20
Test accuracy for 0: 0.796
Num non-zero elements: 20
Test accuracy for 1: 0.867
Num non-zero elements: 20
Test accuracy for 2: 0.847
Num non-zero elements: 20
Test accuracy for 6: 0.96
Num non-zero elements: 20
Test accuracy for 9: 0.945
Num non-zero elements: 50
Test accuracy for 0: 0.862
Num non-zero elements: 50
Test accuracy for 1: 0.905
Num non-zero elements: 50
Test accuracy for 2: 0.897
Num non-zero elements: 50
Test accuracy for 6: 0.977
Num non-zero elements: 50
Test accuracy for 9: 0.948
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 22 epochs
Test accuracy for 0: 0.9420000314712524
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 1: 0.9630000591278076
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 21 epochs
Test accuracy for 2: 0.9460000395774841
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 14 epochs
Test accuracy for 6: 0.9850000739097595
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for 9: 0.9800000190734863
Num non-zero elements: 1
Test accuracy for 0: 0.634
Num non-zero elements: 1
Test accuracy for 1: 0.66
Num non-zero elements: 1
Test accuracy for 2: 0.85
Num non-zero elements: 1
Test accuracy for 6: 0.962
Num non-zero elements: 1
Test accuracy for 9: 0.926
Num non-zero elements: 2
Test accuracy for 0: 0.817
Num non-zero elements: 2
Test accuracy for 1: 0.716
Num non-zero elements: 2
Test accuracy for 2: 0.909
Num non-zero elements: 2
Test accuracy for 6: 0.969
Num non-zero elements: 2
Test accuracy for 9: 0.931
Num non-zero elements: 5
Test accuracy for 0: 0.881
Num non-zero elements: 5
Test accuracy for 1: 0.874
Num non-zero elements: 5
Test accuracy for 2: 0.897
Num non-zero elements: 5
Test accuracy for 6: 0.986
Num non-zero elements: 5
Test accuracy for 9: 0.942
Num non-zero elements: 10
Test accuracy for 0: 0.893
Num non-zero elements: 10
Test accuracy for 1: 0.874
Num non-zero elements: 10
Test accuracy for 2: 0.92
Num non-zero elements: 10
Test accuracy for 6: 0.985
Num non-zero elements: 10
Test accuracy for 9: 0.951
Num non-zero elements: 20
Test accuracy for 0: 0.901
Num non-zero elements: 20
Test accuracy for 1: 0.943
Num non-zero elements: 20
Test accuracy for 2: 0.924
Num non-zero elements: 20
Test accuracy for 6: 0.984
Num non-zero elements: 20
Test accuracy for 9: 0.968
Num non-zero elements: 50
Test accuracy for 0: 0.939
Num non-zero elements: 50
Test accuracy for 1: 0.961
Num non-zero elements: 50
Test accuracy for 2: 0.919
Num non-zero elements: 50
Test accuracy for 6: 0.987
Num non-zero elements: 50
Test accuracy for 9: 0.972


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 653.67it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 1088.46it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 12.81it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 12.83it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 12.87it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 45.31it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 45.05it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 26.50it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.30it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.65it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.59it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.18it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.89it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.67it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.49it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.38it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.31it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.26it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.21it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.20it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.15it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.15it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.14it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.14it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.14it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.13it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.12it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.11it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.55it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.16it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.25it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.82it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.57it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.42it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.32it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.20it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.06it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.18it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.76it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.51it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.35it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.15it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.97it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.12it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.71it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.47it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.32it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.22it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.15it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.11it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.98it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.12it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.79it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.37it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.83it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.53it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.33it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.20it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.08it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.51it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.92it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.09it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.99it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.39it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.83it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.50it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.30it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.17it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.46it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.85it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.65it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.81it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.64it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.39it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.22it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.14it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.56it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.68it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.61it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 16.62it/s][A[A

Collecting activations:  69%|██████▉   | 11/16 [00:00<00:00, 19.06it/s][A[A

Collecting activations:  81%|████████▏ | 13/16 [00:00<00:00, 18.69it/s][A[A

Collecting activations:  94%|█████████▍| 15/16 [00:00<00:00, 16.47it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.02it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 25.35it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 20.37it/s][A[A

Collecting activations:  56%|█████▋    | 9/16 [00:00<00:00, 19.14it/s][A[A

Collecting activations:  69%|██████▉   | 11/16 [00:00<00:00, 17.66it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.68it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.46it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.85it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.34it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.47it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.87it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.52it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.30it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.17it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.09it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.48it/s]
Num non-zero elements: 2304
Test accuracy for 11: 0.937
Num non-zero elements: 2304
Test accuracy for 13: 0.944
Num non-zero elements: 2304
Test accuracy for 14: 0.944
Num non-zero elements: 2304
Test accuracy for 18: 0.919
Num non-zero elements: 2304
Test accuracy for 19: 0.956
Num non-zero elements: 1
Test accuracy for 11: 0.711
Num non-zero elements: 1
Test accuracy for 13: 0.709
Num non-zero elements: 1
Test accuracy for 14: 0.669
Num non-zero elements: 1
Test accuracy for 18: 0.69
Num non-zero elements: 1
Test accuracy for 19: 0.787
Num non-zero elements: 2
Test accuracy for 11: 0.736
Num non-zero elements: 2
Test accuracy for 13: 0.692
Num non-zero elements: 2
Test accuracy for 14: 0.67
Num non-zero elements: 2
Test accuracy for 18: 0.703
Num non-zero elements: 2
Test accuracy for 19: 0.803
Num non-zero elements: 5
Test accuracy for 11: 0.832
Num non-zero elements: 5
Test accuracy for 13: 0.777
Num non-zero elements: 5
Test accuracy for 14: 0.762
Num non-zero elements: 5
Test accuracy for 18: 0.72
Num non-zero elements: 5
Test accuracy for 19: 0.824
Num non-zero elements: 10
Test accuracy for 11: 0.877
Num non-zero elements: 10
Test accuracy for 13: 0.844
Num non-zero elements: 10
Test accuracy for 14: 0.79
Num non-zero elements: 10
Test accuracy for 18: 0.746
Num non-zero elements: 10
Test accuracy for 19: 0.828
Num non-zero elements: 20
Test accuracy for 11: 0.904
Num non-zero elements: 20
Test accuracy for 13: 0.875
Num non-zero elements: 20
Test accuracy for 14: 0.856
Num non-zero elements: 20
Test accuracy for 18: 0.762
Num non-zero elements: 20
Test accuracy for 19: 0.919
Num non-zero elements: 50
Test accuracy for 11: 0.917
Num non-zero elements: 50
Test accuracy for 13: 0.893
Num non-zero elements: 50
Test accuracy for 14: 0.896
Num non-zero elements: 50
Test accuracy for 18: 0.822
Num non-zero elements: 50
Test accuracy for 19: 0.921
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for 11: 0.9540000557899475
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for 13: 0.9490000605583191
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 14: 0.9510000348091125
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for 18: 0.9350000619888306
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 22 epochs
Test accuracy for 19: 0.9590000510215759
Num non-zero elements: 1
Test accuracy for 11: 0.725
Num non-zero elements: 1
Test accuracy for 13: 0.747
Num non-zero elements: 1
Test accuracy for 14: 0.911
Num non-zero elements: 1
Test accuracy for 18: 0.723
Num non-zero elements: 1
Test accuracy for 19: 0.86
Num non-zero elements: 2
Test accuracy for 11: 0.844
Num non-zero elements: 2
Test accuracy for 13: 0.797
Num non-zero elements: 2
Test accuracy for 14: 0.917
Num non-zero elements: 2
Test accuracy for 18: 0.839
Num non-zero elements: 2
Test accuracy for 19: 0.859
Num non-zero elements: 5
Test accuracy for 11: 0.915
Num non-zero elements: 5
Test accuracy for 13: 0.804
Num non-zero elements: 5
Test accuracy for 14: 0.925
Num non-zero elements: 5
Test accuracy for 18: 0.893
Num non-zero elements: 5
Test accuracy for 19: 0.879
Num non-zero elements: 10
Test accuracy for 11: 0.936
Num non-zero elements: 10
Test accuracy for 13: 0.916
Num non-zero elements: 10
Test accuracy for 14: 0.92
Num non-zero elements: 10
Test accuracy for 18: 0.888
Num non-zero elements: 10
Test accuracy for 19: 0.902
Num non-zero elements: 20
Test accuracy for 11: 0.959
Num non-zero elements: 20
Test accuracy for 13: 0.934
Num non-zero elements: 20
Test accuracy for 14: 0.938
Num non-zero elements: 20
Test accuracy for 18: 0.887
Num non-zero elements: 20
Test accuracy for 19: 0.924
Num non-zero elements: 50
Test accuracy for 11: 0.951
Num non-zero elements: 50
Test accuracy for 13: 0.943
Num non-zero elements: 50
Test accuracy for 14: 0.944
Num non-zero elements: 50
Test accuracy for 18: 0.912
Num non-zero elements: 50
Test accuracy for 19: 0.934


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 643.50it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 1047.58it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 12.40it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00,  7.63it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00,  8.75it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 45.40it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 45.22it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 26.32it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.35it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.68it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.63it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.22it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.92it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.69it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.51it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.41it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.34it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.29it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.25it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.23it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.22it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.21it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.17it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.15it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.15it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.15it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.15it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.15it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.14it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.14it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.14it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.15it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.58it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.18it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.27it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.86it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.62it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.45it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.35it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.28it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.20it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.19it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.12it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.11it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.12it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.12it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.25it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.11it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.25it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.83it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.57it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.42it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.32it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.20it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.08it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.22it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.07it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.19it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.79it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.54it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.39it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.28it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.17it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.04it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.16it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.74it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.49it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.32it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.22it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.12it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.14it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.01it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.11it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.67it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.42it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.27it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.11it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.46it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.36it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.87it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.52it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.32it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.21it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.13it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.35it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.67it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.00it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.60it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.37it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.23it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.14it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.38it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.13it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.13it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.68it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.43it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.45it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.37it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.86it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.52it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.30it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.17it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.09it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.06it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.32it/s]
Num non-zero elements: 2304
Test accuracy for 20: 0.939
Num non-zero elements: 2304
Test accuracy for 21: 0.905
Num non-zero elements: 2304
Test accuracy for 22: 0.92
Num non-zero elements: 2304
Test accuracy for 25: 0.954
Num non-zero elements: 2304
Test accuracy for 26: 0.857
Num non-zero elements: 1
Test accuracy for 20: 0.752
Num non-zero elements: 1
Test accuracy for 21: 0.628
Num non-zero elements: 1
Test accuracy for 22: 0.626
Num non-zero elements: 1
Test accuracy for 25: 0.7
Num non-zero elements: 1
Test accuracy for 26: 0.653
Num non-zero elements: 2
Test accuracy for 20: 0.809
Num non-zero elements: 2
Test accuracy for 21: 0.73
Num non-zero elements: 2
Test accuracy for 22: 0.623
Num non-zero elements: 2
Test accuracy for 25: 0.712
Num non-zero elements: 2
Test accuracy for 26: 0.654
Num non-zero elements: 5
Test accuracy for 20: 0.847
Num non-zero elements: 5
Test accuracy for 21: 0.756
Num non-zero elements: 5
Test accuracy for 22: 0.732
Num non-zero elements: 5
Test accuracy for 25: 0.797
Num non-zero elements: 5
Test accuracy for 26: 0.691
Num non-zero elements: 10
Test accuracy for 20: 0.874
Num non-zero elements: 10
Test accuracy for 21: 0.834
Num non-zero elements: 10
Test accuracy for 22: 0.732
Num non-zero elements: 10
Test accuracy for 25: 0.869
Num non-zero elements: 10
Test accuracy for 26: 0.706
Num non-zero elements: 20
Test accuracy for 20: 0.897
Num non-zero elements: 20
Test accuracy for 21: 0.82
Num non-zero elements: 20
Test accuracy for 22: 0.79
Num non-zero elements: 20
Test accuracy for 25: 0.897
Num non-zero elements: 20
Test accuracy for 26: 0.776
Num non-zero elements: 50
Test accuracy for 20: 0.902
Num non-zero elements: 50
Test accuracy for 21: 0.876
Num non-zero elements: 50
Test accuracy for 22: 0.838
Num non-zero elements: 50
Test accuracy for 25: 0.923
Num non-zero elements: 50
Test accuracy for 26: 0.807
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 32 epochs
Test accuracy for 20: 0.9550000429153442
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 21: 0.9110000729560852
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 17 epochs
Test accuracy for 22: 0.9110000729560852
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for 25: 0.9570000171661377
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 26: 0.8810000419616699
Num non-zero elements: 1
Test accuracy for 20: 0.891
Num non-zero elements: 1
Test accuracy for 21: 0.747
Num non-zero elements: 1
Test accuracy for 22: 0.797
Num non-zero elements: 1
Test accuracy for 25: 0.849
Num non-zero elements: 1
Test accuracy for 26: 0.719
Num non-zero elements: 2
Test accuracy for 20: 0.893
Num non-zero elements: 2
Test accuracy for 21: 0.826
Num non-zero elements: 2
Test accuracy for 22: 0.858
Num non-zero elements: 2
Test accuracy for 25: 0.876
Num non-zero elements: 2
Test accuracy for 26: 0.779
Num non-zero elements: 5
Test accuracy for 20: 0.908
Num non-zero elements: 5
Test accuracy for 21: 0.818
Num non-zero elements: 5
Test accuracy for 22: 0.876
Num non-zero elements: 5
Test accuracy for 25: 0.898
Num non-zero elements: 5
Test accuracy for 26: 0.786
Num non-zero elements: 10
Test accuracy for 20: 0.91
Num non-zero elements: 10
Test accuracy for 21: 0.835
Num non-zero elements: 10
Test accuracy for 22: 0.887
Num non-zero elements: 10
Test accuracy for 25: 0.901
Num non-zero elements: 10
Test accuracy for 26: 0.822
Num non-zero elements: 20
Test accuracy for 20: 0.915
Num non-zero elements: 20
Test accuracy for 21: 0.85
Num non-zero elements: 20
Test accuracy for 22: 0.888
Num non-zero elements: 20
Test accuracy for 25: 0.936
Num non-zero elements: 20
Test accuracy for 26: 0.847
Num non-zero elements: 50
Test accuracy for 20: 0.925
Num non-zero elements: 50
Test accuracy for 21: 0.875
Num non-zero elements: 50
Test accuracy for 22: 0.885
Num non-zero elements: 50
Test accuracy for 25: 0.957
Num non-zero elements: 50
Test accuracy for 26: 0.858


  0%|          | 0/34 [00:00<?, ?it/s][A[A100%|██████████| 34/34 [00:00<00:00, 397.64it/s]


  0%|          | 0/31 [00:00<?, ?it/s][A[A100%|██████████| 31/31 [00:00<00:00, 894.88it/s]
Removing 31 from train set
Removing 0 from train set
Removing 29 from train set
Removing 28 from train set
Removing 7 from train set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  20%|██        | 1/5 [00:00<00:00,  9.91it/s][A[A

Tokenizing data:  60%|██████    | 3/5 [00:00<00:00, 10.31it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 10.21it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 10.17it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 38.61it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 38.01it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 28.08it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 22.82it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.40it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.42it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.04it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.76it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.56it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.38it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.28it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.22it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.77it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.20it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.46it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.96it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.45it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.91it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.60it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.41it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.22it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 16.40it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.46it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.33it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.23it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 18.11it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.16it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.27it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.20it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.75it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.48it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.09it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.95it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.10it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.81it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.34it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.81it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.52it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.33it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.20it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.11it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.05it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.95it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:02, 14.18it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 16.87it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 17.14it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 17.08it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 17.59it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 17.68it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:01, 17.75it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 17.79it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 17.81it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 17.84it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 17.88it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 17.88it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.89it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.89it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.91it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.76it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 23.43it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.81it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 18.88it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.57it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.37it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.11it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 17.95it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 17.93it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:02, 17.91it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 17.89it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 17.88it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 17.88it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 17.87it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 14.19it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 16.86it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.13it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.33it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.48it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.58it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 16.37it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.92it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.92it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.78it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.09it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.94it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.88it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.50it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.27it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 16.69it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.50it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.03it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.03it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.58it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.32it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.05it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.26it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.83it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.60it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.92it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.53it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.30it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.05it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.51it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.28it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.42it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.80it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.44it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.23it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.10it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.02it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.14it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 26.61it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 22.64it/s][A[A

Collecting activations:  56%|█████▋    | 9/16 [00:00<00:00, 20.14it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 17.96it/s][A[A

Collecting activations:  94%|█████████▍| 15/16 [00:00<00:00, 18.86it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 19.44it/s]
Num non-zero elements: 2304
Test accuracy for 1: 0.915
Num non-zero elements: 2304
Test accuracy for 2: 0.913
Num non-zero elements: 2304
Test accuracy for 3: 0.898
Num non-zero elements: 2304
Test accuracy for 5: 0.89
Num non-zero elements: 2304
Test accuracy for 6: 0.8
Num non-zero elements: 1
Test accuracy for 1: 0.724
Num non-zero elements: 1
Test accuracy for 2: 0.712
Num non-zero elements: 1
Test accuracy for 3: 0.601
Num non-zero elements: 1
Test accuracy for 5: 0.681
Num non-zero elements: 1
Test accuracy for 6: 0.616
Num non-zero elements: 2
Test accuracy for 1: 0.714
Num non-zero elements: 2
Test accuracy for 2: 0.783
Num non-zero elements: 2
Test accuracy for 3: 0.615
Num non-zero elements: 2
Test accuracy for 5: 0.697
Num non-zero elements: 2
Test accuracy for 6: 0.612
Num non-zero elements: 5
Test accuracy for 1: 0.792
Num non-zero elements: 5
Test accuracy for 2: 0.804
Num non-zero elements: 5
Test accuracy for 3: 0.635
Num non-zero elements: 5
Test accuracy for 5: 0.712
Num non-zero elements: 5
Test accuracy for 6: 0.697
Num non-zero elements: 10
Test accuracy for 1: 0.843
Num non-zero elements: 10
Test accuracy for 2: 0.81
Num non-zero elements: 10
Test accuracy for 3: 0.712
Num non-zero elements: 10
Test accuracy for 5: 0.744
Num non-zero elements: 10
Test accuracy for 6: 0.729
Num non-zero elements: 20
Test accuracy for 1: 0.832
Num non-zero elements: 20
Test accuracy for 2: 0.827
Num non-zero elements: 20
Test accuracy for 3: 0.8
Num non-zero elements: 20
Test accuracy for 5: 0.75
Num non-zero elements: 20
Test accuracy for 6: 0.743
Num non-zero elements: 50
Test accuracy for 1: 0.881
Num non-zero elements: 50
Test accuracy for 2: 0.853
Num non-zero elements: 50
Test accuracy for 3: 0.86
Num non-zero elements: 50
Test accuracy for 5: 0.815
Num non-zero elements: 50
Test accuracy for 6: 0.775
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for 1: 0.9320000410079956
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 28 epochs
Test accuracy for 2: 0.9430000185966492
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 40 epochs
Test accuracy for 3: 0.9080000519752502
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 24 epochs
Test accuracy for 5: 0.9120000600814819
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 22 epochs
Test accuracy for 6: 0.8400000333786011
Num non-zero elements: 1
Test accuracy for 1: 0.853
Num non-zero elements: 1
Test accuracy for 2: 0.789
Num non-zero elements: 1
Test accuracy for 3: 0.69
Num non-zero elements: 1
Test accuracy for 5: 0.799
Num non-zero elements: 1
Test accuracy for 6: 0.638
Num non-zero elements: 2
Test accuracy for 1: 0.862
Num non-zero elements: 2
Test accuracy for 2: 0.817
Num non-zero elements: 2
Test accuracy for 3: 0.707
Num non-zero elements: 2
Test accuracy for 5: 0.847
Num non-zero elements: 2
Test accuracy for 6: 0.715
Num non-zero elements: 5
Test accuracy for 1: 0.875
Num non-zero elements: 5
Test accuracy for 2: 0.859
Num non-zero elements: 5
Test accuracy for 3: 0.805
Num non-zero elements: 5
Test accuracy for 5: 0.87
Num non-zero elements: 5
Test accuracy for 6: 0.728
Num non-zero elements: 10
Test accuracy for 1: 0.904
Num non-zero elements: 10
Test accuracy for 2: 0.872
Num non-zero elements: 10
Test accuracy for 3: 0.836
Num non-zero elements: 10
Test accuracy for 5: 0.874
Num non-zero elements: 10
Test accuracy for 6: 0.748
Num non-zero elements: 20
Test accuracy for 1: 0.918
Num non-zero elements: 20
Test accuracy for 2: 0.878
Num non-zero elements: 20
Test accuracy for 3: 0.876
Num non-zero elements: 20
Test accuracy for 5: 0.896
Num non-zero elements: 20
Test accuracy for 6: 0.782
Num non-zero elements: 50
Test accuracy for 1: 0.932
Num non-zero elements: 50
Test accuracy for 2: 0.901
Num non-zero elements: 50
Test accuracy for 3: 0.89
Num non-zero elements: 50
Test accuracy for 5: 0.907
Num non-zero elements: 50
Test accuracy for 6: 0.813


Tokenizing data:   0%|          | 0/2 [00:00<?, ?it/s][A[A

Tokenizing data: 100%|██████████| 2/2 [00:00<00:00, 10.45it/s][A[ATokenizing data: 100%|██████████| 2/2 [00:00<00:00, 10.42it/s]


Tokenizing data:   0%|          | 0/2 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 2/2 [00:00<00:00, 40.82it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 29.04it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.17it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.55it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.50it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.98it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.75it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:00<00:02, 18.55it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.41it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.31it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.25it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.20it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 16.83it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.40it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.31it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.50it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.90it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:03, 15.85it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:03, 17.93it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 17.96it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 17.99it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:03, 15.55it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.03it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.32it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.24it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.91it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.43it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.27it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.79it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.51it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.33it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.22it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.16it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.50it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.62it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.32it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.82it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.53it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.35it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.24it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.17it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.51it/s]
Num non-zero elements: 2304
Test accuracy for 1.0: 0.902
Num non-zero elements: 2304
Test accuracy for 5.0: 0.903
Num non-zero elements: 1
Test accuracy for 1.0: 0.631
Num non-zero elements: 1
Test accuracy for 5.0: 0.631
Num non-zero elements: 2
Test accuracy for 1.0: 0.654
Num non-zero elements: 2
Test accuracy for 5.0: 0.654
Num non-zero elements: 5
Test accuracy for 1.0: 0.669
Num non-zero elements: 5
Test accuracy for 5.0: 0.669
Num non-zero elements: 10
Test accuracy for 1.0: 0.764
Num non-zero elements: 10
Test accuracy for 5.0: 0.764
Num non-zero elements: 20
Test accuracy for 1.0: 0.792
Num non-zero elements: 20
Test accuracy for 5.0: 0.792
Num non-zero elements: 50
Test accuracy for 1.0: 0.829
Num non-zero elements: 50
Test accuracy for 5.0: 0.828
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 25 epochs
Test accuracy for 1.0: 0.9050000309944153
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 20 epochs
Test accuracy for 5.0: 0.9030000567436218
Num non-zero elements: 1
Test accuracy for 1.0: 0.654
Num non-zero elements: 1
Test accuracy for 5.0: 0.654
Num non-zero elements: 2
Test accuracy for 1.0: 0.712
Num non-zero elements: 2
Test accuracy for 5.0: 0.712
Num non-zero elements: 5
Test accuracy for 1.0: 0.876
Num non-zero elements: 5
Test accuracy for 5.0: 0.876
Num non-zero elements: 10
Test accuracy for 1.0: 0.889
Num non-zero elements: 10
Test accuracy for 5.0: 0.889
Num non-zero elements: 20
Test accuracy for 1.0: 0.896
Num non-zero elements: 20
Test accuracy for 5.0: 0.896
Num non-zero elements: 50
Test accuracy for 1.0: 0.9
Num non-zero elements: 50
Test accuracy for 5.0: 0.9
Loading dataset codeparrot/github-code, this usually takes ~30 seconds


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  20%|██        | 1/5 [00:01<00:07,  1.91s/it][A[A

Tokenizing data:  40%|████      | 2/5 [00:02<00:04,  1.40s/it][A[A

Tokenizing data:  60%|██████    | 3/5 [00:04<00:02,  1.26s/it][A[A

Tokenizing data:  80%|████████  | 4/5 [00:04<00:00,  1.05it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:05<00:00,  1.19it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:05<00:00,  1.03s/it]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  20%|██        | 1/5 [00:00<00:02,  1.76it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:01,  2.30it/s][A[A

Tokenizing data:  60%|██████    | 3/5 [00:01<00:00,  2.67it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:01<00:00,  3.46it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:01<00:00,  3.98it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:01<00:00,  3.22it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.00it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 22.99it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.45it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.44it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.05it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.76it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.55it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.39it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.29it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.22it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.44it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 22.00it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.44it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.89it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.58it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:03, 15.31it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.02it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.01it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 15.95it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.31it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.22it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:01, 15.34it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 17.77it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 17.83it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 17.90it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 17.92it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.94it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.82it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 23.97it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 20.04it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 19.04it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.70it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.46it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.30it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 17.71it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 17.92it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 17.60it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.93it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.13it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 23.22it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.75it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 18.86it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.54it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.34it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.20it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.11it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 16.31it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.41it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.26it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.89it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.88it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.88it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.88it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.88it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:03<00:00, 16.67it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.20it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.04it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 23.51it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.81it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 18.87it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.55it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.34it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.08it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 17.92it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 17.89it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:02, 17.88it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 17.88it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 17.87it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 17.86it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 17.85it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 17.85it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 17.84it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 17.85it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 17.84it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:01, 17.84it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 17.83it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 17.83it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 17.83it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 17.83it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 17.83it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 17.83it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.83it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.83it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.83it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.05it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.73it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.89it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.49it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.25it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.10it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.01it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.96it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.29it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.10it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.66it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.33it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.14it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.02it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.95it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.92it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.18it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.09it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.68it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.36it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.03it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.95it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.91it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.18it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.07it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.66it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.34it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.03it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.95it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.92it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.18it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.03it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.65it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.32it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.14it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.03it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.96it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.90it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.17it/s]
Num non-zero elements: 2304
Test accuracy for C: 0.95
Num non-zero elements: 2304
Test accuracy for Python: 0.985
Num non-zero elements: 2304
Test accuracy for HTML: 0.985
Num non-zero elements: 2304
Test accuracy for Java: 0.968
Num non-zero elements: 2304
Test accuracy for PHP: 0.956
Num non-zero elements: 1
Test accuracy for C: 0.611
Num non-zero elements: 1
Test accuracy for Python: 0.617
Num non-zero elements: 1
Test accuracy for HTML: 0.715
Num non-zero elements: 1
Test accuracy for Java: 0.616
Num non-zero elements: 1
Test accuracy for PHP: 0.571
Num non-zero elements: 2
Test accuracy for C: 0.743
Num non-zero elements: 2
Test accuracy for Python: 0.693
Num non-zero elements: 2
Test accuracy for HTML: 0.946
Num non-zero elements: 2
Test accuracy for Java: 0.635
Num non-zero elements: 2
Test accuracy for PHP: 0.65
Num non-zero elements: 5
Test accuracy for C: 0.813
Num non-zero elements: 5
Test accuracy for Python: 0.753
Num non-zero elements: 5
Test accuracy for HTML: 0.948
Num non-zero elements: 5
Test accuracy for Java: 0.786
Num non-zero elements: 5
Test accuracy for PHP: 0.717
Num non-zero elements: 10
Test accuracy for C: 0.834
Num non-zero elements: 10
Test accuracy for Python: 0.868
Num non-zero elements: 10
Test accuracy for HTML: 0.95
Num non-zero elements: 10
Test accuracy for Java: 0.823
Num non-zero elements: 10
Test accuracy for PHP: 0.804
Num non-zero elements: 20
Test accuracy for C: 0.876
Num non-zero elements: 20
Test accuracy for Python: 0.896
Num non-zero elements: 20
Test accuracy for HTML: 0.964
Num non-zero elements: 20
Test accuracy for Java: 0.877
Num non-zero elements: 20
Test accuracy for PHP: 0.871
Num non-zero elements: 50
Test accuracy for C: 0.917
Num non-zero elements: 50
Test accuracy for Python: 0.965
Num non-zero elements: 50
Test accuracy for HTML: 0.963
Num non-zero elements: 50
Test accuracy for Java: 0.912
Num non-zero elements: 50
Test accuracy for PHP: 0.895
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 28 epochs
Test accuracy for C: 0.9590000510215759
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 20 epochs
Test accuracy for Python: 0.984000027179718
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 21 epochs
Test accuracy for HTML: 0.9880000352859497
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 27 epochs
Test accuracy for Java: 0.9600000381469727
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 25 epochs
Test accuracy for PHP: 0.9540000557899475
Num non-zero elements: 1
Test accuracy for C: 0.639
Num non-zero elements: 1
Test accuracy for Python: 0.928
Num non-zero elements: 1
Test accuracy for HTML: 0.873
Num non-zero elements: 1
Test accuracy for Java: 0.773
Num non-zero elements: 1
Test accuracy for PHP: 0.909
Num non-zero elements: 2
Test accuracy for C: 0.677
Num non-zero elements: 2
Test accuracy for Python: 0.93
Num non-zero elements: 2
Test accuracy for HTML: 0.902
Num non-zero elements: 2
Test accuracy for Java: 0.862
Num non-zero elements: 2
Test accuracy for PHP: 0.905
Num non-zero elements: 5
Test accuracy for C: 0.896
Num non-zero elements: 5
Test accuracy for Python: 0.964
Num non-zero elements: 5
Test accuracy for HTML: 0.949
Num non-zero elements: 5
Test accuracy for Java: 0.898
Num non-zero elements: 5
Test accuracy for PHP: 0.916
Num non-zero elements: 10
Test accuracy for C: 0.914
Num non-zero elements: 10
Test accuracy for Python: 0.971
Num non-zero elements: 10
Test accuracy for HTML: 0.946
Num non-zero elements: 10
Test accuracy for Java: 0.931
Num non-zero elements: 10
Test accuracy for PHP: 0.912
Num non-zero elements: 20
Test accuracy for C: 0.93
Num non-zero elements: 20
Test accuracy for Python: 0.982
Num non-zero elements: 20
Test accuracy for HTML: 0.946
Num non-zero elements: 20
Test accuracy for Java: 0.926
Num non-zero elements: 20
Test accuracy for PHP: 0.915
Num non-zero elements: 50
Test accuracy for C: 0.951
Num non-zero elements: 50
Test accuracy for Python: 0.982
Num non-zero elements: 50
Test accuracy for HTML: 0.973
Num non-zero elements: 50
Test accuracy for Java: 0.933
Num non-zero elements: 50
Test accuracy for PHP: 0.927


Tokenizing data:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Tokenizing data:  50%|█████     | 2/4 [00:00<00:00, 14.11it/s][A[A

Tokenizing data: 100%|██████████| 4/4 [00:00<00:00, 14.10it/s][A[ATokenizing data: 100%|██████████| 4/4 [00:00<00:00, 14.09it/s]


Tokenizing data:   0%|          | 0/4 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 4/4 [00:00<00:00, 53.62it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 26.94it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.25it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.62it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.58it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.17it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.88it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.67it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.49it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.38it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.31it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.27it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.23it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.20it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.15it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.14it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.15it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.14it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.12it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.13it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.14it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.12it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.56it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.03it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.23it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.82it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.58it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.41it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.20it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.22it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.05it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.19it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.78it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.54it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.39it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.23it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.06it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.20it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.01it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.14it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.74it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.50it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.36it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.27it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.20it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.15it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.16it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.97it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.11it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.71it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.46it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.32it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.22it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.16it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.50it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.29it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.87it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.55it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.35it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.22it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.14it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.37it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.26it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.83it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.52it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.33it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.21it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.08it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.35it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.25it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.82it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.50it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.31it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.19it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.07it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.34it/s]
Num non-zero elements: 2304
Test accuracy for 0: 0.917
Num non-zero elements: 2304
Test accuracy for 1: 0.984
Num non-zero elements: 2304
Test accuracy for 2: 0.906
Num non-zero elements: 2304
Test accuracy for 3: 0.928
Num non-zero elements: 1
Test accuracy for 0: 0.771
Num non-zero elements: 1
Test accuracy for 1: 0.683
Num non-zero elements: 1
Test accuracy for 2: 0.668
Num non-zero elements: 1
Test accuracy for 3: 0.782
Num non-zero elements: 2
Test accuracy for 0: 0.794
Num non-zero elements: 2
Test accuracy for 1: 0.795
Num non-zero elements: 2
Test accuracy for 2: 0.688
Num non-zero elements: 2
Test accuracy for 3: 0.801
Num non-zero elements: 5
Test accuracy for 0: 0.878
Num non-zero elements: 5
Test accuracy for 1: 0.875
Num non-zero elements: 5
Test accuracy for 2: 0.775
Num non-zero elements: 5
Test accuracy for 3: 0.847
Num non-zero elements: 10
Test accuracy for 0: 0.869
Num non-zero elements: 10
Test accuracy for 1: 0.94
Num non-zero elements: 10
Test accuracy for 2: 0.797
Num non-zero elements: 10
Test accuracy for 3: 0.856
Num non-zero elements: 20
Test accuracy for 0: 0.903
Num non-zero elements: 20
Test accuracy for 1: 0.957
Num non-zero elements: 20
Test accuracy for 2: 0.86
Num non-zero elements: 20
Test accuracy for 3: 0.878
Num non-zero elements: 50
Test accuracy for 0: 0.903
Num non-zero elements: 50
Test accuracy for 1: 0.967
Num non-zero elements: 50
Test accuracy for 2: 0.873
Num non-zero elements: 50
Test accuracy for 3: 0.908
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for 0: 0.937000036239624
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for 1: 0.9770000576972961
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 2: 0.9310000538825989
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 20 epochs
Test accuracy for 3: 0.9460000395774841
Num non-zero elements: 1
Test accuracy for 0: 0.735
Num non-zero elements: 1
Test accuracy for 1: 0.958
Num non-zero elements: 1
Test accuracy for 2: 0.78
Num non-zero elements: 1
Test accuracy for 3: 0.711
Num non-zero elements: 2
Test accuracy for 0: 0.764
Num non-zero elements: 2
Test accuracy for 1: 0.96
Num non-zero elements: 2
Test accuracy for 2: 0.836
Num non-zero elements: 2
Test accuracy for 3: 0.805
Num non-zero elements: 5
Test accuracy for 0: 0.843
Num non-zero elements: 5
Test accuracy for 1: 0.96
Num non-zero elements: 5
Test accuracy for 2: 0.852
Num non-zero elements: 5
Test accuracy for 3: 0.845
Num non-zero elements: 10
Test accuracy for 0: 0.893
Num non-zero elements: 10
Test accuracy for 1: 0.977
Num non-zero elements: 10
Test accuracy for 2: 0.858
Num non-zero elements: 10
Test accuracy for 3: 0.895
Num non-zero elements: 20
Test accuracy for 0: 0.909
Num non-zero elements: 20
Test accuracy for 1: 0.979
Num non-zero elements: 20
Test accuracy for 2: 0.87
Num non-zero elements: 20
Test accuracy for 3: 0.907
Num non-zero elements: 50
Test accuracy for 0: 0.919
Num non-zero elements: 50
Test accuracy for 1: 0.983
Num non-zero elements: 50
Test accuracy for 2: 0.899
Num non-zero elements: 50
Test accuracy for 3: 0.923
Loading dataset Helsinki-NLP/europarl, this usually takes ~10 seconds


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 14.91it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 15.00it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 14.99it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 50.62it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 26.77it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.34it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.72it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.67it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 19.13it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.90it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:00<00:02, 18.70it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.56it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.46it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.40it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.35it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.31it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.29it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.27it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.25it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 18.24it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.23it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.22it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.23it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.21it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.23it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.21it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.21it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.21it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 18.20it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.21it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.20it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.21it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.23it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.64it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.21it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.35it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.93it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.67it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.53it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.42it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.35it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.28it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.25it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.24it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.22it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.22it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.21it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.21it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.20it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.20it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.19it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.20it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.20it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.19it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.19it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.20it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.19it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.19it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.19it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.18it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.19it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.20it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.19it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.32it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.17it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.31it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.89it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.65it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.49it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.39it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.33it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.25it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.22it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.22it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.21it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.20it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.17it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.16it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.16it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.17it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.17it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.17it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.17it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.15it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.15it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.14it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.14it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.29it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.09it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.26it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.85it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.60it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.44it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.35it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.28it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.23it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.19it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.08it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.23it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.03it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.19it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.77it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.52it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.37it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.27it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.18it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.02it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.14it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.71it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.48it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.33it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.23it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.17it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.51it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.28it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.90it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.57it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.37it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.27it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.19it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.14it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.41it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.25it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.88it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.56it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.38it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.24it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.13it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.40it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.29it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.87it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.56it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.36it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.24it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.15it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.40it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.24it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.83it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.49it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.30it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.19it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.09it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.34it/s]
Num non-zero elements: 2304
Test accuracy for en: 0.999
Num non-zero elements: 2304
Test accuracy for fr: 1.0
Num non-zero elements: 2304
Test accuracy for de: 1.0
Num non-zero elements: 2304
Test accuracy for es: 1.0
Num non-zero elements: 2304
Test accuracy for nl: 1.0
Num non-zero elements: 1
Test accuracy for en: 0.939
Num non-zero elements: 1
Test accuracy for fr: 0.64
Num non-zero elements: 1
Test accuracy for de: 0.83
Num non-zero elements: 1
Test accuracy for es: 0.885
Num non-zero elements: 1
Test accuracy for nl: 0.855
Num non-zero elements: 2
Test accuracy for en: 0.973
Num non-zero elements: 2
Test accuracy for fr: 0.906
Num non-zero elements: 2
Test accuracy for de: 0.838
Num non-zero elements: 2
Test accuracy for es: 0.907
Num non-zero elements: 2
Test accuracy for nl: 0.88
Num non-zero elements: 5
Test accuracy for en: 0.993
Num non-zero elements: 5
Test accuracy for fr: 0.967
Num non-zero elements: 5
Test accuracy for de: 0.893
Num non-zero elements: 5
Test accuracy for es: 0.978
Num non-zero elements: 5
Test accuracy for nl: 0.957
Num non-zero elements: 10
Test accuracy for en: 0.998
Num non-zero elements: 10
Test accuracy for fr: 0.987
Num non-zero elements: 10
Test accuracy for de: 0.98
Num non-zero elements: 10
Test accuracy for es: 0.987
Num non-zero elements: 10
Test accuracy for nl: 0.974
Num non-zero elements: 20
Test accuracy for en: 0.998
Num non-zero elements: 20
Test accuracy for fr: 0.994
Num non-zero elements: 20
Test accuracy for de: 0.988
Num non-zero elements: 20
Test accuracy for es: 0.996
Num non-zero elements: 20
Test accuracy for nl: 0.977
Num non-zero elements: 50
Test accuracy for en: 0.997
Num non-zero elements: 50
Test accuracy for fr: 0.998
Num non-zero elements: 50
Test accuracy for de: 0.999
Num non-zero elements: 50
Test accuracy for es: 1.0
Num non-zero elements: 50
Test accuracy for nl: 0.994
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for en: 0.999000072479248
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 14 epochs
Test accuracy for fr: 1.0
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 12 epochs
Test accuracy for de: 1.0
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 11 epochs
Test accuracy for es: 0.999000072479248
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 14 epochs
Test accuracy for nl: 1.0
Num non-zero elements: 1
Test accuracy for en: 1.0
Num non-zero elements: 1
Test accuracy for fr: 0.869
Num non-zero elements: 1
Test accuracy for de: 1.0
Num non-zero elements: 1
Test accuracy for es: 0.941
Num non-zero elements: 1
Test accuracy for nl: 0.871
Num non-zero elements: 2
Test accuracy for en: 0.997
Num non-zero elements: 2
Test accuracy for fr: 0.998
Num non-zero elements: 2
Test accuracy for de: 0.999
Num non-zero elements: 2
Test accuracy for es: 0.983
Num non-zero elements: 2
Test accuracy for nl: 1.0
Num non-zero elements: 5
Test accuracy for en: 0.997
Num non-zero elements: 5
Test accuracy for fr: 0.996
Num non-zero elements: 5
Test accuracy for de: 0.999
Num non-zero elements: 5
Test accuracy for es: 0.997
Num non-zero elements: 5
Test accuracy for nl: 0.997
Num non-zero elements: 10
Test accuracy for en: 0.998
Num non-zero elements: 10
Test accuracy for fr: 0.995
Num non-zero elements: 10
Test accuracy for de: 1.0
Num non-zero elements: 10
Test accuracy for es: 0.997
Num non-zero elements: 10
Test accuracy for nl: 0.997
Num non-zero elements: 20
Test accuracy for en: 1.0
Num non-zero elements: 20
Test accuracy for fr: 0.997
Num non-zero elements: 20
Test accuracy for de: 1.0
Num non-zero elements: 20
Test accuracy for es: 0.997
Num non-zero elements: 20
Test accuracy for nl: 0.999
Num non-zero elements: 50
Test accuracy for en: 1.0
Num non-zero elements: 50
Test accuracy for fr: 0.998
Num non-zero elements: 50
Test accuracy for de: 0.999
Num non-zero elements: 50
Test accuracy for es: 0.997
Num non-zero elements: 50
Test accuracy for nl: 0.999

Running SAE evaluation on all selected SAEs: 100%|██████████| 1/1 [16:17<00:00, 977.42s/it][ARunning SAE evaluation on all selected SAEs: 100%|██████████| 1/1 [16:17<00:00, 977.43s/it]
Evaluations: 100%|██████████| 1/1 [16:36<00:00, 996.73s/it]Evaluations: 100%|██████████| 1/1 [16:36<00:00, 996.73s/it]
/share/u/can/SAEBench/custom_saes/topk_sae.py:110: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  pt_params = t.load(path_to_params)
Loaded config: {'trainer': {'trainer_class': 'TrainerTopKAdditivity', 'dict_class': 'AutoEncoderTopK', 'lr': 0.000282842712474619, 'steps': 48828, 'seed': 0, 'activation_dim': 2304, 'dict_size': 8192, 'k': 125, 'auxk_alpha': 0.03125, 'additivity_coeff': 1.0, 'intersection_coeff': 1.0, 'device': 'cuda:0', 'layer': 4, 'lm_name': 'google/gemma-2-2b', 'wandb_name': 'TopKTrainer_Additivity-google/gemma-2-2b-resid_post_layer_4-add_coeff-1.0-inters_coeff-1.0', 'submodule_name': 'resid_post_layer_4'}, 'buffer': {'d_submodule': 2304, 'io': 'out', 'n_ctxs': 8192, 'ctx_len': 128, 'refresh_batch_size': 32, 'out_batch_size': 2048, 'device': 'cuda:0'}}
Original keys in state_dict: odict_keys(['b_dec', 'encoder.weight', 'encoder.bias', 'decoder.weight'])
Renamed keys in state_dict: dict_keys(['b_dec', 'W_enc', 'b_enc', 'W_dec'])
Evaluations:   0%|          | 0/1 [00:00<?, ?it/s]


Running sparse_probing evaluation




Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s][A
Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:01,  1.50it/s][A
Loading checkpoint shards:  67%|██████▋   | 2/3 [00:01<00:00,  1.55it/s][A
Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.19it/s][ALoading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  1.96it/s]
Loaded pretrained model gemma-2-2b into HookedTransformer

Running SAE evaluation on all selected SAEs:   0%|          | 0/1 [00:00<?, ?it/s][A

  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 652.41it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 953.68it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 12.64it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 12.80it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 12.67it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 47.81it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 47.42it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.43it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.33it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.65it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.59it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.18it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.88it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.66it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.47it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.35it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.28it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.24it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.20it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 15.53it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.42it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 23.05it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.82it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 18.97it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.69it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.50it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.36it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.27it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.21it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.07it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.25it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.36it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.29it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.83it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.56it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.38it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.27it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.20it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.17it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.24it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.23it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.79it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.53it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.35it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.17it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.12it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.14it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.23it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.20it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.75it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.47it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.12it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.06it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.92it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.92it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.92it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.92it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.92it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.92it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.07it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.08it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.10it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.66it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.41it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.25it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.14it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.08it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.44it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.29it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.82it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.48it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.28it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.09it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.31it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.30it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.83it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.47it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.27it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.14it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.30it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.39it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.85it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.50it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.29it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.17it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.08it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.32it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.29it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.81it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.46it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.25it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.04it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.28it/s]
Num non-zero elements: 2304
Test accuracy for 0: 0.925
Num non-zero elements: 2304
Test accuracy for 1: 0.943
Num non-zero elements: 2304
Test accuracy for 2: 0.947
Num non-zero elements: 2304
Test accuracy for 6: 0.991
Num non-zero elements: 2304
Test accuracy for 9: 0.971
Num non-zero elements: 1
Test accuracy for 0: 0.603
Num non-zero elements: 1
Test accuracy for 1: 0.648
Num non-zero elements: 1
Test accuracy for 2: 0.731
Num non-zero elements: 1
Test accuracy for 6: 0.773
Num non-zero elements: 1
Test accuracy for 9: 0.68
Num non-zero elements: 2
Test accuracy for 0: 0.682
Num non-zero elements: 2
Test accuracy for 1: 0.655
Num non-zero elements: 2
Test accuracy for 2: 0.744
Num non-zero elements: 2
Test accuracy for 6: 0.771
Num non-zero elements: 2
Test accuracy for 9: 0.772
Num non-zero elements: 5
Test accuracy for 0: 0.768
Num non-zero elements: 5
Test accuracy for 1: 0.69
Num non-zero elements: 5
Test accuracy for 2: 0.754
Num non-zero elements: 5
Test accuracy for 6: 0.905
Num non-zero elements: 5
Test accuracy for 9: 0.798
Num non-zero elements: 10
Test accuracy for 0: 0.797
Num non-zero elements: 10
Test accuracy for 1: 0.818
Num non-zero elements: 10
Test accuracy for 2: 0.83
Num non-zero elements: 10
Test accuracy for 6: 0.929
Num non-zero elements: 10
Test accuracy for 9: 0.912
Num non-zero elements: 20
Test accuracy for 0: 0.796
Num non-zero elements: 20
Test accuracy for 1: 0.867
Num non-zero elements: 20
Test accuracy for 2: 0.847
Num non-zero elements: 20
Test accuracy for 6: 0.96
Num non-zero elements: 20
Test accuracy for 9: 0.945
Num non-zero elements: 50
Test accuracy for 0: 0.862
Num non-zero elements: 50
Test accuracy for 1: 0.905
Num non-zero elements: 50
Test accuracy for 2: 0.897
Num non-zero elements: 50
Test accuracy for 6: 0.977
Num non-zero elements: 50
Test accuracy for 9: 0.948
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 0: 0.9430000185966492
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for 1: 0.9600000381469727
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for 2: 0.9390000700950623
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 20 epochs
Test accuracy for 6: 0.9920000433921814
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 23 epochs
Test accuracy for 9: 0.9720000624656677
Num non-zero elements: 1
Test accuracy for 0: 0.626
Num non-zero elements: 1
Test accuracy for 1: 0.658
Num non-zero elements: 1
Test accuracy for 2: 0.895
Num non-zero elements: 1
Test accuracy for 6: 0.972
Num non-zero elements: 1
Test accuracy for 9: 0.928
Num non-zero elements: 2
Test accuracy for 0: 0.81
Num non-zero elements: 2
Test accuracy for 1: 0.715
Num non-zero elements: 2
Test accuracy for 2: 0.905
Num non-zero elements: 2
Test accuracy for 6: 0.984
Num non-zero elements: 2
Test accuracy for 9: 0.933
Num non-zero elements: 5
Test accuracy for 0: 0.845
Num non-zero elements: 5
Test accuracy for 1: 0.849
Num non-zero elements: 5
Test accuracy for 2: 0.918
Num non-zero elements: 5
Test accuracy for 6: 0.983
Num non-zero elements: 5
Test accuracy for 9: 0.939
Num non-zero elements: 10
Test accuracy for 0: 0.892
Num non-zero elements: 10
Test accuracy for 1: 0.866
Num non-zero elements: 10
Test accuracy for 2: 0.927
Num non-zero elements: 10
Test accuracy for 6: 0.987
Num non-zero elements: 10
Test accuracy for 9: 0.954
Num non-zero elements: 20
Test accuracy for 0: 0.885
Num non-zero elements: 20
Test accuracy for 1: 0.933
Num non-zero elements: 20
Test accuracy for 2: 0.929
Num non-zero elements: 20
Test accuracy for 6: 0.985
Num non-zero elements: 20
Test accuracy for 9: 0.961
Num non-zero elements: 50
Test accuracy for 0: 0.936
Num non-zero elements: 50
Test accuracy for 1: 0.953
Num non-zero elements: 50
Test accuracy for 2: 0.932
Num non-zero elements: 50
Test accuracy for 6: 0.987
Num non-zero elements: 50
Test accuracy for 9: 0.964


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 652.85it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 950.34it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 13.00it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00,  9.99it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 10.76it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 45.07it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 43.31it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 26.71it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.03it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.47it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.45it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.06it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.77it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.57it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.38it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.29it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.21it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.05it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.47it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 22.27it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.58it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 19.00it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.66it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:03, 14.95it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 17.77it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 17.85it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 17.55it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:02, 17.65it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.98it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 23.40it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.91it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 18.99it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.68it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.47it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.33it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.23it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 17.25it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.19it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.13it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 14.31it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 16.86it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.13it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.84it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 23.68it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.90it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 18.93it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.61it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.39it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:03, 13.41it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:01<00:02, 16.24it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 16.66it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 16.99it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.24it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.42it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.55it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.65it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.72it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.77it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:02<00:01, 17.80it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.82it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.84it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.85it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.86it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:03<00:00, 17.88it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.87it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.88it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.87it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.86it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.65it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.84it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.29it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.73it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.44it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:03, 16.04it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.48it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.30it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:02, 17.95it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 17.90it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 17.89it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 16.28it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.35it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.21it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 15.46it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 17.88it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 17.86it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 17.85it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.86it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.85it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.86it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.88it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.73it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.22it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.70it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.39it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.19it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.08it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.38it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.74it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.24it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.69it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.38it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.06it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.35it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.38it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.44it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.83it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.46it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 17.88it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.20it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.42it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.72it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.53it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.51it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.60it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.32it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.05it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.47it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.18it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.35it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.75it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.41it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.20it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.06it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.38it/s]
Num non-zero elements: 2304
Test accuracy for 11: 0.944
Num non-zero elements: 2304
Test accuracy for 13: 0.946
Num non-zero elements: 2304
Test accuracy for 14: 0.936
Num non-zero elements: 2304
Test accuracy for 18: 0.903
Num non-zero elements: 2304
Test accuracy for 19: 0.958
Num non-zero elements: 1
Test accuracy for 11: 0.705
Num non-zero elements: 1
Test accuracy for 13: 0.725
Num non-zero elements: 1
Test accuracy for 14: 0.663
Num non-zero elements: 1
Test accuracy for 18: 0.703
Num non-zero elements: 1
Test accuracy for 19: 0.782
Num non-zero elements: 2
Test accuracy for 11: 0.777
Num non-zero elements: 2
Test accuracy for 13: 0.701
Num non-zero elements: 2
Test accuracy for 14: 0.66
Num non-zero elements: 2
Test accuracy for 18: 0.712
Num non-zero elements: 2
Test accuracy for 19: 0.803
Num non-zero elements: 5
Test accuracy for 11: 0.837
Num non-zero elements: 5
Test accuracy for 13: 0.788
Num non-zero elements: 5
Test accuracy for 14: 0.766
Num non-zero elements: 5
Test accuracy for 18: 0.735
Num non-zero elements: 5
Test accuracy for 19: 0.828
Num non-zero elements: 10
Test accuracy for 11: 0.873
Num non-zero elements: 10
Test accuracy for 13: 0.846
Num non-zero elements: 10
Test accuracy for 14: 0.785
Num non-zero elements: 10
Test accuracy for 18: 0.743
Num non-zero elements: 10
Test accuracy for 19: 0.823
Num non-zero elements: 20
Test accuracy for 11: 0.893
Num non-zero elements: 20
Test accuracy for 13: 0.872
Num non-zero elements: 20
Test accuracy for 14: 0.865
Num non-zero elements: 20
Test accuracy for 18: 0.756
Num non-zero elements: 20
Test accuracy for 19: 0.922
Num non-zero elements: 50
Test accuracy for 11: 0.93
Num non-zero elements: 50
Test accuracy for 13: 0.892
Num non-zero elements: 50
Test accuracy for 14: 0.897
Num non-zero elements: 50
Test accuracy for 18: 0.83
Num non-zero elements: 50
Test accuracy for 19: 0.914
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 17 epochs
Test accuracy for 11: 0.9550000429153442
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 20 epochs
Test accuracy for 13: 0.9410000443458557
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 25 epochs
Test accuracy for 14: 0.9510000348091125
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 27 epochs
Test accuracy for 18: 0.909000039100647
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for 19: 0.9610000252723694
Num non-zero elements: 1
Test accuracy for 11: 0.732
Num non-zero elements: 1
Test accuracy for 13: 0.752
Num non-zero elements: 1
Test accuracy for 14: 0.921
Num non-zero elements: 1
Test accuracy for 18: 0.729
Num non-zero elements: 1
Test accuracy for 19: 0.848
Num non-zero elements: 2
Test accuracy for 11: 0.836
Num non-zero elements: 2
Test accuracy for 13: 0.756
Num non-zero elements: 2
Test accuracy for 14: 0.915
Num non-zero elements: 2
Test accuracy for 18: 0.878
Num non-zero elements: 2
Test accuracy for 19: 0.858
Num non-zero elements: 5
Test accuracy for 11: 0.932
Num non-zero elements: 5
Test accuracy for 13: 0.798
Num non-zero elements: 5
Test accuracy for 14: 0.919
Num non-zero elements: 5
Test accuracy for 18: 0.903
Num non-zero elements: 5
Test accuracy for 19: 0.867
Num non-zero elements: 10
Test accuracy for 11: 0.926
Num non-zero elements: 10
Test accuracy for 13: 0.872
Num non-zero elements: 10
Test accuracy for 14: 0.921
Num non-zero elements: 10
Test accuracy for 18: 0.9
Num non-zero elements: 10
Test accuracy for 19: 0.875
Num non-zero elements: 20
Test accuracy for 11: 0.944
Num non-zero elements: 20
Test accuracy for 13: 0.933
Num non-zero elements: 20
Test accuracy for 14: 0.935
Num non-zero elements: 20
Test accuracy for 18: 0.894
Num non-zero elements: 20
Test accuracy for 19: 0.913
Num non-zero elements: 50
Test accuracy for 11: 0.956
Num non-zero elements: 50
Test accuracy for 13: 0.944
Num non-zero elements: 50
Test accuracy for 14: 0.951
Num non-zero elements: 50
Test accuracy for 18: 0.905
Num non-zero elements: 50
Test accuracy for 19: 0.939


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 637.66it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 1042.57it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 12.30it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00,  7.56it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00,  8.69it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 45.04it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 44.86it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.94it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.31it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.61it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.54it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.13it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.82it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.61it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.43it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.32it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.25it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.19it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.02it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.49it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.05it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.18it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.76it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.53it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.38it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.28it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.17it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.01it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.16it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.74it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.50it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.34it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.17it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.13it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.14it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.95it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.10it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.69it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.44it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.12it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.07it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.93it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.08it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.90it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.04it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.62it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.38it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.23it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.07it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.03it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.94it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.91it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.91it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.90it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.90it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.90it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.90it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.03it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.52it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.20it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.71it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.42it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.23it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.05it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.45it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.25it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.78it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.45it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.25it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.13it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.04it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.27it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.23it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.77it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.43it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.24it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.13it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.04it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.27it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.19it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.77it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.42it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.22it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.10it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.03it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.98it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.25it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.22it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.77it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.43it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.23it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.10it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.03it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.26it/s]
Num non-zero elements: 2304
Test accuracy for 20: 0.949
Num non-zero elements: 2304
Test accuracy for 21: 0.893
Num non-zero elements: 2304
Test accuracy for 22: 0.885
Num non-zero elements: 2304
Test accuracy for 25: 0.945
Num non-zero elements: 2304
Test accuracy for 26: 0.862
Num non-zero elements: 1
Test accuracy for 20: 0.753
Num non-zero elements: 1
Test accuracy for 21: 0.626
Num non-zero elements: 1
Test accuracy for 22: 0.647
Num non-zero elements: 1
Test accuracy for 25: 0.705
Num non-zero elements: 1
Test accuracy for 26: 0.652
Num non-zero elements: 2
Test accuracy for 20: 0.797
Num non-zero elements: 2
Test accuracy for 21: 0.717
Num non-zero elements: 2
Test accuracy for 22: 0.595
Num non-zero elements: 2
Test accuracy for 25: 0.704
Num non-zero elements: 2
Test accuracy for 26: 0.67
Num non-zero elements: 5
Test accuracy for 20: 0.849
Num non-zero elements: 5
Test accuracy for 21: 0.751
Num non-zero elements: 5
Test accuracy for 22: 0.742
Num non-zero elements: 5
Test accuracy for 25: 0.796
Num non-zero elements: 5
Test accuracy for 26: 0.691
Num non-zero elements: 10
Test accuracy for 20: 0.885
Num non-zero elements: 10
Test accuracy for 21: 0.818
Num non-zero elements: 10
Test accuracy for 22: 0.776
Num non-zero elements: 10
Test accuracy for 25: 0.879
Num non-zero elements: 10
Test accuracy for 26: 0.715
Num non-zero elements: 20
Test accuracy for 20: 0.896
Num non-zero elements: 20
Test accuracy for 21: 0.833
Num non-zero elements: 20
Test accuracy for 22: 0.773
Num non-zero elements: 20
Test accuracy for 25: 0.899
Num non-zero elements: 20
Test accuracy for 26: 0.762
Num non-zero elements: 50
Test accuracy for 20: 0.906
Num non-zero elements: 50
Test accuracy for 21: 0.872
Num non-zero elements: 50
Test accuracy for 22: 0.825
Num non-zero elements: 50
Test accuracy for 25: 0.929
Num non-zero elements: 50
Test accuracy for 26: 0.828
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for 20: 0.937000036239624
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for 21: 0.9070000648498535
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 21 epochs
Test accuracy for 22: 0.9050000309944153
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for 25: 0.9600000381469727
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 22 epochs
Test accuracy for 26: 0.8920000195503235
Num non-zero elements: 1
Test accuracy for 20: 0.891
Num non-zero elements: 1
Test accuracy for 21: 0.771
Num non-zero elements: 1
Test accuracy for 22: 0.826
Num non-zero elements: 1
Test accuracy for 25: 0.84
Num non-zero elements: 1
Test accuracy for 26: 0.721
Num non-zero elements: 2
Test accuracy for 20: 0.894
Num non-zero elements: 2
Test accuracy for 21: 0.771
Num non-zero elements: 2
Test accuracy for 22: 0.867
Num non-zero elements: 2
Test accuracy for 25: 0.872
Num non-zero elements: 2
Test accuracy for 26: 0.792
Num non-zero elements: 5
Test accuracy for 20: 0.923
Num non-zero elements: 5
Test accuracy for 21: 0.809
Num non-zero elements: 5
Test accuracy for 22: 0.884
Num non-zero elements: 5
Test accuracy for 25: 0.894
Num non-zero elements: 5
Test accuracy for 26: 0.818
Num non-zero elements: 10
Test accuracy for 20: 0.909
Num non-zero elements: 10
Test accuracy for 21: 0.82
Num non-zero elements: 10
Test accuracy for 22: 0.868
Num non-zero elements: 10
Test accuracy for 25: 0.918
Num non-zero elements: 10
Test accuracy for 26: 0.831
Num non-zero elements: 20
Test accuracy for 20: 0.912
Num non-zero elements: 20
Test accuracy for 21: 0.877
Num non-zero elements: 20
Test accuracy for 22: 0.88
Num non-zero elements: 20
Test accuracy for 25: 0.949
Num non-zero elements: 20
Test accuracy for 26: 0.858
Num non-zero elements: 50
Test accuracy for 20: 0.94
Num non-zero elements: 50
Test accuracy for 21: 0.867
Num non-zero elements: 50
Test accuracy for 22: 0.893
Num non-zero elements: 50
Test accuracy for 25: 0.948
Num non-zero elements: 50
Test accuracy for 26: 0.87


  0%|          | 0/34 [00:00<?, ?it/s][A[A100%|██████████| 34/34 [00:00<00:00, 417.76it/s]


  0%|          | 0/31 [00:00<?, ?it/s][A[A100%|██████████| 31/31 [00:00<00:00, 902.41it/s]
Removing 31 from train set
Removing 0 from train set
Removing 29 from train set
Removing 28 from train set
Removing 7 from train set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  20%|██        | 1/5 [00:00<00:00,  9.77it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00,  5.68it/s][A[A

Tokenizing data:  60%|██████    | 3/5 [00:00<00:00,  7.06it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00,  7.93it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00,  8.48it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00,  7.81it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 36.99it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 36.26it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.38it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 22.96it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.44it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.43it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.03it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.74it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.53it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.37it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.27it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.19it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 16.10it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.52it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 18.38it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.28it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.21it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.15it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 15.41it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.90it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.31it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.01it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.14it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.71it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.47it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.32it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.23it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.17it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.13it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.14it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.94it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.09it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.68it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.44it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.13it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.09it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.94it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.09it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.94it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.06it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.65it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.41it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.15it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.07it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.04it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.94it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.91it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.91it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.91it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.90it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.90it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.90it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.90it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.04it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.87it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.01it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.59it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.34it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.20it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.10it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.03it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 17.98it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.94it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.93it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.92it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.90it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.90it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.90it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.87it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.88it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.88it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.88it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.88it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.87it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.88it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.86it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.87it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.83it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.88it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.87it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.00it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.81it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.96it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.54it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.30it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.14it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.03it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.97it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.32it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.23it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.74it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.40it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.21it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.09it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.01it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.97it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.24it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.19it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.73it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.40it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.20it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.99it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.96it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.22it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.23it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.74it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.40it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.20it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.98it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.94it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.22it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.16it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.71it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.39it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.19it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.98it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.94it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.21it/s]
Num non-zero elements: 2304
Test accuracy for 1: 0.917
Num non-zero elements: 2304
Test accuracy for 2: 0.905
Num non-zero elements: 2304
Test accuracy for 3: 0.885
Num non-zero elements: 2304
Test accuracy for 5: 0.896
Num non-zero elements: 2304
Test accuracy for 6: 0.835
Num non-zero elements: 1
Test accuracy for 1: 0.704
Num non-zero elements: 1
Test accuracy for 2: 0.691
Num non-zero elements: 1
Test accuracy for 3: 0.595
Num non-zero elements: 1
Test accuracy for 5: 0.689
Num non-zero elements: 1
Test accuracy for 6: 0.627
Num non-zero elements: 2
Test accuracy for 1: 0.729
Num non-zero elements: 2
Test accuracy for 2: 0.764
Num non-zero elements: 2
Test accuracy for 3: 0.614
Num non-zero elements: 2
Test accuracy for 5: 0.679
Num non-zero elements: 2
Test accuracy for 6: 0.635
Num non-zero elements: 5
Test accuracy for 1: 0.789
Num non-zero elements: 5
Test accuracy for 2: 0.815
Num non-zero elements: 5
Test accuracy for 3: 0.65
Num non-zero elements: 5
Test accuracy for 5: 0.714
Num non-zero elements: 5
Test accuracy for 6: 0.661
Num non-zero elements: 10
Test accuracy for 1: 0.834
Num non-zero elements: 10
Test accuracy for 2: 0.811
Num non-zero elements: 10
Test accuracy for 3: 0.712
Num non-zero elements: 10
Test accuracy for 5: 0.753
Num non-zero elements: 10
Test accuracy for 6: 0.738
Num non-zero elements: 20
Test accuracy for 1: 0.832
Num non-zero elements: 20
Test accuracy for 2: 0.837
Num non-zero elements: 20
Test accuracy for 3: 0.787
Num non-zero elements: 20
Test accuracy for 5: 0.765
Num non-zero elements: 20
Test accuracy for 6: 0.738
Num non-zero elements: 50
Test accuracy for 1: 0.89
Num non-zero elements: 50
Test accuracy for 2: 0.86
Num non-zero elements: 50
Test accuracy for 3: 0.854
Num non-zero elements: 50
Test accuracy for 5: 0.823
Num non-zero elements: 50
Test accuracy for 6: 0.78
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 33 epochs
Test accuracy for 1: 0.9350000619888306
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 24 epochs
Test accuracy for 2: 0.9220000505447388
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 17 epochs
Test accuracy for 3: 0.9030000567436218
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 29 epochs
Test accuracy for 5: 0.9070000648498535
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for 6: 0.8490000367164612
Num non-zero elements: 1
Test accuracy for 1: 0.83
Num non-zero elements: 1
Test accuracy for 2: 0.815
Num non-zero elements: 1
Test accuracy for 3: 0.689
Num non-zero elements: 1
Test accuracy for 5: 0.818
Num non-zero elements: 1
Test accuracy for 6: 0.637
Num non-zero elements: 2
Test accuracy for 1: 0.836
Num non-zero elements: 2
Test accuracy for 2: 0.84
Num non-zero elements: 2
Test accuracy for 3: 0.732
Num non-zero elements: 2
Test accuracy for 5: 0.861
Num non-zero elements: 2
Test accuracy for 6: 0.657
Num non-zero elements: 5
Test accuracy for 1: 0.864
Num non-zero elements: 5
Test accuracy for 2: 0.841
Num non-zero elements: 5
Test accuracy for 3: 0.813
Num non-zero elements: 5
Test accuracy for 5: 0.891
Num non-zero elements: 5
Test accuracy for 6: 0.739
Num non-zero elements: 10
Test accuracy for 1: 0.897
Num non-zero elements: 10
Test accuracy for 2: 0.875
Num non-zero elements: 10
Test accuracy for 3: 0.872
Num non-zero elements: 10
Test accuracy for 5: 0.897
Num non-zero elements: 10
Test accuracy for 6: 0.747
Num non-zero elements: 20
Test accuracy for 1: 0.922
Num non-zero elements: 20
Test accuracy for 2: 0.891
Num non-zero elements: 20
Test accuracy for 3: 0.875
Num non-zero elements: 20
Test accuracy for 5: 0.888
Num non-zero elements: 20
Test accuracy for 6: 0.791
Num non-zero elements: 50
Test accuracy for 1: 0.925
Num non-zero elements: 50
Test accuracy for 2: 0.909
Num non-zero elements: 50
Test accuracy for 3: 0.868
Num non-zero elements: 50
Test accuracy for 5: 0.906
Num non-zero elements: 50
Test accuracy for 6: 0.824


Tokenizing data:   0%|          | 0/2 [00:00<?, ?it/s][A[A

Tokenizing data: 100%|██████████| 2/2 [00:00<00:00, 10.23it/s][A[ATokenizing data: 100%|██████████| 2/2 [00:00<00:00, 10.01it/s]


Tokenizing data:   0%|          | 0/2 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 2/2 [00:00<00:00, 38.19it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 28.16it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.08it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.48it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.44it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.04it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.75it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.55it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.40it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.30it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.22it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.05it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.48it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.45it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.29it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.81it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.52it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.35it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.12it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 16.23it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.53it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.40it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:01, 17.80it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.34it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.24it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.17it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.12it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 27.99it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 22.92it/s][A[A

Collecting activations:  56%|█████▋    | 9/16 [00:00<00:00, 20.35it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 19.33it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.93it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.66it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 19.62it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.72it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.64it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.98it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.61it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.39it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.25it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.17it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.68it/s]
Num non-zero elements: 2304
Test accuracy for 1.0: 0.902
Num non-zero elements: 2304
Test accuracy for 5.0: 0.902
Num non-zero elements: 1
Test accuracy for 1.0: 0.631
Num non-zero elements: 1
Test accuracy for 5.0: 0.631
Num non-zero elements: 2
Test accuracy for 1.0: 0.654
Num non-zero elements: 2
Test accuracy for 5.0: 0.654
Num non-zero elements: 5
Test accuracy for 1.0: 0.669
Num non-zero elements: 5
Test accuracy for 5.0: 0.669
Num non-zero elements: 10
Test accuracy for 1.0: 0.764
Num non-zero elements: 10
Test accuracy for 5.0: 0.764
Num non-zero elements: 20
Test accuracy for 1.0: 0.791
Num non-zero elements: 20
Test accuracy for 5.0: 0.791
Num non-zero elements: 50
Test accuracy for 1.0: 0.829
Num non-zero elements: 50
Test accuracy for 5.0: 0.83
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 33 epochs
Test accuracy for 1.0: 0.909000039100647
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 30 epochs
Test accuracy for 5.0: 0.9070000648498535
Num non-zero elements: 1
Test accuracy for 1.0: 0.652
Num non-zero elements: 1
Test accuracy for 5.0: 0.652
Num non-zero elements: 2
Test accuracy for 1.0: 0.712
Num non-zero elements: 2
Test accuracy for 5.0: 0.712
Num non-zero elements: 5
Test accuracy for 1.0: 0.856
Num non-zero elements: 5
Test accuracy for 5.0: 0.856
Num non-zero elements: 10
Test accuracy for 1.0: 0.881
Num non-zero elements: 10
Test accuracy for 5.0: 0.881
Num non-zero elements: 20
Test accuracy for 1.0: 0.894
Num non-zero elements: 20
Test accuracy for 5.0: 0.894
Num non-zero elements: 50
Test accuracy for 1.0: 0.91
Num non-zero elements: 50
Test accuracy for 5.0: 0.91
Loading dataset codeparrot/github-code, this usually takes ~30 seconds


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  20%|██        | 1/5 [00:01<00:07,  1.93s/it][A[A

Tokenizing data:  40%|████      | 2/5 [00:02<00:04,  1.41s/it][A[A

Tokenizing data:  60%|██████    | 3/5 [00:04<00:02,  1.24s/it][A[A

Tokenizing data:  80%|████████  | 4/5 [00:04<00:00,  1.06it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:05<00:00,  1.20it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:05<00:00,  1.03s/it]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  20%|██        | 1/5 [00:00<00:02,  1.95it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:01,  2.46it/s][A[A

Tokenizing data:  60%|██████    | 3/5 [00:01<00:00,  2.81it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:01<00:00,  3.58it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:01<00:00,  4.10it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:01<00:00,  3.37it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 29.11it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.20it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.54it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.49it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.08it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.78it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.57it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.39it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.28it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.22it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.02it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.47it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.99it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.12it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.71it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.46it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.10it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.94it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.10it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.91it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.07it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.65it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.41it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.07it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.03it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.91it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.91it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.91it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.92it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.92it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.88it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.89it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.89it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.89it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.04it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.87it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.01it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.59it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.34it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.10it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.03it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 17.99it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.94it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.93it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.91it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.89it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.89it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.89it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.89it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.89it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.89it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.88it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.88it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.87it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.86it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.86it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.86it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.87it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.87it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.86it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.86it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.00it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.82it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:03, 18.97it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.55it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.15it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.07it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.00it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 17.96it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.92it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.89it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.89it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.88it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.86it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.85it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.85it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.84it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.85it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.84it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.83it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.83it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.83it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.84it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.84it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.84it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.84it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:03<00:00, 17.83it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.83it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.82it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.80it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.80it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.96it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.38it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.12it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.63it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.33it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.14it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.02it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.95it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.27it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.78it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.56it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.89it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.50it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.11it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.55it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.10it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.66it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.33it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.14it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.02it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.95it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.91it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.17it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.17it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.69it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.35it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.02it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.94it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.90it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.17it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.18it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.70it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.35it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.01it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.93it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.90it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.17it/s]
Num non-zero elements: 2304
Test accuracy for C: 0.958
Num non-zero elements: 2304
Test accuracy for Python: 0.983
Num non-zero elements: 2304
Test accuracy for HTML: 0.988
Num non-zero elements: 2304
Test accuracy for Java: 0.967
Num non-zero elements: 2304
Test accuracy for PHP: 0.946
Num non-zero elements: 1
Test accuracy for C: 0.605
Num non-zero elements: 1
Test accuracy for Python: 0.634
Num non-zero elements: 1
Test accuracy for HTML: 0.715
Num non-zero elements: 1
Test accuracy for Java: 0.599
Num non-zero elements: 1
Test accuracy for PHP: 0.586
Num non-zero elements: 2
Test accuracy for C: 0.726
Num non-zero elements: 2
Test accuracy for Python: 0.696
Num non-zero elements: 2
Test accuracy for HTML: 0.941
Num non-zero elements: 2
Test accuracy for Java: 0.642
Num non-zero elements: 2
Test accuracy for PHP: 0.654
Num non-zero elements: 5
Test accuracy for C: 0.827
Num non-zero elements: 5
Test accuracy for Python: 0.766
Num non-zero elements: 5
Test accuracy for HTML: 0.946
Num non-zero elements: 5
Test accuracy for Java: 0.783
Num non-zero elements: 5
Test accuracy for PHP: 0.713
Num non-zero elements: 10
Test accuracy for C: 0.822
Num non-zero elements: 10
Test accuracy for Python: 0.869
Num non-zero elements: 10
Test accuracy for HTML: 0.951
Num non-zero elements: 10
Test accuracy for Java: 0.847
Num non-zero elements: 10
Test accuracy for PHP: 0.81
Num non-zero elements: 20
Test accuracy for C: 0.867
Num non-zero elements: 20
Test accuracy for Python: 0.887
Num non-zero elements: 20
Test accuracy for HTML: 0.952
Num non-zero elements: 20
Test accuracy for Java: 0.857
Num non-zero elements: 20
Test accuracy for PHP: 0.873
Num non-zero elements: 50
Test accuracy for C: 0.926
Num non-zero elements: 50
Test accuracy for Python: 0.967
Num non-zero elements: 50
Test accuracy for HTML: 0.971
Num non-zero elements: 50
Test accuracy for Java: 0.919
Num non-zero elements: 50
Test accuracy for PHP: 0.897
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 40 epochs
Test accuracy for C: 0.9600000381469727
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for Python: 0.984000027179718
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 22 epochs
Test accuracy for HTML: 0.9900000691413879
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 39 epochs
Test accuracy for Java: 0.971000075340271
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 31 epochs
Test accuracy for PHP: 0.9510000348091125
Num non-zero elements: 1
Test accuracy for C: 0.717
Num non-zero elements: 1
Test accuracy for Python: 0.937
Num non-zero elements: 1
Test accuracy for HTML: 0.897
Num non-zero elements: 1
Test accuracy for Java: 0.794
Num non-zero elements: 1
Test accuracy for PHP: 0.903
Num non-zero elements: 2
Test accuracy for C: 0.837
Num non-zero elements: 2
Test accuracy for Python: 0.939
Num non-zero elements: 2
Test accuracy for HTML: 0.9
Num non-zero elements: 2
Test accuracy for Java: 0.87
Num non-zero elements: 2
Test accuracy for PHP: 0.902
Num non-zero elements: 5
Test accuracy for C: 0.895
Num non-zero elements: 5
Test accuracy for Python: 0.968
Num non-zero elements: 5
Test accuracy for HTML: 0.952
Num non-zero elements: 5
Test accuracy for Java: 0.914
Num non-zero elements: 5
Test accuracy for PHP: 0.911
Num non-zero elements: 10
Test accuracy for C: 0.914
Num non-zero elements: 10
Test accuracy for Python: 0.978
Num non-zero elements: 10
Test accuracy for HTML: 0.957
Num non-zero elements: 10
Test accuracy for Java: 0.939
Num non-zero elements: 10
Test accuracy for PHP: 0.916
Num non-zero elements: 20
Test accuracy for C: 0.937
Num non-zero elements: 20
Test accuracy for Python: 0.981
Num non-zero elements: 20
Test accuracy for HTML: 0.958
Num non-zero elements: 20
Test accuracy for Java: 0.947
Num non-zero elements: 20
Test accuracy for PHP: 0.928
Num non-zero elements: 50
Test accuracy for C: 0.95
Num non-zero elements: 50
Test accuracy for Python: 0.989
Num non-zero elements: 50
Test accuracy for HTML: 0.963
Num non-zero elements: 50
Test accuracy for Java: 0.939
Num non-zero elements: 50
Test accuracy for PHP: 0.932


Tokenizing data:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Tokenizing data:  50%|█████     | 2/4 [00:00<00:00, 14.78it/s][A[A

Tokenizing data: 100%|██████████| 4/4 [00:00<00:00, 14.44it/s][A[ATokenizing data: 100%|██████████| 4/4 [00:00<00:00, 14.24it/s]


Tokenizing data:   0%|          | 0/4 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 4/4 [00:00<00:00, 49.81it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.77it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.17it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.58it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.54it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.13it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.84it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.64it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.48it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.37it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.31it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.26it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.22it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.21it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.04it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.44it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.36it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.29it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.25it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.22it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.19it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 17.89it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 18.25it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.20it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 15.41it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.93it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.41it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 22.33it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.65it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:03, 16.86it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 19.26it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.87it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.63it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.47it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.36it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.29it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.24it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.21it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.09it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.24it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 23.71it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 20.01it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 19.07it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:03, 16.77it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.01it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.75it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.56it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.43it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.32it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.23it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.44it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.27it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 18.21it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.16it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.22it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 23.94it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.63it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 19.16it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.79it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.54it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.37it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.26it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 16.93it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.28it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.19it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.12it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.40it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.24it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.18it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.18it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 23.59it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.89it/s][A[A

Collecting activations:  56%|█████▋    | 9/16 [00:00<00:00, 18.96it/s][A[A

Collecting activations:  69%|██████▉   | 11/16 [00:00<00:00, 18.65it/s][A[A

Collecting activations:  81%|████████▏ | 13/16 [00:00<00:00, 18.43it/s][A[A

Collecting activations:  94%|█████████▍| 15/16 [00:00<00:00, 18.30it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.81it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.30it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.84it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.52it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.32it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.20it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.11it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.07it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.31it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.18it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.16it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.72it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.45it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.28it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.17it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.42it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.88it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.38it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.84it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.53it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.34it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.21it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.13it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.49it/s]
Num non-zero elements: 2304
Test accuracy for 0: 0.931
Num non-zero elements: 2304
Test accuracy for 1: 0.986
Num non-zero elements: 2304
Test accuracy for 2: 0.892
Num non-zero elements: 2304
Test accuracy for 3: 0.923
Num non-zero elements: 1
Test accuracy for 0: 0.776
Num non-zero elements: 1
Test accuracy for 1: 0.675
Num non-zero elements: 1
Test accuracy for 2: 0.655
Num non-zero elements: 1
Test accuracy for 3: 0.784
Num non-zero elements: 2
Test accuracy for 0: 0.794
Num non-zero elements: 2
Test accuracy for 1: 0.802
Num non-zero elements: 2
Test accuracy for 2: 0.693
Num non-zero elements: 2
Test accuracy for 3: 0.804
Num non-zero elements: 5
Test accuracy for 0: 0.876
Num non-zero elements: 5
Test accuracy for 1: 0.876
Num non-zero elements: 5
Test accuracy for 2: 0.781
Num non-zero elements: 5
Test accuracy for 3: 0.846
Num non-zero elements: 10
Test accuracy for 0: 0.889
Num non-zero elements: 10
Test accuracy for 1: 0.943
Num non-zero elements: 10
Test accuracy for 2: 0.802
Num non-zero elements: 10
Test accuracy for 3: 0.865
Num non-zero elements: 20
Test accuracy for 0: 0.909
Num non-zero elements: 20
Test accuracy for 1: 0.963
Num non-zero elements: 20
Test accuracy for 2: 0.869
Num non-zero elements: 20
Test accuracy for 3: 0.897
Num non-zero elements: 50
Test accuracy for 0: 0.912
Num non-zero elements: 50
Test accuracy for 1: 0.971
Num non-zero elements: 50
Test accuracy for 2: 0.892
Num non-zero elements: 50
Test accuracy for 3: 0.921
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for 0: 0.9340000152587891
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for 1: 0.9780000448226929
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 21 epochs
Test accuracy for 2: 0.9260000586509705
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 25 epochs
Test accuracy for 3: 0.9570000171661377
Num non-zero elements: 1
Test accuracy for 0: 0.855
Num non-zero elements: 1
Test accuracy for 1: 0.952
Num non-zero elements: 1
Test accuracy for 2: 0.784
Num non-zero elements: 1
Test accuracy for 3: 0.719
Num non-zero elements: 2
Test accuracy for 0: 0.858
Num non-zero elements: 2
Test accuracy for 1: 0.957
Num non-zero elements: 2
Test accuracy for 2: 0.827
Num non-zero elements: 2
Test accuracy for 3: 0.793
Num non-zero elements: 5
Test accuracy for 0: 0.86
Num non-zero elements: 5
Test accuracy for 1: 0.964
Num non-zero elements: 5
Test accuracy for 2: 0.852
Num non-zero elements: 5
Test accuracy for 3: 0.852
Num non-zero elements: 10
Test accuracy for 0: 0.885
Num non-zero elements: 10
Test accuracy for 1: 0.967
Num non-zero elements: 10
Test accuracy for 2: 0.876
Num non-zero elements: 10
Test accuracy for 3: 0.875
Num non-zero elements: 20
Test accuracy for 0: 0.907
Num non-zero elements: 20
Test accuracy for 1: 0.967
Num non-zero elements: 20
Test accuracy for 2: 0.887
Num non-zero elements: 20
Test accuracy for 3: 0.909
Num non-zero elements: 50
Test accuracy for 0: 0.904
Num non-zero elements: 50
Test accuracy for 1: 0.978
Num non-zero elements: 50
Test accuracy for 2: 0.896
Num non-zero elements: 50
Test accuracy for 3: 0.926
Loading dataset Helsinki-NLP/europarl, this usually takes ~10 seconds


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 14.80it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 14.83it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 14.87it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 52.55it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 28.11it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.26it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.61it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.56it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 19.03it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.80it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:00<00:02, 18.60it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.46it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.37it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.31it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.25it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.22it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.14it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.14it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.11it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.11it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.11it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.13it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.55it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.15it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.24it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.80it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.55it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.39it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.30it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.23it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.17it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.07it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.16it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.73it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.48it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.32it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.23it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.12it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.13it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.02it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.11it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.69it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.44it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.30it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.09it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.97it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.10it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.91it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.09it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.66it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.42it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.26it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.15it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.10it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.04it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.95it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.94it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.90it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.91it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.91it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.89it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.89it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.89it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.89it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.89it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.89it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.89it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.89it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.03it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.85it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.00it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.57it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.34it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.08it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.36it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.22it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.77it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.44it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.24it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.10it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.03it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.26it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.21it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.77it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.43it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.23it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.11it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.03it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.26it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.24it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.75it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.42it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.22it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.10it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.03it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.25it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.26it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.77it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.42it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.22it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.09it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.02it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.25it/s]
Num non-zero elements: 2304
Test accuracy for en: 0.999
Num non-zero elements: 2304
Test accuracy for fr: 1.0
Num non-zero elements: 2304
Test accuracy for de: 1.0
Num non-zero elements: 2304
Test accuracy for es: 1.0
Num non-zero elements: 2304
Test accuracy for nl: 1.0
Num non-zero elements: 1
Test accuracy for en: 0.943
Num non-zero elements: 1
Test accuracy for fr: 0.658
Num non-zero elements: 1
Test accuracy for de: 0.803
Num non-zero elements: 1
Test accuracy for es: 0.886
Num non-zero elements: 1
Test accuracy for nl: 0.86
Num non-zero elements: 2
Test accuracy for en: 0.982
Num non-zero elements: 2
Test accuracy for fr: 0.913
Num non-zero elements: 2
Test accuracy for de: 0.832
Num non-zero elements: 2
Test accuracy for es: 0.899
Num non-zero elements: 2
Test accuracy for nl: 0.883
Num non-zero elements: 5
Test accuracy for en: 0.995
Num non-zero elements: 5
Test accuracy for fr: 0.968
Num non-zero elements: 5
Test accuracy for de: 0.894
Num non-zero elements: 5
Test accuracy for es: 0.982
Num non-zero elements: 5
Test accuracy for nl: 0.959
Num non-zero elements: 10
Test accuracy for en: 0.997
Num non-zero elements: 10
Test accuracy for fr: 0.99
Num non-zero elements: 10
Test accuracy for de: 0.973
Num non-zero elements: 10
Test accuracy for es: 0.988
Num non-zero elements: 10
Test accuracy for nl: 0.974
Num non-zero elements: 20
Test accuracy for en: 0.996
Num non-zero elements: 20
Test accuracy for fr: 0.993
Num non-zero elements: 20
Test accuracy for de: 0.993
Num non-zero elements: 20
Test accuracy for es: 0.995
Num non-zero elements: 20
Test accuracy for nl: 0.984
Num non-zero elements: 50
Test accuracy for en: 0.997
Num non-zero elements: 50
Test accuracy for fr: 0.998
Num non-zero elements: 50
Test accuracy for de: 0.998
Num non-zero elements: 50
Test accuracy for es: 0.999
Num non-zero elements: 50
Test accuracy for nl: 0.994
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 14 epochs
Test accuracy for en: 0.999000072479248
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 12 epochs
Test accuracy for fr: 0.999000072479248
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for de: 1.0
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for es: 0.999000072479248
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 12 epochs
Test accuracy for nl: 1.0
Num non-zero elements: 1
Test accuracy for en: 0.999
Num non-zero elements: 1
Test accuracy for fr: 0.869
Num non-zero elements: 1
Test accuracy for de: 0.999
Num non-zero elements: 1
Test accuracy for es: 0.953
Num non-zero elements: 1
Test accuracy for nl: 0.862
Num non-zero elements: 2
Test accuracy for en: 0.998
Num non-zero elements: 2
Test accuracy for fr: 0.997
Num non-zero elements: 2
Test accuracy for de: 0.998
Num non-zero elements: 2
Test accuracy for es: 0.959
Num non-zero elements: 2
Test accuracy for nl: 0.997
Num non-zero elements: 5
Test accuracy for en: 1.0
Num non-zero elements: 5
Test accuracy for fr: 0.994
Num non-zero elements: 5
Test accuracy for de: 0.998
Num non-zero elements: 5
Test accuracy for es: 0.975
Num non-zero elements: 5
Test accuracy for nl: 0.996
Num non-zero elements: 10
Test accuracy for en: 1.0
Num non-zero elements: 10
Test accuracy for fr: 0.996
Num non-zero elements: 10
Test accuracy for de: 0.998
Num non-zero elements: 10
Test accuracy for es: 0.997
Num non-zero elements: 10
Test accuracy for nl: 0.999
Num non-zero elements: 20
Test accuracy for en: 0.999
Num non-zero elements: 20
Test accuracy for fr: 0.997
Num non-zero elements: 20
Test accuracy for de: 1.0
Num non-zero elements: 20
Test accuracy for es: 0.997
Num non-zero elements: 20
Test accuracy for nl: 0.999
Num non-zero elements: 50
Test accuracy for en: 0.998
Num non-zero elements: 50
Test accuracy for fr: 0.996
Num non-zero elements: 50
Test accuracy for de: 1.0
Num non-zero elements: 50
Test accuracy for es: 0.997
Num non-zero elements: 50
Test accuracy for nl: 1.0

Running SAE evaluation on all selected SAEs: 100%|██████████| 1/1 [16:42<00:00, 1002.76s/it][ARunning SAE evaluation on all selected SAEs: 100%|██████████| 1/1 [16:42<00:00, 1002.76s/it]
Evaluations: 100%|██████████| 1/1 [16:59<00:00, 1019.68s/it]Evaluations: 100%|██████████| 1/1 [16:59<00:00, 1019.68s/it]
/share/u/can/SAEBench/custom_saes/topk_sae.py:110: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  pt_params = t.load(path_to_params)
Loaded config: {'trainer': {'trainer_class': 'TrainerTopKAdditivity', 'dict_class': 'AutoEncoderTopK', 'lr': 0.000282842712474619, 'steps': 48828, 'seed': 0, 'activation_dim': 2304, 'dict_size': 8192, 'k': 313, 'auxk_alpha': 0.03125, 'additivity_coeff': 0.0, 'intersection_coeff': 0.0, 'device': 'cuda:0', 'layer': 4, 'lm_name': 'google/gemma-2-2b', 'wandb_name': 'TopKTrainer_Additivity-google/gemma-2-2b-resid_post_layer_4-add_coeff-0.0-inters_coeff-0.0', 'submodule_name': 'resid_post_layer_4'}, 'buffer': {'d_submodule': 2304, 'io': 'out', 'n_ctxs': 8192, 'ctx_len': 128, 'refresh_batch_size': 32, 'out_batch_size': 2048, 'device': 'cuda:0'}}
Original keys in state_dict: odict_keys(['b_dec', 'encoder.weight', 'encoder.bias', 'decoder.weight'])
Renamed keys in state_dict: dict_keys(['b_dec', 'W_enc', 'b_enc', 'W_dec'])
Evaluations:   0%|          | 0/1 [00:00<?, ?it/s]


Running sparse_probing evaluation




Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s][A
Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:01,  1.53it/s][A
Loading checkpoint shards:  67%|██████▋   | 2/3 [00:01<00:00,  1.59it/s][A
Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.25it/s][ALoading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.01it/s]
Loaded pretrained model gemma-2-2b into HookedTransformer

Running SAE evaluation on all selected SAEs:   0%|          | 0/1 [00:00<?, ?it/s][A

  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 651.11it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 1088.90it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 12.74it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 13.08it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 13.00it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 47.85it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 47.63it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 26.70it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 22.94it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.45it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.47it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.09it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.81it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.61it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.44it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.34it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.27it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.23it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.20it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.09it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.51it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.31it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.29it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.83it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.57it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.40it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.23it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.18it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.22it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.23it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.77it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.47it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.35it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.15it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.10it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.98it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.13it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.25it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.20it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.75it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.48it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.33it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.22it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.09it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.96it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.11it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.21it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.13it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.68it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.42it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.27it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.10it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.04it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.94it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.93it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.89it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.89it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.89it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.89it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.89it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.89it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.88it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.89it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.88it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.04it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.36it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.18it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.70it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.42it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.25it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.13it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.06it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.45it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.27it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.79it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.45it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.14it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.06it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.02it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.29it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.27it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.79it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.43it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.24it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.04it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.27it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.39it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.83it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.47it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.05it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.29it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.29it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.79it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.44it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.22it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.08it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.00it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.96it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.22it/s]
Num non-zero elements: 2304
Test accuracy for 0: 0.925
Num non-zero elements: 2304
Test accuracy for 1: 0.943
Num non-zero elements: 2304
Test accuracy for 2: 0.947
Num non-zero elements: 2304
Test accuracy for 6: 0.991
Num non-zero elements: 2304
Test accuracy for 9: 0.971
Num non-zero elements: 1
Test accuracy for 0: 0.603
Num non-zero elements: 1
Test accuracy for 1: 0.648
Num non-zero elements: 1
Test accuracy for 2: 0.731
Num non-zero elements: 1
Test accuracy for 6: 0.773
Num non-zero elements: 1
Test accuracy for 9: 0.68
Num non-zero elements: 2
Test accuracy for 0: 0.682
Num non-zero elements: 2
Test accuracy for 1: 0.655
Num non-zero elements: 2
Test accuracy for 2: 0.744
Num non-zero elements: 2
Test accuracy for 6: 0.771
Num non-zero elements: 2
Test accuracy for 9: 0.772
Num non-zero elements: 5
Test accuracy for 0: 0.768
Num non-zero elements: 5
Test accuracy for 1: 0.69
Num non-zero elements: 5
Test accuracy for 2: 0.754
Num non-zero elements: 5
Test accuracy for 6: 0.905
Num non-zero elements: 5
Test accuracy for 9: 0.798
Num non-zero elements: 10
Test accuracy for 0: 0.797
Num non-zero elements: 10
Test accuracy for 1: 0.818
Num non-zero elements: 10
Test accuracy for 2: 0.83
Num non-zero elements: 10
Test accuracy for 6: 0.929
Num non-zero elements: 10
Test accuracy for 9: 0.912
Num non-zero elements: 20
Test accuracy for 0: 0.796
Num non-zero elements: 20
Test accuracy for 1: 0.867
Num non-zero elements: 20
Test accuracy for 2: 0.847
Num non-zero elements: 20
Test accuracy for 6: 0.96
Num non-zero elements: 20
Test accuracy for 9: 0.945
Num non-zero elements: 50
Test accuracy for 0: 0.862
Num non-zero elements: 50
Test accuracy for 1: 0.905
Num non-zero elements: 50
Test accuracy for 2: 0.897
Num non-zero elements: 50
Test accuracy for 6: 0.977
Num non-zero elements: 50
Test accuracy for 9: 0.948
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 28 epochs
Test accuracy for 0: 0.940000057220459
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for 1: 0.9570000171661377
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for 2: 0.940000057220459
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 21 epochs
Test accuracy for 6: 0.9890000224113464
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 22 epochs
Test accuracy for 9: 0.971000075340271
Num non-zero elements: 1
Test accuracy for 0: 0.681
Num non-zero elements: 1
Test accuracy for 1: 0.817
Num non-zero elements: 1
Test accuracy for 2: 0.864
Num non-zero elements: 1
Test accuracy for 6: 0.975
Num non-zero elements: 1
Test accuracy for 9: 0.933
Num non-zero elements: 2
Test accuracy for 0: 0.659
Num non-zero elements: 2
Test accuracy for 1: 0.811
Num non-zero elements: 2
Test accuracy for 2: 0.872
Num non-zero elements: 2
Test accuracy for 6: 0.961
Num non-zero elements: 2
Test accuracy for 9: 0.938
Num non-zero elements: 5
Test accuracy for 0: 0.792
Num non-zero elements: 5
Test accuracy for 1: 0.819
Num non-zero elements: 5
Test accuracy for 2: 0.882
Num non-zero elements: 5
Test accuracy for 6: 0.981
Num non-zero elements: 5
Test accuracy for 9: 0.951
Num non-zero elements: 10
Test accuracy for 0: 0.883
Num non-zero elements: 10
Test accuracy for 1: 0.89
Num non-zero elements: 10
Test accuracy for 2: 0.888
Num non-zero elements: 10
Test accuracy for 6: 0.986
Num non-zero elements: 10
Test accuracy for 9: 0.956
Num non-zero elements: 20
Test accuracy for 0: 0.876
Num non-zero elements: 20
Test accuracy for 1: 0.915
Num non-zero elements: 20
Test accuracy for 2: 0.904
Num non-zero elements: 20
Test accuracy for 6: 0.985
Num non-zero elements: 20
Test accuracy for 9: 0.962
Num non-zero elements: 50
Test accuracy for 0: 0.91
Num non-zero elements: 50
Test accuracy for 1: 0.948
Num non-zero elements: 50
Test accuracy for 2: 0.93
Num non-zero elements: 50
Test accuracy for 6: 0.989
Num non-zero elements: 50
Test accuracy for 9: 0.966


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 657.61it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 958.78it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 13.18it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 13.08it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 13.04it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 50.79it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.60it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 22.91it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:03, 16.76it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.02it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.04it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.07it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.08it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.23it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.76it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.44it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.92it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.62it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.45it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.33it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:03, 13.50it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 16.42it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:02, 16.84it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 17.16it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 17.41it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 17.60it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 17.73it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 17.83it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 17.89it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.06it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.78it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 23.67it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 20.01it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 19.06it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.75it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.54it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.39it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 18.21it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.20it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 23.90it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 20.02it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 19.04it/s][A[A

Collecting activations:  17%|█▋        | 11/63 [00:00<00:02, 18.72it/s][A[A

Collecting activations:  21%|██        | 13/63 [00:00<00:02, 18.49it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 18.34it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:01<00:02, 16.37it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.62it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.45it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.32it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.22it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.96it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.20it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 22.12it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.44it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.87it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.56it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.35it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.22it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.13it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:01<00:02, 16.56it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.46it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.31it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.21it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 17.14it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 15.55it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.96it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 17.99it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.87it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.66it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.99it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.60it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.36it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.20it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.12it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.57it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.38it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.49it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.88it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.52it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.31it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.17it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.08it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.49it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.54it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.53it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.89it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.53it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.31it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.17it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.08it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.52it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.96it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.35it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.79it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.46it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.13it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.06it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.42it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 22.74it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.59it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 13.33it/s][A[A

Collecting activations:  69%|██████▉   | 11/16 [00:00<00:00, 16.44it/s][A[A

Collecting activations:  81%|████████▏ | 13/16 [00:00<00:00, 16.82it/s][A[A

Collecting activations:  94%|█████████▍| 15/16 [00:00<00:00, 17.11it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 16.97it/s]
Num non-zero elements: 2304
Test accuracy for 11: 0.942
Num non-zero elements: 2304
Test accuracy for 13: 0.948
Num non-zero elements: 2304
Test accuracy for 14: 0.95
Num non-zero elements: 2304
Test accuracy for 18: 0.92
Num non-zero elements: 2304
Test accuracy for 19: 0.951
Num non-zero elements: 1
Test accuracy for 11: 0.71
Num non-zero elements: 1
Test accuracy for 13: 0.706
Num non-zero elements: 1
Test accuracy for 14: 0.659
Num non-zero elements: 1
Test accuracy for 18: 0.708
Num non-zero elements: 1
Test accuracy for 19: 0.766
Num non-zero elements: 2
Test accuracy for 11: 0.774
Num non-zero elements: 2
Test accuracy for 13: 0.713
Num non-zero elements: 2
Test accuracy for 14: 0.671
Num non-zero elements: 2
Test accuracy for 18: 0.703
Num non-zero elements: 2
Test accuracy for 19: 0.789
Num non-zero elements: 5
Test accuracy for 11: 0.846
Num non-zero elements: 5
Test accuracy for 13: 0.785
Num non-zero elements: 5
Test accuracy for 14: 0.759
Num non-zero elements: 5
Test accuracy for 18: 0.716
Num non-zero elements: 5
Test accuracy for 19: 0.818
Num non-zero elements: 10
Test accuracy for 11: 0.873
Num non-zero elements: 10
Test accuracy for 13: 0.849
Num non-zero elements: 10
Test accuracy for 14: 0.796
Num non-zero elements: 10
Test accuracy for 18: 0.744
Num non-zero elements: 10
Test accuracy for 19: 0.837
Num non-zero elements: 20
Test accuracy for 11: 0.886
Num non-zero elements: 20
Test accuracy for 13: 0.87
Num non-zero elements: 20
Test accuracy for 14: 0.872
Num non-zero elements: 20
Test accuracy for 18: 0.752
Num non-zero elements: 20
Test accuracy for 19: 0.915
Num non-zero elements: 50
Test accuracy for 11: 0.931
Num non-zero elements: 50
Test accuracy for 13: 0.897
Num non-zero elements: 50
Test accuracy for 14: 0.903
Num non-zero elements: 50
Test accuracy for 18: 0.828
Num non-zero elements: 50
Test accuracy for 19: 0.924
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for 11: 0.9590000510215759
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for 13: 0.9490000605583191
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 23 epochs
Test accuracy for 14: 0.9520000219345093
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 29 epochs
Test accuracy for 18: 0.9100000262260437
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 26 epochs
Test accuracy for 19: 0.9640000462532043
Num non-zero elements: 1
Test accuracy for 11: 0.733
Num non-zero elements: 1
Test accuracy for 13: 0.685
Num non-zero elements: 1
Test accuracy for 14: 0.82
Num non-zero elements: 1
Test accuracy for 18: 0.605
Num non-zero elements: 1
Test accuracy for 19: 0.865
Num non-zero elements: 2
Test accuracy for 11: 0.837
Num non-zero elements: 2
Test accuracy for 13: 0.706
Num non-zero elements: 2
Test accuracy for 14: 0.876
Num non-zero elements: 2
Test accuracy for 18: 0.742
Num non-zero elements: 2
Test accuracy for 19: 0.854
Num non-zero elements: 5
Test accuracy for 11: 0.853
Num non-zero elements: 5
Test accuracy for 13: 0.82
Num non-zero elements: 5
Test accuracy for 14: 0.875
Num non-zero elements: 5
Test accuracy for 18: 0.873
Num non-zero elements: 5
Test accuracy for 19: 0.852
Num non-zero elements: 10
Test accuracy for 11: 0.883
Num non-zero elements: 10
Test accuracy for 13: 0.861
Num non-zero elements: 10
Test accuracy for 14: 0.932
Num non-zero elements: 10
Test accuracy for 18: 0.882
Num non-zero elements: 10
Test accuracy for 19: 0.91
Num non-zero elements: 20
Test accuracy for 11: 0.932
Num non-zero elements: 20
Test accuracy for 13: 0.906
Num non-zero elements: 20
Test accuracy for 14: 0.931
Num non-zero elements: 20
Test accuracy for 18: 0.885
Num non-zero elements: 20
Test accuracy for 19: 0.921
Num non-zero elements: 50
Test accuracy for 11: 0.954
Num non-zero elements: 50
Test accuracy for 13: 0.938
Num non-zero elements: 50
Test accuracy for 14: 0.941
Num non-zero elements: 50
Test accuracy for 18: 0.912
Num non-zero elements: 50
Test accuracy for 19: 0.929


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 622.73it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 1035.80it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 12.21it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00,  7.42it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00,  8.55it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 49.60it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 49.35it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.14it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 22.90it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.44it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.48it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.08it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.81it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.60it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.41it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.32it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.26it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.21it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.08it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.50it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.06it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.19it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.78it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.51it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.36it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.27it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.20it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.16it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.01it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.13it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.71it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.48it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.32it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.22it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.11it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.98it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.12it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.98it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.11it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.69it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.43it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.26it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.09it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.05it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.92it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.92it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.93it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.07it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.91it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.04it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.62it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.37it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.22it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.11it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.04it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.00it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.94it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.93it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.90it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.90it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.90it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.91it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.89it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.89it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.89it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.89it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.89it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.89it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.89it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.02it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.88it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.00it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.57it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.31it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.35it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.27it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.77it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.44it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.24it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.11it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.02it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.97it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.25it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.24it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.80it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.45it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.25it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.10it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.02it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.97it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.25it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.20it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.76it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.42it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.22it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.10it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.02it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.98it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.25it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.22it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.76it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.42it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.22it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.09it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.01it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.97it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.24it/s]
Num non-zero elements: 2304
Test accuracy for 20: 0.926
Num non-zero elements: 2304
Test accuracy for 21: 0.886
Num non-zero elements: 2304
Test accuracy for 22: 0.902
Num non-zero elements: 2304
Test accuracy for 25: 0.946
Num non-zero elements: 2304
Test accuracy for 26: 0.871
Num non-zero elements: 1
Test accuracy for 20: 0.743
Num non-zero elements: 1
Test accuracy for 21: 0.632
Num non-zero elements: 1
Test accuracy for 22: 0.62
Num non-zero elements: 1
Test accuracy for 25: 0.704
Num non-zero elements: 1
Test accuracy for 26: 0.655
Num non-zero elements: 2
Test accuracy for 20: 0.791
Num non-zero elements: 2
Test accuracy for 21: 0.706
Num non-zero elements: 2
Test accuracy for 22: 0.616
Num non-zero elements: 2
Test accuracy for 25: 0.712
Num non-zero elements: 2
Test accuracy for 26: 0.66
Num non-zero elements: 5
Test accuracy for 20: 0.853
Num non-zero elements: 5
Test accuracy for 21: 0.775
Num non-zero elements: 5
Test accuracy for 22: 0.726
Num non-zero elements: 5
Test accuracy for 25: 0.8
Num non-zero elements: 5
Test accuracy for 26: 0.682
Num non-zero elements: 10
Test accuracy for 20: 0.876
Num non-zero elements: 10
Test accuracy for 21: 0.834
Num non-zero elements: 10
Test accuracy for 22: 0.741
Num non-zero elements: 10
Test accuracy for 25: 0.887
Num non-zero elements: 10
Test accuracy for 26: 0.706
Num non-zero elements: 20
Test accuracy for 20: 0.898
Num non-zero elements: 20
Test accuracy for 21: 0.848
Num non-zero elements: 20
Test accuracy for 22: 0.756
Num non-zero elements: 20
Test accuracy for 25: 0.896
Num non-zero elements: 20
Test accuracy for 26: 0.772
Num non-zero elements: 50
Test accuracy for 20: 0.914
Num non-zero elements: 50
Test accuracy for 21: 0.859
Num non-zero elements: 50
Test accuracy for 22: 0.833
Num non-zero elements: 50
Test accuracy for 25: 0.929
Num non-zero elements: 50
Test accuracy for 26: 0.833
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for 20: 0.9450000524520874
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 21: 0.8950000405311584
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 17 epochs
Test accuracy for 22: 0.9120000600814819
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 25: 0.9590000510215759
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for 26: 0.8940000534057617
Num non-zero elements: 1
Test accuracy for 20: 0.832
Num non-zero elements: 1
Test accuracy for 21: 0.77
Num non-zero elements: 1
Test accuracy for 22: 0.766
Num non-zero elements: 1
Test accuracy for 25: 0.845
Num non-zero elements: 1
Test accuracy for 26: 0.667
Num non-zero elements: 2
Test accuracy for 20: 0.891
Num non-zero elements: 2
Test accuracy for 21: 0.772
Num non-zero elements: 2
Test accuracy for 22: 0.869
Num non-zero elements: 2
Test accuracy for 25: 0.871
Num non-zero elements: 2
Test accuracy for 26: 0.739
Num non-zero elements: 5
Test accuracy for 20: 0.919
Num non-zero elements: 5
Test accuracy for 21: 0.815
Num non-zero elements: 5
Test accuracy for 22: 0.876
Num non-zero elements: 5
Test accuracy for 25: 0.908
Num non-zero elements: 5
Test accuracy for 26: 0.824
Num non-zero elements: 10
Test accuracy for 20: 0.913
Num non-zero elements: 10
Test accuracy for 21: 0.827
Num non-zero elements: 10
Test accuracy for 22: 0.879
Num non-zero elements: 10
Test accuracy for 25: 0.92
Num non-zero elements: 10
Test accuracy for 26: 0.825
Num non-zero elements: 20
Test accuracy for 20: 0.934
Num non-zero elements: 20
Test accuracy for 21: 0.85
Num non-zero elements: 20
Test accuracy for 22: 0.883
Num non-zero elements: 20
Test accuracy for 25: 0.93
Num non-zero elements: 20
Test accuracy for 26: 0.844
Num non-zero elements: 50
Test accuracy for 20: 0.929
Num non-zero elements: 50
Test accuracy for 21: 0.866
Num non-zero elements: 50
Test accuracy for 22: 0.879
Num non-zero elements: 50
Test accuracy for 25: 0.939
Num non-zero elements: 50
Test accuracy for 26: 0.876


  0%|          | 0/34 [00:00<?, ?it/s][A[A100%|██████████| 34/34 [00:00<00:00, 402.48it/s]


  0%|          | 0/31 [00:00<?, ?it/s][A[A100%|██████████| 31/31 [00:00<00:00, 876.74it/s]
Removing 31 from train set
Removing 0 from train set
Removing 29 from train set
Removing 28 from train set
Removing 7 from train set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  20%|██        | 1/5 [00:00<00:00,  9.88it/s][A[A

Tokenizing data:  60%|██████    | 3/5 [00:00<00:00, 10.03it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 10.01it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 10.00it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 36.97it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 37.14it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 26.49it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 22.84it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.43it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.46it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.08it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.81it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.61it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.45it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.35it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.29it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.24it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.20it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.51it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.02it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.18it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.78it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.55it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.40it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.30it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.20it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.09it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.21it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.02it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.18it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.77it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.53it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.37it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.27it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.22it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.18it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.98it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.13it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.71it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.47it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.32it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.23it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.13it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.13it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.92it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.09it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.67it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.44it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.28it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.13it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.07it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.94it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.94it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.09it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.86it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.03it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.61it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.37it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.21it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.07it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.40it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.18it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.79it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.46it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.27it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.30it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.20it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.79it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.46it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.27it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.02it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.30it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.17it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.76it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.44it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.13it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.06it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.28it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.18it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.75it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.43it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.23it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.04it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.27it/s]
Num non-zero elements: 2304
Test accuracy for 1: 0.915
Num non-zero elements: 2304
Test accuracy for 2: 0.913
Num non-zero elements: 2304
Test accuracy for 3: 0.886
Num non-zero elements: 2304
Test accuracy for 5: 0.891
Num non-zero elements: 2304
Test accuracy for 6: 0.828
Num non-zero elements: 1
Test accuracy for 1: 0.701
Num non-zero elements: 1
Test accuracy for 2: 0.681
Num non-zero elements: 1
Test accuracy for 3: 0.593
Num non-zero elements: 1
Test accuracy for 5: 0.687
Num non-zero elements: 1
Test accuracy for 6: 0.584
Num non-zero elements: 2
Test accuracy for 1: 0.749
Num non-zero elements: 2
Test accuracy for 2: 0.782
Num non-zero elements: 2
Test accuracy for 3: 0.614
Num non-zero elements: 2
Test accuracy for 5: 0.698
Num non-zero elements: 2
Test accuracy for 6: 0.619
Num non-zero elements: 5
Test accuracy for 1: 0.76
Num non-zero elements: 5
Test accuracy for 2: 0.805
Num non-zero elements: 5
Test accuracy for 3: 0.631
Num non-zero elements: 5
Test accuracy for 5: 0.704
Num non-zero elements: 5
Test accuracy for 6: 0.7
Num non-zero elements: 10
Test accuracy for 1: 0.823
Num non-zero elements: 10
Test accuracy for 2: 0.822
Num non-zero elements: 10
Test accuracy for 3: 0.74
Num non-zero elements: 10
Test accuracy for 5: 0.736
Num non-zero elements: 10
Test accuracy for 6: 0.718
Num non-zero elements: 20
Test accuracy for 1: 0.828
Num non-zero elements: 20
Test accuracy for 2: 0.847
Num non-zero elements: 20
Test accuracy for 3: 0.795
Num non-zero elements: 20
Test accuracy for 5: 0.756
Num non-zero elements: 20
Test accuracy for 6: 0.737
Num non-zero elements: 50
Test accuracy for 1: 0.892
Num non-zero elements: 50
Test accuracy for 2: 0.862
Num non-zero elements: 50
Test accuracy for 3: 0.857
Num non-zero elements: 50
Test accuracy for 5: 0.799
Num non-zero elements: 50
Test accuracy for 6: 0.788
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 25 epochs
Test accuracy for 1: 0.9340000152587891
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 28 epochs
Test accuracy for 2: 0.9330000281333923
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 38 epochs
Test accuracy for 3: 0.9100000262260437
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 24 epochs
Test accuracy for 5: 0.9180000424385071
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 29 epochs
Test accuracy for 6: 0.8550000190734863
Num non-zero elements: 1
Test accuracy for 1: 0.838
Num non-zero elements: 1
Test accuracy for 2: 0.757
Num non-zero elements: 1
Test accuracy for 3: 0.641
Num non-zero elements: 1
Test accuracy for 5: 0.742
Num non-zero elements: 1
Test accuracy for 6: 0.608
Num non-zero elements: 2
Test accuracy for 1: 0.831
Num non-zero elements: 2
Test accuracy for 2: 0.831
Num non-zero elements: 2
Test accuracy for 3: 0.664
Num non-zero elements: 2
Test accuracy for 5: 0.852
Num non-zero elements: 2
Test accuracy for 6: 0.68
Num non-zero elements: 5
Test accuracy for 1: 0.846
Num non-zero elements: 5
Test accuracy for 2: 0.838
Num non-zero elements: 5
Test accuracy for 3: 0.747
Num non-zero elements: 5
Test accuracy for 5: 0.869
Num non-zero elements: 5
Test accuracy for 6: 0.742
Num non-zero elements: 10
Test accuracy for 1: 0.882
Num non-zero elements: 10
Test accuracy for 2: 0.852
Num non-zero elements: 10
Test accuracy for 3: 0.83
Num non-zero elements: 10
Test accuracy for 5: 0.878
Num non-zero elements: 10
Test accuracy for 6: 0.768
Num non-zero elements: 20
Test accuracy for 1: 0.919
Num non-zero elements: 20
Test accuracy for 2: 0.877
Num non-zero elements: 20
Test accuracy for 3: 0.867
Num non-zero elements: 20
Test accuracy for 5: 0.889
Num non-zero elements: 20
Test accuracy for 6: 0.776
Num non-zero elements: 50
Test accuracy for 1: 0.931
Num non-zero elements: 50
Test accuracy for 2: 0.905
Num non-zero elements: 50
Test accuracy for 3: 0.877
Num non-zero elements: 50
Test accuracy for 5: 0.908
Num non-zero elements: 50
Test accuracy for 6: 0.827


Tokenizing data:   0%|          | 0/2 [00:00<?, ?it/s][A[A

Tokenizing data:  50%|█████     | 1/2 [00:00<00:00,  9.76it/s][A[ATokenizing data: 100%|██████████| 2/2 [00:00<00:00,  9.90it/s]


Tokenizing data:   0%|          | 0/2 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 2/2 [00:00<00:00, 37.97it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 28.04it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.14it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.57it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.55it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.14it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.85it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.63it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.46it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.35it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.28it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.23it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.20it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.53it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.05it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.21it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.78it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.55it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.39it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.23it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.08it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.21it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.05it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.19it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.76it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.50it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.36it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.27it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.22it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.56it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.34it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.94it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.61it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.43it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.31it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.23it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.19it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.46it/s]
Num non-zero elements: 2304
Test accuracy for 1.0: 0.903
Num non-zero elements: 2304
Test accuracy for 5.0: 0.904
Num non-zero elements: 1
Test accuracy for 1.0: 0.631
Num non-zero elements: 1
Test accuracy for 5.0: 0.631
Num non-zero elements: 2
Test accuracy for 1.0: 0.654
Num non-zero elements: 2
Test accuracy for 5.0: 0.654
Num non-zero elements: 5
Test accuracy for 1.0: 0.669
Num non-zero elements: 5
Test accuracy for 5.0: 0.669
Num non-zero elements: 10
Test accuracy for 1.0: 0.764
Num non-zero elements: 10
Test accuracy for 5.0: 0.764
Num non-zero elements: 20
Test accuracy for 1.0: 0.792
Num non-zero elements: 20
Test accuracy for 5.0: 0.792
Num non-zero elements: 50
Test accuracy for 1.0: 0.829
Num non-zero elements: 50
Test accuracy for 5.0: 0.828
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 24 epochs
Test accuracy for 1.0: 0.9030000567436218
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 28 epochs
Test accuracy for 5.0: 0.9070000648498535
Num non-zero elements: 1
Test accuracy for 1.0: 0.816
Num non-zero elements: 1
Test accuracy for 5.0: 0.816
Num non-zero elements: 2
Test accuracy for 1.0: 0.817
Num non-zero elements: 2
Test accuracy for 5.0: 0.817
Num non-zero elements: 5
Test accuracy for 1.0: 0.825
Num non-zero elements: 5
Test accuracy for 5.0: 0.825
Num non-zero elements: 10
Test accuracy for 1.0: 0.841
Num non-zero elements: 10
Test accuracy for 5.0: 0.841
Num non-zero elements: 20
Test accuracy for 1.0: 0.881
Num non-zero elements: 20
Test accuracy for 5.0: 0.881
Num non-zero elements: 50
Test accuracy for 1.0: 0.891
Num non-zero elements: 50
Test accuracy for 5.0: 0.892
Loading dataset codeparrot/github-code, this usually takes ~30 seconds


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  20%|██        | 1/5 [00:01<00:07,  1.85s/it][A[A

Tokenizing data:  40%|████      | 2/5 [00:02<00:03,  1.33s/it][A[A

Tokenizing data:  60%|██████    | 3/5 [00:03<00:02,  1.22s/it][A[A

Tokenizing data:  80%|████████  | 4/5 [00:04<00:00,  1.08it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:04<00:00,  1.23it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:04<00:00,  1.00it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  20%|██        | 1/5 [00:00<00:02,  1.85it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00,  3.11it/s][A[A

Tokenizing data:  60%|██████    | 3/5 [00:01<00:00,  3.23it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:01<00:00,  3.96it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:01<00:00,  4.45it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:01<00:00,  3.72it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 28.23it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.32it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.61it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.55it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 19.00it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.77it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:00<00:02, 18.57it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.43it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.33it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.26it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.21it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.08it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.52it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.01it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.18it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.77it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.53it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.35it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.26it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.15it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.17it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.95it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.11it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.71it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.48it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.32it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.22it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.15it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.10it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.98it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.11it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.86it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.05it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.64it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.41it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.27it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.09it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.05it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.93it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.07it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.84it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.01it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.60it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.38it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.23it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.13it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.06it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.01it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.95it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.94it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.91it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.91it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.89it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.90it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.89it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.88it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.87it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.02it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.79it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.97it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.56it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.30it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.06it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.34it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.08it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.71it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.38it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.20it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.09it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.01it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.97it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.23it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.15it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.72it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.39it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.19it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.08it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.02it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.98it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.24it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.12it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.70it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.38it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.19it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.99it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.96it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.22it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.10it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.70it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.39it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.20it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.99it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.96it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.22it/s]
Num non-zero elements: 2304
Test accuracy for C: 0.962
Num non-zero elements: 2304
Test accuracy for Python: 0.986
Num non-zero elements: 2304
Test accuracy for HTML: 0.989
Num non-zero elements: 2304
Test accuracy for Java: 0.959
Num non-zero elements: 2304
Test accuracy for PHP: 0.96
Num non-zero elements: 1
Test accuracy for C: 0.607
Num non-zero elements: 1
Test accuracy for Python: 0.634
Num non-zero elements: 1
Test accuracy for HTML: 0.719
Num non-zero elements: 1
Test accuracy for Java: 0.585
Num non-zero elements: 1
Test accuracy for PHP: 0.57
Num non-zero elements: 2
Test accuracy for C: 0.735
Num non-zero elements: 2
Test accuracy for Python: 0.677
Num non-zero elements: 2
Test accuracy for HTML: 0.95
Num non-zero elements: 2
Test accuracy for Java: 0.628
Num non-zero elements: 2
Test accuracy for PHP: 0.654
Num non-zero elements: 5
Test accuracy for C: 0.808
Num non-zero elements: 5
Test accuracy for Python: 0.753
Num non-zero elements: 5
Test accuracy for HTML: 0.953
Num non-zero elements: 5
Test accuracy for Java: 0.785
Num non-zero elements: 5
Test accuracy for PHP: 0.726
Num non-zero elements: 10
Test accuracy for C: 0.825
Num non-zero elements: 10
Test accuracy for Python: 0.862
Num non-zero elements: 10
Test accuracy for HTML: 0.952
Num non-zero elements: 10
Test accuracy for Java: 0.849
Num non-zero elements: 10
Test accuracy for PHP: 0.813
Num non-zero elements: 20
Test accuracy for C: 0.875
Num non-zero elements: 20
Test accuracy for Python: 0.895
Num non-zero elements: 20
Test accuracy for HTML: 0.951
Num non-zero elements: 20
Test accuracy for Java: 0.847
Num non-zero elements: 20
Test accuracy for PHP: 0.861
Num non-zero elements: 50
Test accuracy for C: 0.906
Num non-zero elements: 50
Test accuracy for Python: 0.972
Num non-zero elements: 50
Test accuracy for HTML: 0.966
Num non-zero elements: 50
Test accuracy for Java: 0.908
Num non-zero elements: 50
Test accuracy for PHP: 0.887
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 36 epochs
Test accuracy for C: 0.9440000653266907
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for Python: 0.9860000610351562
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 21 epochs
Test accuracy for HTML: 0.9890000224113464
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 44 epochs
Test accuracy for Java: 0.968000054359436
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 32 epochs
Test accuracy for PHP: 0.9580000638961792
Num non-zero elements: 1
Test accuracy for C: 0.64
Num non-zero elements: 1
Test accuracy for Python: 0.918
Num non-zero elements: 1
Test accuracy for HTML: 0.724
Num non-zero elements: 1
Test accuracy for Java: 0.646
Num non-zero elements: 1
Test accuracy for PHP: 0.897
Num non-zero elements: 2
Test accuracy for C: 0.715
Num non-zero elements: 2
Test accuracy for Python: 0.92
Num non-zero elements: 2
Test accuracy for HTML: 0.912
Num non-zero elements: 2
Test accuracy for Java: 0.656
Num non-zero elements: 2
Test accuracy for PHP: 0.902
Num non-zero elements: 5
Test accuracy for C: 0.898
Num non-zero elements: 5
Test accuracy for Python: 0.967
Num non-zero elements: 5
Test accuracy for HTML: 0.948
Num non-zero elements: 5
Test accuracy for Java: 0.909
Num non-zero elements: 5
Test accuracy for PHP: 0.895
Num non-zero elements: 10
Test accuracy for C: 0.903
Num non-zero elements: 10
Test accuracy for Python: 0.973
Num non-zero elements: 10
Test accuracy for HTML: 0.956
Num non-zero elements: 10
Test accuracy for Java: 0.906
Num non-zero elements: 10
Test accuracy for PHP: 0.903
Num non-zero elements: 20
Test accuracy for C: 0.929
Num non-zero elements: 20
Test accuracy for Python: 0.978
Num non-zero elements: 20
Test accuracy for HTML: 0.955
Num non-zero elements: 20
Test accuracy for Java: 0.923
Num non-zero elements: 20
Test accuracy for PHP: 0.918
Num non-zero elements: 50
Test accuracy for C: 0.951
Num non-zero elements: 50
Test accuracy for Python: 0.985
Num non-zero elements: 50
Test accuracy for HTML: 0.964
Num non-zero elements: 50
Test accuracy for Java: 0.948
Num non-zero elements: 50
Test accuracy for PHP: 0.917


Tokenizing data:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Tokenizing data:  50%|█████     | 2/4 [00:00<00:00,  6.21it/s][A[A

Tokenizing data: 100%|██████████| 4/4 [00:00<00:00,  9.23it/s][A[ATokenizing data: 100%|██████████| 4/4 [00:00<00:00,  8.60it/s]


Tokenizing data:   0%|          | 0/4 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 4/4 [00:00<00:00, 55.13it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 26.80it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.01it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.56it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.56it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.17it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.88it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.68it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.53it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.43it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.36it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.31it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.27it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.25it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.23it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.22it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.20it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.19it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.18it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.18it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.18it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.18it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.18it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.18it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.17it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.17it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.17it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.17it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.17it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.18it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.59it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.13it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.30it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.88it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.64it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.48it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.39it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.32it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.27it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.23it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.21it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.20it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.19it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.16it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.15it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.16it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.16it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.15it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.15it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.15it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.15it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.15it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.14it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.28it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.12it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.25it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.84it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.61it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.45it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.34it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.28it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.23it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.20it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.18it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.11it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.11it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.11it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.11it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.25it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.98it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.18it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.78it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.55it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.42it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.06it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.19it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.01it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.16it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.76it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.52it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.35it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.21it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.55it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.27it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.89it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.57it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.39it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.28it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.21it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.17it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.43it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.31it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.90it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.57it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.38it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.27it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.20it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.17it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.42it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.29it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.88it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.55it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.36it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.24it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.15it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.40it/s]
Num non-zero elements: 2304
Test accuracy for 0: 0.923
Num non-zero elements: 2304
Test accuracy for 1: 0.989
Num non-zero elements: 2304
Test accuracy for 2: 0.903
Num non-zero elements: 2304
Test accuracy for 3: 0.922
Num non-zero elements: 1
Test accuracy for 0: 0.758
Num non-zero elements: 1
Test accuracy for 1: 0.683
Num non-zero elements: 1
Test accuracy for 2: 0.654
Num non-zero elements: 1
Test accuracy for 3: 0.782
Num non-zero elements: 2
Test accuracy for 0: 0.766
Num non-zero elements: 2
Test accuracy for 1: 0.8
Num non-zero elements: 2
Test accuracy for 2: 0.692
Num non-zero elements: 2
Test accuracy for 3: 0.805
Num non-zero elements: 5
Test accuracy for 0: 0.885
Num non-zero elements: 5
Test accuracy for 1: 0.874
Num non-zero elements: 5
Test accuracy for 2: 0.769
Num non-zero elements: 5
Test accuracy for 3: 0.831
Num non-zero elements: 10
Test accuracy for 0: 0.874
Num non-zero elements: 10
Test accuracy for 1: 0.942
Num non-zero elements: 10
Test accuracy for 2: 0.785
Num non-zero elements: 10
Test accuracy for 3: 0.857
Num non-zero elements: 20
Test accuracy for 0: 0.892
Num non-zero elements: 20
Test accuracy for 1: 0.967
Num non-zero elements: 20
Test accuracy for 2: 0.866
Num non-zero elements: 20
Test accuracy for 3: 0.889
Num non-zero elements: 50
Test accuracy for 0: 0.904
Num non-zero elements: 50
Test accuracy for 1: 0.965
Num non-zero elements: 50
Test accuracy for 2: 0.882
Num non-zero elements: 50
Test accuracy for 3: 0.913
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 17 epochs
Test accuracy for 0: 0.9430000185966492
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 1: 0.9770000576972961
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 25 epochs
Test accuracy for 2: 0.921000063419342
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for 3: 0.9420000314712524
Num non-zero elements: 1
Test accuracy for 0: 0.708
Num non-zero elements: 1
Test accuracy for 1: 0.957
Num non-zero elements: 1
Test accuracy for 2: 0.792
Num non-zero elements: 1
Test accuracy for 3: 0.795
Num non-zero elements: 2
Test accuracy for 0: 0.733
Num non-zero elements: 2
Test accuracy for 1: 0.958
Num non-zero elements: 2
Test accuracy for 2: 0.784
Num non-zero elements: 2
Test accuracy for 3: 0.776
Num non-zero elements: 5
Test accuracy for 0: 0.822
Num non-zero elements: 5
Test accuracy for 1: 0.964
Num non-zero elements: 5
Test accuracy for 2: 0.81
Num non-zero elements: 5
Test accuracy for 3: 0.823
Num non-zero elements: 10
Test accuracy for 0: 0.883
Num non-zero elements: 10
Test accuracy for 1: 0.977
Num non-zero elements: 10
Test accuracy for 2: 0.874
Num non-zero elements: 10
Test accuracy for 3: 0.855
Num non-zero elements: 20
Test accuracy for 0: 0.893
Num non-zero elements: 20
Test accuracy for 1: 0.977
Num non-zero elements: 20
Test accuracy for 2: 0.876
Num non-zero elements: 20
Test accuracy for 3: 0.865
Num non-zero elements: 50
Test accuracy for 0: 0.912
Num non-zero elements: 50
Test accuracy for 1: 0.983
Num non-zero elements: 50
Test accuracy for 2: 0.895
Num non-zero elements: 50
Test accuracy for 3: 0.93
Loading dataset Helsinki-NLP/europarl, this usually takes ~10 seconds


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 14.78it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 15.12it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 15.14it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 61.78it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.43it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.30it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.67it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.64it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 19.11it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.87it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:00<00:02, 18.68it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.53it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.44it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.38it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.34it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.31it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.29it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.28it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.26it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 18.24it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.23it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.22it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.22it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.22it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.23it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.22it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.22it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.21it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 18.21it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.21it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.21it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.21it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.22it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.64it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.18it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.30it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.88it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.65it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.49it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.40it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.33it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.26it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.23it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.22it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.19it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.18it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.18it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.18it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.18it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.18it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.18it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.18it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.18it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.17it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.17it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.17it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.16it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.17it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.30it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.11it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.27it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.87it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.62it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.48it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.38it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.20it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.18it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.18it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.08it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.25it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.01it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.18it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.77it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.53it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.39it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.30it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.23it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.17it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.06it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.19it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.99it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.16it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.74it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.49it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.33it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.13it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.15it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.97it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.11it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.70it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.45it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.30it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.21it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.17it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.50it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.24it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.81it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.51it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.32it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.10it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.07it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.34it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.22it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.82it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.49it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.30it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.17it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.09it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.07it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.33it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.23it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.82it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.48it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.29it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.17it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.09it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.06it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.33it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.22it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.81it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.48it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.29it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.09it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.05it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.32it/s]
Num non-zero elements: 2304
Test accuracy for en: 0.997
Num non-zero elements: 2304
Test accuracy for fr: 1.0
Num non-zero elements: 2304
Test accuracy for de: 0.999
Num non-zero elements: 2304
Test accuracy for es: 0.999
Num non-zero elements: 2304
Test accuracy for nl: 1.0
Num non-zero elements: 1
Test accuracy for en: 0.94
Num non-zero elements: 1
Test accuracy for fr: 0.665
Num non-zero elements: 1
Test accuracy for de: 0.818
Num non-zero elements: 1
Test accuracy for es: 0.888
Num non-zero elements: 1
Test accuracy for nl: 0.855
Num non-zero elements: 2
Test accuracy for en: 0.973
Num non-zero elements: 2
Test accuracy for fr: 0.901
Num non-zero elements: 2
Test accuracy for de: 0.84
Num non-zero elements: 2
Test accuracy for es: 0.906
Num non-zero elements: 2
Test accuracy for nl: 0.893
Num non-zero elements: 5
Test accuracy for en: 0.994
Num non-zero elements: 5
Test accuracy for fr: 0.971
Num non-zero elements: 5
Test accuracy for de: 0.897
Num non-zero elements: 5
Test accuracy for es: 0.979
Num non-zero elements: 5
Test accuracy for nl: 0.949
Num non-zero elements: 10
Test accuracy for en: 0.996
Num non-zero elements: 10
Test accuracy for fr: 0.992
Num non-zero elements: 10
Test accuracy for de: 0.978
Num non-zero elements: 10
Test accuracy for es: 0.986
Num non-zero elements: 10
Test accuracy for nl: 0.972
Num non-zero elements: 20
Test accuracy for en: 0.997
Num non-zero elements: 20
Test accuracy for fr: 0.994
Num non-zero elements: 20
Test accuracy for de: 0.99
Num non-zero elements: 20
Test accuracy for es: 0.998
Num non-zero elements: 20
Test accuracy for nl: 0.982
Num non-zero elements: 50
Test accuracy for en: 0.998
Num non-zero elements: 50
Test accuracy for fr: 0.999
Num non-zero elements: 50
Test accuracy for de: 0.998
Num non-zero elements: 50
Test accuracy for es: 0.999
Num non-zero elements: 50
Test accuracy for nl: 0.993
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 12 epochs
Test accuracy for en: 0.9980000257492065
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for fr: 0.999000072479248
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for de: 0.999000072479248
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 12 epochs
Test accuracy for es: 1.0
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 14 epochs
Test accuracy for nl: 1.0
Num non-zero elements: 1
Test accuracy for en: 0.998
Num non-zero elements: 1
Test accuracy for fr: 0.86
Num non-zero elements: 1
Test accuracy for de: 1.0
Num non-zero elements: 1
Test accuracy for es: 0.874
Num non-zero elements: 1
Test accuracy for nl: 0.999
Num non-zero elements: 2
Test accuracy for en: 1.0
Num non-zero elements: 2
Test accuracy for fr: 0.994
Num non-zero elements: 2
Test accuracy for de: 0.997
Num non-zero elements: 2
Test accuracy for es: 0.996
Num non-zero elements: 2
Test accuracy for nl: 0.998
Num non-zero elements: 5
Test accuracy for en: 0.997
Num non-zero elements: 5
Test accuracy for fr: 0.996
Num non-zero elements: 5
Test accuracy for de: 0.998
Num non-zero elements: 5
Test accuracy for es: 0.997
Num non-zero elements: 5
Test accuracy for nl: 0.996
Num non-zero elements: 10
Test accuracy for en: 1.0
Num non-zero elements: 10
Test accuracy for fr: 0.994
Num non-zero elements: 10
Test accuracy for de: 1.0
Num non-zero elements: 10
Test accuracy for es: 0.997
Num non-zero elements: 10
Test accuracy for nl: 0.998
Num non-zero elements: 20
Test accuracy for en: 0.999
Num non-zero elements: 20
Test accuracy for fr: 0.996
Num non-zero elements: 20
Test accuracy for de: 0.998
Num non-zero elements: 20
Test accuracy for es: 0.999
Num non-zero elements: 20
Test accuracy for nl: 0.997
Num non-zero elements: 50
Test accuracy for en: 0.999
Num non-zero elements: 50
Test accuracy for fr: 1.0
Num non-zero elements: 50
Test accuracy for de: 0.999
Num non-zero elements: 50
Test accuracy for es: 1.0
Num non-zero elements: 50
Test accuracy for nl: 0.999

Running SAE evaluation on all selected SAEs: 100%|██████████| 1/1 [17:08<00:00, 1028.31s/it][ARunning SAE evaluation on all selected SAEs: 100%|██████████| 1/1 [17:08<00:00, 1028.32s/it]
Evaluations: 100%|██████████| 1/1 [17:24<00:00, 1044.25s/it]Evaluations: 100%|██████████| 1/1 [17:24<00:00, 1044.25s/it]
/share/u/can/SAEBench/custom_saes/topk_sae.py:110: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  pt_params = t.load(path_to_params)
Loaded config: {'trainer': {'trainer_class': 'TrainerTopKAdditivity', 'dict_class': 'AutoEncoderTopK', 'lr': 0.000282842712474619, 'steps': 48828, 'seed': 0, 'activation_dim': 2304, 'dict_size': 8192, 'k': 313, 'auxk_alpha': 0.03125, 'additivity_coeff': 0.0, 'intersection_coeff': 1.0, 'device': 'cuda:0', 'layer': 4, 'lm_name': 'google/gemma-2-2b', 'wandb_name': 'TopKTrainer_Additivity-google/gemma-2-2b-resid_post_layer_4-add_coeff-0.0-inters_coeff-1.0', 'submodule_name': 'resid_post_layer_4'}, 'buffer': {'d_submodule': 2304, 'io': 'out', 'n_ctxs': 8192, 'ctx_len': 128, 'refresh_batch_size': 32, 'out_batch_size': 2048, 'device': 'cuda:0'}}
Original keys in state_dict: odict_keys(['b_dec', 'encoder.weight', 'encoder.bias', 'decoder.weight'])
Renamed keys in state_dict: dict_keys(['b_dec', 'W_enc', 'b_enc', 'W_dec'])
Evaluations:   0%|          | 0/1 [00:00<?, ?it/s]


Running sparse_probing evaluation




Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s][A
Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:01,  1.49it/s][A
Loading checkpoint shards:  67%|██████▋   | 2/3 [00:01<00:00,  1.55it/s][A
Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.21it/s][ALoading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  1.97it/s]
Loaded pretrained model gemma-2-2b into HookedTransformer

Running SAE evaluation on all selected SAEs:   0%|          | 0/1 [00:00<?, ?it/s][A

  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 641.94it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 1038.80it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 12.40it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 12.78it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 12.64it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 46.95it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 46.89it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 26.63it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.49it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.76it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.68it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 19.13it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.87it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:00<00:02, 18.66it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.53it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.42it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.36it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.31it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.28it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.26it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.24it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.23it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 18.20it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.19it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.18it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.19it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.19it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.20it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.20it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.21it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.21it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 18.20it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.20it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.19it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.18it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.20it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.62it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.42it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.41it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.94it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.69it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.51it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.40it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.33it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.28it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.24it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.22it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.20it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.18it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.17it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.16it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.17it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.16it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.17it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.17it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.15it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.16it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.16it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.16it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.16it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.30it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.34it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.35it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.90it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.62it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.46it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.36it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.21it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.18it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.12it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.11it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.11it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.09it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.25it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.27it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.27it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.83it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.56it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.41it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.20it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.22it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.22it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.76it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.52it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.35it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.13it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.14it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.20it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.20it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.75it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.49it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.32it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.22it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.16it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.53it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.27it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.88it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.56it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.36it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.24it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.12it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.39it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.28it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.86it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.53it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.35it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.23it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.09it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.37it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.30it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.87it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.52it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.31it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.20it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.13it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.09it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.36it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.20it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.79it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.47it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.28it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.08it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.05it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.31it/s]
Num non-zero elements: 2304
Test accuracy for 0: 0.925
Num non-zero elements: 2304
Test accuracy for 1: 0.943
Num non-zero elements: 2304
Test accuracy for 2: 0.947
Num non-zero elements: 2304
Test accuracy for 6: 0.991
Num non-zero elements: 2304
Test accuracy for 9: 0.971
Num non-zero elements: 1
Test accuracy for 0: 0.603
Num non-zero elements: 1
Test accuracy for 1: 0.648
Num non-zero elements: 1
Test accuracy for 2: 0.731
Num non-zero elements: 1
Test accuracy for 6: 0.773
Num non-zero elements: 1
Test accuracy for 9: 0.68
Num non-zero elements: 2
Test accuracy for 0: 0.682
Num non-zero elements: 2
Test accuracy for 1: 0.655
Num non-zero elements: 2
Test accuracy for 2: 0.744
Num non-zero elements: 2
Test accuracy for 6: 0.771
Num non-zero elements: 2
Test accuracy for 9: 0.772
Num non-zero elements: 5
Test accuracy for 0: 0.768
Num non-zero elements: 5
Test accuracy for 1: 0.69
Num non-zero elements: 5
Test accuracy for 2: 0.754
Num non-zero elements: 5
Test accuracy for 6: 0.905
Num non-zero elements: 5
Test accuracy for 9: 0.798
Num non-zero elements: 10
Test accuracy for 0: 0.797
Num non-zero elements: 10
Test accuracy for 1: 0.818
Num non-zero elements: 10
Test accuracy for 2: 0.83
Num non-zero elements: 10
Test accuracy for 6: 0.929
Num non-zero elements: 10
Test accuracy for 9: 0.912
Num non-zero elements: 20
Test accuracy for 0: 0.796
Num non-zero elements: 20
Test accuracy for 1: 0.867
Num non-zero elements: 20
Test accuracy for 2: 0.847
Num non-zero elements: 20
Test accuracy for 6: 0.96
Num non-zero elements: 20
Test accuracy for 9: 0.945
Num non-zero elements: 50
Test accuracy for 0: 0.862
Num non-zero elements: 50
Test accuracy for 1: 0.905
Num non-zero elements: 50
Test accuracy for 2: 0.897
Num non-zero elements: 50
Test accuracy for 6: 0.977
Num non-zero elements: 50
Test accuracy for 9: 0.948
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for 0: 0.9470000267028809
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 17 epochs
Test accuracy for 1: 0.9610000252723694
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 24 epochs
Test accuracy for 2: 0.9390000700950623
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 24 epochs
Test accuracy for 6: 0.9920000433921814
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for 9: 0.987000048160553
Num non-zero elements: 1
Test accuracy for 0: 0.697
Num non-zero elements: 1
Test accuracy for 1: 0.812
Num non-zero elements: 1
Test accuracy for 2: 0.88
Num non-zero elements: 1
Test accuracy for 6: 0.965
Num non-zero elements: 1
Test accuracy for 9: 0.932
Num non-zero elements: 2
Test accuracy for 0: 0.707
Num non-zero elements: 2
Test accuracy for 1: 0.829
Num non-zero elements: 2
Test accuracy for 2: 0.879
Num non-zero elements: 2
Test accuracy for 6: 0.985
Num non-zero elements: 2
Test accuracy for 9: 0.934
Num non-zero elements: 5
Test accuracy for 0: 0.85
Num non-zero elements: 5
Test accuracy for 1: 0.834
Num non-zero elements: 5
Test accuracy for 2: 0.898
Num non-zero elements: 5
Test accuracy for 6: 0.982
Num non-zero elements: 5
Test accuracy for 9: 0.945
Num non-zero elements: 10
Test accuracy for 0: 0.855
Num non-zero elements: 10
Test accuracy for 1: 0.932
Num non-zero elements: 10
Test accuracy for 2: 0.904
Num non-zero elements: 10
Test accuracy for 6: 0.987
Num non-zero elements: 10
Test accuracy for 9: 0.95
Num non-zero elements: 20
Test accuracy for 0: 0.879
Num non-zero elements: 20
Test accuracy for 1: 0.951
Num non-zero elements: 20
Test accuracy for 2: 0.939
Num non-zero elements: 20
Test accuracy for 6: 0.982
Num non-zero elements: 20
Test accuracy for 9: 0.965
Num non-zero elements: 50
Test accuracy for 0: 0.933
Num non-zero elements: 50
Test accuracy for 1: 0.956
Num non-zero elements: 50
Test accuracy for 2: 0.942
Num non-zero elements: 50
Test accuracy for 6: 0.991
Num non-zero elements: 50
Test accuracy for 9: 0.964


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 628.35it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 1033.69it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 12.54it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 12.78it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 12.90it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 46.69it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 46.64it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 28.33it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.46it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.73it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.66it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 19.12it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.88it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:00<00:02, 18.67it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.52it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.43it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.36it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.31it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.27it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.25it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.23it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.22it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 18.20it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.17it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.16it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.16it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.15it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.15it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.14it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.14it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.14it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.15it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.60it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.13it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.23it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.81it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.56it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.40it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.20it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.07it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.22it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.03it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.19it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.78it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.53it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.37it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.28it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.05it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.18it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.00it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.18it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.76it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.52it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.37it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.28it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.18it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.96it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.13it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.73it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.48it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.32it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.23it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.17it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.13it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.14it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.95it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.10it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.68it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.43it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.29it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.13it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.47it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.25it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.85it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.52it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.32it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.19it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.11it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.07it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.35it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.27it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.85it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.51it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.33it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.20it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.11it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.06it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.34it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.22it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.80it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.48it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.27it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.09it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.05it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.31it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.18it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.79it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.46it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.27it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.08it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.05it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.31it/s]
Num non-zero elements: 2304
Test accuracy for 11: 0.935
Num non-zero elements: 2304
Test accuracy for 13: 0.933
Num non-zero elements: 2304
Test accuracy for 14: 0.929
Num non-zero elements: 2304
Test accuracy for 18: 0.911
Num non-zero elements: 2304
Test accuracy for 19: 0.957
Num non-zero elements: 1
Test accuracy for 11: 0.703
Num non-zero elements: 1
Test accuracy for 13: 0.709
Num non-zero elements: 1
Test accuracy for 14: 0.65
Num non-zero elements: 1
Test accuracy for 18: 0.699
Num non-zero elements: 1
Test accuracy for 19: 0.79
Num non-zero elements: 2
Test accuracy for 11: 0.779
Num non-zero elements: 2
Test accuracy for 13: 0.686
Num non-zero elements: 2
Test accuracy for 14: 0.66
Num non-zero elements: 2
Test accuracy for 18: 0.711
Num non-zero elements: 2
Test accuracy for 19: 0.8
Num non-zero elements: 5
Test accuracy for 11: 0.821
Num non-zero elements: 5
Test accuracy for 13: 0.763
Num non-zero elements: 5
Test accuracy for 14: 0.764
Num non-zero elements: 5
Test accuracy for 18: 0.723
Num non-zero elements: 5
Test accuracy for 19: 0.837
Num non-zero elements: 10
Test accuracy for 11: 0.87
Num non-zero elements: 10
Test accuracy for 13: 0.827
Num non-zero elements: 10
Test accuracy for 14: 0.79
Num non-zero elements: 10
Test accuracy for 18: 0.752
Num non-zero elements: 10
Test accuracy for 19: 0.841
Num non-zero elements: 20
Test accuracy for 11: 0.897
Num non-zero elements: 20
Test accuracy for 13: 0.874
Num non-zero elements: 20
Test accuracy for 14: 0.85
Num non-zero elements: 20
Test accuracy for 18: 0.753
Num non-zero elements: 20
Test accuracy for 19: 0.913
Num non-zero elements: 50
Test accuracy for 11: 0.92
Num non-zero elements: 50
Test accuracy for 13: 0.9
Num non-zero elements: 50
Test accuracy for 14: 0.899
Num non-zero elements: 50
Test accuracy for 18: 0.833
Num non-zero elements: 50
Test accuracy for 19: 0.922
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 17 epochs
Test accuracy for 11: 0.9570000171661377
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 26 epochs
Test accuracy for 13: 0.9510000348091125
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 24 epochs
Test accuracy for 14: 0.9430000185966492
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 23 epochs
Test accuracy for 18: 0.9220000505447388
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 27 epochs
Test accuracy for 19: 0.9590000510215759
Num non-zero elements: 1
Test accuracy for 11: 0.73
Num non-zero elements: 1
Test accuracy for 13: 0.76
Num non-zero elements: 1
Test accuracy for 14: 0.915
Num non-zero elements: 1
Test accuracy for 18: 0.714
Num non-zero elements: 1
Test accuracy for 19: 0.863
Num non-zero elements: 2
Test accuracy for 11: 0.833
Num non-zero elements: 2
Test accuracy for 13: 0.725
Num non-zero elements: 2
Test accuracy for 14: 0.919
Num non-zero elements: 2
Test accuracy for 18: 0.807
Num non-zero elements: 2
Test accuracy for 19: 0.86
Num non-zero elements: 5
Test accuracy for 11: 0.856
Num non-zero elements: 5
Test accuracy for 13: 0.8
Num non-zero elements: 5
Test accuracy for 14: 0.913
Num non-zero elements: 5
Test accuracy for 18: 0.819
Num non-zero elements: 5
Test accuracy for 19: 0.854
Num non-zero elements: 10
Test accuracy for 11: 0.931
Num non-zero elements: 10
Test accuracy for 13: 0.904
Num non-zero elements: 10
Test accuracy for 14: 0.933
Num non-zero elements: 10
Test accuracy for 18: 0.87
Num non-zero elements: 10
Test accuracy for 19: 0.869
Num non-zero elements: 20
Test accuracy for 11: 0.954
Num non-zero elements: 20
Test accuracy for 13: 0.931
Num non-zero elements: 20
Test accuracy for 14: 0.955
Num non-zero elements: 20
Test accuracy for 18: 0.867
Num non-zero elements: 20
Test accuracy for 19: 0.917
Num non-zero elements: 50
Test accuracy for 11: 0.957
Num non-zero elements: 50
Test accuracy for 13: 0.946
Num non-zero elements: 50
Test accuracy for 14: 0.955
Num non-zero elements: 50
Test accuracy for 18: 0.907
Num non-zero elements: 50
Test accuracy for 19: 0.939


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 629.34it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 1038.25it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 12.42it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00,  7.41it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00,  8.56it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 45.13it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 45.08it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 28.50it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.41it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.69it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.61it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 19.05it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.80it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:00<00:02, 18.61it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.46it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.36it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.29it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.25it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.21it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.11it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.55it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.04it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.18it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.77it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.52it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.38it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.28it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.17it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.18it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.98it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.16it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.76it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.51it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.36it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.26it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.15it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.17it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.93it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.11it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.71it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.46it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.12it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.13it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.92it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.10it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.68it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.44it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.30it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.20it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.10it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.93it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.09it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.85it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.03it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.61it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.37it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.21it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.11it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.06it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.40it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.19it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.78it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.46it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.06it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.02it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.29it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.18it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.78it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.45it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.14it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.29it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.12it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.75it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.43it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.24it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.04it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.27it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.15it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.77it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.44it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.25it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.13it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.05it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.02it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.28it/s]
Num non-zero elements: 2304
Test accuracy for 20: 0.941
Num non-zero elements: 2304
Test accuracy for 21: 0.89
Num non-zero elements: 2304
Test accuracy for 22: 0.901
Num non-zero elements: 2304
Test accuracy for 25: 0.947
Num non-zero elements: 2304
Test accuracy for 26: 0.856
Num non-zero elements: 1
Test accuracy for 20: 0.738
Num non-zero elements: 1
Test accuracy for 21: 0.601
Num non-zero elements: 1
Test accuracy for 22: 0.63
Num non-zero elements: 1
Test accuracy for 25: 0.715
Num non-zero elements: 1
Test accuracy for 26: 0.637
Num non-zero elements: 2
Test accuracy for 20: 0.786
Num non-zero elements: 2
Test accuracy for 21: 0.707
Num non-zero elements: 2
Test accuracy for 22: 0.612
Num non-zero elements: 2
Test accuracy for 25: 0.7
Num non-zero elements: 2
Test accuracy for 26: 0.67
Num non-zero elements: 5
Test accuracy for 20: 0.849
Num non-zero elements: 5
Test accuracy for 21: 0.78
Num non-zero elements: 5
Test accuracy for 22: 0.729
Num non-zero elements: 5
Test accuracy for 25: 0.788
Num non-zero elements: 5
Test accuracy for 26: 0.704
Num non-zero elements: 10
Test accuracy for 20: 0.878
Num non-zero elements: 10
Test accuracy for 21: 0.824
Num non-zero elements: 10
Test accuracy for 22: 0.752
Num non-zero elements: 10
Test accuracy for 25: 0.895
Num non-zero elements: 10
Test accuracy for 26: 0.72
Num non-zero elements: 20
Test accuracy for 20: 0.895
Num non-zero elements: 20
Test accuracy for 21: 0.839
Num non-zero elements: 20
Test accuracy for 22: 0.791
Num non-zero elements: 20
Test accuracy for 25: 0.896
Num non-zero elements: 20
Test accuracy for 26: 0.754
Num non-zero elements: 50
Test accuracy for 20: 0.902
Num non-zero elements: 50
Test accuracy for 21: 0.864
Num non-zero elements: 50
Test accuracy for 22: 0.833
Num non-zero elements: 50
Test accuracy for 25: 0.925
Num non-zero elements: 50
Test accuracy for 26: 0.824
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 21 epochs
Test accuracy for 20: 0.940000057220459
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 21: 0.9190000295639038
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for 22: 0.9040000438690186
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 25 epochs
Test accuracy for 25: 0.9650000333786011
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 26: 0.8810000419616699
Num non-zero elements: 1
Test accuracy for 20: 0.896
Num non-zero elements: 1
Test accuracy for 21: 0.764
Num non-zero elements: 1
Test accuracy for 22: 0.868
Num non-zero elements: 1
Test accuracy for 25: 0.837
Num non-zero elements: 1
Test accuracy for 26: 0.699
Num non-zero elements: 2
Test accuracy for 20: 0.905
Num non-zero elements: 2
Test accuracy for 21: 0.75
Num non-zero elements: 2
Test accuracy for 22: 0.854
Num non-zero elements: 2
Test accuracy for 25: 0.863
Num non-zero elements: 2
Test accuracy for 26: 0.809
Num non-zero elements: 5
Test accuracy for 20: 0.909
Num non-zero elements: 5
Test accuracy for 21: 0.823
Num non-zero elements: 5
Test accuracy for 22: 0.873
Num non-zero elements: 5
Test accuracy for 25: 0.891
Num non-zero elements: 5
Test accuracy for 26: 0.816
Num non-zero elements: 10
Test accuracy for 20: 0.92
Num non-zero elements: 10
Test accuracy for 21: 0.823
Num non-zero elements: 10
Test accuracy for 22: 0.865
Num non-zero elements: 10
Test accuracy for 25: 0.919
Num non-zero elements: 10
Test accuracy for 26: 0.868
Num non-zero elements: 20
Test accuracy for 20: 0.918
Num non-zero elements: 20
Test accuracy for 21: 0.852
Num non-zero elements: 20
Test accuracy for 22: 0.875
Num non-zero elements: 20
Test accuracy for 25: 0.919
Num non-zero elements: 20
Test accuracy for 26: 0.876
Num non-zero elements: 50
Test accuracy for 20: 0.939
Num non-zero elements: 50
Test accuracy for 21: 0.876
Num non-zero elements: 50
Test accuracy for 22: 0.9
Num non-zero elements: 50
Test accuracy for 25: 0.954
Num non-zero elements: 50
Test accuracy for 26: 0.853


  0%|          | 0/34 [00:00<?, ?it/s][A[A100%|██████████| 34/34 [00:00<00:00, 404.46it/s]


  0%|          | 0/31 [00:00<?, ?it/s][A[A100%|██████████| 31/31 [00:00<00:00, 868.02it/s]
Removing 31 from train set
Removing 0 from train set
Removing 29 from train set
Removing 28 from train set
Removing 7 from train set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  20%|██        | 1/5 [00:00<00:00,  9.79it/s][A[A

Tokenizing data:  60%|██████    | 3/5 [00:00<00:00, 10.08it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 10.02it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 10.01it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 38.07it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 37.74it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 28.30it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.37it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.69it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.61it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 19.07it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.83it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:00<00:02, 18.65it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.50it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.40it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.33it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.29it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.24it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.21it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.20it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.15it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.15it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.14it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.14it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.13it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.12it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.14it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.58it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.04it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.21it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.81it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.56it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.40it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.07it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.21it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.02it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.17it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.77it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.53it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.36it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.26it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.15it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.02it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.16it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.93it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.13it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.72it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.46it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.30it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.22it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.15it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.11it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.02it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.15it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.96it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.12it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.70it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.46it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.15it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.10it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.12it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.88it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.05it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.64it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.40it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.25it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.12it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.45it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.26it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.84it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.51it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.31it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.11it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.08it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.35it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.25it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.82it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.50it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.32it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.20it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.07it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.34it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.22it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.82it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.48it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.29it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.10it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.07it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.33it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.20it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.79it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.46it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.08it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.30it/s]
Num non-zero elements: 2304
Test accuracy for 1: 0.925
Num non-zero elements: 2304
Test accuracy for 2: 0.917
Num non-zero elements: 2304
Test accuracy for 3: 0.891
Num non-zero elements: 2304
Test accuracy for 5: 0.893
Num non-zero elements: 2304
Test accuracy for 6: 0.829
Num non-zero elements: 1
Test accuracy for 1: 0.702
Num non-zero elements: 1
Test accuracy for 2: 0.703
Num non-zero elements: 1
Test accuracy for 3: 0.608
Num non-zero elements: 1
Test accuracy for 5: 0.701
Num non-zero elements: 1
Test accuracy for 6: 0.623
Num non-zero elements: 2
Test accuracy for 1: 0.714
Num non-zero elements: 2
Test accuracy for 2: 0.776
Num non-zero elements: 2
Test accuracy for 3: 0.622
Num non-zero elements: 2
Test accuracy for 5: 0.715
Num non-zero elements: 2
Test accuracy for 6: 0.616
Num non-zero elements: 5
Test accuracy for 1: 0.766
Num non-zero elements: 5
Test accuracy for 2: 0.817
Num non-zero elements: 5
Test accuracy for 3: 0.631
Num non-zero elements: 5
Test accuracy for 5: 0.711
Num non-zero elements: 5
Test accuracy for 6: 0.66
Num non-zero elements: 10
Test accuracy for 1: 0.83
Num non-zero elements: 10
Test accuracy for 2: 0.83
Num non-zero elements: 10
Test accuracy for 3: 0.72
Num non-zero elements: 10
Test accuracy for 5: 0.756
Num non-zero elements: 10
Test accuracy for 6: 0.733
Num non-zero elements: 20
Test accuracy for 1: 0.835
Num non-zero elements: 20
Test accuracy for 2: 0.835
Num non-zero elements: 20
Test accuracy for 3: 0.796
Num non-zero elements: 20
Test accuracy for 5: 0.746
Num non-zero elements: 20
Test accuracy for 6: 0.729
Num non-zero elements: 50
Test accuracy for 1: 0.888
Num non-zero elements: 50
Test accuracy for 2: 0.846
Num non-zero elements: 50
Test accuracy for 3: 0.841
Num non-zero elements: 50
Test accuracy for 5: 0.823
Num non-zero elements: 50
Test accuracy for 6: 0.793
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 23 epochs
Test accuracy for 1: 0.9310000538825989
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 25 epochs
Test accuracy for 2: 0.9350000619888306
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 22 epochs
Test accuracy for 3: 0.9050000309944153
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for 5: 0.9220000505447388
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 22 epochs
Test accuracy for 6: 0.8570000529289246
Num non-zero elements: 1
Test accuracy for 1: 0.834
Num non-zero elements: 1
Test accuracy for 2: 0.838
Num non-zero elements: 1
Test accuracy for 3: 0.664
Num non-zero elements: 1
Test accuracy for 5: 0.832
Num non-zero elements: 1
Test accuracy for 6: 0.731
Num non-zero elements: 2
Test accuracy for 1: 0.848
Num non-zero elements: 2
Test accuracy for 2: 0.84
Num non-zero elements: 2
Test accuracy for 3: 0.714
Num non-zero elements: 2
Test accuracy for 5: 0.849
Num non-zero elements: 2
Test accuracy for 6: 0.747
Num non-zero elements: 5
Test accuracy for 1: 0.875
Num non-zero elements: 5
Test accuracy for 2: 0.838
Num non-zero elements: 5
Test accuracy for 3: 0.778
Num non-zero elements: 5
Test accuracy for 5: 0.863
Num non-zero elements: 5
Test accuracy for 6: 0.757
Num non-zero elements: 10
Test accuracy for 1: 0.909
Num non-zero elements: 10
Test accuracy for 2: 0.873
Num non-zero elements: 10
Test accuracy for 3: 0.851
Num non-zero elements: 10
Test accuracy for 5: 0.875
Num non-zero elements: 10
Test accuracy for 6: 0.754
Num non-zero elements: 20
Test accuracy for 1: 0.918
Num non-zero elements: 20
Test accuracy for 2: 0.891
Num non-zero elements: 20
Test accuracy for 3: 0.859
Num non-zero elements: 20
Test accuracy for 5: 0.895
Num non-zero elements: 20
Test accuracy for 6: 0.794
Num non-zero elements: 50
Test accuracy for 1: 0.931
Num non-zero elements: 50
Test accuracy for 2: 0.896
Num non-zero elements: 50
Test accuracy for 3: 0.874
Num non-zero elements: 50
Test accuracy for 5: 0.886
Num non-zero elements: 50
Test accuracy for 6: 0.809


Tokenizing data:   0%|          | 0/2 [00:00<?, ?it/s][A[A

Tokenizing data:  50%|█████     | 1/2 [00:00<00:00,  9.82it/s][A[ATokenizing data: 100%|██████████| 2/2 [00:00<00:00, 10.00it/s]


Tokenizing data:   0%|          | 0/2 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 2/2 [00:00<00:00, 37.15it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 28.00it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.38it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.67it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.61it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 19.06it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.81it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:00<00:02, 18.62it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.48it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.38it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.31it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.27it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.23it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.20it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.12it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.55it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.04it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.19it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.78it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.54it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.38it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.22it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.05it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.19it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.99it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.16it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.76it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.51it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.35it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.25it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.20it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.54it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.32it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.90it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.58it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.39it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.27it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.20it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.16it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.42it/s]
Num non-zero elements: 2304
Test accuracy for 1.0: 0.903
Num non-zero elements: 2304
Test accuracy for 5.0: 0.903
Num non-zero elements: 1
Test accuracy for 1.0: 0.631
Num non-zero elements: 1
Test accuracy for 5.0: 0.631
Num non-zero elements: 2
Test accuracy for 1.0: 0.654
Num non-zero elements: 2
Test accuracy for 5.0: 0.654
Num non-zero elements: 5
Test accuracy for 1.0: 0.669
Num non-zero elements: 5
Test accuracy for 5.0: 0.669
Num non-zero elements: 10
Test accuracy for 1.0: 0.764
Num non-zero elements: 10
Test accuracy for 5.0: 0.764
Num non-zero elements: 20
Test accuracy for 1.0: 0.792
Num non-zero elements: 20
Test accuracy for 5.0: 0.792
Num non-zero elements: 50
Test accuracy for 1.0: 0.828
Num non-zero elements: 50
Test accuracy for 5.0: 0.83
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 25 epochs
Test accuracy for 1.0: 0.9130000472068787
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 31 epochs
Test accuracy for 5.0: 0.9100000262260437
Num non-zero elements: 1
Test accuracy for 1.0: 0.7
Num non-zero elements: 1
Test accuracy for 5.0: 0.7
Num non-zero elements: 2
Test accuracy for 1.0: 0.8
Num non-zero elements: 2
Test accuracy for 5.0: 0.8
Num non-zero elements: 5
Test accuracy for 1.0: 0.87
Num non-zero elements: 5
Test accuracy for 5.0: 0.87
Num non-zero elements: 10
Test accuracy for 1.0: 0.882
Num non-zero elements: 10
Test accuracy for 5.0: 0.882
Num non-zero elements: 20
Test accuracy for 1.0: 0.892
Num non-zero elements: 20
Test accuracy for 5.0: 0.892
Num non-zero elements: 50
Test accuracy for 1.0: 0.91
Num non-zero elements: 50
Test accuracy for 5.0: 0.91
Loading dataset codeparrot/github-code, this usually takes ~30 seconds


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  20%|██        | 1/5 [00:01<00:07,  1.86s/it][A[A

Tokenizing data:  40%|████      | 2/5 [00:02<00:04,  1.40s/it][A[A

Tokenizing data:  60%|██████    | 3/5 [00:03<00:02,  1.23s/it][A[A

Tokenizing data:  80%|████████  | 4/5 [00:04<00:00,  1.07it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:05<00:00,  1.24it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:05<00:00,  1.01s/it]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  20%|██        | 1/5 [00:00<00:02,  1.74it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:01,  2.97it/s][A[A

Tokenizing data:  60%|██████    | 3/5 [00:01<00:00,  3.09it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:01<00:00,  3.86it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:01<00:00,  4.31it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:01<00:00,  3.58it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 28.13it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.19it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.53it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.47it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.07it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.78it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.56it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.41it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.30it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.22it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.46it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.93it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.09it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.69it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.45it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.30it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.20it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.11it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.13it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.95it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.12it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.70it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.45it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.30it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.09it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.96it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.11it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.88it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.06it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.65it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.41it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.26it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.09it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.05it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.92it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.92it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.91it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.06it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.80it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:03, 18.99it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.59it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.35it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.10it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.04it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.00it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.95it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.93it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.92it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.91it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.90it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.89it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.89it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.89it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.89it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.90it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.89it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.89it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.89it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.89it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.88it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.88it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.88it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.87it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.87it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.87it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.01it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.78it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.97it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.55it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.30it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.14it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.04it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.33it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.10it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.73it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.40it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.20it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.08it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.01it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.97it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.23it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.14it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.72it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.40it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.21it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.08it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.00it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.96it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.23it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.11it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.70it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.38it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.99it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.95it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.22it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.11it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.71it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.37it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.17it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.06it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.98it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.94it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.21it/s]
Num non-zero elements: 2304
Test accuracy for C: 0.955
Num non-zero elements: 2304
Test accuracy for Python: 0.985
Num non-zero elements: 2304
Test accuracy for HTML: 0.982
Num non-zero elements: 2304
Test accuracy for Java: 0.966
Num non-zero elements: 2304
Test accuracy for PHP: 0.94
Num non-zero elements: 1
Test accuracy for C: 0.613
Num non-zero elements: 1
Test accuracy for Python: 0.627
Num non-zero elements: 1
Test accuracy for HTML: 0.713
Num non-zero elements: 1
Test accuracy for Java: 0.601
Num non-zero elements: 1
Test accuracy for PHP: 0.565
Num non-zero elements: 2
Test accuracy for C: 0.723
Num non-zero elements: 2
Test accuracy for Python: 0.67
Num non-zero elements: 2
Test accuracy for HTML: 0.944
Num non-zero elements: 2
Test accuracy for Java: 0.621
Num non-zero elements: 2
Test accuracy for PHP: 0.661
Num non-zero elements: 5
Test accuracy for C: 0.821
Num non-zero elements: 5
Test accuracy for Python: 0.747
Num non-zero elements: 5
Test accuracy for HTML: 0.952
Num non-zero elements: 5
Test accuracy for Java: 0.78
Num non-zero elements: 5
Test accuracy for PHP: 0.714
Num non-zero elements: 10
Test accuracy for C: 0.831
Num non-zero elements: 10
Test accuracy for Python: 0.868
Num non-zero elements: 10
Test accuracy for HTML: 0.951
Num non-zero elements: 10
Test accuracy for Java: 0.826
Num non-zero elements: 10
Test accuracy for PHP: 0.812
Num non-zero elements: 20
Test accuracy for C: 0.864
Num non-zero elements: 20
Test accuracy for Python: 0.901
Num non-zero elements: 20
Test accuracy for HTML: 0.953
Num non-zero elements: 20
Test accuracy for Java: 0.87
Num non-zero elements: 20
Test accuracy for PHP: 0.864
Num non-zero elements: 50
Test accuracy for C: 0.912
Num non-zero elements: 50
Test accuracy for Python: 0.968
Num non-zero elements: 50
Test accuracy for HTML: 0.974
Num non-zero elements: 50
Test accuracy for Java: 0.901
Num non-zero elements: 50
Test accuracy for PHP: 0.885
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 38 epochs
Test accuracy for C: 0.9590000510215759
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 17 epochs
Test accuracy for Python: 0.9880000352859497
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 28 epochs
Test accuracy for HTML: 0.9880000352859497
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 30 epochs
Test accuracy for Java: 0.9590000510215759
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 21 epochs
Test accuracy for PHP: 0.9580000638961792
Num non-zero elements: 1
Test accuracy for C: 0.64
Num non-zero elements: 1
Test accuracy for Python: 0.76
Num non-zero elements: 1
Test accuracy for HTML: 0.94
Num non-zero elements: 1
Test accuracy for Java: 0.772
Num non-zero elements: 1
Test accuracy for PHP: 0.898
Num non-zero elements: 2
Test accuracy for C: 0.718
Num non-zero elements: 2
Test accuracy for Python: 0.792
Num non-zero elements: 2
Test accuracy for HTML: 0.95
Num non-zero elements: 2
Test accuracy for Java: 0.783
Num non-zero elements: 2
Test accuracy for PHP: 0.902
Num non-zero elements: 5
Test accuracy for C: 0.75
Num non-zero elements: 5
Test accuracy for Python: 0.852
Num non-zero elements: 5
Test accuracy for HTML: 0.951
Num non-zero elements: 5
Test accuracy for Java: 0.906
Num non-zero elements: 5
Test accuracy for PHP: 0.906
Num non-zero elements: 10
Test accuracy for C: 0.891
Num non-zero elements: 10
Test accuracy for Python: 0.885
Num non-zero elements: 10
Test accuracy for HTML: 0.958
Num non-zero elements: 10
Test accuracy for Java: 0.927
Num non-zero elements: 10
Test accuracy for PHP: 0.908
Num non-zero elements: 20
Test accuracy for C: 0.906
Num non-zero elements: 20
Test accuracy for Python: 0.957
Num non-zero elements: 20
Test accuracy for HTML: 0.959
Num non-zero elements: 20
Test accuracy for Java: 0.939
Num non-zero elements: 20
Test accuracy for PHP: 0.923
Num non-zero elements: 50
Test accuracy for C: 0.936
Num non-zero elements: 50
Test accuracy for Python: 0.984
Num non-zero elements: 50
Test accuracy for HTML: 0.972
Num non-zero elements: 50
Test accuracy for Java: 0.935
Num non-zero elements: 50
Test accuracy for PHP: 0.928


Tokenizing data:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Tokenizing data:  50%|█████     | 2/4 [00:00<00:00,  6.36it/s][A[A

Tokenizing data: 100%|██████████| 4/4 [00:00<00:00,  9.38it/s][A[ATokenizing data: 100%|██████████| 4/4 [00:00<00:00,  8.75it/s]


Tokenizing data:   0%|          | 0/4 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 4/4 [00:00<00:00, 51.99it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 28.47it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.48it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.77it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.69it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 19.15it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.91it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:00<00:02, 18.73it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.58it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.47it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.41it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.36it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.32it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.29it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.27it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.26it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 18.25it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.23it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.23it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.22it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.22it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.22it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.21it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.22it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.21it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 18.21it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.21it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.20it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.21it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.23it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.66it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.20it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.33it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.90it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.65it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.49it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.39it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.32it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.27it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.24it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.22it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.21it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.20it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.16it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.17it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.16it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.17it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.15it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.15it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.15it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.14it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.15it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.15it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.16it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.29it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.07it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.25it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.83it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.59it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.44it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.35it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.28it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.19it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.24it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.03it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.19it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.78it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.55it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.39it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.30it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.08it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.21it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.03it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.19it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.78it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.53it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.38it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.28it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.23it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.57it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.36it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.94it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.63it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.43it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.31it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.23it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.20it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.46it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.36it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.94it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.62it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.43it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.31it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.22it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.19it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.46it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.33it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.94it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.61it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.41it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.29it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.21it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.18it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.44it/s]
Num non-zero elements: 2304
Test accuracy for 0: 0.928
Num non-zero elements: 2304
Test accuracy for 1: 0.987
Num non-zero elements: 2304
Test accuracy for 2: 0.895
Num non-zero elements: 2304
Test accuracy for 3: 0.922
Num non-zero elements: 1
Test accuracy for 0: 0.764
Num non-zero elements: 1
Test accuracy for 1: 0.686
Num non-zero elements: 1
Test accuracy for 2: 0.661
Num non-zero elements: 1
Test accuracy for 3: 0.787
Num non-zero elements: 2
Test accuracy for 0: 0.802
Num non-zero elements: 2
Test accuracy for 1: 0.797
Num non-zero elements: 2
Test accuracy for 2: 0.692
Num non-zero elements: 2
Test accuracy for 3: 0.81
Num non-zero elements: 5
Test accuracy for 0: 0.881
Num non-zero elements: 5
Test accuracy for 1: 0.872
Num non-zero elements: 5
Test accuracy for 2: 0.772
Num non-zero elements: 5
Test accuracy for 3: 0.849
Num non-zero elements: 10
Test accuracy for 0: 0.884
Num non-zero elements: 10
Test accuracy for 1: 0.943
Num non-zero elements: 10
Test accuracy for 2: 0.815
Num non-zero elements: 10
Test accuracy for 3: 0.851
Num non-zero elements: 20
Test accuracy for 0: 0.893
Num non-zero elements: 20
Test accuracy for 1: 0.957
Num non-zero elements: 20
Test accuracy for 2: 0.875
Num non-zero elements: 20
Test accuracy for 3: 0.889
Num non-zero elements: 50
Test accuracy for 0: 0.907
Num non-zero elements: 50
Test accuracy for 1: 0.968
Num non-zero elements: 50
Test accuracy for 2: 0.89
Num non-zero elements: 50
Test accuracy for 3: 0.913
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 17 epochs
Test accuracy for 0: 0.9420000314712524
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 27 epochs
Test accuracy for 1: 0.984000027179718
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 14 epochs
Test accuracy for 2: 0.9170000553131104
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for 3: 0.9430000185966492
Num non-zero elements: 1
Test accuracy for 0: 0.699
Num non-zero elements: 1
Test accuracy for 1: 0.958
Num non-zero elements: 1
Test accuracy for 2: 0.818
Num non-zero elements: 1
Test accuracy for 3: 0.644
Num non-zero elements: 2
Test accuracy for 0: 0.819
Num non-zero elements: 2
Test accuracy for 1: 0.963
Num non-zero elements: 2
Test accuracy for 2: 0.832
Num non-zero elements: 2
Test accuracy for 3: 0.798
Num non-zero elements: 5
Test accuracy for 0: 0.871
Num non-zero elements: 5
Test accuracy for 1: 0.967
Num non-zero elements: 5
Test accuracy for 2: 0.848
Num non-zero elements: 5
Test accuracy for 3: 0.84
Num non-zero elements: 10
Test accuracy for 0: 0.899
Num non-zero elements: 10
Test accuracy for 1: 0.976
Num non-zero elements: 10
Test accuracy for 2: 0.858
Num non-zero elements: 10
Test accuracy for 3: 0.885
Num non-zero elements: 20
Test accuracy for 0: 0.907
Num non-zero elements: 20
Test accuracy for 1: 0.978
Num non-zero elements: 20
Test accuracy for 2: 0.873
Num non-zero elements: 20
Test accuracy for 3: 0.922
Num non-zero elements: 50
Test accuracy for 0: 0.923
Num non-zero elements: 50
Test accuracy for 1: 0.982
Num non-zero elements: 50
Test accuracy for 2: 0.9
Num non-zero elements: 50
Test accuracy for 3: 0.935
Loading dataset Helsinki-NLP/europarl, this usually takes ~10 seconds


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 14.46it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 14.85it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 14.82it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 57.25it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 28.38it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.40it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.71it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.64it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 19.10it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.86it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:00<00:02, 18.65it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.49it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.39it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.32it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.26it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.24it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.21it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.21it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.16it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.15it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.15it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.15it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.15it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.15it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 18.15it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.15it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.13it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.13it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.16it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.59it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.10it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.22it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.81it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.57it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.41it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.33it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.26it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.18it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.12it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.12it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.11it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.12it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.24it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.04it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.20it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.80it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.57it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.42it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.32it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.07it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.21it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.04it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.19it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.77it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.52it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.37it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.27it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.18it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.97it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.14it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.73it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.47it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.32it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.15it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.10it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.97it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.11it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.87it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.08it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.66it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.41it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.17it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.13it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.46it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.22it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.81it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.50it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.31it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.11it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.08it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.34it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.25it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.83it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.49it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.30it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.08it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.34it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.21it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.81it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.48it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.30it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.10it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.07it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.33it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.16it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.80it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.47it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.28it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.17it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.09it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.05it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.31it/s]
Num non-zero elements: 2304
Test accuracy for en: 0.997
Num non-zero elements: 2304
Test accuracy for fr: 0.999
Num non-zero elements: 2304
Test accuracy for de: 1.0
Num non-zero elements: 2304
Test accuracy for es: 1.0
Num non-zero elements: 2304
Test accuracy for nl: 1.0
Num non-zero elements: 1
Test accuracy for en: 0.936
Num non-zero elements: 1
Test accuracy for fr: 0.654
Num non-zero elements: 1
Test accuracy for de: 0.8
Num non-zero elements: 1
Test accuracy for es: 0.88
Num non-zero elements: 1
Test accuracy for nl: 0.861
Num non-zero elements: 2
Test accuracy for en: 0.97
Num non-zero elements: 2
Test accuracy for fr: 0.902
Num non-zero elements: 2
Test accuracy for de: 0.849
Num non-zero elements: 2
Test accuracy for es: 0.901
Num non-zero elements: 2
Test accuracy for nl: 0.882
Num non-zero elements: 5
Test accuracy for en: 0.994
Num non-zero elements: 5
Test accuracy for fr: 0.97
Num non-zero elements: 5
Test accuracy for de: 0.885
Num non-zero elements: 5
Test accuracy for es: 0.981
Num non-zero elements: 5
Test accuracy for nl: 0.935
Num non-zero elements: 10
Test accuracy for en: 0.997
Num non-zero elements: 10
Test accuracy for fr: 0.989
Num non-zero elements: 10
Test accuracy for de: 0.976
Num non-zero elements: 10
Test accuracy for es: 0.985
Num non-zero elements: 10
Test accuracy for nl: 0.971
Num non-zero elements: 20
Test accuracy for en: 0.998
Num non-zero elements: 20
Test accuracy for fr: 0.996
Num non-zero elements: 20
Test accuracy for de: 0.994
Num non-zero elements: 20
Test accuracy for es: 0.999
Num non-zero elements: 20
Test accuracy for nl: 0.981
Num non-zero elements: 50
Test accuracy for en: 0.997
Num non-zero elements: 50
Test accuracy for fr: 0.999
Num non-zero elements: 50
Test accuracy for de: 0.995
Num non-zero elements: 50
Test accuracy for es: 0.998
Num non-zero elements: 50
Test accuracy for nl: 0.992
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 11 epochs
Test accuracy for en: 0.9980000257492065
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 12 epochs
Test accuracy for fr: 1.0
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 12 epochs
Test accuracy for de: 1.0
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for es: 1.0
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for nl: 1.0
Num non-zero elements: 1
Test accuracy for en: 0.997
Num non-zero elements: 1
Test accuracy for fr: 0.865
Num non-zero elements: 1
Test accuracy for de: 0.999
Num non-zero elements: 1
Test accuracy for es: 0.893
Num non-zero elements: 1
Test accuracy for nl: 0.929
Num non-zero elements: 2
Test accuracy for en: 0.999
Num non-zero elements: 2
Test accuracy for fr: 0.997
Num non-zero elements: 2
Test accuracy for de: 0.995
Num non-zero elements: 2
Test accuracy for es: 0.921
Num non-zero elements: 2
Test accuracy for nl: 0.996
Num non-zero elements: 5
Test accuracy for en: 1.0
Num non-zero elements: 5
Test accuracy for fr: 0.997
Num non-zero elements: 5
Test accuracy for de: 0.998
Num non-zero elements: 5
Test accuracy for es: 0.995
Num non-zero elements: 5
Test accuracy for nl: 0.998
Num non-zero elements: 10
Test accuracy for en: 0.999
Num non-zero elements: 10
Test accuracy for fr: 0.995
Num non-zero elements: 10
Test accuracy for de: 1.0
Num non-zero elements: 10
Test accuracy for es: 0.997
Num non-zero elements: 10
Test accuracy for nl: 0.998
Num non-zero elements: 20
Test accuracy for en: 1.0
Num non-zero elements: 20
Test accuracy for fr: 0.996
Num non-zero elements: 20
Test accuracy for de: 1.0
Num non-zero elements: 20
Test accuracy for es: 0.997
Num non-zero elements: 20
Test accuracy for nl: 1.0
Num non-zero elements: 50
Test accuracy for en: 1.0
Num non-zero elements: 50
Test accuracy for fr: 0.996
Num non-zero elements: 50
Test accuracy for de: 0.999
Num non-zero elements: 50
Test accuracy for es: 0.999
Num non-zero elements: 50
Test accuracy for nl: 0.999

Running SAE evaluation on all selected SAEs: 100%|██████████| 1/1 [17:23<00:00, 1043.95s/it][ARunning SAE evaluation on all selected SAEs: 100%|██████████| 1/1 [17:23<00:00, 1043.95s/it]
Evaluations: 100%|██████████| 1/1 [17:36<00:00, 1056.86s/it]Evaluations: 100%|██████████| 1/1 [17:36<00:00, 1056.86s/it]
/share/u/can/SAEBench/custom_saes/topk_sae.py:110: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  pt_params = t.load(path_to_params)
Loaded config: {'trainer': {'trainer_class': 'TrainerTopKAdditivity', 'dict_class': 'AutoEncoderTopK', 'lr': 0.000282842712474619, 'steps': 48828, 'seed': 0, 'activation_dim': 2304, 'dict_size': 8192, 'k': 313, 'auxk_alpha': 0.03125, 'additivity_coeff': 1.0, 'intersection_coeff': 0.0, 'device': 'cuda:0', 'layer': 4, 'lm_name': 'google/gemma-2-2b', 'wandb_name': 'TopKTrainer_Additivity-google/gemma-2-2b-resid_post_layer_4-add_coeff-1.0-inters_coeff-0.0', 'submodule_name': 'resid_post_layer_4'}, 'buffer': {'d_submodule': 2304, 'io': 'out', 'n_ctxs': 8192, 'ctx_len': 128, 'refresh_batch_size': 32, 'out_batch_size': 2048, 'device': 'cuda:0'}}
Original keys in state_dict: odict_keys(['b_dec', 'encoder.weight', 'encoder.bias', 'decoder.weight'])
Renamed keys in state_dict: dict_keys(['b_dec', 'W_enc', 'b_enc', 'W_dec'])
Evaluations:   0%|          | 0/1 [00:00<?, ?it/s]


Running sparse_probing evaluation




Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s][A
Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:01,  1.54it/s][A
Loading checkpoint shards:  67%|██████▋   | 2/3 [00:01<00:00,  1.60it/s][A
Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.29it/s][ALoading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.04it/s]
Loaded pretrained model gemma-2-2b into HookedTransformer

Running SAE evaluation on all selected SAEs:   0%|          | 0/1 [00:00<?, ?it/s][A

  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 674.36it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 1102.68it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 12.78it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 13.14it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 13.06it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 47.81it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 47.75it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.87it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.33it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.69it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.64it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 19.10it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.87it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:00<00:02, 18.67it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.53it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.44it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.38it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.33it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.29it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.27it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.25it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.21it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 18.22it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.21it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.20it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.19it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.18it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.18it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.17it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.16it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.16it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.16it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.17it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.61it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.38it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.33it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.88it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.63it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.47it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.37it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.28it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.18it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.20it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.19it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.11it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.26it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.32it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.31it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.85it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.59it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.42it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.20it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.05it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.21it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.23it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.27it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.83it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.56it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.41it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.06it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.21it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.23it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.24it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.80it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.54it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.38it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.28it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.16it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.12it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.18it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.75it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.50it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.35it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.22it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.18it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.53it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.28it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.88it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.56it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.37it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.14it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.40it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.30it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.84it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.57it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.37it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.17it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.13it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.40it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.32it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.88it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.55it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.35it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.23it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.11it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.38it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.19it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.83it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.51it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.31it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.19it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.10it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.07it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.34it/s]
Num non-zero elements: 2304
Test accuracy for 0: 0.925
Num non-zero elements: 2304
Test accuracy for 1: 0.943
Num non-zero elements: 2304
Test accuracy for 2: 0.947
Num non-zero elements: 2304
Test accuracy for 6: 0.991
Num non-zero elements: 2304
Test accuracy for 9: 0.971
Num non-zero elements: 1
Test accuracy for 0: 0.603
Num non-zero elements: 1
Test accuracy for 1: 0.648
Num non-zero elements: 1
Test accuracy for 2: 0.731
Num non-zero elements: 1
Test accuracy for 6: 0.773
Num non-zero elements: 1
Test accuracy for 9: 0.68
Num non-zero elements: 2
Test accuracy for 0: 0.682
Num non-zero elements: 2
Test accuracy for 1: 0.655
Num non-zero elements: 2
Test accuracy for 2: 0.744
Num non-zero elements: 2
Test accuracy for 6: 0.771
Num non-zero elements: 2
Test accuracy for 9: 0.772
Num non-zero elements: 5
Test accuracy for 0: 0.768
Num non-zero elements: 5
Test accuracy for 1: 0.69
Num non-zero elements: 5
Test accuracy for 2: 0.754
Num non-zero elements: 5
Test accuracy for 6: 0.905
Num non-zero elements: 5
Test accuracy for 9: 0.798
Num non-zero elements: 10
Test accuracy for 0: 0.797
Num non-zero elements: 10
Test accuracy for 1: 0.818
Num non-zero elements: 10
Test accuracy for 2: 0.83
Num non-zero elements: 10
Test accuracy for 6: 0.929
Num non-zero elements: 10
Test accuracy for 9: 0.912
Num non-zero elements: 20
Test accuracy for 0: 0.796
Num non-zero elements: 20
Test accuracy for 1: 0.867
Num non-zero elements: 20
Test accuracy for 2: 0.847
Num non-zero elements: 20
Test accuracy for 6: 0.96
Num non-zero elements: 20
Test accuracy for 9: 0.945
Num non-zero elements: 50
Test accuracy for 0: 0.862
Num non-zero elements: 50
Test accuracy for 1: 0.905
Num non-zero elements: 50
Test accuracy for 2: 0.897
Num non-zero elements: 50
Test accuracy for 6: 0.977
Num non-zero elements: 50
Test accuracy for 9: 0.948
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 17 epochs
Test accuracy for 0: 0.9470000267028809
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 36 epochs
Test accuracy for 1: 0.9700000286102295
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 22 epochs
Test accuracy for 2: 0.9510000348091125
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for 6: 0.9930000305175781
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 22 epochs
Test accuracy for 9: 0.9830000400543213
Num non-zero elements: 1
Test accuracy for 0: 0.666
Num non-zero elements: 1
Test accuracy for 1: 0.815
Num non-zero elements: 1
Test accuracy for 2: 0.89
Num non-zero elements: 1
Test accuracy for 6: 0.968
Num non-zero elements: 1
Test accuracy for 9: 0.94
Num non-zero elements: 2
Test accuracy for 0: 0.708
Num non-zero elements: 2
Test accuracy for 1: 0.825
Num non-zero elements: 2
Test accuracy for 2: 0.896
Num non-zero elements: 2
Test accuracy for 6: 0.982
Num non-zero elements: 2
Test accuracy for 9: 0.938
Num non-zero elements: 5
Test accuracy for 0: 0.862
Num non-zero elements: 5
Test accuracy for 1: 0.829
Num non-zero elements: 5
Test accuracy for 2: 0.895
Num non-zero elements: 5
Test accuracy for 6: 0.984
Num non-zero elements: 5
Test accuracy for 9: 0.948
Num non-zero elements: 10
Test accuracy for 0: 0.852
Num non-zero elements: 10
Test accuracy for 1: 0.942
Num non-zero elements: 10
Test accuracy for 2: 0.916
Num non-zero elements: 10
Test accuracy for 6: 0.988
Num non-zero elements: 10
Test accuracy for 9: 0.961
Num non-zero elements: 20
Test accuracy for 0: 0.896
Num non-zero elements: 20
Test accuracy for 1: 0.954
Num non-zero elements: 20
Test accuracy for 2: 0.93
Num non-zero elements: 20
Test accuracy for 6: 0.987
Num non-zero elements: 20
Test accuracy for 9: 0.967
Num non-zero elements: 50
Test accuracy for 0: 0.936
Num non-zero elements: 50
Test accuracy for 1: 0.963
Num non-zero elements: 50
Test accuracy for 2: 0.945
Num non-zero elements: 50
Test accuracy for 6: 0.988
Num non-zero elements: 50
Test accuracy for 9: 0.976


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 628.80it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 1028.98it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 12.65it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 12.75it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 12.83it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 46.81it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 46.75it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.87it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.34it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.69it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.65it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 19.11it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.88it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:00<00:02, 18.69it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.54it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.44it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.37it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.32it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.29it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.27it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.26it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.23it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 18.22it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.20it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.20it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.20it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.19it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.19it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.19it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.19it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.20it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 18.18it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.17it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.16it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.16it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.18it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.62it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.12it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.26it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.84it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.60it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.45it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.35it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.28it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.19it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.25it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.05it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.21it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.79it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.55it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.39it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.20it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.07it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.21it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.99it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.17it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.77it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.53it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.37it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.27it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.05it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.19it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.00it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.17it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.75it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.51it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.36it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.26it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.15it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.17it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.95it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.12it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.71it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.47it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.32it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.22it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.16it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.50it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.27it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.88it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.55it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.36it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.25it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.17it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.13it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.39it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.25it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.85it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.53it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.35it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.22it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.14it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.12it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.38it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.30it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.86it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.53it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.34it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.23it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.37it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.29it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.85it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.51it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.32it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.21it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.13it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.36it/s]
Num non-zero elements: 2304
Test accuracy for 11: 0.945
Num non-zero elements: 2304
Test accuracy for 13: 0.943
Num non-zero elements: 2304
Test accuracy for 14: 0.946
Num non-zero elements: 2304
Test accuracy for 18: 0.917
Num non-zero elements: 2304
Test accuracy for 19: 0.958
Num non-zero elements: 1
Test accuracy for 11: 0.714
Num non-zero elements: 1
Test accuracy for 13: 0.705
Num non-zero elements: 1
Test accuracy for 14: 0.655
Num non-zero elements: 1
Test accuracy for 18: 0.703
Num non-zero elements: 1
Test accuracy for 19: 0.761
Num non-zero elements: 2
Test accuracy for 11: 0.785
Num non-zero elements: 2
Test accuracy for 13: 0.7
Num non-zero elements: 2
Test accuracy for 14: 0.678
Num non-zero elements: 2
Test accuracy for 18: 0.707
Num non-zero elements: 2
Test accuracy for 19: 0.785
Num non-zero elements: 5
Test accuracy for 11: 0.834
Num non-zero elements: 5
Test accuracy for 13: 0.791
Num non-zero elements: 5
Test accuracy for 14: 0.756
Num non-zero elements: 5
Test accuracy for 18: 0.701
Num non-zero elements: 5
Test accuracy for 19: 0.829
Num non-zero elements: 10
Test accuracy for 11: 0.869
Num non-zero elements: 10
Test accuracy for 13: 0.834
Num non-zero elements: 10
Test accuracy for 14: 0.786
Num non-zero elements: 10
Test accuracy for 18: 0.762
Num non-zero elements: 10
Test accuracy for 19: 0.846
Num non-zero elements: 20
Test accuracy for 11: 0.891
Num non-zero elements: 20
Test accuracy for 13: 0.87
Num non-zero elements: 20
Test accuracy for 14: 0.864
Num non-zero elements: 20
Test accuracy for 18: 0.766
Num non-zero elements: 20
Test accuracy for 19: 0.914
Num non-zero elements: 50
Test accuracy for 11: 0.934
Num non-zero elements: 50
Test accuracy for 13: 0.9
Num non-zero elements: 50
Test accuracy for 14: 0.901
Num non-zero elements: 50
Test accuracy for 18: 0.841
Num non-zero elements: 50
Test accuracy for 19: 0.931
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for 11: 0.9520000219345093
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 25 epochs
Test accuracy for 13: 0.9500000476837158
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 22 epochs
Test accuracy for 14: 0.9520000219345093
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 40 epochs
Test accuracy for 18: 0.9290000200271606
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 41 epochs
Test accuracy for 19: 0.9620000720024109
Num non-zero elements: 1
Test accuracy for 11: 0.725
Num non-zero elements: 1
Test accuracy for 13: 0.76
Num non-zero elements: 1
Test accuracy for 14: 0.839
Num non-zero elements: 1
Test accuracy for 18: 0.713
Num non-zero elements: 1
Test accuracy for 19: 0.857
Num non-zero elements: 2
Test accuracy for 11: 0.852
Num non-zero elements: 2
Test accuracy for 13: 0.733
Num non-zero elements: 2
Test accuracy for 14: 0.852
Num non-zero elements: 2
Test accuracy for 18: 0.871
Num non-zero elements: 2
Test accuracy for 19: 0.864
Num non-zero elements: 5
Test accuracy for 11: 0.859
Num non-zero elements: 5
Test accuracy for 13: 0.854
Num non-zero elements: 5
Test accuracy for 14: 0.917
Num non-zero elements: 5
Test accuracy for 18: 0.879
Num non-zero elements: 5
Test accuracy for 19: 0.876
Num non-zero elements: 10
Test accuracy for 11: 0.895
Num non-zero elements: 10
Test accuracy for 13: 0.921
Num non-zero elements: 10
Test accuracy for 14: 0.916
Num non-zero elements: 10
Test accuracy for 18: 0.871
Num non-zero elements: 10
Test accuracy for 19: 0.894
Num non-zero elements: 20
Test accuracy for 11: 0.947
Num non-zero elements: 20
Test accuracy for 13: 0.94
Num non-zero elements: 20
Test accuracy for 14: 0.949
Num non-zero elements: 20
Test accuracy for 18: 0.885
Num non-zero elements: 20
Test accuracy for 19: 0.918
Num non-zero elements: 50
Test accuracy for 11: 0.955
Num non-zero elements: 50
Test accuracy for 13: 0.94
Num non-zero elements: 50
Test accuracy for 14: 0.949
Num non-zero elements: 50
Test accuracy for 18: 0.9
Num non-zero elements: 50
Test accuracy for 19: 0.941


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 629.83it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 1024.41it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 12.36it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00,  7.40it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00,  8.52it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 47.93it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 47.87it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.76it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.29it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.63it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.58it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.17it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.86it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.65it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.47it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.36it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.30it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.23it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.21it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.08it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.54it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.02it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.19it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.77it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.52it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.38it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.28it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.17it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.08it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.19it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.04it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.17it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.75it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.51it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.37it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.27it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.17it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.96it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.13it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.72it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.47it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.22it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.15it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.11it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.14it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.93it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.10it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.70it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.46it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.30it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.12it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.07it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.96it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.96it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.09it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.88it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.06it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.63it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.38it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.22it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.07it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.41it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.23it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.81it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.47it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.28it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.30it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.20it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.81it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.48it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.27it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.08it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.31it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.13it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.76it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.44it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.14it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.06it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.29it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.19it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.77it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.45it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.14it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.29it/s]
Num non-zero elements: 2304
Test accuracy for 20: 0.933
Num non-zero elements: 2304
Test accuracy for 21: 0.899
Num non-zero elements: 2304
Test accuracy for 22: 0.902
Num non-zero elements: 2304
Test accuracy for 25: 0.94
Num non-zero elements: 2304
Test accuracy for 26: 0.866
Num non-zero elements: 1
Test accuracy for 20: 0.751
Num non-zero elements: 1
Test accuracy for 21: 0.638
Num non-zero elements: 1
Test accuracy for 22: 0.616
Num non-zero elements: 1
Test accuracy for 25: 0.707
Num non-zero elements: 1
Test accuracy for 26: 0.662
Num non-zero elements: 2
Test accuracy for 20: 0.804
Num non-zero elements: 2
Test accuracy for 21: 0.732
Num non-zero elements: 2
Test accuracy for 22: 0.614
Num non-zero elements: 2
Test accuracy for 25: 0.695
Num non-zero elements: 2
Test accuracy for 26: 0.674
Num non-zero elements: 5
Test accuracy for 20: 0.852
Num non-zero elements: 5
Test accuracy for 21: 0.767
Num non-zero elements: 5
Test accuracy for 22: 0.739
Num non-zero elements: 5
Test accuracy for 25: 0.793
Num non-zero elements: 5
Test accuracy for 26: 0.706
Num non-zero elements: 10
Test accuracy for 20: 0.869
Num non-zero elements: 10
Test accuracy for 21: 0.826
Num non-zero elements: 10
Test accuracy for 22: 0.746
Num non-zero elements: 10
Test accuracy for 25: 0.885
Num non-zero elements: 10
Test accuracy for 26: 0.716
Num non-zero elements: 20
Test accuracy for 20: 0.901
Num non-zero elements: 20
Test accuracy for 21: 0.84
Num non-zero elements: 20
Test accuracy for 22: 0.78
Num non-zero elements: 20
Test accuracy for 25: 0.891
Num non-zero elements: 20
Test accuracy for 26: 0.78
Num non-zero elements: 50
Test accuracy for 20: 0.904
Num non-zero elements: 50
Test accuracy for 21: 0.862
Num non-zero elements: 50
Test accuracy for 22: 0.829
Num non-zero elements: 50
Test accuracy for 25: 0.921
Num non-zero elements: 50
Test accuracy for 26: 0.819
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 38 epochs
Test accuracy for 20: 0.9500000476837158
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for 21: 0.9010000228881836
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 23 epochs
Test accuracy for 22: 0.9050000309944153
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 24 epochs
Test accuracy for 25: 0.9640000462532043
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 17 epochs
Test accuracy for 26: 0.8750000596046448
Num non-zero elements: 1
Test accuracy for 20: 0.889
Num non-zero elements: 1
Test accuracy for 21: 0.731
Num non-zero elements: 1
Test accuracy for 22: 0.803
Num non-zero elements: 1
Test accuracy for 25: 0.843
Num non-zero elements: 1
Test accuracy for 26: 0.71
Num non-zero elements: 2
Test accuracy for 20: 0.911
Num non-zero elements: 2
Test accuracy for 21: 0.8
Num non-zero elements: 2
Test accuracy for 22: 0.862
Num non-zero elements: 2
Test accuracy for 25: 0.873
Num non-zero elements: 2
Test accuracy for 26: 0.803
Num non-zero elements: 5
Test accuracy for 20: 0.909
Num non-zero elements: 5
Test accuracy for 21: 0.823
Num non-zero elements: 5
Test accuracy for 22: 0.876
Num non-zero elements: 5
Test accuracy for 25: 0.896
Num non-zero elements: 5
Test accuracy for 26: 0.822
Num non-zero elements: 10
Test accuracy for 20: 0.913
Num non-zero elements: 10
Test accuracy for 21: 0.822
Num non-zero elements: 10
Test accuracy for 22: 0.867
Num non-zero elements: 10
Test accuracy for 25: 0.923
Num non-zero elements: 10
Test accuracy for 26: 0.836
Num non-zero elements: 20
Test accuracy for 20: 0.935
Num non-zero elements: 20
Test accuracy for 21: 0.864
Num non-zero elements: 20
Test accuracy for 22: 0.871
Num non-zero elements: 20
Test accuracy for 25: 0.939
Num non-zero elements: 20
Test accuracy for 26: 0.859
Num non-zero elements: 50
Test accuracy for 20: 0.934
Num non-zero elements: 50
Test accuracy for 21: 0.891
Num non-zero elements: 50
Test accuracy for 22: 0.896
Num non-zero elements: 50
Test accuracy for 25: 0.947
Num non-zero elements: 50
Test accuracy for 26: 0.875


  0%|          | 0/34 [00:00<?, ?it/s][A[A100%|██████████| 34/34 [00:00<00:00, 405.04it/s]


  0%|          | 0/31 [00:00<?, ?it/s][A[A100%|██████████| 31/31 [00:00<00:00, 868.18it/s]
Removing 31 from train set
Removing 0 from train set
Removing 29 from train set
Removing 28 from train set
Removing 7 from train set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  20%|██        | 1/5 [00:00<00:00,  9.81it/s][A[A

Tokenizing data:  60%|██████    | 3/5 [00:00<00:00, 10.09it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 10.03it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 10.02it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 37.67it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 38.16it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 28.13it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.18it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.59it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.57it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 19.04it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.81it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:00<00:02, 18.60it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.46it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.37it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.30it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.25it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.22it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.20it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.54it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.03it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.19it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.78it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.54it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.39it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.23it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.06it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.19it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.98it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.16it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.74it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.50it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.34it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.17it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.13it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.15it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.93it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.13it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.72it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.48it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.33it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.23it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.17it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.12it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.14it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.89it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.08it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.68it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.46it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.30it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.20it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.09it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.97it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.11it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.83it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.02it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.61it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.37it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.24it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.42it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.21it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.81it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.48it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.28it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.09it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.05it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.31it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.24it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.81it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.48it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.28it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.08it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.06it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.32it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.13it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.74it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.43it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.25it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.13it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.05it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.02it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.28it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.14it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.75it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.44it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.25it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.13it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.05it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.28it/s]
Num non-zero elements: 2304
Test accuracy for 1: 0.927
Num non-zero elements: 2304
Test accuracy for 2: 0.908
Num non-zero elements: 2304
Test accuracy for 3: 0.885
Num non-zero elements: 2304
Test accuracy for 5: 0.895
Num non-zero elements: 2304
Test accuracy for 6: 0.828
Num non-zero elements: 1
Test accuracy for 1: 0.715
Num non-zero elements: 1
Test accuracy for 2: 0.705
Num non-zero elements: 1
Test accuracy for 3: 0.605
Num non-zero elements: 1
Test accuracy for 5: 0.695
Num non-zero elements: 1
Test accuracy for 6: 0.591
Num non-zero elements: 2
Test accuracy for 1: 0.725
Num non-zero elements: 2
Test accuracy for 2: 0.788
Num non-zero elements: 2
Test accuracy for 3: 0.618
Num non-zero elements: 2
Test accuracy for 5: 0.708
Num non-zero elements: 2
Test accuracy for 6: 0.635
Num non-zero elements: 5
Test accuracy for 1: 0.783
Num non-zero elements: 5
Test accuracy for 2: 0.811
Num non-zero elements: 5
Test accuracy for 3: 0.678
Num non-zero elements: 5
Test accuracy for 5: 0.699
Num non-zero elements: 5
Test accuracy for 6: 0.654
Num non-zero elements: 10
Test accuracy for 1: 0.832
Num non-zero elements: 10
Test accuracy for 2: 0.815
Num non-zero elements: 10
Test accuracy for 3: 0.721
Num non-zero elements: 10
Test accuracy for 5: 0.748
Num non-zero elements: 10
Test accuracy for 6: 0.731
Num non-zero elements: 20
Test accuracy for 1: 0.826
Num non-zero elements: 20
Test accuracy for 2: 0.838
Num non-zero elements: 20
Test accuracy for 3: 0.781
Num non-zero elements: 20
Test accuracy for 5: 0.755
Num non-zero elements: 20
Test accuracy for 6: 0.751
Num non-zero elements: 50
Test accuracy for 1: 0.897
Num non-zero elements: 50
Test accuracy for 2: 0.863
Num non-zero elements: 50
Test accuracy for 3: 0.839
Num non-zero elements: 50
Test accuracy for 5: 0.81
Num non-zero elements: 50
Test accuracy for 6: 0.771
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 26 epochs
Test accuracy for 1: 0.9360000491142273
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 23 epochs
Test accuracy for 2: 0.9250000715255737
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 25 epochs
Test accuracy for 3: 0.9080000519752502
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for 5: 0.9050000309944153
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 25 epochs
Test accuracy for 6: 0.8600000143051147
Num non-zero elements: 1
Test accuracy for 1: 0.838
Num non-zero elements: 1
Test accuracy for 2: 0.766
Num non-zero elements: 1
Test accuracy for 3: 0.585
Num non-zero elements: 1
Test accuracy for 5: 0.818
Num non-zero elements: 1
Test accuracy for 6: 0.586
Num non-zero elements: 2
Test accuracy for 1: 0.868
Num non-zero elements: 2
Test accuracy for 2: 0.791
Num non-zero elements: 2
Test accuracy for 3: 0.668
Num non-zero elements: 2
Test accuracy for 5: 0.856
Num non-zero elements: 2
Test accuracy for 6: 0.747
Num non-zero elements: 5
Test accuracy for 1: 0.878
Num non-zero elements: 5
Test accuracy for 2: 0.804
Num non-zero elements: 5
Test accuracy for 3: 0.779
Num non-zero elements: 5
Test accuracy for 5: 0.87
Num non-zero elements: 5
Test accuracy for 6: 0.761
Num non-zero elements: 10
Test accuracy for 1: 0.9
Num non-zero elements: 10
Test accuracy for 2: 0.862
Num non-zero elements: 10
Test accuracy for 3: 0.855
Num non-zero elements: 10
Test accuracy for 5: 0.881
Num non-zero elements: 10
Test accuracy for 6: 0.778
Num non-zero elements: 20
Test accuracy for 1: 0.918
Num non-zero elements: 20
Test accuracy for 2: 0.888
Num non-zero elements: 20
Test accuracy for 3: 0.879
Num non-zero elements: 20
Test accuracy for 5: 0.887
Num non-zero elements: 20
Test accuracy for 6: 0.8
Num non-zero elements: 50
Test accuracy for 1: 0.931
Num non-zero elements: 50
Test accuracy for 2: 0.892
Num non-zero elements: 50
Test accuracy for 3: 0.891
Num non-zero elements: 50
Test accuracy for 5: 0.909
Num non-zero elements: 50
Test accuracy for 6: 0.827


Tokenizing data:   0%|          | 0/2 [00:00<?, ?it/s][A[A

Tokenizing data:  50%|█████     | 1/2 [00:00<00:00,  9.65it/s][A[ATokenizing data: 100%|██████████| 2/2 [00:00<00:00, 10.01it/s]


Tokenizing data:   0%|          | 0/2 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 2/2 [00:00<00:00, 37.95it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.99it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.41it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.69it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.63it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 19.09it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.84it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:00<00:02, 18.64it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.50it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.40it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.34it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.28it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.25it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.22it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.20it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.15it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.14it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.14it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.11it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.11it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.57it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.06it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.22it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.80it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.56it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.40it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.07it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.21it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.99it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.16it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.74it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.50it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.36it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.21it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.55it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.34it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.93it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.60it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.40it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.29it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.21it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.16it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.43it/s]
Num non-zero elements: 2304
Test accuracy for 1.0: 0.903
Num non-zero elements: 2304
Test accuracy for 5.0: 0.902
Num non-zero elements: 1
Test accuracy for 1.0: 0.631
Num non-zero elements: 1
Test accuracy for 5.0: 0.631
Num non-zero elements: 2
Test accuracy for 1.0: 0.654
Num non-zero elements: 2
Test accuracy for 5.0: 0.654
Num non-zero elements: 5
Test accuracy for 1.0: 0.669
Num non-zero elements: 5
Test accuracy for 5.0: 0.669
Num non-zero elements: 10
Test accuracy for 1.0: 0.764
Num non-zero elements: 10
Test accuracy for 5.0: 0.764
Num non-zero elements: 20
Test accuracy for 1.0: 0.792
Num non-zero elements: 20
Test accuracy for 5.0: 0.792
Num non-zero elements: 50
Test accuracy for 1.0: 0.828
Num non-zero elements: 50
Test accuracy for 5.0: 0.828
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 32 epochs
Test accuracy for 1.0: 0.909000039100647
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 28 epochs
Test accuracy for 5.0: 0.9080000519752502
Num non-zero elements: 1
Test accuracy for 1.0: 0.768
Num non-zero elements: 1
Test accuracy for 5.0: 0.768
Num non-zero elements: 2
Test accuracy for 1.0: 0.747
Num non-zero elements: 2
Test accuracy for 5.0: 0.747
Num non-zero elements: 5
Test accuracy for 1.0: 0.868
Num non-zero elements: 5
Test accuracy for 5.0: 0.868
Num non-zero elements: 10
Test accuracy for 1.0: 0.876
Num non-zero elements: 10
Test accuracy for 5.0: 0.876
Num non-zero elements: 20
Test accuracy for 1.0: 0.887
Num non-zero elements: 20
Test accuracy for 5.0: 0.887
Num non-zero elements: 50
Test accuracy for 1.0: 0.901
Num non-zero elements: 50
Test accuracy for 5.0: 0.901
Loading dataset codeparrot/github-code, this usually takes ~30 seconds


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  20%|██        | 1/5 [00:01<00:07,  1.83s/it][A[A

Tokenizing data:  40%|████      | 2/5 [00:02<00:04,  1.38s/it][A[A

Tokenizing data:  60%|██████    | 3/5 [00:03<00:02,  1.21s/it][A[A

Tokenizing data:  80%|████████  | 4/5 [00:04<00:00,  1.07it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:05<00:00,  1.22it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:05<00:00,  1.00s/it]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  20%|██        | 1/5 [00:00<00:02,  1.84it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00,  3.19it/s][A[A

Tokenizing data:  60%|██████    | 3/5 [00:01<00:00,  3.20it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:01<00:00,  3.87it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:01<00:00,  3.40it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:01<00:00,  3.24it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 28.22it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.28it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.57it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.51it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.09it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.79it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.58it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.42it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.31it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.22it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.02it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.02it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.47it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.95it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.14it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.70it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.46it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.11it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.13it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.93it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.12it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.70it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.44it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.13it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.09it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.99it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.97it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.11it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.85it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.06it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.65it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.41it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.09it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.06it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.99it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.97it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.96it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.94it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.95it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.94it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.95it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.94it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.93it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.93it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.92it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.91it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.90it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.06it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.79it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:03, 18.98it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.57it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.34it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.09it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.03it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 17.98it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.92it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.93it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.92it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.91it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.90it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.89it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.88it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.89it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.88it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.87it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.88it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.88it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.88it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.88it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.88it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.88it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.86it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.87it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.87it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.86it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.88it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.00it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.75it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.93it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.54it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.29it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.14it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.03it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.97it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.32it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.12it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.74it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.40it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.21it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.08it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.01it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.97it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.24it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.12it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.72it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.39it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.20it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.08it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.99it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.96it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.23it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.11it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.70it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.38it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.99it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.95it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.22it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.10it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.70it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.37it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.06it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.99it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.95it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.21it/s]
Num non-zero elements: 2304
Test accuracy for C: 0.962
Num non-zero elements: 2304
Test accuracy for Python: 0.985
Num non-zero elements: 2304
Test accuracy for HTML: 0.987
Num non-zero elements: 2304
Test accuracy for Java: 0.959
Num non-zero elements: 2304
Test accuracy for PHP: 0.961
Num non-zero elements: 1
Test accuracy for C: 0.602
Num non-zero elements: 1
Test accuracy for Python: 0.624
Num non-zero elements: 1
Test accuracy for HTML: 0.721
Num non-zero elements: 1
Test accuracy for Java: 0.621
Num non-zero elements: 1
Test accuracy for PHP: 0.563
Num non-zero elements: 2
Test accuracy for C: 0.74
Num non-zero elements: 2
Test accuracy for Python: 0.619
Num non-zero elements: 2
Test accuracy for HTML: 0.942
Num non-zero elements: 2
Test accuracy for Java: 0.615
Num non-zero elements: 2
Test accuracy for PHP: 0.662
Num non-zero elements: 5
Test accuracy for C: 0.818
Num non-zero elements: 5
Test accuracy for Python: 0.745
Num non-zero elements: 5
Test accuracy for HTML: 0.953
Num non-zero elements: 5
Test accuracy for Java: 0.794
Num non-zero elements: 5
Test accuracy for PHP: 0.705
Num non-zero elements: 10
Test accuracy for C: 0.844
Num non-zero elements: 10
Test accuracy for Python: 0.854
Num non-zero elements: 10
Test accuracy for HTML: 0.958
Num non-zero elements: 10
Test accuracy for Java: 0.809
Num non-zero elements: 10
Test accuracy for PHP: 0.804
Num non-zero elements: 20
Test accuracy for C: 0.871
Num non-zero elements: 20
Test accuracy for Python: 0.904
Num non-zero elements: 20
Test accuracy for HTML: 0.963
Num non-zero elements: 20
Test accuracy for Java: 0.865
Num non-zero elements: 20
Test accuracy for PHP: 0.853
Num non-zero elements: 50
Test accuracy for C: 0.914
Num non-zero elements: 50
Test accuracy for Python: 0.959
Num non-zero elements: 50
Test accuracy for HTML: 0.974
Num non-zero elements: 50
Test accuracy for Java: 0.907
Num non-zero elements: 50
Test accuracy for PHP: 0.899
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 28 epochs
Test accuracy for C: 0.9530000686645508
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 17 epochs
Test accuracy for Python: 0.9860000610351562
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 24 epochs
Test accuracy for HTML: 0.9860000610351562
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for Java: 0.9620000720024109
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 52 epochs
Test accuracy for PHP: 0.9580000638961792
Num non-zero elements: 1
Test accuracy for C: 0.758
Num non-zero elements: 1
Test accuracy for Python: 0.932
Num non-zero elements: 1
Test accuracy for HTML: 0.936
Num non-zero elements: 1
Test accuracy for Java: 0.796
Num non-zero elements: 1
Test accuracy for PHP: 0.912
Num non-zero elements: 2
Test accuracy for C: 0.893
Num non-zero elements: 2
Test accuracy for Python: 0.926
Num non-zero elements: 2
Test accuracy for HTML: 0.945
Num non-zero elements: 2
Test accuracy for Java: 0.79
Num non-zero elements: 2
Test accuracy for PHP: 0.907
Num non-zero elements: 5
Test accuracy for C: 0.906
Num non-zero elements: 5
Test accuracy for Python: 0.971
Num non-zero elements: 5
Test accuracy for HTML: 0.944
Num non-zero elements: 5
Test accuracy for Java: 0.888
Num non-zero elements: 5
Test accuracy for PHP: 0.916
Num non-zero elements: 10
Test accuracy for C: 0.917
Num non-zero elements: 10
Test accuracy for Python: 0.977
Num non-zero elements: 10
Test accuracy for HTML: 0.95
Num non-zero elements: 10
Test accuracy for Java: 0.915
Num non-zero elements: 10
Test accuracy for PHP: 0.918
Num non-zero elements: 20
Test accuracy for C: 0.935
Num non-zero elements: 20
Test accuracy for Python: 0.98
Num non-zero elements: 20
Test accuracy for HTML: 0.955
Num non-zero elements: 20
Test accuracy for Java: 0.918
Num non-zero elements: 20
Test accuracy for PHP: 0.927
Num non-zero elements: 50
Test accuracy for C: 0.953
Num non-zero elements: 50
Test accuracy for Python: 0.989
Num non-zero elements: 50
Test accuracy for HTML: 0.974
Num non-zero elements: 50
Test accuracy for Java: 0.941
Num non-zero elements: 50
Test accuracy for PHP: 0.922


Tokenizing data:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Tokenizing data:  50%|█████     | 2/4 [00:00<00:00, 14.71it/s][A[A

Tokenizing data: 100%|██████████| 4/4 [00:00<00:00, 14.69it/s][A[ATokenizing data: 100%|██████████| 4/4 [00:00<00:00, 14.69it/s]


Tokenizing data:   0%|          | 0/4 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 4/4 [00:00<00:00, 51.76it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 28.53it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.50it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.80it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.73it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 19.17it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.92it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:00<00:02, 18.73it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.59it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.49it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.43it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.38it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.34it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.31it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.29it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.27it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 18.26it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.25it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.23it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.23it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.23it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.23it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.23it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.22it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.23it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 18.22it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.22it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.22it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.22it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.24it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.67it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.21it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.34it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.92it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.67it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.51it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.41it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.34it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.26it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.24it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.23it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.22it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.20it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.17it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.18it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.19it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.18it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.17it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.15it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.17it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.18it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.18it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.17it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.31it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.10it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.25it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.84it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.60it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.45it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.36it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.30it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.22it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.18it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.11it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.25it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.06it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.23it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.81it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.57it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.42it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.32it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.20it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.09it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.22it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.03it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.20it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.79it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.54it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.41it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.30it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.24it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.58it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.41it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.97it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.64it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.45it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.32it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.24it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.22it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.48it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.35it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.96it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.62it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.43it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.31it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.23it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.19it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.46it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.40it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.97it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.63it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.44it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.32it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.22it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.17it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.46it/s]
Num non-zero elements: 2304
Test accuracy for 0: 0.929
Num non-zero elements: 2304
Test accuracy for 1: 0.984
Num non-zero elements: 2304
Test accuracy for 2: 0.908
Num non-zero elements: 2304
Test accuracy for 3: 0.915
Num non-zero elements: 1
Test accuracy for 0: 0.776
Num non-zero elements: 1
Test accuracy for 1: 0.675
Num non-zero elements: 1
Test accuracy for 2: 0.65
Num non-zero elements: 1
Test accuracy for 3: 0.776
Num non-zero elements: 2
Test accuracy for 0: 0.799
Num non-zero elements: 2
Test accuracy for 1: 0.795
Num non-zero elements: 2
Test accuracy for 2: 0.695
Num non-zero elements: 2
Test accuracy for 3: 0.795
Num non-zero elements: 5
Test accuracy for 0: 0.865
Num non-zero elements: 5
Test accuracy for 1: 0.869
Num non-zero elements: 5
Test accuracy for 2: 0.774
Num non-zero elements: 5
Test accuracy for 3: 0.853
Num non-zero elements: 10
Test accuracy for 0: 0.874
Num non-zero elements: 10
Test accuracy for 1: 0.946
Num non-zero elements: 10
Test accuracy for 2: 0.802
Num non-zero elements: 10
Test accuracy for 3: 0.843
Num non-zero elements: 20
Test accuracy for 0: 0.896
Num non-zero elements: 20
Test accuracy for 1: 0.964
Num non-zero elements: 20
Test accuracy for 2: 0.863
Num non-zero elements: 20
Test accuracy for 3: 0.892
Num non-zero elements: 50
Test accuracy for 0: 0.913
Num non-zero elements: 50
Test accuracy for 1: 0.97
Num non-zero elements: 50
Test accuracy for 2: 0.865
Num non-zero elements: 50
Test accuracy for 3: 0.911
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 29 epochs
Test accuracy for 0: 0.940000057220459
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 30 epochs
Test accuracy for 1: 0.9810000658035278
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 24 epochs
Test accuracy for 2: 0.9250000715255737
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 20 epochs
Test accuracy for 3: 0.9460000395774841
Num non-zero elements: 1
Test accuracy for 0: 0.827
Num non-zero elements: 1
Test accuracy for 1: 0.956
Num non-zero elements: 1
Test accuracy for 2: 0.796
Num non-zero elements: 1
Test accuracy for 3: 0.707
Num non-zero elements: 2
Test accuracy for 0: 0.837
Num non-zero elements: 2
Test accuracy for 1: 0.965
Num non-zero elements: 2
Test accuracy for 2: 0.815
Num non-zero elements: 2
Test accuracy for 3: 0.784
Num non-zero elements: 5
Test accuracy for 0: 0.87
Num non-zero elements: 5
Test accuracy for 1: 0.967
Num non-zero elements: 5
Test accuracy for 2: 0.836
Num non-zero elements: 5
Test accuracy for 3: 0.844
Num non-zero elements: 10
Test accuracy for 0: 0.901
Num non-zero elements: 10
Test accuracy for 1: 0.972
Num non-zero elements: 10
Test accuracy for 2: 0.866
Num non-zero elements: 10
Test accuracy for 3: 0.873
Num non-zero elements: 20
Test accuracy for 0: 0.913
Num non-zero elements: 20
Test accuracy for 1: 0.974
Num non-zero elements: 20
Test accuracy for 2: 0.87
Num non-zero elements: 20
Test accuracy for 3: 0.921
Num non-zero elements: 50
Test accuracy for 0: 0.92
Num non-zero elements: 50
Test accuracy for 1: 0.981
Num non-zero elements: 50
Test accuracy for 2: 0.889
Num non-zero elements: 50
Test accuracy for 3: 0.936
Loading dataset Helsinki-NLP/europarl, this usually takes ~10 seconds


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 14.61it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 14.95it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 14.95it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 56.08it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.65it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.20it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.62it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.58it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.19it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.90it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.69it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.51it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.40it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.33it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.27it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.24it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.22it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.22it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.20it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.18it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.15it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.16it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.15it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.15it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.15it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.14it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.14it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.14it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.13it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.58it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.12it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.26it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.84it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.60it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.44it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.33it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.20it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.11it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.12it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.11it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.12it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.24it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.03it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.22it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.79it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.56it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.42it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.32it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.07it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.21it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.02it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.19it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.77it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.53it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.38it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.27it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.15it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.04it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.18it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.93it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.12it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.71it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.47it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.32it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.22it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.15it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.10it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.99it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.99it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.98it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.96it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.11it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.91it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.08it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.67it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.43it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.27it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.17it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.12it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.46it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.21it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.83it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.51it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.32it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.20it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.08it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.35it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.23it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.82it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.50it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.33it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.20it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.08it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.35it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.20it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.80it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.47it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.30it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.11it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.07it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.33it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.18it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.78it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.46it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.27it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.10it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.05it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.31it/s]
Num non-zero elements: 2304
Test accuracy for en: 1.0
Num non-zero elements: 2304
Test accuracy for fr: 1.0
Num non-zero elements: 2304
Test accuracy for de: 0.999
Num non-zero elements: 2304
Test accuracy for es: 1.0
Num non-zero elements: 2304
Test accuracy for nl: 1.0
Num non-zero elements: 1
Test accuracy for en: 0.939
Num non-zero elements: 1
Test accuracy for fr: 0.652
Num non-zero elements: 1
Test accuracy for de: 0.808
Num non-zero elements: 1
Test accuracy for es: 0.883
Num non-zero elements: 1
Test accuracy for nl: 0.853
Num non-zero elements: 2
Test accuracy for en: 0.975
Num non-zero elements: 2
Test accuracy for fr: 0.901
Num non-zero elements: 2
Test accuracy for de: 0.836
Num non-zero elements: 2
Test accuracy for es: 0.962
Num non-zero elements: 2
Test accuracy for nl: 0.885
Num non-zero elements: 5
Test accuracy for en: 0.993
Num non-zero elements: 5
Test accuracy for fr: 0.968
Num non-zero elements: 5
Test accuracy for de: 0.894
Num non-zero elements: 5
Test accuracy for es: 0.984
Num non-zero elements: 5
Test accuracy for nl: 0.956
Num non-zero elements: 10
Test accuracy for en: 0.995
Num non-zero elements: 10
Test accuracy for fr: 0.99
Num non-zero elements: 10
Test accuracy for de: 0.973
Num non-zero elements: 10
Test accuracy for es: 0.986
Num non-zero elements: 10
Test accuracy for nl: 0.971
Num non-zero elements: 20
Test accuracy for en: 0.998
Num non-zero elements: 20
Test accuracy for fr: 0.994
Num non-zero elements: 20
Test accuracy for de: 0.988
Num non-zero elements: 20
Test accuracy for es: 0.998
Num non-zero elements: 20
Test accuracy for nl: 0.981
Num non-zero elements: 50
Test accuracy for en: 0.997
Num non-zero elements: 50
Test accuracy for fr: 0.999
Num non-zero elements: 50
Test accuracy for de: 0.997
Num non-zero elements: 50
Test accuracy for es: 0.999
Num non-zero elements: 50
Test accuracy for nl: 0.996
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 12 epochs
Test accuracy for en: 0.9980000257492065
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 12 epochs
Test accuracy for fr: 0.999000072479248
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 12 epochs
Test accuracy for de: 1.0
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for es: 1.0
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for nl: 0.999000072479248
Num non-zero elements: 1
Test accuracy for en: 0.999
Num non-zero elements: 1
Test accuracy for fr: 0.867
Num non-zero elements: 1
Test accuracy for de: 0.875
Num non-zero elements: 1
Test accuracy for es: 0.893
Num non-zero elements: 1
Test accuracy for nl: 0.866
Num non-zero elements: 2
Test accuracy for en: 1.0
Num non-zero elements: 2
Test accuracy for fr: 0.996
Num non-zero elements: 2
Test accuracy for de: 0.878
Num non-zero elements: 2
Test accuracy for es: 0.921
Num non-zero elements: 2
Test accuracy for nl: 0.997
Num non-zero elements: 5
Test accuracy for en: 0.998
Num non-zero elements: 5
Test accuracy for fr: 0.997
Num non-zero elements: 5
Test accuracy for de: 0.997
Num non-zero elements: 5
Test accuracy for es: 0.995
Num non-zero elements: 5
Test accuracy for nl: 0.997
Num non-zero elements: 10
Test accuracy for en: 0.998
Num non-zero elements: 10
Test accuracy for fr: 0.998
Num non-zero elements: 10
Test accuracy for de: 0.998
Num non-zero elements: 10
Test accuracy for es: 0.997
Num non-zero elements: 10
Test accuracy for nl: 0.998
Num non-zero elements: 20
Test accuracy for en: 1.0
Num non-zero elements: 20
Test accuracy for fr: 0.998
Num non-zero elements: 20
Test accuracy for de: 1.0
Num non-zero elements: 20
Test accuracy for es: 0.997
Num non-zero elements: 20
Test accuracy for nl: 0.999
Num non-zero elements: 50
Test accuracy for en: 1.0
Num non-zero elements: 50
Test accuracy for fr: 0.997
Num non-zero elements: 50
Test accuracy for de: 1.0
Num non-zero elements: 50
Test accuracy for es: 1.0
Num non-zero elements: 50
Test accuracy for nl: 1.0

Running SAE evaluation on all selected SAEs: 100%|██████████| 1/1 [17:50<00:00, 1070.22s/it][ARunning SAE evaluation on all selected SAEs: 100%|██████████| 1/1 [17:50<00:00, 1070.22s/it]
Evaluations: 100%|██████████| 1/1 [18:02<00:00, 1082.43s/it]Evaluations: 100%|██████████| 1/1 [18:02<00:00, 1082.43s/it]
/share/u/can/SAEBench/custom_saes/topk_sae.py:110: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  pt_params = t.load(path_to_params)
Loaded config: {'trainer': {'trainer_class': 'TrainerTopKAdditivity', 'dict_class': 'AutoEncoderTopK', 'lr': 0.000282842712474619, 'steps': 48828, 'seed': 0, 'activation_dim': 2304, 'dict_size': 8192, 'k': 313, 'auxk_alpha': 0.03125, 'additivity_coeff': 1.0, 'intersection_coeff': 1.0, 'device': 'cuda:0', 'layer': 4, 'lm_name': 'google/gemma-2-2b', 'wandb_name': 'TopKTrainer_Additivity-google/gemma-2-2b-resid_post_layer_4-add_coeff-1.0-inters_coeff-1.0', 'submodule_name': 'resid_post_layer_4'}, 'buffer': {'d_submodule': 2304, 'io': 'out', 'n_ctxs': 8192, 'ctx_len': 128, 'refresh_batch_size': 32, 'out_batch_size': 2048, 'device': 'cuda:0'}}
Original keys in state_dict: odict_keys(['b_dec', 'encoder.weight', 'encoder.bias', 'decoder.weight'])
Renamed keys in state_dict: dict_keys(['b_dec', 'W_enc', 'b_enc', 'W_dec'])
Evaluations:   0%|          | 0/1 [00:00<?, ?it/s]


Running sparse_probing evaluation




Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s][A
Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:01,  1.54it/s][A
Loading checkpoint shards:  67%|██████▋   | 2/3 [00:01<00:00,  1.60it/s][A
Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.28it/s][ALoading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  2.03it/s]
Loaded pretrained model gemma-2-2b into HookedTransformer

Running SAE evaluation on all selected SAEs:   0%|          | 0/1 [00:00<?, ?it/s][A

  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 667.26it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 1102.03it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 12.89it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 13.28it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 13.16it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 47.44it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 47.38it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.62it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.39it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.71it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.65it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 19.11it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.86it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:00<00:02, 18.68it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.54it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.45it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.38it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.33it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.28it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.26it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.23it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.22it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 18.21it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.18it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.18it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.17it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.17it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.17it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.17it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 18.15it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.16it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.16it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.15it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.17it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.61it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.34it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.34it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.89it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.63it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.47it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.37it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.23it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.19it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.18it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.11it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.25it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.30it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.29it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.84it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.57it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.41it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.06it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.20it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.23it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.27it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.83it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.58it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.41it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.30it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.23it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.06it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.20it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.21it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.23it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.77it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.52it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.36it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.26it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.15it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.20it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.13it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.78it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.51it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.35it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.23it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.18it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.54it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.34it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.89it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.56it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.37it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.25it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.12it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.40it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.26it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.87it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.55it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.35it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.23it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.38it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.32it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.89it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.55it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.35it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.23it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.14it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.38it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.22it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.82it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.49it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.31it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.10it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.07it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.33it/s]
Num non-zero elements: 2304
Test accuracy for 0: 0.925
Num non-zero elements: 2304
Test accuracy for 1: 0.943
Num non-zero elements: 2304
Test accuracy for 2: 0.947
Num non-zero elements: 2304
Test accuracy for 6: 0.991
Num non-zero elements: 2304
Test accuracy for 9: 0.971
Num non-zero elements: 1
Test accuracy for 0: 0.603
Num non-zero elements: 1
Test accuracy for 1: 0.648
Num non-zero elements: 1
Test accuracy for 2: 0.731
Num non-zero elements: 1
Test accuracy for 6: 0.773
Num non-zero elements: 1
Test accuracy for 9: 0.68
Num non-zero elements: 2
Test accuracy for 0: 0.682
Num non-zero elements: 2
Test accuracy for 1: 0.655
Num non-zero elements: 2
Test accuracy for 2: 0.744
Num non-zero elements: 2
Test accuracy for 6: 0.771
Num non-zero elements: 2
Test accuracy for 9: 0.772
Num non-zero elements: 5
Test accuracy for 0: 0.768
Num non-zero elements: 5
Test accuracy for 1: 0.69
Num non-zero elements: 5
Test accuracy for 2: 0.754
Num non-zero elements: 5
Test accuracy for 6: 0.905
Num non-zero elements: 5
Test accuracy for 9: 0.798
Num non-zero elements: 10
Test accuracy for 0: 0.797
Num non-zero elements: 10
Test accuracy for 1: 0.818
Num non-zero elements: 10
Test accuracy for 2: 0.83
Num non-zero elements: 10
Test accuracy for 6: 0.929
Num non-zero elements: 10
Test accuracy for 9: 0.912
Num non-zero elements: 20
Test accuracy for 0: 0.796
Num non-zero elements: 20
Test accuracy for 1: 0.867
Num non-zero elements: 20
Test accuracy for 2: 0.847
Num non-zero elements: 20
Test accuracy for 6: 0.96
Num non-zero elements: 20
Test accuracy for 9: 0.945
Num non-zero elements: 50
Test accuracy for 0: 0.862
Num non-zero elements: 50
Test accuracy for 1: 0.905
Num non-zero elements: 50
Test accuracy for 2: 0.897
Num non-zero elements: 50
Test accuracy for 6: 0.977
Num non-zero elements: 50
Test accuracy for 9: 0.948
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 25 epochs
Test accuracy for 0: 0.9480000734329224
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 1: 0.971000075340271
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 23 epochs
Test accuracy for 2: 0.9490000605583191
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 20 epochs
Test accuracy for 6: 0.9910000562667847
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 23 epochs
Test accuracy for 9: 0.9720000624656677
Num non-zero elements: 1
Test accuracy for 0: 0.646
Num non-zero elements: 1
Test accuracy for 1: 0.85
Num non-zero elements: 1
Test accuracy for 2: 0.861
Num non-zero elements: 1
Test accuracy for 6: 0.971
Num non-zero elements: 1
Test accuracy for 9: 0.938
Num non-zero elements: 2
Test accuracy for 0: 0.657
Num non-zero elements: 2
Test accuracy for 1: 0.844
Num non-zero elements: 2
Test accuracy for 2: 0.877
Num non-zero elements: 2
Test accuracy for 6: 0.982
Num non-zero elements: 2
Test accuracy for 9: 0.938
Num non-zero elements: 5
Test accuracy for 0: 0.863
Num non-zero elements: 5
Test accuracy for 1: 0.896
Num non-zero elements: 5
Test accuracy for 2: 0.895
Num non-zero elements: 5
Test accuracy for 6: 0.986
Num non-zero elements: 5
Test accuracy for 9: 0.951
Num non-zero elements: 10
Test accuracy for 0: 0.869
Num non-zero elements: 10
Test accuracy for 1: 0.941
Num non-zero elements: 10
Test accuracy for 2: 0.906
Num non-zero elements: 10
Test accuracy for 6: 0.986
Num non-zero elements: 10
Test accuracy for 9: 0.959
Num non-zero elements: 20
Test accuracy for 0: 0.873
Num non-zero elements: 20
Test accuracy for 1: 0.948
Num non-zero elements: 20
Test accuracy for 2: 0.932
Num non-zero elements: 20
Test accuracy for 6: 0.985
Num non-zero elements: 20
Test accuracy for 9: 0.963
Num non-zero elements: 50
Test accuracy for 0: 0.923
Num non-zero elements: 50
Test accuracy for 1: 0.966
Num non-zero elements: 50
Test accuracy for 2: 0.943
Num non-zero elements: 50
Test accuracy for 6: 0.989
Num non-zero elements: 50
Test accuracy for 9: 0.972


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 649.94it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 1083.79it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 12.97it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 13.23it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 13.24it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 49.02it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 48.96it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 28.70it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.37it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.70it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.66it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 19.12it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.87it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:00<00:02, 18.69it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.55it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.46it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.38it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.34it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.31it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.28it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.26it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.24it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 18.22it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.21it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.20it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.20it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.21it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.21it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.21it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.19it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.19it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 18.18it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.18it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.18it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.18it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.19it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.63it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.12it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.26it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.84it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.60it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.44it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.35it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.27it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.20it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.19it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.12it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.12it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.11it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.11it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.25it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.08it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.22it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.80it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.57it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.42it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.20it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.06it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.21it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.02it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.18it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.77it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.54it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.38it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.28it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.07it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.20it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.02it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.17it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.76it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.52it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.35it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.26it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.20it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.15it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.17it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.98it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.10it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.70it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.46it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.32it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.22it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.18it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.51it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.27it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.86it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.53it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.35it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.23it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.13it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.38it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.30it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.88it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.55it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.35it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.23it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.13it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.39it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.28it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.87it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.56it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.35it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.23it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.12it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.39it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.26it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.86it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.54it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.33it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.20it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.13it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.37it/s]
Num non-zero elements: 2304
Test accuracy for 11: 0.947
Num non-zero elements: 2304
Test accuracy for 13: 0.942
Num non-zero elements: 2304
Test accuracy for 14: 0.938
Num non-zero elements: 2304
Test accuracy for 18: 0.913
Num non-zero elements: 2304
Test accuracy for 19: 0.953
Num non-zero elements: 1
Test accuracy for 11: 0.708
Num non-zero elements: 1
Test accuracy for 13: 0.704
Num non-zero elements: 1
Test accuracy for 14: 0.66
Num non-zero elements: 1
Test accuracy for 18: 0.696
Num non-zero elements: 1
Test accuracy for 19: 0.792
Num non-zero elements: 2
Test accuracy for 11: 0.787
Num non-zero elements: 2
Test accuracy for 13: 0.699
Num non-zero elements: 2
Test accuracy for 14: 0.673
Num non-zero elements: 2
Test accuracy for 18: 0.683
Num non-zero elements: 2
Test accuracy for 19: 0.796
Num non-zero elements: 5
Test accuracy for 11: 0.843
Num non-zero elements: 5
Test accuracy for 13: 0.758
Num non-zero elements: 5
Test accuracy for 14: 0.723
Num non-zero elements: 5
Test accuracy for 18: 0.706
Num non-zero elements: 5
Test accuracy for 19: 0.833
Num non-zero elements: 10
Test accuracy for 11: 0.863
Num non-zero elements: 10
Test accuracy for 13: 0.849
Num non-zero elements: 10
Test accuracy for 14: 0.809
Num non-zero elements: 10
Test accuracy for 18: 0.745
Num non-zero elements: 10
Test accuracy for 19: 0.847
Num non-zero elements: 20
Test accuracy for 11: 0.898
Num non-zero elements: 20
Test accuracy for 13: 0.874
Num non-zero elements: 20
Test accuracy for 14: 0.862
Num non-zero elements: 20
Test accuracy for 18: 0.767
Num non-zero elements: 20
Test accuracy for 19: 0.908
Num non-zero elements: 50
Test accuracy for 11: 0.926
Num non-zero elements: 50
Test accuracy for 13: 0.898
Num non-zero elements: 50
Test accuracy for 14: 0.896
Num non-zero elements: 50
Test accuracy for 18: 0.827
Num non-zero elements: 50
Test accuracy for 19: 0.926
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 17 epochs
Test accuracy for 11: 0.9450000524520874
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for 13: 0.9490000605583191
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 22 epochs
Test accuracy for 14: 0.9630000591278076
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 17 epochs
Test accuracy for 18: 0.9290000200271606
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for 19: 0.9590000510215759
Num non-zero elements: 1
Test accuracy for 11: 0.73
Num non-zero elements: 1
Test accuracy for 13: 0.76
Num non-zero elements: 1
Test accuracy for 14: 0.87
Num non-zero elements: 1
Test accuracy for 18: 0.719
Num non-zero elements: 1
Test accuracy for 19: 0.864
Num non-zero elements: 2
Test accuracy for 11: 0.85
Num non-zero elements: 2
Test accuracy for 13: 0.799
Num non-zero elements: 2
Test accuracy for 14: 0.872
Num non-zero elements: 2
Test accuracy for 18: 0.86
Num non-zero elements: 2
Test accuracy for 19: 0.85
Num non-zero elements: 5
Test accuracy for 11: 0.87
Num non-zero elements: 5
Test accuracy for 13: 0.845
Num non-zero elements: 5
Test accuracy for 14: 0.911
Num non-zero elements: 5
Test accuracy for 18: 0.859
Num non-zero elements: 5
Test accuracy for 19: 0.87
Num non-zero elements: 10
Test accuracy for 11: 0.942
Num non-zero elements: 10
Test accuracy for 13: 0.904
Num non-zero elements: 10
Test accuracy for 14: 0.919
Num non-zero elements: 10
Test accuracy for 18: 0.886
Num non-zero elements: 10
Test accuracy for 19: 0.925
Num non-zero elements: 20
Test accuracy for 11: 0.956
Num non-zero elements: 20
Test accuracy for 13: 0.933
Num non-zero elements: 20
Test accuracy for 14: 0.938
Num non-zero elements: 20
Test accuracy for 18: 0.887
Num non-zero elements: 20
Test accuracy for 19: 0.929
Num non-zero elements: 50
Test accuracy for 11: 0.947
Num non-zero elements: 50
Test accuracy for 13: 0.933
Num non-zero elements: 50
Test accuracy for 14: 0.954
Num non-zero elements: 50
Test accuracy for 18: 0.897
Num non-zero elements: 50
Test accuracy for 19: 0.94


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 659.19it/s]


  0%|          | 0/28 [00:00<?, ?it/s][A[A100%|██████████| 28/28 [00:00<00:00, 1078.04it/s]
Removing 24 from test set
Removing 12 from test set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 12.70it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00,  7.58it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00,  8.78it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:00<00:00, 49.09it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 49.02it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 28.74it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.23it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.59it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.56it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 19.03it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.79it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:00<00:02, 18.60it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.46it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.37it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.30it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.25it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.22it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.14it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.55it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.02it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.19it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.78it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.54it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.40it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.23it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.17it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.08it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.07it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.08it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.20it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.02it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.19it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.77it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.53it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.37it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.27it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.17it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.18it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.98it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.14it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.73it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.49it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.33it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.23it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.13it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.14it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.94it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.11it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.70it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.46it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.30it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.10it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.95it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.95it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.10it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.83it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.03it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.61it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.38it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.23it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.13it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.09it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.42it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.19it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.79it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.47it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.27it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.08it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.05it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.31it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.20it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.80it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.47it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.27it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.09it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.31it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.18it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.80it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.47it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.27it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.30it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.20it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.79it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.47it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.27it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.30it/s]
Num non-zero elements: 2304
Test accuracy for 20: 0.929
Num non-zero elements: 2304
Test accuracy for 21: 0.906
Num non-zero elements: 2304
Test accuracy for 22: 0.897
Num non-zero elements: 2304
Test accuracy for 25: 0.94
Num non-zero elements: 2304
Test accuracy for 26: 0.877
Num non-zero elements: 1
Test accuracy for 20: 0.735
Num non-zero elements: 1
Test accuracy for 21: 0.62
Num non-zero elements: 1
Test accuracy for 22: 0.627
Num non-zero elements: 1
Test accuracy for 25: 0.711
Num non-zero elements: 1
Test accuracy for 26: 0.66
Num non-zero elements: 2
Test accuracy for 20: 0.796
Num non-zero elements: 2
Test accuracy for 21: 0.716
Num non-zero elements: 2
Test accuracy for 22: 0.603
Num non-zero elements: 2
Test accuracy for 25: 0.727
Num non-zero elements: 2
Test accuracy for 26: 0.648
Num non-zero elements: 5
Test accuracy for 20: 0.844
Num non-zero elements: 5
Test accuracy for 21: 0.749
Num non-zero elements: 5
Test accuracy for 22: 0.745
Num non-zero elements: 5
Test accuracy for 25: 0.789
Num non-zero elements: 5
Test accuracy for 26: 0.703
Num non-zero elements: 10
Test accuracy for 20: 0.88
Num non-zero elements: 10
Test accuracy for 21: 0.831
Num non-zero elements: 10
Test accuracy for 22: 0.745
Num non-zero elements: 10
Test accuracy for 25: 0.882
Num non-zero elements: 10
Test accuracy for 26: 0.708
Num non-zero elements: 20
Test accuracy for 20: 0.906
Num non-zero elements: 20
Test accuracy for 21: 0.848
Num non-zero elements: 20
Test accuracy for 22: 0.795
Num non-zero elements: 20
Test accuracy for 25: 0.906
Num non-zero elements: 20
Test accuracy for 26: 0.755
Num non-zero elements: 50
Test accuracy for 20: 0.905
Num non-zero elements: 50
Test accuracy for 21: 0.863
Num non-zero elements: 50
Test accuracy for 22: 0.816
Num non-zero elements: 50
Test accuracy for 25: 0.912
Num non-zero elements: 50
Test accuracy for 26: 0.825
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 24 epochs
Test accuracy for 20: 0.9530000686645508
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 22 epochs
Test accuracy for 21: 0.9070000648498535
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 26 epochs
Test accuracy for 22: 0.921000063419342
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 25 epochs
Test accuracy for 25: 0.9600000381469727
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 17 epochs
Test accuracy for 26: 0.8910000324249268
Num non-zero elements: 1
Test accuracy for 20: 0.876
Num non-zero elements: 1
Test accuracy for 21: 0.746
Num non-zero elements: 1
Test accuracy for 22: 0.857
Num non-zero elements: 1
Test accuracy for 25: 0.845
Num non-zero elements: 1
Test accuracy for 26: 0.717
Num non-zero elements: 2
Test accuracy for 20: 0.893
Num non-zero elements: 2
Test accuracy for 21: 0.735
Num non-zero elements: 2
Test accuracy for 22: 0.867
Num non-zero elements: 2
Test accuracy for 25: 0.894
Num non-zero elements: 2
Test accuracy for 26: 0.797
Num non-zero elements: 5
Test accuracy for 20: 0.91
Num non-zero elements: 5
Test accuracy for 21: 0.827
Num non-zero elements: 5
Test accuracy for 22: 0.88
Num non-zero elements: 5
Test accuracy for 25: 0.897
Num non-zero elements: 5
Test accuracy for 26: 0.817
Num non-zero elements: 10
Test accuracy for 20: 0.916
Num non-zero elements: 10
Test accuracy for 21: 0.823
Num non-zero elements: 10
Test accuracy for 22: 0.873
Num non-zero elements: 10
Test accuracy for 25: 0.913
Num non-zero elements: 10
Test accuracy for 26: 0.81
Num non-zero elements: 20
Test accuracy for 20: 0.929
Num non-zero elements: 20
Test accuracy for 21: 0.87
Num non-zero elements: 20
Test accuracy for 22: 0.882
Num non-zero elements: 20
Test accuracy for 25: 0.938
Num non-zero elements: 20
Test accuracy for 26: 0.857
Num non-zero elements: 50
Test accuracy for 20: 0.935
Num non-zero elements: 50
Test accuracy for 21: 0.884
Num non-zero elements: 50
Test accuracy for 22: 0.883
Num non-zero elements: 50
Test accuracy for 25: 0.948
Num non-zero elements: 50
Test accuracy for 26: 0.868


  0%|          | 0/34 [00:00<?, ?it/s][A[A100%|██████████| 34/34 [00:00<00:00, 405.05it/s]


  0%|          | 0/31 [00:00<?, ?it/s][A[A100%|██████████| 31/31 [00:00<00:00, 883.85it/s]
Removing 31 from train set
Removing 0 from train set
Removing 29 from train set
Removing 28 from train set
Removing 7 from train set


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 10.01it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 10.05it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 10.06it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 38.79it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 38.60it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 26.44it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 22.97it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.50it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.51it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.13it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.84it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.63it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.45it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.35it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.28it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.23it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.20it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.51it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.00it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.19it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.77it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.53it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.39it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.15it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.05it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.19it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.97it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.12it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.72it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.48it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.33it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.23it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.05it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.05it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.05it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.17it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.97it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.13it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.72it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.49it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.34it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.24it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.17it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.12it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.13it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.91it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.09it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.68it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.44it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.20it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.13it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.09it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.00it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.97it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.96it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.95it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.95it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.09it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.87it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.02it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.61it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.37it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.22it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.07it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.40it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.18it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.81it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.45it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.15it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.04it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.30it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.19it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.78it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.46it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.27it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.14it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.29it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.19it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.78it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.45it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.14it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.06it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.02it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.29it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.21it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.77it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.43it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.24it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.04it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.01it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.28it/s]
Num non-zero elements: 2304
Test accuracy for 1: 0.93
Num non-zero elements: 2304
Test accuracy for 2: 0.911
Num non-zero elements: 2304
Test accuracy for 3: 0.894
Num non-zero elements: 2304
Test accuracy for 5: 0.877
Num non-zero elements: 2304
Test accuracy for 6: 0.828
Num non-zero elements: 1
Test accuracy for 1: 0.704
Num non-zero elements: 1
Test accuracy for 2: 0.717
Num non-zero elements: 1
Test accuracy for 3: 0.608
Num non-zero elements: 1
Test accuracy for 5: 0.689
Num non-zero elements: 1
Test accuracy for 6: 0.586
Num non-zero elements: 2
Test accuracy for 1: 0.708
Num non-zero elements: 2
Test accuracy for 2: 0.791
Num non-zero elements: 2
Test accuracy for 3: 0.599
Num non-zero elements: 2
Test accuracy for 5: 0.678
Num non-zero elements: 2
Test accuracy for 6: 0.625
Num non-zero elements: 5
Test accuracy for 1: 0.791
Num non-zero elements: 5
Test accuracy for 2: 0.809
Num non-zero elements: 5
Test accuracy for 3: 0.64
Num non-zero elements: 5
Test accuracy for 5: 0.709
Num non-zero elements: 5
Test accuracy for 6: 0.683
Num non-zero elements: 10
Test accuracy for 1: 0.806
Num non-zero elements: 10
Test accuracy for 2: 0.82
Num non-zero elements: 10
Test accuracy for 3: 0.724
Num non-zero elements: 10
Test accuracy for 5: 0.75
Num non-zero elements: 10
Test accuracy for 6: 0.734
Num non-zero elements: 20
Test accuracy for 1: 0.831
Num non-zero elements: 20
Test accuracy for 2: 0.831
Num non-zero elements: 20
Test accuracy for 3: 0.775
Num non-zero elements: 20
Test accuracy for 5: 0.75
Num non-zero elements: 20
Test accuracy for 6: 0.754
Num non-zero elements: 50
Test accuracy for 1: 0.877
Num non-zero elements: 50
Test accuracy for 2: 0.871
Num non-zero elements: 50
Test accuracy for 3: 0.848
Num non-zero elements: 50
Test accuracy for 5: 0.802
Num non-zero elements: 50
Test accuracy for 6: 0.784
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 37 epochs
Test accuracy for 1: 0.940000057220459
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 29 epochs
Test accuracy for 2: 0.9320000410079956
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 28 epochs
Test accuracy for 3: 0.9140000343322754
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 26 epochs
Test accuracy for 5: 0.9100000262260437
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 20 epochs
Test accuracy for 6: 0.843000054359436
Num non-zero elements: 1
Test accuracy for 1: 0.843
Num non-zero elements: 1
Test accuracy for 2: 0.797
Num non-zero elements: 1
Test accuracy for 3: 0.703
Num non-zero elements: 1
Test accuracy for 5: 0.842
Num non-zero elements: 1
Test accuracy for 6: 0.624
Num non-zero elements: 2
Test accuracy for 1: 0.845
Num non-zero elements: 2
Test accuracy for 2: 0.798
Num non-zero elements: 2
Test accuracy for 3: 0.784
Num non-zero elements: 2
Test accuracy for 5: 0.863
Num non-zero elements: 2
Test accuracy for 6: 0.732
Num non-zero elements: 5
Test accuracy for 1: 0.877
Num non-zero elements: 5
Test accuracy for 2: 0.82
Num non-zero elements: 5
Test accuracy for 3: 0.791
Num non-zero elements: 5
Test accuracy for 5: 0.868
Num non-zero elements: 5
Test accuracy for 6: 0.762
Num non-zero elements: 10
Test accuracy for 1: 0.907
Num non-zero elements: 10
Test accuracy for 2: 0.852
Num non-zero elements: 10
Test accuracy for 3: 0.858
Num non-zero elements: 10
Test accuracy for 5: 0.884
Num non-zero elements: 10
Test accuracy for 6: 0.787
Num non-zero elements: 20
Test accuracy for 1: 0.901
Num non-zero elements: 20
Test accuracy for 2: 0.87
Num non-zero elements: 20
Test accuracy for 3: 0.866
Num non-zero elements: 20
Test accuracy for 5: 0.887
Num non-zero elements: 20
Test accuracy for 6: 0.799
Num non-zero elements: 50
Test accuracy for 1: 0.934
Num non-zero elements: 50
Test accuracy for 2: 0.89
Num non-zero elements: 50
Test accuracy for 3: 0.884
Num non-zero elements: 50
Test accuracy for 5: 0.908
Num non-zero elements: 50
Test accuracy for 6: 0.833


Tokenizing data:   0%|          | 0/2 [00:00<?, ?it/s][A[A

Tokenizing data:  50%|█████     | 1/2 [00:00<00:00,  9.62it/s][A[ATokenizing data: 100%|██████████| 2/2 [00:00<00:00,  9.81it/s]


Tokenizing data:   0%|          | 0/2 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 2/2 [00:00<00:00, 36.51it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 27.26it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.18it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.60it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.57it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.17it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.89it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.67it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.50it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.39it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.32it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.28it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.25it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.23it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.15it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.15it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.15it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.16it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.15it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.15it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.12it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.12it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.13it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.11it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.56it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.05it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.22it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.81it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.57it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.43it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.33it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.20it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.10it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.09it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.09it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.09it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.08it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.09it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.22it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.01it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.19it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.78it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.52it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.36it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.27it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.21it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.56it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.35it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.97it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.64it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.45it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.32it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.22it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.18it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.46it/s]
Num non-zero elements: 2304
Test accuracy for 1.0: 0.902
Num non-zero elements: 2304
Test accuracy for 5.0: 0.902
Num non-zero elements: 1
Test accuracy for 1.0: 0.631
Num non-zero elements: 1
Test accuracy for 5.0: 0.631
Num non-zero elements: 2
Test accuracy for 1.0: 0.654
Num non-zero elements: 2
Test accuracy for 5.0: 0.654
Num non-zero elements: 5
Test accuracy for 1.0: 0.669
Num non-zero elements: 5
Test accuracy for 5.0: 0.669
Num non-zero elements: 10
Test accuracy for 1.0: 0.764
Num non-zero elements: 10
Test accuracy for 5.0: 0.764
Num non-zero elements: 20
Test accuracy for 1.0: 0.792
Num non-zero elements: 20
Test accuracy for 5.0: 0.791
Num non-zero elements: 50
Test accuracy for 1.0: 0.829
Num non-zero elements: 50
Test accuracy for 5.0: 0.829
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 22 epochs
Test accuracy for 1.0: 0.9020000696182251
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 27 epochs
Test accuracy for 5.0: 0.9050000309944153
Num non-zero elements: 1
Test accuracy for 1.0: 0.78
Num non-zero elements: 1
Test accuracy for 5.0: 0.78
Num non-zero elements: 2
Test accuracy for 1.0: 0.803
Num non-zero elements: 2
Test accuracy for 5.0: 0.803
Num non-zero elements: 5
Test accuracy for 1.0: 0.829
Num non-zero elements: 5
Test accuracy for 5.0: 0.829
Num non-zero elements: 10
Test accuracy for 1.0: 0.892
Num non-zero elements: 10
Test accuracy for 5.0: 0.892
Num non-zero elements: 20
Test accuracy for 1.0: 0.895
Num non-zero elements: 20
Test accuracy for 5.0: 0.895
Num non-zero elements: 50
Test accuracy for 1.0: 0.898
Num non-zero elements: 50
Test accuracy for 5.0: 0.898
Loading dataset codeparrot/github-code, this usually takes ~30 seconds


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  20%|██        | 1/5 [00:01<00:07,  1.90s/it][A[A

Tokenizing data:  40%|████      | 2/5 [00:02<00:04,  1.35s/it][A[A

Tokenizing data:  60%|██████    | 3/5 [00:03<00:02,  1.20s/it][A[A

Tokenizing data:  80%|████████  | 4/5 [00:04<00:00,  1.07it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:05<00:00,  1.21it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:05<00:00,  1.01s/it]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  20%|██        | 1/5 [00:00<00:02,  1.85it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00,  3.15it/s][A[A

Tokenizing data:  60%|██████    | 3/5 [00:01<00:00,  3.23it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:01<00:00,  3.93it/s][A[A

Tokenizing data: 100%|██████████| 5/5 [00:01<00:00,  4.36it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:01<00:00,  3.68it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 28.44it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.27it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.59it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.52it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.11it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.80it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.59it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.40it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.30it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.22it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.07it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.06it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.06it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.06it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.06it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.05it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.49it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.97it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.16it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.74it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.50it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.35it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.14it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.10it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.09it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.08it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.06it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.05it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.04it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.03it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.03it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.02it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.03it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.02it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.01it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.00it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.15it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.93it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.11it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.70it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.45it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.30it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.21it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.13it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.08it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.02it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.00it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.99it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.98it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.97it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.98it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.98it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.97it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.97it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.96it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.97it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.10it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.89it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.03it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.62it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.38it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.23it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.13it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.07it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.02it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.01it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.98it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.96it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.94it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.93it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.92it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.93it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.92it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.91it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.90it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.90it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.91it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.91it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.91it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.04it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.80it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:03, 19.00it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.58it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.34it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.19it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.10it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.04it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.00it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 17.95it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 17.93it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 17.92it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 17.90it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 17.90it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 17.90it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 17.89it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 17.89it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 17.89it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 17.89it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 17.88it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 17.88it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 17.88it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 17.88it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 17.88it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 17.87it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 17.88it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 17.87it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 17.87it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.86it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.00it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.75it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.94it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.53it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.29it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.16it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.05it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.33it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.10it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.73it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.38it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.19it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.00it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.96it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.23it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.11it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.71it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.38it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.19it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.07it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.00it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.96it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.22it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.09it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.67it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.36it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.17it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.05it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.97it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.94it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.20it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.12it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.69it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.36it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.17it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.05it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 17.98it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 17.94it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.20it/s]
Num non-zero elements: 2304
Test accuracy for C: 0.957
Num non-zero elements: 2304
Test accuracy for Python: 0.984
Num non-zero elements: 2304
Test accuracy for HTML: 0.979
Num non-zero elements: 2304
Test accuracy for Java: 0.955
Num non-zero elements: 2304
Test accuracy for PHP: 0.954
Num non-zero elements: 1
Test accuracy for C: 0.609
Num non-zero elements: 1
Test accuracy for Python: 0.607
Num non-zero elements: 1
Test accuracy for HTML: 0.715
Num non-zero elements: 1
Test accuracy for Java: 0.608
Num non-zero elements: 1
Test accuracy for PHP: 0.573
Num non-zero elements: 2
Test accuracy for C: 0.744
Num non-zero elements: 2
Test accuracy for Python: 0.679
Num non-zero elements: 2
Test accuracy for HTML: 0.936
Num non-zero elements: 2
Test accuracy for Java: 0.623
Num non-zero elements: 2
Test accuracy for PHP: 0.633
Num non-zero elements: 5
Test accuracy for C: 0.798
Num non-zero elements: 5
Test accuracy for Python: 0.751
Num non-zero elements: 5
Test accuracy for HTML: 0.949
Num non-zero elements: 5
Test accuracy for Java: 0.778
Num non-zero elements: 5
Test accuracy for PHP: 0.723
Num non-zero elements: 10
Test accuracy for C: 0.829
Num non-zero elements: 10
Test accuracy for Python: 0.868
Num non-zero elements: 10
Test accuracy for HTML: 0.957
Num non-zero elements: 10
Test accuracy for Java: 0.83
Num non-zero elements: 10
Test accuracy for PHP: 0.813
Num non-zero elements: 20
Test accuracy for C: 0.865
Num non-zero elements: 20
Test accuracy for Python: 0.91
Num non-zero elements: 20
Test accuracy for HTML: 0.961
Num non-zero elements: 20
Test accuracy for Java: 0.858
Num non-zero elements: 20
Test accuracy for PHP: 0.85
Num non-zero elements: 50
Test accuracy for C: 0.907
Num non-zero elements: 50
Test accuracy for Python: 0.973
Num non-zero elements: 50
Test accuracy for HTML: 0.967
Num non-zero elements: 50
Test accuracy for Java: 0.918
Num non-zero elements: 50
Test accuracy for PHP: 0.896
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 21 epochs
Test accuracy for C: 0.9520000219345093
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 22 epochs
Test accuracy for Python: 0.9900000691413879
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 45 epochs
Test accuracy for HTML: 0.9900000691413879
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 45 epochs
Test accuracy for Java: 0.971000075340271
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for PHP: 0.9570000171661377
Num non-zero elements: 1
Test accuracy for C: 0.643
Num non-zero elements: 1
Test accuracy for Python: 0.939
Num non-zero elements: 1
Test accuracy for HTML: 0.884
Num non-zero elements: 1
Test accuracy for Java: 0.795
Num non-zero elements: 1
Test accuracy for PHP: 0.903
Num non-zero elements: 2
Test accuracy for C: 0.644
Num non-zero elements: 2
Test accuracy for Python: 0.935
Num non-zero elements: 2
Test accuracy for HTML: 0.95
Num non-zero elements: 2
Test accuracy for Java: 0.788
Num non-zero elements: 2
Test accuracy for PHP: 0.906
Num non-zero elements: 5
Test accuracy for C: 0.863
Num non-zero elements: 5
Test accuracy for Python: 0.969
Num non-zero elements: 5
Test accuracy for HTML: 0.952
Num non-zero elements: 5
Test accuracy for Java: 0.873
Num non-zero elements: 5
Test accuracy for PHP: 0.911
Num non-zero elements: 10
Test accuracy for C: 0.923
Num non-zero elements: 10
Test accuracy for Python: 0.98
Num non-zero elements: 10
Test accuracy for HTML: 0.958
Num non-zero elements: 10
Test accuracy for Java: 0.924
Num non-zero elements: 10
Test accuracy for PHP: 0.915
Num non-zero elements: 20
Test accuracy for C: 0.938
Num non-zero elements: 20
Test accuracy for Python: 0.981
Num non-zero elements: 20
Test accuracy for HTML: 0.954
Num non-zero elements: 20
Test accuracy for Java: 0.936
Num non-zero elements: 20
Test accuracy for PHP: 0.931
Num non-zero elements: 50
Test accuracy for C: 0.947
Num non-zero elements: 50
Test accuracy for Python: 0.986
Num non-zero elements: 50
Test accuracy for HTML: 0.957
Num non-zero elements: 50
Test accuracy for Java: 0.943
Num non-zero elements: 50
Test accuracy for PHP: 0.933


Tokenizing data:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Tokenizing data:  50%|█████     | 2/4 [00:00<00:00,  6.27it/s][A[A

Tokenizing data: 100%|██████████| 4/4 [00:00<00:00,  9.34it/s][A[ATokenizing data: 100%|██████████| 4/4 [00:00<00:00,  8.70it/s]


Tokenizing data:   0%|          | 0/4 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 4/4 [00:00<00:00, 51.18it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 28.03it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.40it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.74it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.69it/s][A[A

Collecting activations:  24%|██▍       | 15/63 [00:00<00:02, 19.15it/s][A[A

Collecting activations:  27%|██▋       | 17/63 [00:00<00:02, 18.92it/s][A[A

Collecting activations:  30%|███       | 19/63 [00:00<00:02, 18.70it/s][A[A

Collecting activations:  33%|███▎      | 21/63 [00:01<00:02, 18.56it/s][A[A

Collecting activations:  37%|███▋      | 23/63 [00:01<00:02, 18.46it/s][A[A

Collecting activations:  40%|███▉      | 25/63 [00:01<00:02, 18.39it/s][A[A

Collecting activations:  43%|████▎     | 27/63 [00:01<00:01, 18.35it/s][A[A

Collecting activations:  46%|████▌     | 29/63 [00:01<00:01, 18.32it/s][A[A

Collecting activations:  49%|████▉     | 31/63 [00:01<00:01, 18.30it/s][A[A

Collecting activations:  52%|█████▏    | 33/63 [00:01<00:01, 18.28it/s][A[A

Collecting activations:  56%|█████▌    | 35/63 [00:01<00:01, 18.27it/s][A[A

Collecting activations:  59%|█████▊    | 37/63 [00:01<00:01, 18.24it/s][A[A

Collecting activations:  62%|██████▏   | 39/63 [00:02<00:01, 18.23it/s][A[A

Collecting activations:  65%|██████▌   | 41/63 [00:02<00:01, 18.22it/s][A[A

Collecting activations:  68%|██████▊   | 43/63 [00:02<00:01, 18.21it/s][A[A

Collecting activations:  71%|███████▏  | 45/63 [00:02<00:00, 18.21it/s][A[A

Collecting activations:  75%|███████▍  | 47/63 [00:02<00:00, 18.21it/s][A[A

Collecting activations:  78%|███████▊  | 49/63 [00:02<00:00, 18.21it/s][A[A

Collecting activations:  81%|████████  | 51/63 [00:02<00:00, 18.20it/s][A[A

Collecting activations:  84%|████████▍ | 53/63 [00:02<00:00, 18.21it/s][A[A

Collecting activations:  87%|████████▋ | 55/63 [00:02<00:00, 18.20it/s][A[A

Collecting activations:  90%|█████████ | 57/63 [00:03<00:00, 18.20it/s][A[A

Collecting activations:  94%|█████████▎| 59/63 [00:03<00:00, 18.19it/s][A[A

Collecting activations:  97%|█████████▋| 61/63 [00:03<00:00, 18.19it/s][A[A

Collecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.20it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.65it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.16it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.30it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.89it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.65it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.50it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.40it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.33it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.28it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.24it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.21it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.21it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.21it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.18it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.16it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.16it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.16it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.17it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.17it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.15it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.15it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.14it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.15it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.15it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.29it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.12it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.28it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.85it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.60it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.45it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.34it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.27it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.23it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.20it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.18it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.12it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.12it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.11it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.25it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.08it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.24it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.83it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.59it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.45it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.35it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.28it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.23it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.20it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.18it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.15it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.13it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.13it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.12it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.12it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.12it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.25it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 21.06it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.22it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.81it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.57it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.42it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.30it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.24it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.59it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.42it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.99it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.66it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.46it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.33it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.26it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.21it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.49it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.34it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.96it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.64it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.46it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.33it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.25it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.20it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.47it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.39it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.94it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.62it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.44it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.32it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.25it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.20it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.47it/s]
Num non-zero elements: 2304
Test accuracy for 0: 0.931
Num non-zero elements: 2304
Test accuracy for 1: 0.98
Num non-zero elements: 2304
Test accuracy for 2: 0.899
Num non-zero elements: 2304
Test accuracy for 3: 0.924
Num non-zero elements: 1
Test accuracy for 0: 0.776
Num non-zero elements: 1
Test accuracy for 1: 0.675
Num non-zero elements: 1
Test accuracy for 2: 0.661
Num non-zero elements: 1
Test accuracy for 3: 0.788
Num non-zero elements: 2
Test accuracy for 0: 0.79
Num non-zero elements: 2
Test accuracy for 1: 0.795
Num non-zero elements: 2
Test accuracy for 2: 0.692
Num non-zero elements: 2
Test accuracy for 3: 0.797
Num non-zero elements: 5
Test accuracy for 0: 0.876
Num non-zero elements: 5
Test accuracy for 1: 0.873
Num non-zero elements: 5
Test accuracy for 2: 0.781
Num non-zero elements: 5
Test accuracy for 3: 0.85
Num non-zero elements: 10
Test accuracy for 0: 0.882
Num non-zero elements: 10
Test accuracy for 1: 0.942
Num non-zero elements: 10
Test accuracy for 2: 0.809
Num non-zero elements: 10
Test accuracy for 3: 0.843
Num non-zero elements: 20
Test accuracy for 0: 0.892
Num non-zero elements: 20
Test accuracy for 1: 0.962
Num non-zero elements: 20
Test accuracy for 2: 0.87
Num non-zero elements: 20
Test accuracy for 3: 0.891
Num non-zero elements: 50
Test accuracy for 0: 0.911
Num non-zero elements: 50
Test accuracy for 1: 0.969
Num non-zero elements: 50
Test accuracy for 2: 0.875
Num non-zero elements: 50
Test accuracy for 3: 0.905
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 22 epochs
Test accuracy for 0: 0.9340000152587891
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 21 epochs
Test accuracy for 1: 0.9830000400543213
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 2: 0.9220000505447388
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 20 epochs
Test accuracy for 3: 0.9520000219345093
Num non-zero elements: 1
Test accuracy for 0: 0.76
Num non-zero elements: 1
Test accuracy for 1: 0.957
Num non-zero elements: 1
Test accuracy for 2: 0.799
Num non-zero elements: 1
Test accuracy for 3: 0.638
Num non-zero elements: 2
Test accuracy for 0: 0.782
Num non-zero elements: 2
Test accuracy for 1: 0.959
Num non-zero elements: 2
Test accuracy for 2: 0.84
Num non-zero elements: 2
Test accuracy for 3: 0.787
Num non-zero elements: 5
Test accuracy for 0: 0.869
Num non-zero elements: 5
Test accuracy for 1: 0.969
Num non-zero elements: 5
Test accuracy for 2: 0.854
Num non-zero elements: 5
Test accuracy for 3: 0.853
Num non-zero elements: 10
Test accuracy for 0: 0.904
Num non-zero elements: 10
Test accuracy for 1: 0.977
Num non-zero elements: 10
Test accuracy for 2: 0.852
Num non-zero elements: 10
Test accuracy for 3: 0.882
Num non-zero elements: 20
Test accuracy for 0: 0.908
Num non-zero elements: 20
Test accuracy for 1: 0.974
Num non-zero elements: 20
Test accuracy for 2: 0.865
Num non-zero elements: 20
Test accuracy for 3: 0.896
Num non-zero elements: 50
Test accuracy for 0: 0.914
Num non-zero elements: 50
Test accuracy for 1: 0.978
Num non-zero elements: 50
Test accuracy for 2: 0.901
Num non-zero elements: 50
Test accuracy for 3: 0.944
Loading dataset Helsinki-NLP/europarl, this usually takes ~10 seconds


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Tokenizing data:  40%|████      | 2/5 [00:00<00:00, 14.67it/s][A[A

Tokenizing data:  80%|████████  | 4/5 [00:00<00:00, 14.83it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 14.85it/s]


Tokenizing data:   0%|          | 0/5 [00:00<?, ?it/s][A[ATokenizing data: 100%|██████████| 5/5 [00:00<00:00, 55.06it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 26.68it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 23.00it/s][A[A

Collecting activations:  14%|█▍        | 9/63 [00:00<00:02, 20.53it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 19.55it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 19.17it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.89it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.68it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.50it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.41it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.34it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.29it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.27it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.23it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.22it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.21it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.19it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.18it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.18it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.18it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.18it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.17it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.17it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.16it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.16it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.16it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.16it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.15it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.57it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.13it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.24it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.83it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.60it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.44it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.35it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.28it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.25it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.22it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.19it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.18it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.17it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.16it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.14it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.15it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.15it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.14it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.15it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.15it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.14it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.14it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.14it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.14it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.14it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.27it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.08it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.25it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.83it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.59it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.44it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.34it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.27it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.23it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.20it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.17it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.16it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.15it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.14it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.13it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.12it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.12it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.11it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.10it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.11it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.11it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.10it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.09it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.24it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 21.03it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.21it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.79it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.56it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.39it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.29it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.23it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.18it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.14it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.13it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.12it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.11it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.11it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.10it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.09it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.08it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.08it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.07it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.07it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.05it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.04it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.04it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.03it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 18.03it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.19it/s]


Collecting activations:   0%|          | 0/63 [00:00<?, ?it/s][A[A

Collecting activations:   5%|▍         | 3/63 [00:00<00:02, 20.93it/s][A[A

Collecting activations:  10%|▉         | 6/63 [00:00<00:02, 19.11it/s][A[A

Collecting activations:  13%|█▎        | 8/63 [00:00<00:02, 18.70it/s][A[A

Collecting activations:  16%|█▌        | 10/63 [00:00<00:02, 18.47it/s][A[A

Collecting activations:  19%|█▉        | 12/63 [00:00<00:02, 18.31it/s][A[A

Collecting activations:  22%|██▏       | 14/63 [00:00<00:02, 18.22it/s][A[A

Collecting activations:  25%|██▌       | 16/63 [00:00<00:02, 18.16it/s][A[A

Collecting activations:  29%|██▊       | 18/63 [00:00<00:02, 18.11it/s][A[A

Collecting activations:  32%|███▏      | 20/63 [00:01<00:02, 18.07it/s][A[A

Collecting activations:  35%|███▍      | 22/63 [00:01<00:02, 18.05it/s][A[A

Collecting activations:  38%|███▊      | 24/63 [00:01<00:02, 18.04it/s][A[A

Collecting activations:  41%|████▏     | 26/63 [00:01<00:02, 18.03it/s][A[A

Collecting activations:  44%|████▍     | 28/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  48%|████▊     | 30/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  51%|█████     | 32/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  54%|█████▍    | 34/63 [00:01<00:01, 18.02it/s][A[A

Collecting activations:  57%|█████▋    | 36/63 [00:01<00:01, 18.01it/s][A[A

Collecting activations:  60%|██████    | 38/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  63%|██████▎   | 40/63 [00:02<00:01, 18.01it/s][A[A

Collecting activations:  67%|██████▋   | 42/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  70%|██████▉   | 44/63 [00:02<00:01, 18.00it/s][A[A

Collecting activations:  73%|███████▎  | 46/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  76%|███████▌  | 48/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  79%|███████▉  | 50/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  83%|████████▎ | 52/63 [00:02<00:00, 18.01it/s][A[A

Collecting activations:  86%|████████▌ | 54/63 [00:02<00:00, 18.00it/s][A[A

Collecting activations:  89%|████████▉ | 56/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  92%|█████████▏| 58/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  95%|█████████▌| 60/63 [00:03<00:00, 18.00it/s][A[A

Collecting activations:  98%|█████████▊| 62/63 [00:03<00:00, 17.99it/s][A[ACollecting activations: 100%|██████████| 63/63 [00:03<00:00, 18.12it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.93it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 19.10it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.69it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.45it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.30it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.20it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.15it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.48it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.21it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.83it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.51it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.32it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.20it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.13it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.35it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.25it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.84it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.51it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.32it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.10it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.35it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.22it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.84it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.50it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.31it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.12it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.09it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.35it/s]


Collecting activations:   0%|          | 0/16 [00:00<?, ?it/s][A[A

Collecting activations:  19%|█▉        | 3/16 [00:00<00:00, 20.23it/s][A[A

Collecting activations:  38%|███▊      | 6/16 [00:00<00:00, 18.83it/s][A[A

Collecting activations:  50%|█████     | 8/16 [00:00<00:00, 18.49it/s][A[A

Collecting activations:  62%|██████▎   | 10/16 [00:00<00:00, 18.30it/s][A[A

Collecting activations:  75%|███████▌  | 12/16 [00:00<00:00, 18.18it/s][A[A

Collecting activations:  88%|████████▊ | 14/16 [00:00<00:00, 18.09it/s][A[A

Collecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.07it/s][A[ACollecting activations: 100%|██████████| 16/16 [00:00<00:00, 18.34it/s]
Num non-zero elements: 2304
Test accuracy for en: 0.998
Num non-zero elements: 2304
Test accuracy for fr: 1.0
Num non-zero elements: 2304
Test accuracy for de: 0.998
Num non-zero elements: 2304
Test accuracy for es: 1.0
Num non-zero elements: 2304
Test accuracy for nl: 1.0
Num non-zero elements: 1
Test accuracy for en: 0.937
Num non-zero elements: 1
Test accuracy for fr: 0.887
Num non-zero elements: 1
Test accuracy for de: 0.81
Num non-zero elements: 1
Test accuracy for es: 0.883
Num non-zero elements: 1
Test accuracy for nl: 0.854
Num non-zero elements: 2
Test accuracy for en: 0.969
Num non-zero elements: 2
Test accuracy for fr: 0.899
Num non-zero elements: 2
Test accuracy for de: 0.833
Num non-zero elements: 2
Test accuracy for es: 0.901
Num non-zero elements: 2
Test accuracy for nl: 0.896
Num non-zero elements: 5
Test accuracy for en: 0.994
Num non-zero elements: 5
Test accuracy for fr: 0.971
Num non-zero elements: 5
Test accuracy for de: 0.889
Num non-zero elements: 5
Test accuracy for es: 0.987
Num non-zero elements: 5
Test accuracy for nl: 0.939
Num non-zero elements: 10
Test accuracy for en: 0.997
Num non-zero elements: 10
Test accuracy for fr: 0.988
Num non-zero elements: 10
Test accuracy for de: 0.97
Num non-zero elements: 10
Test accuracy for es: 0.99
Num non-zero elements: 10
Test accuracy for nl: 0.959
Num non-zero elements: 20
Test accuracy for en: 0.997
Num non-zero elements: 20
Test accuracy for fr: 0.994
Num non-zero elements: 20
Test accuracy for de: 0.993
Num non-zero elements: 20
Test accuracy for es: 0.994
Num non-zero elements: 20
Test accuracy for nl: 0.988
Num non-zero elements: 50
Test accuracy for en: 0.998
Num non-zero elements: 50
Test accuracy for fr: 0.999
Num non-zero elements: 50
Test accuracy for de: 0.998
Num non-zero elements: 50
Test accuracy for es: 0.998
Num non-zero elements: 50
Test accuracy for nl: 0.995
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 11 epochs
Test accuracy for en: 0.999000072479248
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 12 epochs
Test accuracy for fr: 0.999000072479248
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 12 epochs
Test accuracy for de: 0.999000072479248
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 11 epochs
Test accuracy for es: 0.999000072479248
Num non-zero elements: 8192
Training probe with dim: 8192, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 12 epochs
Test accuracy for nl: 1.0
Num non-zero elements: 1
Test accuracy for en: 0.998
Num non-zero elements: 1
Test accuracy for fr: 0.847
Num non-zero elements: 1
Test accuracy for de: 0.997
Num non-zero elements: 1
Test accuracy for es: 0.866
Num non-zero elements: 1
Test accuracy for nl: 0.997
Num non-zero elements: 2
Test accuracy for en: 0.998
Num non-zero elements: 2
Test accuracy for fr: 0.997
Num non-zero elements: 2
Test accuracy for de: 1.0
Num non-zero elements: 2
Test accuracy for es: 0.998
Num non-zero elements: 2
Test accuracy for nl: 0.997
Num non-zero elements: 5
Test accuracy for en: 0.998
Num non-zero elements: 5
Test accuracy for fr: 0.997
Num non-zero elements: 5
Test accuracy for de: 0.998
Num non-zero elements: 5
Test accuracy for es: 0.999
Num non-zero elements: 5
Test accuracy for nl: 0.998
Num non-zero elements: 10
Test accuracy for en: 1.0
Num non-zero elements: 10
Test accuracy for fr: 0.998
Num non-zero elements: 10
Test accuracy for de: 0.999
Num non-zero elements: 10
Test accuracy for es: 0.997
Num non-zero elements: 10
Test accuracy for nl: 0.998
Num non-zero elements: 20
Test accuracy for en: 0.999
Num non-zero elements: 20
Test accuracy for fr: 0.997
Num non-zero elements: 20
Test accuracy for de: 0.999
Num non-zero elements: 20
Test accuracy for es: 0.998
Num non-zero elements: 20
Test accuracy for nl: 1.0
Num non-zero elements: 50
Test accuracy for en: 0.999
Num non-zero elements: 50
Test accuracy for fr: 0.997
Num non-zero elements: 50
Test accuracy for de: 1.0
Num non-zero elements: 50
Test accuracy for es: 0.998
Num non-zero elements: 50
Test accuracy for nl: 0.997

Running SAE evaluation on all selected SAEs: 100%|██████████| 1/1 [17:20<00:00, 1040.82s/it][ARunning SAE evaluation on all selected SAEs: 100%|██████████| 1/1 [17:20<00:00, 1040.82s/it]
Evaluations: 100%|██████████| 1/1 [17:33<00:00, 1053.49s/it]Evaluations: 100%|██████████| 1/1 [17:33<00:00, 1053.49s/it]
